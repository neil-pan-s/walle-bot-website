(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{337:function(e,t,r){r(78);e.exports={init:function(){},process:function(e,t,r,a){var n=0;return r<-10?(n=r,e.day["open-crash"]++,e.profit["open-crash"]+=n,e.profit["open-crash"]=+e.profit["open-crash"].toFixed(2),a>0&&(e.day["reverse-crash"]++,e.profit["reverse-crash"]+=a+10,e.profit["reverse-crash"]=+e.profit["reverse-crash"].toFixed(2))):a<-10?(n=-10,e.day["stop-crash"]++,e.profit["stop-crash"]+=a+10,e.profit["stop-crash"]=+e.profit["stop-crash"].toFixed(2)):n=a,n},getPTCChange:function(e,t){return e<-10?e:t<-10?-10:t}}},423:function(e,t){var r={};e.exports={process:function(e,t,a){window?function(e,t,a){for(var n in r={},e){var s=e[n],c=+n+1+"";e[c]?a[n]>0&&a[c]>0?r[s]="+":a[n]<0&&a[c]<0?r[s]="-":r[s]="~":r[s]="~"}}(e,0,a):function(e,t,a){for(var n in r={},e){var s=e[n],c=+n+1+"",i=+n+2+"";e[c]&&e[i]?a[c]>0&&a[i]>0?r[s]="+":a[c]<0&&a[i]<0?r[s]="-":r[s]="~":r[s]="~"}}(e,0,a)},trend:function(e){return r[e]||"~"}}},686:function(e,t,r){r(40),r(41),r(42),r(35),r(21),r(43),r(33),r(25);var a=r(1);r(18);var n=r(687),s=r(688).generate,c=r(423),i=[r(689),r(337),r(690),r(691),r(692),r(693),r(694)];function o(){return(o=n(a.mark((function e(t,r){var n,o,u,l,h,p,f,v,d,b,m,k,y,x,g,w,O,j,S;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s(t),e.prev=1,r){e.next=4;break}return e.abrupt("return",n);case 4:for(o=r.date,u=r.open,l=r.close,t.includes("上证指数")&&c.process(o,u,l),h=!0,p=!1,f=void 0,e.prev=11,v=i[Symbol.iterator]();!(h=(d=v.next()).done);h=!0)d.value.init();e.next=19;break;case 15:e.prev=15,e.t0=e.catch(11),p=!0,f=e.t0;case 19:e.prev=19,e.prev=20,h||null==v.return||v.return();case 22:if(e.prev=22,!p){e.next=25;break}throw f;case 25:return e.finish(22);case 26:return e.finish(19);case 27:b=o.length,m=0;case 29:if(!(m<b)){e.next=55;break}for(k=o[m],y=u[m],x=l[m],g=!0,w=!1,O=void 0,e.prev=36,j=i[Symbol.iterator]();!(g=(S=j.next()).done);g=!0)S.value.process(n,k,y,x);e.next=44;break;case 40:e.prev=40,e.t1=e.catch(36),w=!0,O=e.t1;case 44:e.prev=44,e.prev=45,g||null==j.return||j.return();case 47:if(e.prev=47,!w){e.next=50;break}throw O;case 50:return e.finish(47);case 51:return e.finish(44);case 52:m++,e.next=29;break;case 55:e.next=60;break;case 57:e.prev=57,e.t2=e.catch(1),console.log("#strategy# analyse fail: ",e.t2);case 60:return e.abrupt("return",n);case 61:case"end":return e.stop()}}),e,null,[[1,57],[11,15,19,27],[20,,22,26],[36,40,44,52],[45,,47,51]])})))).apply(this,arguments)}e.exports={analyse:function(e,t){return o.apply(this,arguments)}}},688:function(e,t){e.exports={generate:function(e){return{name:e,profit:{max:0,"open-crash":-0,"stop-crash":0,"reverse-crash":0,normal:0,strategy:0,compound:0,hot:0,"up-trade":0,"down-trade":0},day:{normal:0,up:0,down:0,"open-crash":0,"stop-crash":0,"reverse-crash":0,trade:0,rest:0,compound:0,hot:0,"up-trade":0,"down-trade":0},profitrate:{normal:0,strategy:0,compound:0,hot:0,"up-trade":0,"down-trade":0},winrate:{normal:0,strategy:0,compound:0,hot:0,"up-trade":0,"down-trade":0},"daily-open-profit":[],"daily-close-profit":[],"daily-open-ptcchange":[],"daily-close-ptcchange":[]}}}},689:function(e,t,r){r(78),e.exports={init:function(){},process:function(e,t,r,a){a>=0?(e.day.up++,e.profit.max+=a,e.profit.max=+e.profit.max.toFixed(2)):e.day.down++,e.day.normal++,e.profit.normal+=a,e.profit.normal=+e.profit.normal.toFixed(2),e.profitrate.normal=+(e.profit.normal/e.day.normal).toFixed(2),e.winrate.normal=+(e.day.up/e.day.normal*100).toFixed(2),e["daily-open-ptcchange"].push(t,r),e["daily-close-ptcchange"].push(t,a);var n=e["daily-open-profit"].length,s=e["daily-close-profit"].length,c=e["daily-open-profit"][n-1]||0,i=e["daily-close-profit"][s-1]||0;i+=a,c=+(c+=r).toFixed(2),i=+i.toFixed(2),e["daily-open-profit"].push(t,c),e["daily-close-profit"].push(t,i)}}},690:function(e,t,r){r(78);var a=r(337),n=0,s=0,c=!1,i={};e.exports={isPeriodRest:function(e){return c},process:function(e,t,r,o){var u=a.getPTCChange(r,o);s<2?(c=!1,e.day.trade++,e.profit.strategy+=u,e.profit.strategy=+e.profit.strategy.toFixed(2),e.profitrate.strategy=+(e.profit.strategy/e.day.trade).toFixed(2),u>0?n++:0,e.winrate.strategy=+(n/e.day.trade*100).toFixed(2)):(c=!0,e.day.rest++),window?function(e,t,r,n){(i.date?a.getPTCChange(i.open,i.close):a.getPTCChange(r,n))>=0?(s=0):(0,s++),i={date:t,open:r,close:n}}(0,t,r,o):function(e,t,r,n){a.getPTCChange(r,n)>=0?(s=0):(0,s++)}(0,0,r,o)},init:function(){n=0,0,0,s=0,c=!1,i={}}}},691:function(e,t,r){r(78);var a=r(337),n=1,s=0;e.exports={process:function(e,t,r,c){var i=a.getPTCChange(r,c);n*=1+i/100*.1,e.profit.compound=1e3*(n-1),e.profit.compound=+e.profit.compound.toFixed(2),e.day.compound++,e.profitrate.compound=+(e.profit.compound/e.day.compound).toFixed(2),i>0?s++:0,e.winrate.compound=+(s/e.day.compound*100).toFixed(2)},init:function(){s=0,0,n=1}}},692:function(e,t,r){r(78);var a=r(337),n=0,s=0,c={};e.exports={process:function(e,t,r,i){var o=a.getPTCChange(r,i);s>=2&&(e.day.hot++,e.profit.hot=+(e.profit.hot+o).toFixed(2),e.profitrate.hot=+(e.profit.hot/e.day.hot).toFixed(2),o>0?n++:0,e.winrate.hot=+(n/e.day.hot*100).toFixed(2)),window?function(e,t,r,n){(c.date?a.getPTCChange(c.open,c.close):a.getPTCChange(r,n))>=20?s++:s=0,c={date:t,open:r,close:n}}(0,t,r,i):function(e,t,r,n){a.getPTCChange(r,n)>=20?s++:s=0}(0,0,r,i)},init:function(){n=0,0,s=0,c={}}}},693:function(e,t,r){r(78);var a=r(337),n=r(423),s=0;e.exports={process:function(e,t,r,c){var i=a.getPTCChange(r,c);"+"===n.trend(t)&&(e.day["up-trade"]++,e.profit["up-trade"]=+(e.profit["up-trade"]+i).toFixed(2),e.profitrate["up-trade"]=+(e.profit["up-trade"]/e.day["up-trade"]).toFixed(2),i>0?s++:0,e.winrate["up-trade"]=+(s/e.day["up-trade"]*100).toFixed(2))},init:function(){s=0,0}}},694:function(e,t,r){r(78);var a=r(337),n=r(423),s=0;e.exports={process:function(e,t,r,c){var i=a.getPTCChange(r,c);"-"===n.trend(t)&&(e.day["down-trade"]++,e.profit["down-trade"]=+(e.profit["down-trade"]+i).toFixed(2),e.profitrate["down-trade"]=+(e.profit["down-trade"]/e.day["down-trade"]).toFixed(2),i>0?s++:0,e.winrate["down-trade"]=+(s/e.day["down-trade"]*100).toFixed(2))},init:function(){s=0,0}}},695:function(e,t){},696:function(e,t){},697:function(e,t){},698:function(e,t){},699:function(e,t){},700:function(e,t){},701:function(e,t){},702:function(e,t){},703:function(e,t){},704:function(e,t){},705:function(e,t){},706:function(e,t){},729:function(e,t,r){"use strict";r.r(t);var a=r(1),n=r.n(a),s=(r(18),r(2)),c=r(5),i=r(6),o=(r(40),r(41),r(42),r(24),r(34),r(21),r(33),r(25),r(359)),u=r(3),l=function e(t){var r=t.capture,a=t.trace,n=t.interval,s=t.lists,i=t.date,o=t.name;Object(c.a)(this,e),Object(u.a)(this,"capture",void 0),Object(u.a)(this,"trace",[]),Object(u.a)(this,"interval",void 0),Object(u.a)(this,"lists",void 0),Object(u.a)(this,"date",void 0),Object(u.a)(this,"name",void 0),this.capture=r,this.trace=a,this.interval=n,this.lists=s,this.name=o,this.date=i},h=(r(35),r(53),r(26),r(43),r(682),r(267),r(352)),p=(r(99),r(52),r(323),r(78),r(683),r(54),r(100),r(38)),f=r(320),v=r(338),d=(r(57),r(271),r(266),r(333)),b=r(327),m=r(334),k=r(520),y=r(317),x=r(0),g=r.n(x),w=r(7),O=r.n(w),j=O.a.createInstance({name:"flow",driver:O.a.INDEXEDDB}),S=new(function(){function e(){var t=this;Object(c.a)(this,e),Object(u.a)(this,"flows",{}),Object(u.a)(this,"maOfFlows",{}),Object(u.a)(this,"continueOfFlows",{}),Object(u.a)(this,"topOfFlows",{rate:[],change:[],limitup:[]}),Object(u.a)(this,"lastFlowDate","");var r=(parent.location.hash||location.hash).includes("9529");setTimeout(Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=6;break}return console.info("#Flows# force download start ..."),e.next=4,t.download();case 4:return console.info("#Flows# force download end ..."),e.abrupt("return");case 6:return e.next=8,t.load();case 8:return e.next=10,t.calcContinue();case 10:return e.next=12,t.calcTop();case 12:return e.next=14,t.update();case 14:case"end":return e.stop()}}),e)}))))}var t,r,a,o,l,h,p,v,x,w;return Object(i.a)(e,[{key:"load",value:(w=Object(s.a)(n.a.mark((function e(){var t,r=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.length();case 3:if(t=e.sent){e.next=7;break}return console.log("#Flows# flows not exist!"),e.abrupt("return");case 7:return e.next=9,j.iterate((function(e,t){e&&(r.flows[t]=e)}));case 9:this.lastFlowDate=this.flows[1.000001][0].date,console.info("#Flows# load flows ".concat(t," date ").concat(this.lastFlowDate," ...")),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.warn("#Flows# load flows fail ",e.t0);case 16:case"end":return e.stop()}}),e,this,[[0,13]])}))),function(){return w.apply(this,arguments)})},{key:"save",value:(x=Object(s.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t in this.flows)this.flows[t].length>30&&(this.flows[t]=this.flows[t].slice(0,30)),j.setItem(t,this.flows[t]);case 1:case"end":return e.stop()}}),e,this)}))),function(){return x.apply(this,arguments)})},{key:"download",value:(v=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=d.a.stocks(),t=[].concat(t,"1.000001"),console.time("Flows Download"),r=!0,a=!1,s=void 0,e.prev=7,c=t[Symbol.iterator]();case 9:if(r=(i=c.next()).done){e.next=19;break}return o=i.value,e.next=13,f.a.captureFlows(o);case 13:return this.flows[o]=e.sent,e.next=16,Object(y.a)(50);case 16:r=!0,e.next=9;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(7),a=!0,s=e.t0;case 25:e.prev=25,e.prev=26,r||null==c.return||c.return();case 28:if(e.prev=28,!a){e.next=31;break}throw s;case 31:return e.finish(28);case 32:return e.finish(25);case 33:console.timeEnd("Flows Download"),this.save(),e.next=40;break;case 37:e.prev=37,e.t1=e.catch(0),console.warn("#Flows# download flows fail ",e.t1);case 40:case"end":return e.stop()}}),e,this,[[0,37],[7,21,25,33],[26,,28,32]])}))),function(){return v.apply(this,arguments)})},{key:"update",value:(p=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i,o,u,l,h,p;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.length();case 2:if(e.sent){e.next=6;break}return console.log("#Flows# flows not exist, update exit !"),e.abrupt("return");case 6:if(b.a.isWeekend()){e.next=31;break}return e.next=9,b.a.until("150000");case 9:console.info("#Flows# auto update daily ..."),t=m.a.stocks(),r=g()().format("YYYYMMDD"),e.t0=n.a.keys(t);case 13:if((e.t1=e.t0()).done){e.next=30;break}if(a=e.t1.value,e.prev=15,s=t[a],c=s.name,i=s.price,o=s.change,u=s.netinflow,l=s.rate,!((h=this.flows[a][0])&&+h.date>=+r)){e.next=20;break}return e.abrupt("continue",13);case 20:if(h.price!==i||h.rate!==l||h.netinflow!==u){e.next=22;break}return e.abrupt("continue",13);case 22:p=new k.a({code:a,name:c,date:r,price:i,change:o,netinflow:u,netinflowrate:l}),this.flows[a].unshift(p),e.next=28;break;case 26:e.prev=26,e.t2=e.catch(15);case 28:e.next=13;break;case 30:this.save();case 31:case"end":return e.stop()}}),e,this,[[15,26]])}))),function(){return p.apply(this,arguments)})},{key:"downloadDaily",value:(h=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=g()().format("YYYYMMDD"),r=g()().format("HHmmss"),a=g()().subtract(1,"day").format("YYYYMMDD"),1==+g()().day()&&(a=g()().subtract(3,"days").format("YYYYMMDD")),!(t===this.lastFlowDate||a<=this.lastFlowDate)){e.next=6;break}return e.abrupt("return");case 6:if(!(+r>=15e4)){e.next=8;break}return e.abrupt("return");case 8:if(b.a.isWeekend()){e.next=17;break}return s=Math.floor(58*Math.random())+1,c="00".concat(s).slice(-2),i="07"+c+"00",console.info("#Flows# auto download daily at ".concat(i," ...")),e.next=15,b.a.until(i);case 15:return e.next=17,this.download();case 17:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"has",value:function(e){return!!this.flows[e]&&this.flows[e]}},{key:"flow",value:(l=Object(s.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.has(t)){e.next=2;break}return e.abrupt("return",this.capture(t));case 2:return e.abrupt("return",this.flows[t]);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"capture",value:(o=Object(s.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.flows[t]=f.a.captureFlows(t),e.abrupt("return",this.flows[t]);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"calcContinue",value:(a=Object(s.a)(n.a.mark((function e(){var t,r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n.a.keys(this.flows);case 1:if((e.t1=e.t0()).done){e.next=12;break}return t=e.t1.value,r=this.flows[t],a=r[0]?r[0].name:"",e.next=7,F.isValidStock(t,a);case 7:if(e.sent){e.next=9;break}return e.abrupt("continue",1);case 9:this.calcContinueCore(t,a,r),e.next=1;break;case 12:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"calcContinueCore",value:function(e,t,r){this.continueOfFlows[e]={code:e,name:t,rate:0,change:0,limitup:0};var a=!0,n=!1,s=void 0;try{for(var c,i=r[Symbol.iterator]();!(a=(c=i.next()).done);a=!0){var o=c.value;o.change;if(!(o.rate>0))break;this.continueOfFlows[e].rate+=1}}catch(e){n=!0,s=e}finally{try{a||null==i.return||i.return()}finally{if(n)throw s}}var u=!0,l=!1,h=void 0;try{for(var p,f=r[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var v=p.value,d=v.change;v.rate;if(!(d>0))break;this.continueOfFlows[e].change+=1}}catch(e){l=!0,h=e}finally{try{u||null==f.return||f.return()}finally{if(l)throw h}}var b=!0,m=!1,k=void 0;try{for(var y,x=r[Symbol.iterator]();!(b=(y=x.next()).done);b=!0){var g=y.value,w=g.change;g.rate;if(!(w>=9.8))break;this.continueOfFlows[e].limitup+=1}}catch(e){m=!0,k=e}finally{try{b||null==x.return||x.return()}finally{if(m)throw k}}}},{key:"calcTop",value:(r=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.calcTopCore("rate"),this.calcTopCore("change"),this.calcTopCore("limitup");case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"calcTopCore",value:function(e){var t=Object.values(this.continueOfFlows).sort((function(t,r){return r[e]-t[e]}));this.topOfFlows[e]=t,console.info("#Flow# top continue ".concat(e," stocks ...")),console.table(this.topOfFlows[e].slice(0,20))}},{key:"ma",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;try{var r=0,a=0,n=this.flows[e],s=m.a.stocks([e])[e],c=g()().format("YYYYMMDD");r+=+s.price,a++;var i=!0,o=!1,u=void 0;try{for(var l,h=n[Symbol.iterator]();!(i=(l=h.next()).done);i=!0){var p=l.value,f=p.price,v=p.date;if(c!==v&&(r+=f,++a===t))break}}catch(e){o=!0,u=e}finally{try{i||null==h.return||h.return()}finally{if(o)throw u}}return+(r/a).toFixed(2)}catch(e){return 0}}},{key:"top",value:function(e){return this.topOfFlows[e]}},{key:"continue",value:(t=Object(s.a)(n.a.mark((function e(t,r){var a,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.continueOfFlows[t]){e.next=3;break}return e.abrupt("return",this.continueOfFlows[t][r]);case 3:return e.next=5,this.flow(t);case 5:return a=e.sent,s=a[0]?a[0].name:"",this.calcContinueCore(t,s,a),e.abrupt("return",this.continueOfFlows[t][r]);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e,r){return t.apply(this,arguments)})}]),e}()),T=function(){function e(t,r,a,n,s){Object(c.a)(this,e),Object(u.a)(this,"$valid",{rateRatio:.6,averageChange2:.2,bigChange:6}),Object(u.a)(this,"range",{change:[null,null],price:[null,null],rate:[null,null],amount:[null,null]}),Object(u.a)(this,"day",{rise:0,down:0,bigRise:0,bigDown:0}),Object(u.a)(this,"fundamental",{eps:0,bvps:0,roe:0}),Object(u.a)(this,"index",{days:0,daysRatio:0,changeUpRatio:0,changeDownRatio:0}),Object(u.a)(this,"ratio",{mainRatio:0,abnormalRatio:0,lockRatio:0,onePercentRate:0,onePercentAmount:0}),Object(u.a)(this,"longterm",{days:0,averagePrice:0,change:0,rate:0,amount:0}),Object(u.a)(this,"shortterm",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(u.a)(this,"limitup",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(u.a)(this,"riseup",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(u.a)(this,"rateup",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(u.a)(this,"code",void 0),Object(u.a)(this,"name",void 0),Object(u.a)(this,"stock",void 0),Object(u.a)(this,"vtype",void 0),Object(u.a)(this,"validator",void 0),Object(u.a)(this,"flow",[]),Object(u.a)(this,"gene",{}),this.code=t,this.stock=r,this.flow=a,this.vtype=s;var i=!0,o=!1,l=void 0;try{for(var h,p=v.a.validators[Symbol.iterator]();!(i=(h=p.next()).done);i=!0){var f=h.value;if(f.name===s){this.validator=new F(f);break}}}catch(e){o=!0,l=e}finally{try{i||null==p.return||p.return()}finally{if(o)throw l}}Object.assign(this,n),r&&(this.name=r.name)}var t,r,a,o;return Object(i.a)(e,[{key:"toMoney",value:function(e){return e=Math.abs(+e)>=1e8?(+e/1e8).toFixed(2)+"亿":(+e/1e4).toFixed(2)+"万"}},{key:"analyse",value:(o=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.flow||!this.flow.length){e.next=25;break}return e.next=4,this.calcFundamental();case 4:return e.next=6,this.calcDays();case 6:return e.next=8,this.calcRange();case 8:return e.next=10,this.calcLimitup();case 10:return e.next=12,this.calcRiseup();case 12:return e.next=14,this.calcRateup();case 14:return e.next=16,this.calcLongterm();case 16:return e.next=18,this.calcShortterm();case 18:return e.next=20,this.calcRatio();case 20:if("1.000001"===this.code){e.next=23;break}return e.next=23,this.calcIndex();case 23:return e.next=25,this.calcGene();case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(0),console.warn("#Gene# analyse fail ",this.code,e.t0);case 30:return e.abrupt("return",this);case 31:case"end":return e.stop()}}),e,this,[[0,27]])}))),function(){return o.apply(this,arguments)})},{key:"calcRange",value:function(){var e=!0,t=!1,r=void 0;try{for(var a,n=this.flow[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){var s=a.value,c=s.price,i=s.change,o=s.rate,u=s.netinflow;null===this.range.price[0]&&(this.range.price[0]=c),null===this.range.price[1]&&(this.range.price[1]=c),c<this.range.price[0]&&(this.range.price[0]=c),c>this.range.price[1]&&(this.range.price[1]=c),null===this.range.change[0]&&(this.range.change[0]=i),null===this.range.change[1]&&(this.range.change[1]=i),i<this.range.change[0]&&(this.range.change[0]=i),i>this.range.change[1]&&(this.range.change[1]=i),null===this.range.amount[0]&&(this.range.amount[0]=u),null===this.range.amount[1]&&(this.range.amount[1]=u),u<this.range.amount[0]&&(this.range.amount[0]=u),u>this.range.amount[1]&&(this.range.amount[1]=u),null===this.range.rate[0]&&(this.range.rate[0]=o),null===this.range.rate[1]&&(this.range.rate[1]=o),o<this.range.rate[0]&&(this.range.rate[0]=o),o>this.range.rate[1]&&(this.range.rate[1]=o)}}catch(e){t=!0,r=e}finally{try{e||null==n.return||n.return()}finally{if(t)throw r}}this.range.price[0]=+this.range.price[0].toFixed(2),this.range.price[1]=+this.range.price[1].toFixed(2),this.range.change[0]=+this.range.change[0].toFixed(2),this.range.change[1]=+this.range.change[1].toFixed(2),this.range.amount[0]=+this.range.amount[0].toFixed(2),this.range.amount[1]=+this.range.amount[1].toFixed(2),this.range.rate[0]=+this.range.rate[0].toFixed(2),this.range.rate[1]=+this.range.rate[1].toFixed(2)}},{key:"calcDays",value:function(){var e=!0,t=!1,r=void 0;try{for(var a,n=this.flow[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){var s=a.value.change;s>=0?this.day.rise++:this.day.down++,s>=this.$valid.bigChange&&this.day.bigRise++,s<=-this.$valid.bigChange&&this.day.bigDown++}}catch(e){t=!0,r=e}finally{try{e||null==n.return||n.return()}finally{if(t)throw r}}}},{key:"calcIndex",value:(a=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=0,r=0,a=0,s=0,c=0,e.next=3,P.gene("1.000001",this.vtype);case 3:i=e.sent,o=i.flow,this.flow.forEach((function(e,n){var i=o[n];i&&e.date===i.date&&(e.change>0&&i.change>0&&(t++,r+=e.change,s+=i.change),e.change<0&&i.change<0&&(t++,a+=e.change,c+=i.change))})),this.index.days=t,this.index.daysRatio=+(t/this.flow.length).toFixed(2),this.index.changeUpRatio=+(r/s).toFixed(2),this.index.changeDownRatio=-(a/c).toFixed(2);case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"calcFundamental",value:function(){this.fundamental.eps=+this.stock.eps.toFixed(2),this.fundamental.bvps=+this.stock.bvps.toFixed(2),this.fundamental.roe=+this.stock.roe.toFixed(2)}},{key:"calcLongterm",value:function(){var e=0,t=!0,r=!1,a=void 0;try{for(var n,s=this.flow[Symbol.iterator]();!(t=(n=s.next()).done);t=!0){var c=n.value,i=c.price,o=c.change,u=c.rate,l=c.netinflow;this.longterm.change+=o,this.longterm.rate+=u,this.longterm.amount+=l,this.longterm.days++,e+=i}}catch(e){r=!0,a=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw a}}this.longterm.averagePrice=+(e/this.flow.length).toFixed(2),this.longterm.change=+this.longterm.change.toFixed(2),this.longterm.rate=+this.longterm.rate.toFixed(2),this.longterm.amount=+this.longterm.amount.toFixed(2)}},{key:"calcShorttermFun",value:(r=Object(s.a)(n.a.mark((function e(t,r){var a,s,c,i,o,u,l,h,p,f,v,d;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0,s=0,c=0,i=0,e.t0=n.a.keys(this.flow);case 2:if((e.t1=e.t0()).done){e.next=16;break}return o=e.t1.value,u=this.flow[o],l=u.code,h=u.name,p=u.price,f=u.change,v=u.rate,e.next=7,r({code:l,name:h,price:p,change:f,rate:v});case 7:if(e.sent){e.next=9;break}return e.abrupt("continue",2);case 9:a++,c+=f,s+=v,(d=this.flow[+o+1])&&(i+=+d.change),e.next=2;break;case 16:a>0&&(t.days=a,t.change=+i.toFixed(2),t.averageChange=+(c/a).toFixed(2),t.averageRate=+(s/a).toFixed(2),t.averageChange2=+(i/a).toFixed(2));case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"calcShortterm",value:function(){return this.calcShorttermFun(this.shortterm,function(){var e=Object(s.a)(n.a.mark((function e(t){var r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.code,t.name,t.price,r=t.change,a=t.rate,e.abrupt("return",r>0&&a>0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"calcLimitup",value:function(){return this.calcShorttermFun(this.limitup,(function(e){e.code,e.name,e.price;var t=e.change,r=e.rate;return t>=9&&r>0}))}},{key:"calcRiseup",value:function(){var e=this;return this.calcShorttermFun(this.riseup,(function(t){t.code,t.name,t.price;var r=t.change,a=t.rate;return r>=e.$valid.bigChange&&a>0}))}},{key:"calcRateup",value:function(){var e=this;return this.calcShorttermFun(this.rateup,(function(t){t.code,t.name,t.price,t.change;return t.rate>e.range.rate[1]*e.$valid.rateRatio}))}},{key:"isValidShortterm",value:(t=Object(s.a)(n.a.mark((function e(t){var r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.code,t.change,r=t.rate,a={},e.next=4,this.calcShorttermFun(a,(function(e){e.code,e.name,e.price,e.change;var t=e.rate;return Math.abs((t-r)/r)>=.2}));case 4:return e.abrupt("return",a.averageChange2>=this.$valid.averageChange2);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"calcRatio",value:function(){var e=0,t=0,r=0,a=this.flow.slice(-1)[0],n=!0,s=!1,c=void 0;try{for(var i,o=this.flow[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value,l=u.change,h=u.rate,p=u.netinflow;l>0&&h>0&&(e+=h,t+=p,r+=l)}}catch(e){s=!0,c=e}finally{try{n||null==o.return||o.return()}finally{if(s)throw c}}this.ratio.onePercentRate=+(e/r).toFixed(2),this.ratio.onePercentAmount=+(t/r).toFixed(2),this.ratio.mainRatio=+(this.longterm.rate/this.longterm.days).toFixed(2),this.ratio.abnormalRatio=+((this.day.bigRise+this.day.bigDown)/this.longterm.days).toFixed(2),this.ratio.lockRatio=+(+a.price/this.longterm.averagePrice).toFixed(2)}},{key:"calcGene",value:function(){this.gene.ratio={mainRatio:this.ratio.mainRatio,abnormalRatio:this.ratio.abnormalRatio,lockRatio:this.ratio.lockRatio,onePercentRate:this.ratio.onePercentRate,onePercentAmount:this.toMoney(this.ratio.onePercentAmount)},this.gene.shortterm=this.shortterm,this.gene.longterm={days:this.longterm.days,averagePrice:this.longterm.averagePrice,change:this.longterm.change,rate:this.longterm.rate,amount:this.toMoney(this.longterm.amount)},this.gene.limitup=this.limitup,this.gene.riseup=this.riseup,this.gene.rateup=this.rateup,this.gene.day=this.day,this.gene.range={change:this.range.change.toString(),price:this.range.price.toString(),rate:this.range.rate.toString(),amount:[this.toMoney(this.range.amount[0]),this.toMoney(this.range.amount[1])]},this.gene.index=this.index,this.gene.fundamental=this.fundamental}},{key:"show",value:function(){for(var e in this.gene)console.info("%c".concat(this.code,".").concat(e.toUpperCase()),"padding-left: 45%; color:#FFC107;"),console.table(this.gene[e])}},{key:"getFlow",value:function(){return this.flow}},{key:"getGene",value:function(){return this.gene}},{key:"toString",value:function(){var e="";for(var t in this.gene){var r=this.gene[t];for(var a in r)e+="".concat(t,".").concat(a,": ").concat(r[a].toString(),"  ")}return e}}]),e}(),P=new(function(){function e(){Object(c.a)(this,e),Object(u.a)(this,"genes",{}),Object(u.a)(this,"vtypes",{});var t=!0,r=!1,a=void 0;try{for(var n,s=v.a.validators[Symbol.iterator]();!(t=(n=s.next()).done);t=!0){var i=n.value,o=i.name,l=i.rule.gene,h={};for(var f in l)if(f.startsWith("$")){var d=f.split("."),b=Object(p.a)(d,2),m=b[0],k=b[1];h[m]||(h[m]={}),h[m][k]=+l[f]}this.vtypes[o]=h}}catch(e){r=!0,a=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw a}}}var t,r,a;return Object(i.a)(e,[{key:"has",value:function(e,t){return!!this.genes[t]&&this.genes[t][e]}},{key:"param",value:(a=Object(s.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.vtypes[t]||{});case 1:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"gene",value:(r=Object(s.a)(n.a.mark((function e(t,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.has(t,r)){e.next=3;break}return e.next=3,this.capture(t,r);case 3:return e.abrupt("return",this.genes[r][t]);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"capture",value:(t=Object(s.a)(n.a.mark((function e(t,r){var a,s,c,i,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.has(t,r)){e.next=3;break}return e.abrupt("return",this.gene(t,r));case 3:return e.next=5,Promise.all([S.flow(t),f.a.captureStock(t)]);case 5:return a=e.sent,s=Object(p.a)(a,2),c=s[0],i=s[1],e.next=11,new T(t,i,c,this.vtypes[r],r).analyse();case 11:return o=e.sent,this.genes[r]||(this.genes[r]={}),this.genes[r][t]=o,e.abrupt("return",o);case 17:e.prev=17,e.t0=e.catch(0),console.warn("#Genes# capture fail ",r,t,e.t0);case 20:case"end":return e.stop()}}),e,this,[[0,17]])}))),function(e,r){return t.apply(this,arguments)})}]),e}()),C=r(354),_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[],values:[]};return Function.apply(void 0,Object(C.a)(t.keys).concat(['"use strict";return ('.concat(e,")")])).apply(void 0,Object(C.a)(t.values))},L=r(315),F=function(){function e(t){Object(c.a)(this,e),this.config=t}var t,r,a,o,u,l,p,f;return Object(i.a)(e,[{key:"hasCaptureRule",value:function(e){return this.config.capture.includes(e)}},{key:"hasIntervalRule",value:function(e){return this.config.interval.includes(e)}},{key:"filter",value:(f=Object(s.a)(n.a.mark((function t(r,a){var s;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a.code,a.name,a.price,a.change,a.rate,a.turnover,a.qrr,a.eps,a.bvps,a.roe,s=this.config.capture,L.lb.getIntervalKeys().includes(r)&&(s=this.config.interval),L.lb.getBondKeys().includes(r)){t.next=11;break}return t.next=9,e.filterOfList(a);case 9:if(t.sent){t.next=11;break}return t.abrupt("return",!1);case 11:if(![L.F.key,L.t.key].includes(r)){t.next=13;break}return t.abrupt("return",!0);case 13:if(!s.includes("base")){t.next=18;break}return t.next=16,this.isValidBase(a);case 16:if(t.sent){t.next=18;break}return t.abrupt("return",!1);case 18:if(!s.includes("fundamental")){t.next=23;break}return t.next=21,this.isValidFundamental(a);case 21:if(t.sent){t.next=23;break}return t.abrupt("return",!1);case 23:if(!s.includes("whitelist")){t.next=28;break}return t.next=26,this.isValidWhitelist(a);case 26:if(t.sent){t.next=28;break}return t.abrupt("return",!1);case 28:if(!s.includes("gene")){t.next=33;break}return t.next=31,this.isValidGeneAnalyse(a.code,a);case 31:if(t.sent){t.next=33;break}return t.abrupt("return",!1);case 33:return t.abrupt("return",!0);case 36:return t.prev=36,t.t0=t.catch(0),t.abrupt("return",!1);case 39:case"end":return t.stop()}}),t,this,[[0,36]])}))),function(e,t){return f.apply(this,arguments)})},{key:"filterOfPreTrace",value:(p=Object(s.a)(n.a.mark((function e(t,r){var a,s,c,i,o,u,l,h,p,f,v,d,b,m,k;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.config.capture.includes("pre-trace")){e.next=3;break}return e.abrupt("return",!0);case 3:if(a=this.config.rule["pre-trace"]){e.next=6;break}return e.abrupt("return",!0);case 6:s=Object.keys(t),c=0,i=s;case 8:if(!(c<i.length)){e.next=22;break}if(o=i[c],![L.F.key,L.t.key].includes(o)){e.next=12;break}return e.abrupt("continue",19);case 12:if(u=t[o],l=r[o],u&&l){e.next=16;break}return e.abrupt("continue",19);case 16:for(f in h=u.getStocks(),p=l.getStocks(),h)for(b in v=h[f],d=p[f],a)m=(d[b]-v[b])/v[b],k="".concat(m).concat(a[b]),_(k)||(console.info("#Validator# filter stock of PreTrace",o,v.code,v.name,v.price,v.change,b,"[ ",d[b]," - ",v[b],a[b]," ]"),delete h[f]);case 19:c++,e.next=8;break;case 22:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"check",value:function(e,t,r,a){if(!e)return!0;try{for(var n=Object.keys(e),s=0,c=n;s<c.length;s++){var i=c[s],o=_("data.".concat(i),{keys:["data"],values:[t]}),u="".concat(o).concat(e[i]);if(void 0!==o&&!_(u))return!1}}catch(e){}return!0}},{key:"isFullRequiredFields",value:function(e){var t=new h.a({});for(var r in t)if(!e.hasOwnProperty(r))return!1;return!0}},{key:"isValidBase",value:(l=Object(s.a)(n.a.mark((function e(t){var r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.code,a=t.name,t.price,t.change,t.rate,t.turnover,t.qrr,e.abrupt("return",this.check(this.config.rule.base,t,r,a));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"isValidWhitelist",value:(u=Object(s.a)(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.code,t.name,d.a.whitelist().has(r)){e.next=3;break}return e.abrupt("return",!1);case 3:return e.abrupt("return",!0);case 4:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"isValidFundamental",value:(o=Object(s.a)(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.config.rule.fundamental){e.next=3;break}return e.abrupt("return",!0);case 3:return e.abrupt("return",this.check(r,t,t.code,t.name));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"isValidGeneAnalyse",value:(a=Object(s.a)(n.a.mark((function e(t,r){var a,s,c,i,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.config.rule.gene){e.next=3;break}return e.abrupt("return",!0);case 3:return s=this.config.name,e.next=6,P.gene(t,s);case 6:return c=e.sent,e.next=9,c.isValidShortterm(r);case 9:if(e.sent){e.next=11;break}return e.abrupt("return",!1);case 11:i={},e.t0=n.a.keys(a);case 13:if((e.t1=e.t0()).done){e.next=20;break}if(!(o=e.t1.value).startsWith("$")){e.next=17;break}return e.abrupt("continue",13);case 17:i[o]=a[o],e.next=13;break;case 20:return e.abrupt("return",this.check(i,c,c.code,c.name));case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})}],[{key:"filterOfList",value:(r=Object(s.a)(n.a.mark((function t(r){var a,s,c,i;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.code,s=r.name,c=r.price,i=r.change,r.rate,r.turnover,r.qrr,!(i>9.8||c<=0)){t.next=3;break}return t.abrupt("return",!1);case 3:return t.abrupt("return",e.isValidStock(a,s));case 4:case"end":return t.stop()}}),t)}))),function(e){return r.apply(this,arguments)})},{key:"isValidStock",value:(t=Object(s.a)(n.a.mark((function e(t,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.toUpperCase().includes("ST")){e.next=2;break}return e.abrupt("return",!1);case 2:if(!r.toUpperCase().includes("B")&&!r.toUpperCase().includes("Ｂ")){e.next=4;break}return e.abrupt("return",!1);case 4:if(!r.includes("退")){e.next=6;break}return e.abrupt("return",!1);case 6:if(!r.match(/\d+/g)){e.next=8;break}return e.abrupt("return",!1);case 8:if(!("".concat(t).startsWith("688")||"".concat(t).startsWith("300")||"".concat(t).startsWith("200")||"".concat(t).startsWith("900"))){e.next=10;break}return e.abrupt("return",!1);case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})}]),e}(),B=(r(422),r(328)),D=r(322),M=r(329),I=function(){function e(t){Object(c.a)(this,e),Object(u.a)(this,"name",void 0),this.name=t}var t,r,a;return Object(i.a)(e,[{key:"filter",value:(a=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"start",value:(r=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"broadcast",value:function(e,t,r){window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Interval_Event",{detail:{name:e,vtype:t,stock:r}}))}},{key:"monitor",value:(t=Object(s.a)(n.a.mark((function e(t,r){var a,s,c,i,o,u,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r||(r=new F(v.a.validators[0])),a=r.config.name,s=!0,c=!1,i=void 0,e.prev=6,o=t[Symbol.iterator]();case 8:if(s=(u=o.next()).done){e.next=25;break}if(l=u.value,r.isFullRequiredFields(l)){e.next=14;break}return e.next=13,f.a.captureStock(l.code);case 13:l=e.sent;case 14:return e.next=16,r.filter(this.name,l);case 16:if(e.sent){e.next=18;break}return e.abrupt("continue",22);case 18:return e.next=20,this.filter(l);case 20:if(!e.sent){e.next=22;break}this.broadcast(this.name,a,l);case 22:s=!0,e.next=8;break;case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(6),c=!0,i=e.t0;case 31:e.prev=31,e.prev=32,s||null==o.return||o.return();case 34:if(e.prev=34,!c){e.next=37;break}throw i;case 37:return e.finish(34);case 38:return e.finish(31);case 39:e.next=43;break;case 41:e.prev=41,e.t1=e.catch(0);case 43:case"end":return e.stop()}}),e,this,[[0,41],[6,27,31,39],[32,,34,38]])}))),function(e,r){return t.apply(this,arguments)})}]),e}(),Y=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L.K.key,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(c.a)(this,t),(e=Object(B.a)(this,Object(D.a)(t).call(this,r))).minContinueDays=a,e}var r,a;return Object(M.a)(t,e),Object(i.a)(t,[{key:"filter",value:(a=Object(s.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.minContinueDays){e.next=6;break}return e.next=3,S.continue(t.code,"limitup");case 3:if(!(e.sent<this.minContinueDays)){e.next=6;break}return e.abrupt("return",!1);case 6:return e.abrupt("return",+t.change>=9.5);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"start",value:(r=Object(s.a)(n.a.mark((function e(){var t=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{b.a.interval(Object(s.a)(n.a.mark((function e(){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.prev=1,e.next=4,m.a.listOfStocks("netinflow");case 4:return r=(r=e.sent).slice(0,200),e.next=8,t.monitor(r);case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(1);case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(0),console.warn("#diggers# capture fail",e.t1);case 17:case"end":return e.stop()}}),e,null,[[0,14],[1,10]])}))),null,30)}catch(e){}case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})}]),t}(I),E=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L.M.key,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return Object(c.a)(this,t),(e=Object(B.a)(this,Object(D.a)(t).call(this,r))).dayOfMa=a,e}var r;return Object(M.a)(t,e),Object(i.a)(t,[{key:"filter",value:(r=Object(s.a)(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=S.ma(t.code,this.dayOfMa),e.abrupt("return",+t.price<r);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}]),t}(I),R=r(353),W=r(335),H=r(339),q=r.n(H),K=function(e){function t(){var e,r;Object(c.a)(this,t);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return r=Object(B.a)(this,(e=Object(D.a)(t)).call.apply(e,[this].concat(n))),Object(u.a)(Object(R.a)(r),"ma5Monitor",new E(L.M.key,5)),Object(u.a)(Object(R.a)(r),"ma7Monitor",new E(L.N.key,7)),Object(u.a)(Object(R.a)(r),"ma10Monitor",new E(L.L.key,10)),r}var r,a,o,l,h;return Object(M.a)(t,e),Object(i.a)(t,[{key:"start",value:(h=Object(s.a)(n.a.mark((function e(){var t,r=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t=v.a.intervals[0],b.a.interval(Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.clear();case 2:return e.next=4,r.capture(r.name);case 4:case"end":return e.stop()}}),e)}))),t.trace)}catch(e){}case 1:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"update",value:(l=Object(s.a)(n.a.mark((function e(){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[this.ma5Monitor,this.ma7Monitor,this.ma10Monitor],e.abrupt("return",Object(W.a)(Object(D.a)(t.prototype),"update",this).call(this,r));case 2:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"clear",value:(o=Object(s.a)(n.a.mark((function e(){var t,r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=n.a.keys(this.stocks);case 2:if((e.t1=e.t0()).done){e.next=13;break}return t=e.t1.value,r=this.stocks[t],e.next=7,this.filter(r);case 7:if(e.sent){e.next=11;break}return this.broadcast(this.name,"v0",r,"sell"),e.next=11,this.deliver(r.code);case 11:e.next=2;break;case 13:e.next=17;break;case 15:e.prev=15,e.t2=e.catch(0);case 17:case"end":return e.stop()}}),e,this,[[0,15]])}))),function(){return o.apply(this,arguments)})},{key:"capture",value:(a=Object(s.a)(n.a.mark((function e(r,a){var s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.captureList(r);case 3:return s=e.sent,e.abrupt("return",Object(W.a)(Object(D.a)(t.prototype),"capture",this).call(this,s,a));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",[]);case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e,t){return a.apply(this,arguments)})},{key:"filter",value:(r=Object(s.a)(n.a.mark((function e(t){var r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=S.ma(t.code,5),a=S.ma(t.code,7),e.abrupt("return",+t.price>r&&+t.price>a);case 3:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})}]),t}(function(){function e(t){var r=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(c.a)(this,e),Object(u.a)(this,"name",void 0),Object(u.a)(this,"origin",{}),Object(u.a)(this,"stocks",{}),this.name=t,this.origin=q()(a),this.stocks=q()(n),window.addEventListener("__Walle_Stock_Ignore_Event",(function(e){var t=e.detail;r.ignore(t)}))}var t,r,a,o,l,h;return Object(i.a)(e,[{key:"filter",value:(h=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"start",value:(l=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)})},{key:"broadcast",value:function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"buy";window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Interval_Event",{detail:{name:e,vtype:t,stock:r,tradetype:a}}))}},{key:"ignore",value:(o=Object(s.a)(n.a.mark((function e(t){var r,a,s,c;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.time,a=t.vtype,s=t.listkey,c=t.code,e.prev=1,"interval"!==r||"v0"!==a||s!==this.name){e.next=9;break}if(!this.origin[c]){e.next=8;break}return e.next=6,this.deliver(c);case 6:e.next=9;break;case 8:delete this.stocks[c];case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(1);case 13:case"end":return e.stop()}}),e,this,[[1,11]])}))),function(e){return o.apply(this,arguments)})},{key:"deliver",value:(a=Object(s.a)(n.a.mark((function e(t){var r,a,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=Q.controller("interval","v0"),!this.origin[t]){e.next=15;break}return console.log("#Digger# filter ".concat(this.name," stock"),t),e.next=6,f.a.captureStock(t);case 6:return a=e.sent,s=this.origin[t],e.next=10,r.ignore(this.name,t);case 10:return e.next=12,r.t0Statement.remove(this.name,t);case 12:return e.next=14,r.t1Statement.update(this.name,s,a);case 14:delete this.stocks[t];case 15:e.next=19;break;case 17:e.prev=17,e.t0=e.catch(0);case 19:case"end":return e.stop()}}),e,this,[[0,17]])}))),function(e){return a.apply(this,arguments)})},{key:"update",value:(r=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(r=Object.keys(this.stocks)).length){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,f.a.captureStocks(r);case 6:this.stocks=e.sent,a=!0,s=!1,c=void 0,e.prev=10,i=t[Symbol.iterator]();case 12:if(a=(o=i.next()).done){e.next=19;break}return u=o.value,e.next=16,u.monitor(this.stocks,this.validator);case 16:a=!0,e.next=12;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(10),s=!0,c=e.t0;case 25:e.prev=25,e.prev=26,a||null==i.return||i.return();case 28:if(e.prev=28,!s){e.next=31;break}throw c;case 31:return e.finish(28);case 32:return e.finish(25);case 33:e.next=37;break;case 35:e.prev=35,e.t1=e.catch(0);case 37:return e.abrupt("return",Object.values(this.stocks));case 38:case"end":return e.stop()}}),e,this,[[0,35],[10,21,25,33],[26,,28,32]])}))),function(e){return r.apply(this,arguments)})},{key:"capture",value:(t=Object(s.a)(n.a.mark((function e(t,r){var a,s,c,i,o,u,l,h,p,d,b,m,k,y;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r||(r=new F(v.a.validators[0])),a=r.config.name,s=!0,c=!1,i=void 0,e.prev=6,o=t[Symbol.iterator]();case 8:if(s=(u=o.next()).done){e.next=34;break}if(l=u.value,r.isFullRequiredFields(l)){e.next=14;break}return e.next=13,f.a.captureStock(l.code);case 13:l=e.sent;case 14:return e.next=16,r.filter(this.name,l);case 16:if(e.sent){e.next=18;break}return e.abrupt("continue",31);case 18:return e.next=20,this.filter(l);case 20:if(e.sent){e.next=22;break}return e.abrupt("continue",31);case 22:if(p=(h=l).code,d=h.name,h.price,b=h.change,m=h.netinflow,k=h.rate,h.eps,h.bvps,h.roe,h.turnover,h.qrr,console.log("#Digger# capture ".concat(this.name,"-").concat(a," stock"),p,d,b,k,m),!this.stocks[p]&&!this.origin[p]){e.next=26;break}return e.abrupt("continue",31);case 26:if(!(Object.keys(this.stocks).length>=10)){e.next=29;break}return e.abrupt("break",34);case 29:this.broadcast(this.name,"v0",l,"buy"),this.stocks[p]=l;case 31:s=!0,e.next=8;break;case 34:e.next=40;break;case 36:e.prev=36,e.t0=e.catch(6),c=!0,i=e.t0;case 40:e.prev=40,e.prev=41,s||null==o.return||o.return();case 43:if(e.prev=43,!c){e.next=46;break}throw i;case 46:return e.finish(43);case 47:return e.finish(40);case 48:return y=Q.controller("interval","v0"),e.next=51,y.update(this.name,this.stocks);case 51:e.next=55;break;case 53:e.prev=53,e.t1=e.catch(0);case 55:return e.abrupt("return",Object.values(this.stocks));case 56:case"end":return e.stop()}}),e,this,[[0,53],[6,36,40,48],[41,,43,47]])}))),function(e,r){return t.apply(this,arguments)})}]),e}()),N=new(function(){function e(){Object(c.a)(this,e),Object(u.a)(this,"diggers",{})}var t,r,a;return Object(i.a)(e,[{key:"load",value:(a=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i,o,u,l,h,f,v,d,b;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Q.controller("interval","v0"),e.next=4,Promise.all([t.getYesterdayLists(),t.getTodayLists()]);case 4:if(r=e.sent,a=Object(p.a)(r,2),s=a[0],a[1]){e.next=11;break}return e.next=11,t.override(s);case 11:for(c=t.lists,i=L.lb.getIntervalKeys(),o=!0,u=!1,l=void 0,e.prev=16,h=i[Symbol.iterator]();!(o=(f=h.next()).done);o=!0){v=f.value,d={},b={};try{d=s[v].stocks,b=c[v].stocks}catch(e){}this.diggers[v]=new K(v,d,b)}e.next=24;break;case 20:e.prev=20,e.t0=e.catch(16),u=!0,l=e.t0;case 24:e.prev=24,e.prev=25,o||null==h.return||h.return();case 27:if(e.prev=27,!u){e.next=30;break}throw l;case 30:return e.finish(27);case 31:return e.finish(24);case 32:e.next=36;break;case 34:e.prev=34,e.t1=e.catch(0);case 36:case"end":return e.stop()}}),e,this,[[0,34],[16,20,24,32],[25,,27,31]])}))),function(){return a.apply(this,arguments)})},{key:"start",value:(r=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:e.prev=2,t=L.lb.getIntervalKeys(),r=!0,a=!1,s=void 0,e.prev=7,c=t[Symbol.iterator]();case 9:if(r=(i=c.next()).done){e.next=16;break}return o=i.value,e.next=13,this.diggers[o].start();case 13:r=!0,e.next=9;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(7),a=!0,s=e.t0;case 22:e.prev=22,e.prev=23,r||null==c.return||c.return();case 25:if(e.prev=25,!a){e.next=28;break}throw s;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return e.next=32,(new Y).start();case 32:e.next=36;break;case 34:e.prev=34,e.t1=e.catch(2);case 36:case"end":return e.stop()}}),e,this,[[2,34],[7,18,22,30],[23,,25,29]])}))),function(){return r.apply(this,arguments)})},{key:"list",value:(t=Object(s.a)(n.a.mark((function e(t,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.diggers[t].update());case 1:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})}]),e}()),A=new(function(){function e(){Object(c.a)(this,e)}var t,r,a;return Object(i.a)(e,[{key:"list",value:(a=Object(s.a)(n.a.mark((function e(t){var r,a,s=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},Object(u.a)(r,L.g.key,(function(){return s.listOfBond("change")})),Object(u.a)(r,L.f.key,(function(){return s.listOfStock("change")})),Object(u.a)(r,L.j.key,(function(){return s.listOfBond("rate")})),Object(u.a)(r,L.i.key,(function(){return s.listOfStock("rate")})),Object(u.a)(r,L.k.key,(function(){return s.listOfBond("netinflow")})),Object(u.a)(r,L.h.key,(function(){return s.listOfStock("netinflow")})),a=r,e.abrupt("return",a[t]());case 2:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"listOfBond",value:(r=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,u,l,h,p,f,v;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=d.a.stocksOfBonds(),a=m.a.stocks(r),s=m.a.listOfBonds(t),c=[],i=!0,o=!1,u=void 0,e.prev=7,l=s[Symbol.iterator]();case 9:if(i=(h=l.next()).done){e.next=25;break}if(p=h.value,f=d.a.stockOfBond(p.code),v=a[f]){e.next=15;break}return e.abrupt("continue",22);case 15:return e.next=17,F.isValidStock(v.code,v.name);case 17:if(e.sent){e.next=19;break}return e.abrupt("continue",22);case 19:if(!(p.price<=0)){e.next=21;break}return e.abrupt("continue",22);case 21:c.push(p);case 22:i=!0,e.next=9;break;case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(7),o=!0,u=e.t0;case 31:e.prev=31,e.prev=32,i||null==l.return||l.return();case 34:if(e.prev=34,!o){e.next=37;break}throw u;case 37:return e.finish(34);case 38:return e.finish(31);case 39:return e.abrupt("return",c);case 40:case"end":return e.stop()}}),e,null,[[7,27,31,39],[32,,34,38]])}))),function(e){return r.apply(this,arguments)})},{key:"listOfStock",value:(t=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,u,l,h,p,f,v,b;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=d.a.stocksOfBonds(),a=m.a.stocks(r),s=m.a.bonds(),c=m.a.list(a,t),i=[],o=!0,u=!1,l=void 0,e.prev=8,h=c[Symbol.iterator]();case 10:if(o=(p=h.next()).done){e.next=26;break}return f=p.value,e.next=14,F.isValidStock(f.code,f.name);case 14:if(e.sent){e.next=16;break}return e.abrupt("continue",23);case 16:if(v=d.a.bondOfStock(f.code),b=s[v]){e.next=20;break}return e.abrupt("continue",23);case 20:if(!(b.price<=0)){e.next=22;break}return e.abrupt("continue",23);case 22:i.push(b);case 23:o=!0,e.next=10;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(8),u=!0,l=e.t0;case 32:e.prev=32,e.prev=33,o||null==h.return||h.return();case 35:if(e.prev=35,!u){e.next=38;break}throw l;case 38:return e.finish(35);case 39:return e.finish(32);case 40:return e.abrupt("return",i);case 41:case"end":return e.stop()}}),e,null,[[8,28,32,40],[33,,35,39]])}))),function(e){return t.apply(this,arguments)})}]),e}()),z=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,e),Object(u.a)(this,"stocks",{}),this.stocks=t}return Object(i.a)(e,[{key:"getStocks",value:function(){return this.stocks}},{key:"setStocks",value:function(e){this.stocks=e}},{key:"getStockCodes",value:function(){return Object.keys(this.stocks)}},{key:"clone",value:function(){var t=Object.assign({},t);return new e(t)}},{key:"merge",value:function(e){for(var t in e.stocks){if(Object.keys(this.stocks).length>9)return;this.stocks[t]||(this.stocks[t]=e.stocks[t])}}},{key:"recover",value:function(e){return this.stocks=e.stocks,this}},{key:"get",value:function(e){return this.stocks[e]}},{key:"upsert",value:function(e){this.stocks[e.code]=e}},{key:"remove",value:function(e){delete this.stocks[e]}}]),e}(),G=function(){function e(t,r){Object(c.a)(this,e),Object(u.a)(this,"oldlist",void 0),Object(u.a)(this,"newlist",void 0),Object(u.a)(this,"openChange",void 0),Object(u.a)(this,"closeChange",void 0),this.oldlist=t,this.newlist=r,this.calc()}return Object(i.a)(e,[{key:"calc",value:function(){var e=this.oldlist.getStockCodes(),t=0,r=0,a=!0,n=!1,s=void 0;try{for(var c,i=e[Symbol.iterator]();!(a=(c=i.next()).done);a=!0){var o=c.value;0!==this.newlist.get(o).price?(t+=(this.newlist.get(o).price-this.oldlist.get(o).price)/this.oldlist.get(o).price,r+=(this.newlist.get(o).open-this.oldlist.get(o).price)/this.oldlist.get(o).price):console.info("#Statement# suspension stock consider as change 0% ...",o,this.newlist.get(o).name)}}catch(e){n=!0,s=e}finally{try{a||null==i.return||i.return()}finally{if(n)throw s}}this.closeChange=(100*t).toFixed(2),this.openChange=(100*r).toFixed(2)}},{key:"getOpenChange",value:function(){return this.openChange}},{key:"getCloseChange",value:function(){return this.closeChange}},{key:"getChange",value:function(){return this.closeChange}},{key:"getProfit",value:function(e){return(this.closeChange*e).toFixed(2)}}]),e}(),V=O.a.createInstance({name:"trace",driver:O.a.INDEXEDDB}),U=function(){function e(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{isToday:!1};Object(c.a)(this,e),Object(u.a)(this,"isToday",void 0),Object(u.a)(this,"record",{change:{},capture:{},trace:{}}),Object(u.a)(this,"name",void 0),Object(u.a)(this,"rule",void 0),Object(u.a)(this,"listController",void 0),Object(u.a)(this,"oldlists",void 0),Object(u.a)(this,"newlists",void 0),Object(u.a)(this,"openChanges",{}),Object(u.a)(this,"closeChanges",{}),this.rule=r,this.listController=t,this.isToday=a.isToday,this.name=(this.isToday?"t0-".concat(this.rule.name):this.rule.name).toLowerCase(),this.reset(),this.deprecated()}var t,r,a,o,l,h,p,v,d;return Object(i.a)(e,[{key:"start",value:(d=Object(s.a)(n.a.mark((function e(){var t,r=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=300,e.prev=2,e.next=5,this.load();case 5:if(!this.rule.name.includes("interval")||this.isToday){e.next=7;break}return e.abrupt("return");case 7:b.a.interval(Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("#StatementController# ".concat(r.name," capture start ...")),e.next=3,r.capture();case 3:console.log("#StatementController# ".concat(r.name," capture end ..."));case 4:case"end":return e.stop()}}),e)}))),null,t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.warn("#StatementController# ",e.t0);case 13:case"end":return e.stop()}}),e,this,[[2,10]])}))),function(){return d.apply(this,arguments)})},{key:"deprecated",value:(v=Object(s.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.until("150000");case 2:return e.next=5,V.length();case 5:if(!(e.sent<=200)){e.next=8;break}return e.abrupt("break",15);case 8:return e.next=10,V.key(0);case 10:return t=e.sent,e.next=13,V.removeItem(t);case 13:e.next=2;break;case 15:case"end":return e.stop()}}),e)}))),function(){return v.apply(this,arguments)})},{key:"load",value:(p=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i,o,u,l,h;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=g()().format("YYYYMMDD"),e.next=4,V.getItem(t);case 4:if(r=e.sent){e.next=7;break}return e.abrupt("return");case 7:for(r[this.name]&&(this.record=r[this.name]),a=this.rule.interval?L.lb.getIntervalKeys():L.lb.getNormalKeys(),s=!0,c=!1,i=void 0,e.prev=12,o=a[Symbol.iterator]();!(s=(u=o.next()).done);s=!0)l=u.value,h=L.lb.name(l),this.oldlists[l]=new z(this.record.capture[h]),this.newlists[l]=new z(this.record.trace[h]);e.next=20;break;case 16:e.prev=16,e.t0=e.catch(12),c=!0,i=e.t0;case 20:e.prev=20,e.prev=21,s||null==o.return||o.return();case 23:if(e.prev=23,!c){e.next=26;break}throw i;case 26:return e.finish(23);case 27:return e.finish(20);case 28:e.next=32;break;case 30:e.prev=30,e.t1=e.catch(0);case 32:case"end":return e.stop()}}),e,this,[[0,30],[12,16,20,28],[21,,23,27]])}))),function(){return p.apply(this,arguments)})},{key:"save",value:(h=Object(s.a)(n.a.mark((function e(t){var r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=g()().format("YYYYMMDD"),e.next=3,V.getItem(r);case 3:return(a=e.sent)||(a={}),this.record={change:t.change,trace:t.trace,capture:t.capture},a[this.name]=this.record,e.abrupt("return",V.setItem(r,a));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"reset",value:function(){var e=this.rule.interval?L.lb.getIntervalKeys():L.lb.getNormalKeys();this.oldlists={},this.newlists={};var t=!0,r=!1,a=void 0;try{for(var n,s=e[Symbol.iterator]();!(t=(n=s.next()).done);t=!0){var c=n.value;this.newlists[c]=new z,this.oldlists[c]=new z}}catch(e){r=!0,a=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw a}}}},{key:"remove",value:(l=Object(s.a)(n.a.mark((function e(t,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.load();case 3:this.newlists[t]&&this.newlists[t].remove(r),this.oldlists[t]&&this.oldlists[t].remove(r),this.calc(),this.broadcast(),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e,t){return l.apply(this,arguments)})},{key:"update",value:(o=Object(s.a)(n.a.mark((function e(t,r,a){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.load();case 3:this.newlists[t]||(this.newlists[t]=new z),this.oldlists[t]||(this.oldlists[t]=new z),this.oldlists[t].upsert(r),this.newlists[t].upsert(a),this.calc(),this.broadcast(),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(0);case 13:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e,t,r){return o.apply(this,arguments)})},{key:"capture",value:(a=Object(s.a)(n.a.mark((function e(t){var r,a,s,c;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.newlists=null,this.oldlists=null,!t){e.next=7;break}this.oldlists=t,e.next=16;break;case 7:if(!this.isToday){e.next=13;break}return e.next=10,this.listController.getTodayLists();case 10:this.oldlists=e.sent,e.next=16;break;case 13:return e.next=15,this.listController.getYesterdayLists();case 15:this.oldlists=e.sent;case 16:if(this.oldlists){e.next=18;break}return e.abrupt("return");case 18:this.newlists={},r=Object.keys(this.oldlists),a=0,s=r;case 21:if(!(a<s.length)){e.next=37;break}if(c=s[a],e.prev=23,L.lb.get(c)){e.next=26;break}return e.abrupt("continue",34);case 26:return e.next=28,this.captureList(this.oldlists[c]);case 28:this.newlists[c]=e.sent,e.next=34;break;case 31:e.prev=31,e.t0=e.catch(23),console.warn("#StatementController# ",e.t0);case 34:a++,e.next=21;break;case 37:this.calc(),this.broadcast(),e.next=44;break;case 41:e.prev=41,e.t1=e.catch(0),console.warn("#StatementController# capture",e.t1);case 44:return e.abrupt("return",this.newlists);case 45:case"end":return e.stop()}}),e,this,[[0,41],[23,31]])}))),function(e){return a.apply(this,arguments)})},{key:"calc",value:function(){if(this.newlists)for(var e=0,t=Object.keys(this.newlists);e<t.length;e++){var r=t[e],a=new G(this.oldlists[r],this.newlists[r]);this.closeChanges[r]=a.getCloseChange(),this.openChanges[r]=a.getOpenChange()}}},{key:"broadcast",value:(r=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i,o,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={name:this.name,change:{},trace:{},capture:{}},r=Object.keys(this.newlists),a=0,s=r;a<s.length;a++)c=s[a],i=L.lb.name(c),o=g()().format("HH:mm"),u=this.closeChanges[c],this.record.change[i]||(this.record.change[i]=[]),this.record.change[i].unshift(u,o),t.change[i]=this.record.change[i],t.trace[i]=this.newlists[c].getStocks(),t.capture[i]=this.oldlists[c].getStocks();return e.next=5,this.save(t);case 5:console.log("#StatementController# list trace [".concat(this.name,"] at ").concat(g()().format("HH:mm:ss")," ...")),window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Trace_Event",{detail:t}));case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"captureList",value:(t=Object(s.a)(n.a.mark((function e(t){var r,a,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new z,a=Object.keys(t.getStocks()),e.next=4,f.a.captureStocks(a);case 4:return s=e.sent,r.setStocks(s),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),Z=O.a.createInstance({name:"capture",driver:O.a.INDEXEDDB}),J=function(){function e(t,r){Object(c.a)(this,e),Object(u.a)(this,"rule",void 0),Object(u.a)(this,"validator",void 0),Object(u.a)(this,"lists",void 0),Object(u.a)(this,"listKeys",void 0),Object(u.a)(this,"statement",void 0),Object(u.a)(this,"t0Statement",void 0),Object(u.a)(this,"blocks",{concept:[],industry:[]}),this.rule=t,this.validator=r,this.t1Statement=new U(this,t),this.t0Statement=new U(this,t,{isToday:!0}),this.listKeys=t.interval?L.lb.getIntervalKeys():L.lb.getNormalKeys(),this.reset(),this.deprecated()}var t,r,a,o,l,h,p,v,d,m,k,x,w,O,j,S;return Object(i.a)(e,[{key:"all",value:function(){return this.lists}},{key:"list",value:function(e){return this.lists[e]}},{key:"stocks",value:function(e){return this.lists[e].getStocks()}},{key:"ignore",value:(S=Object(s.a)(n.a.mark((function e(t,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(this.lists[t]){e.next=4;break}return e.abrupt("return");case 4:return this.lists[t].remove("".concat(r)),this.broadcast(),e.next=8,this.save();case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return S.apply(this,arguments)})},{key:"update",value:(j=Object(s.a)(n.a.mark((function e(t,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lists[t]||(this.lists[t]=new z),this.lists[t].merge({stocks:r}),this.broadcast(),e.next=5,this.save();case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return j.apply(this,arguments)})},{key:"override",value:(O=Object(s.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lists=t,this.broadcast(),e.next=4,this.save();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return O.apply(this,arguments)})},{key:"load",value:(w=Object(s.a)(n.a.mark((function e(){var t,r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g()().format("YYYYMMDD"),e.next=3,this.loadListsOf(t);case 3:(r=e.sent)&&(this.lists=r);case 5:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"loadListsOf",value:(x=Object(s.a)(n.a.mark((function e(t){var r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.rule.name,e.next=3,Z.getItem(t);case 3:if(a=e.sent){e.next=7;break}return console.log("#ListController# ".concat(r," ").concat(t," lists not exist!")),e.abrupt("return");case 7:if(a[r]){e.next=10;break}return console.log("#ListController# ".concat(r," ").concat(t," lists not exist!")),e.abrupt("return");case 10:return e.abrupt("return",this.recover(a[r]));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"getTodayLists",value:(k=Object(s.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g()().format("YYYYMMDD"),e.abrupt("return",this.loadListsOf(t));case 2:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"getYesterdayLists",value:(m=Object(s.a)(n.a.mark((function e(){var t,r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.length();case 2:return t=e.sent,r=g()().format("YYYYMMDD"),e.next=6,Z.key(t-1);case 6:if((a=e.sent)!==r){e.next=13;break}return e.next=10,Z.key(t-2);case 10:a=e.sent,e.next=16;break;case 13:return e.next=15,Z.key(t-1);case 15:a=e.sent;case 16:return e.abrupt("return",this.loadListsOf(a));case 17:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"recover",value:function(e){for(var t in e)e[t]=(new z).recover(e[t]);return e}},{key:"deprecated",value:(d=Object(s.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.until("150000");case 2:return e.next=5,Z.length();case 5:if(!(e.sent<=200)){e.next=8;break}return e.abrupt("break",15);case 8:return e.next=10,Z.key(0);case 10:return t=e.sent,e.next=13,Z.removeItem(t);case 13:e.next=2;break;case 15:case"end":return e.stop()}}),e)}))),function(){return d.apply(this,arguments)})},{key:"save",value:(v=Object(s.a)(n.a.mark((function e(){var t,r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g()().format("YYYYMMDD"),r=this.rule.name,e.next=4,Z.getItem(t);case 4:return(a=e.sent)||(a={}),a[r]=this.lists,e.abrupt("return",Z.setItem(t,a));case 8:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"reset",value:function(){var e=this.listKeys;this.lists={};var t=!0,r=!1,a=void 0;try{for(var n,s=e[Symbol.iterator]();!(t=(n=s.next()).done);t=!0){var c=n.value;this.lists[c]=new z}}catch(e){r=!0,a=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw a}}}},{key:"captureHotBlocks",value:(p=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.captureBlock();case 2:return this.blocks=e.sent,console.info("#EastMoneyBlockCrawler# Hot Concept Blocks ..."),console.table(this.blocks.concept),console.info("#EastMoneyBlockCrawler# Hot Industry Blocks ..."),console.table(this.blocks.industry),e.abrupt("return",this.blocks);case 8:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"createHotBlocksList",value:(h=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i,o,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={concept:[L.o.key,L.p.key,L.q.key],industry:[L.w.key,L.x.key,L.y.key]},e.next=4,this.captureHotBlocks();case 4:for(r in t)for(s in a=t[r])for(u in c=a[s],i=this.lists[c],o=i.getStocks())o[u].block=this.blocks[r][s].name;e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn("#ListController# ",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return h.apply(this,arguments)})},{key:"createHotStocksList",value:(l=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i,o,u,l,h,p,f,v,d,b,m,k,y,x,g,w,O,j;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.listKeys,r=L.lb.getBondKeys(),a={},s={},c=[],i=0,o=!0,u=!1,l=void 0,e.prev=9,h=t[Symbol.iterator]();case 11:if(o=(p=h.next()).done){e.next=22;break}if(f=p.value,!r.includes(f)){e.next=15;break}return e.abrupt("continue",19);case 15:for(b in v=this.lists[f],d=v.getStocks(),Object.assign(a,d),d)m=d[b],c[b]||(c[b]={name:m.name,count:0}),c[b].count++;case 19:o=!0,e.next=11;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(9),u=!0,l=e.t0;case 28:e.prev=28,e.prev=29,o||null==h.return||h.return();case 31:if(e.prev=31,!u){e.next=34;break}throw l;case 34:return e.finish(31);case 35:return e.finish(28);case 36:for(k=Object.keys(c).sort((function(e,t){return c[t].count-c[e].count})),y=!0,x=!1,g=void 0,e.prev=40,w=k[Symbol.iterator]();!(y=(O=w.next()).done);y=!0)j=O.value,c[j].count>=3&&i<10&&(s[j]=Object.assign({},a[j],{hot:c[j].count}),i++);e.next=48;break;case 44:e.prev=44,e.t1=e.catch(40),x=!0,g=e.t1;case 48:e.prev=48,e.prev=49,y||null==w.return||w.return();case 51:if(e.prev=51,!x){e.next=54;break}throw g;case 54:return e.finish(51);case 55:return e.finish(48);case 56:console.log("#ListController# list ".concat(this.rule.name," capture hot stcoks ...")),console.table(c),this.lists[L.v.key].setStocks(s);case 59:case"end":return e.stop()}}),e,this,[[9,24,28,36],[29,,31,35],[40,44,48,56],[49,,51,55]])}))),function(){return l.apply(this,arguments)})},{key:"start",value:(o=Object(s.a)(n.a.mark((function e(){var t,r=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.rule.interval?void 0:[this.rule.capture],e.prev=1,e.next=4,this.load();case 4:b.a.interval(Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("#ListController# list ".concat(r.rule.name," capture start ...")),e.next=3,r.capture();case 3:r.rule.interval||(console.info("=================================================="),console.info("#ListController# today list capture [".concat(r.rule.name,"] at ").concat(g()().format("HH:mm:ss"),": "),r.lists),console.info("==================================================")),console.log("#ListController# list ".concat(r.rule.name," capture end ..."));case 5:case"end":return e.stop()}}),e)}))),t,this.rule.interval),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.warn("#ListController# ",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])}))),function(){return o.apply(this,arguments)})},{key:"captureList",value:(a=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,u,l,h,p,v,d,b;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=L.lb.getIntervalKeys(),a=L.lb.getBondKeys(),s=[],!r.includes(t)){e.next=9;break}return e.next=6,N.list(t,this.validator);case 6:s=e.sent,e.next=18;break;case 9:if(!a.includes(t)){e.next=15;break}return e.next=12,A.list(t);case 12:s=e.sent,e.next=18;break;case 15:return e.next=17,f.a.captureList(t);case 17:s=e.sent;case 18:if(s&&s.length){e.next=20;break}return e.abrupt("return",new z);case 20:c={},i=0,o=!0,u=!1,l=void 0,e.prev=24,h=s[Symbol.iterator]();case 26:if(o=(p=h.next()).done){e.next=52;break}if(v=p.value,b=(d=v).code,d.name,d.change,r.includes(t)){e.next=38;break}if(this.validator.isFullRequiredFields(v)){e.next=34;break}return e.next=33,f.a.captureStock(b);case 33:v=e.sent;case 34:return e.next=36,this.validator.filter(t,v);case 36:if(e.sent){e.next=38;break}return e.abrupt("continue",49);case 38:if(!c[b]){e.next=40;break}return e.abrupt("continue",49);case 40:if(!(v.price<=0)){e.next=42;break}return e.abrupt("continue",49);case 42:if(a.includes(t)){e.next=45;break}if(!(v.change>9.8)){e.next=45;break}return e.abrupt("continue",49);case 45:if(c[b]=v,10!=++i){e.next=49;break}return e.abrupt("break",52);case 49:o=!0,e.next=26;break;case 52:e.next=58;break;case 54:e.prev=54,e.t0=e.catch(24),u=!0,l=e.t0;case 58:e.prev=58,e.prev=59,o||null==h.return||h.return();case 61:if(e.prev=61,!u){e.next=64;break}throw l;case 64:return e.finish(61);case 65:return e.finish(58);case 66:return console.log("#ListController# list ".concat(this.rule.name," capture ").concat(t," "),c),e.abrupt("return",new z(c));case 68:case"end":return e.stop()}}),e,this,[[24,54,58,66],[59,,61,65]])}))),function(e){return a.apply(this,arguments)})},{key:"capture",value:(r=Object(s.a)(n.a.mark((function e(){var t,r,a,c,i,o=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object.keys(this.lists),r=0,a=t;case 2:if(!(r<a.length)){e.next=23;break}if(c=a[r],e.prev=4,c!==L.v.key){e.next=7;break}return e.abrupt("continue",20);case 7:if(this.listKeys.includes(c)){e.next=9;break}return e.abrupt("continue",20);case 9:return e.next=11,this.captureList(c);case 11:return i=e.sent,this.lists[c].merge(i),e.next=15,Object(y.a)(500);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),console.warn("#ListController# ",e.t0);case 20:r++,e.next=2;break;case 23:if(e.prev=23,!this.rule.interval){e.next=30;break}return this.broadcast(),e.next=28,this.save();case 28:e.next=36;break;case 30:return this.createHotStocksList(),this.createHotBlocksList(),this.broadcast(),e.next=35,this.save();case 35:setTimeout(Object(s.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,Object(y.a)(15e4);case 3:return e.next=5,o.t0Statement.capture(o.lists);case 5:if(t=e.sent,console.log("#ListController# [".concat(o.rule.name,"] t0Statement pre-trace "),t),!o.validator.hasCaptureRule("pre-trace")){e.next=13;break}return e.next=10,o.validator.filterOfPreTrace(o.lists,t);case 10:return o.broadcast(),e.next=13,o.save();case 13:case"end":return e.stop()}}),e)}))));case 36:e.next=41;break;case 38:e.prev=38,e.t1=e.catch(23),console.warn("#ListController# ",e.t1);case 41:case"end":return e.stop()}}),e,this,[[4,17],[23,38]])}))),function(){return r.apply(this,arguments)})},{key:"broadcast",value:(t=Object(s.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={name:this.rule.name,lists:this.lists},window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Capture_Event",{detail:t}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Q=new(function(){function e(){Object(c.a)(this,e),Object(u.a)(this,"listControllers",[]),this.clearTempCapture();var t=[].concat(v.a.captures||[],v.a.temps||[]),r=v.a.validators,a=!0,n=!1,s=void 0;try{for(var i,o=t[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var l=i.value,h=!0,p=!1,f=void 0;try{for(var d,b=r[Symbol.iterator]();!(h=(d=b.next()).done);h=!0){var m=d.value,k=this.create(l,m);this.listControllers.push(k)}}catch(e){p=!0,f=e}finally{try{h||null==b.return||b.return()}finally{if(p)throw f}}}}catch(e){n=!0,s=e}finally{try{a||null==o.return||o.return()}finally{if(n)throw s}}var y=this.create(v.a.intervals[0],r[0]);this.listControllers.push(y)}var t,r,a,h,p,f;return Object(i.a)(e,[{key:"create",value:function(e,t){var r="".concat(e.capture,"-").concat(t.name).toLowerCase(),a=new l(Object(o.a)({},e,{name:r})),n=new F(t);return new J(a,n)}},{key:"controller",value:function(e,t){var r=!0,a=!1,n=void 0;try{for(var s,c=this.listControllers[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var i=s.value,o=i.rule,u=i.validator.config;if(o.capture===e&&u.name===t)return i}}catch(e){a=!0,n=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw n}}}},{key:"capture",value:(f=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=g()().format("YYYYMMDD"),r=!0,a=!1,s=void 0,e.prev=5,c=this.listControllers[Symbol.iterator]();case 7:if(r=(i=c.next()).done){e.next=16;break}if(!(o=i.value).rule.date||o.rule.date===t){e.next=12;break}return console.log("#controllers# ignore temp capture rule ",o.rule.capture,o.rule.date),e.abrupt("continue",13);case 12:o.start();case 13:r=!0,e.next=7;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(5),a=!0,s=e.t0;case 22:e.prev=22,e.prev=23,r||null==c.return||c.return();case 25:if(e.prev=25,!a){e.next=28;break}throw s;case 28:return e.finish(25);case 29:return e.finish(22);case 30:e.next=35;break;case 32:e.prev=32,e.t1=e.catch(0),console.warn("#controllers# capture",e.t1);case 35:case"end":return e.stop()}}),e,this,[[0,32],[5,18,22,30],[23,,25,29]])}))),function(){return f.apply(this,arguments)})},{key:"trace",value:(p=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=!0,r=!1,a=void 0,e.prev=4,s=this.listControllers[Symbol.iterator]();case 6:if(t=(c=s.next()).done){e.next=15;break}return i=c.value,e.next=10,i.t1Statement.start();case 10:return e.next=12,i.t0Statement.start();case 12:t=!0,e.next=6;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),r=!0,a=e.t0;case 21:e.prev=21,e.prev=22,t||null==s.return||s.return();case 24:if(e.prev=24,!r){e.next=27;break}throw a;case 27:return e.finish(24);case 28:return e.finish(21);case 29:e.next=34;break;case 31:e.prev=31,e.t1=e.catch(0),console.warn("#controllers# trace ",e.t1);case 34:case"end":return e.stop()}}),e,this,[[0,31],[4,17,21,29],[22,,24,28]])}))),function(){return p.apply(this,arguments)})},{key:"clearTempCapture",value:(h=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i,o,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v.a.temps){e.next=2;break}return e.abrupt("return");case 2:if(v.a.temps.length){e.next=4;break}return e.abrupt("return");case 4:for(t=[],r=g()().subtract(2,"days").format("YYYYMMDD"),1!=+g()().day()&&2!=+g()().day()||(r=g()().subtract(4,"days").format("YYYYMMDD")),a=!0,s=!1,c=void 0,e.prev=10,i=v.a.temps[Symbol.iterator]();!(a=(o=i.next()).done);a=!0)+(u=o.value).date>r&&t.push(u);e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),s=!0,c=e.t0;case 18:e.prev=18,e.prev=19,a||null==i.return||i.return();case 21:if(e.prev=21,!s){e.next=24;break}throw c;case 24:return e.finish(21);case 25:return e.finish(18);case 26:v.a.temps=t;case 27:case"end":return e.stop()}}),e,null,[[10,14,18,26],[19,,21,25]])}))),function(){return h.apply(this,arguments)})},{key:"setTempCapture",value:(a=Object(s.a)(n.a.mark((function e(){var t,r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=g()().format("YYYYMMDD"),r=g()().add(1,"minutes").format("HH:mm"),a=new l({capture:r,trace:["14:40"],date:t}),v.a.temps=[].concat(v.a.temps,a);case 4:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"removeTempCapture",value:(r=Object(s.a)(n.a.mark((function e(t,r){var a,s,c,i,o,u,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],s=!0,c=!1,i=void 0,e.prev=4,o=v.a.temps[Symbol.iterator]();case 6:if(s=(u=o.next()).done){e.next=14;break}if((l=u.value).capture!==t||l.date!==r){e.next=10;break}return e.abrupt("continue",11);case 10:a.push(l);case 11:s=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),c=!0,i=e.t0;case 20:e.prev=20,e.prev=21,s||null==o.return||o.return();case 23:if(e.prev=23,!c){e.next=26;break}throw i;case 26:return e.finish(23);case 27:return e.finish(20);case 28:v.a.temps=a;case 29:case"end":return e.stop()}}),e,null,[[4,16,20,28],[21,,23,27]])}))),function(e,t){return r.apply(this,arguments)})},{key:"ignore",value:(t=Object(s.a)(n.a.mark((function e(t,r,a,s){var c,i,o,u,l,h,p,f,v;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=!0,i=!1,o=void 0,e.prev=3,u=this.listControllers[Symbol.iterator]();case 5:if(c=(l=u.next()).done){e.next=19;break}if(h=l.value,p=h.rule,f=h.validator.config,v=L.lb.keyOf(a),p.capture!==t||f.name!==r){e.next=16;break}return e.next=13,h.ignore(v,s);case 13:return e.next=15,h.t0Statement.remove(v,s);case 15:window.dispatchEvent(new CustomEvent("__Walle_Stock_Ignore_Event",{detail:{time:t,vtype:r,listkey:v,code:s}}));case 16:c=!0,e.next=5;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(3),i=!0,o=e.t0;case 25:e.prev=25,e.prev=26,c||null==u.return||u.return();case 28:if(e.prev=28,!i){e.next=31;break}throw o;case 31:return e.finish(28);case 32:return e.finish(25);case 33:case"end":return e.stop()}}),e,this,[[3,21,25,33],[26,,28,32]])}))),function(e,r,a,n){return t.apply(this,arguments)})}]),e}()),$=r(321),X=new(function(){function e(){Object(c.a)(this,e),Object(u.a)(this,"index",{sse:{price:0,change:0,volume:0,amount:0,netinflow:0,rate:0},szse:{price:0,change:0,volume:0,amount:0,netinflow:0,rate:0},north:{}}),Object(u.a)(this,"number",{full:0,rise:0,down:0,limitup:0,limitdown:0,prelimitup:0,prelimitdown:0}),Object(u.a)(this,"strength",{full:0,netinflow:0,rise:0,down:0}),Object(u.a)(this,"changes",{index:[],netinflow:[],full:[],rise:[],down:[]}),Object(u.a)(this,"rates",{index:[],netinflow:[],full:[],rise:[],down:[]})}var t,r,a,o,l,h;return Object(i.a)(e,[{key:"start",value:function(){var e=this;b.a.interval((function(){e.process()}),null,180,"market-analyse")}},{key:"process",value:(h=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.calcIndex();case 3:return e.next=5,this.calcIndexOfNorth();case 5:return e.next=7,this.calcStocks();case 7:return e.next=9,this.broadcast();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.warn("#Market-Trend# ",e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(){return h.apply(this,arguments)})},{key:"broadcast",value:function(){window.dispatchEvent(new CustomEvent("__Walle_Stock_Market_Analyse_Event",{detail:{index:this.index,number:this.number,strength:this.strength,changes:this.changes,rates:this.rates}}))}},{key:"calcStocks",value:(l=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s in t=m.a.stocks(),r={full:0,rise:0,down:0},a={full:0,rise:0,down:0},this.number.full=0,this.number.rise=0,this.number.down=0,this.number.limitup=0,this.number.limitdown=0,this.number.prelimitup=0,this.number.prelimitdown=0,t)(c=t[s]).change>0&&(this.number.rise++,r.rise+=c.change,a.rise+=c.rate),c.change<0&&(this.number.down++,r.down+=c.change,a.down+=c.rate),c.change>=9.8&&this.number.limitup++,c.change<=-9.8&&this.number.limitdown++,c.change>5&&c.change<9.8&&this.number.prelimitup++,c.change<-5&&c.change>-9.8&&this.number.prelimitdown++,this.number.full++;r.rise=+r.rise.toFixed(2),r.down=+r.down.toFixed(2),r.full=+(r.rise+r.down).toFixed(2),a.rise=+a.rise.toFixed(2),a.down=+a.down.toFixed(2),a.full=+(a.rise+a.down).toFixed(2),this.strength.rise=+(a.rise/this.number.rise).toFixed(2),this.strength.down=+(a.down/this.number.down).toFixed(2),this.strength.full=+(this.strength.rise+this.strength.down).toFixed(2),i=g()().format("HH:mm"),this.changes.rise.unshift(r.rise,i),this.changes.down.unshift(r.down,i),this.changes.full.unshift(r.full,i),this.changes.index.unshift(+this.index.sse.price+this.index.szse.price,i),this.rates.rise.unshift(+(a.rise/this.number.rise).toFixed(2),i),this.rates.down.unshift(+(a.down/this.number.down).toFixed(2),i),this.rates.full.unshift(+(a.rise/this.number.rise+a.down/this.number.down).toFixed(2),i),this.rates.index.unshift(+this.index.sse.rate+this.index.szse.rate,i),this.calcNetinflow(i);case 30:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"calcNetinflow",value:(o=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,u,l,h,p;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=400,a=m.a.listOfStocks("netinflow",1,r),s=0,c=0,i=!0,o=!1,u=void 0,e.prev=7,l=a[Symbol.iterator]();!(i=(h=l.next()).done);i=!0)p=h.value,s+=p.change,c+=p.rate;e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),o=!0,u=e.t0;case 15:e.prev=15,e.prev=16,i||null==l.return||l.return();case 18:if(e.prev=18,!o){e.next=21;break}throw u;case 21:return e.finish(18);case 22:return e.finish(15);case 23:this.strength.netinflow=+(c/r).toFixed(2),this.changes.netinflow.unshift(+s.toFixed(2),t),this.rates.netinflow.unshift(+(c/r).toFixed(2),t);case 26:case"end":return e.stop()}}),e,this,[[7,11,15,23],[16,,18,22]])}))),function(e){return o.apply(this,arguments)})},{key:"calcIndexOfNorth",value:(a=Object(s.a)(n.a.mark((function e(){var t,r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,$.a.get("http://push2.eastmoney.com/api/qt/kamt/get?fields1=f1,f2,f3,f4&fields2=f51,f52,f53,f54",null);case 4:t=e.sent,r=JSON.parse(t),this.index.north=r.data,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return a.apply(this,arguments)})},{key:"calcIndex",value:(r=Object(s.a)(n.a.mark((function e(){var t,r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.captureStocks(["1.000001","399001"]);case 2:t=e.sent,r=t[1.000001],a=t[399001],this.index={sse:r,szse:a};case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"isTradingDay",value:(t=Object(s.a)(n.a.mark((function e(){var t,r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:if(t=+g()().format("HHmmss"),r="092500",!(t<92500)){e.next=8;break}r="092510",e.next=14;break;case 8:if(!(t>113e3)){e.next=12;break}r="130010",e.next=14;break;case 12:if(!(t>15e4)){e.next=14;break}return e.abrupt("return",!1);case 14:return console.log("#Markets# will start at ".concat(r," ...")),e.next=17,b.a.until(r);case 17:return e.next=19,f.a.isTrading();case 19:if(a=e.sent,console.info("#Markets# stock market trading status ".concat(a?"open":"close"," ...")),a){e.next=28;break}if(!(t>=92500&&t<=113e3||t>=13e4&&t<=15e4)){e.next=28;break}return e.next=25,toastr.clearAll();case 25:return e.next=27,toastr.loading("Market Closed","Holidays");case 27:console.info("#Markets# stock market closed for holidays ...");case 28:return e.abrupt("return",a);case 29:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}()),ee=r(684),te=r.n(ee),re=r(262),ae=r(508),ne=function(){function e(){var t=this;Object(c.a)(this,e),re.a.listen("KeyB",(function(){var e={timeOut:5e3,extendedTimeOut:5e3,closeButton:!0,positionClass:"toast-bottom-left"};ae.a.clear(),ae.a.confirm("click to backup trace file","BACKUP",(function(){return t.trace()}),e),ae.a.confirm("click to backup capture file","BACKUP",(function(){return t.capture()}),e),ae.a.confirm("click to backup flow file","BACKUP",(function(){return t.flow()}),e),ae.a.confirm("click to backup storage file","BACKUP",(function(){return t.storage()}),e)}))}var t,r,a,o,u,l,h;return Object(i.a)(e,[{key:"download",value:(h=Object(s.a)(n.a.mark((function e(t,r){var a,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g()().format("YYYYMMDD"),s=new Blob([JSON.stringify(r,null,"\t")],{type:"application/json;charset=utf-8"}),e.next=4,Object(y.a)(1e3);case 4:return e.abrupt("return",te.a.saveAs(s,"".concat(a,"-").concat(t)));case 5:case"end":return e.stop()}}),e)}))),function(e,t){return h.apply(this,arguments)})},{key:"trace",value:(l=Object(s.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,V.iterate((function(e,r){t[r]=e}));case 4:return e.next=6,this.download("walle-stocks-trace.json",t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return l.apply(this,arguments)})},{key:"capture",value:(u=Object(s.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,Z.iterate((function(e,r){t[r]=e}));case 4:return e.next=6,this.download("walle-stocks-capture.json",t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return u.apply(this,arguments)})},{key:"flow",value:(o=Object(s.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,j.iterate((function(e,r){t[r]=e}));case 4:return e.next=6,this.download("walle-stocks-flow.json",t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return o.apply(this,arguments)})},{key:"storage",value:(a=Object(s.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,O.a.iterate((function(e,r){t[r]=e}));case 4:return e.next=6,this.download("walle-stocks-storage.json",t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return a.apply(this,arguments)})},{key:"all",value:(r=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage();case 2:return e.next=4,this.capture();case 4:return e.next=6,this.flow();case 6:return e.next=8,this.trace();case 8:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"autoBackup",value:(t=Object(s.a)(n.a.mark((function e(){var t,r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=g()().endOf("month").format("YYYYMMDD"),r=g()().format("YYYYMMDD"),t!==r){e.next=8;break}return e.next=5,b.a.until("233000");case 5:return e.next=7,this.all();case 7:console.info("#Backup# auto backup storage & records at ".concat(r," ..."));case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),se=function(){function e(){var t=this;Object(c.a)(this,e),re.a.listen("KeyR",(function(){return t.upload()}))}var t,r,a,o,l,h;return Object(i.a)(e,[{key:"upload",value:(h=Object(s.a)(n.a.mark((function e(){var t,r=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=document.createElement("input")).type="file",t.multiple="multiple",t.onchange=function(){r.recover(t.files)},t.click();case 5:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"recover",value:(l=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,l,h,p,f,v,d=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r={},Object(u.a)(r,"walle-stocks-trace.json",(function(e){return d.trace(e)})),Object(u.a)(r,"walle-stocks-capture.json",(function(e){return d.capture(e)})),Object(u.a)(r,"walle-stocks-flow.json",(function(e){return d.flow(e)})),Object(u.a)(r,"walle-stocks-storage.json",(function(e){return d.storage(e)})),a=r,s=!0,c=!1,i=void 0,e.prev=5,o=t[Symbol.iterator]();case 7:if(s=(l=o.next()).done){e.next=20;break}if(h=l.value,p=h.name.slice(9),!a[p]){e.next=17;break}return e.next=13,h.text();case 13:return f=e.sent,v=JSON.parse(f),e.next=17,a[p](v);case 17:s=!0,e.next=7;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(5),c=!0,i=e.t0;case 26:e.prev=26,e.prev=27,s||null==o.return||o.return();case 29:if(e.prev=29,!c){e.next=32;break}throw i;case 32:return e.finish(29);case 33:return e.finish(26);case 34:window.alert("Walle Recover Success ..."),e.next=41;break;case 37:e.prev=37,e.t1=e.catch(0),console.info("#Recover# fail ",e.t1),window.alert("Walle Recover Fail, Try Aagin ...");case 41:case"end":return e.stop()}}),e,null,[[0,37],[5,22,26,34],[27,,29,33]])}))),function(e){return l.apply(this,arguments)})},{key:"trace",value:(o=Object(s.a)(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=n.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.next=6,V.setItem(r,t[r]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(e){return o.apply(this,arguments)})},{key:"capture",value:(a=Object(s.a)(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=n.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.next=6,Z.setItem(r,t[r]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(e){return a.apply(this,arguments)})},{key:"flow",value:(r=Object(s.a)(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=n.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.next=6,j.setItem(r,t[r]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(e){return r.apply(this,arguments)})},{key:"storage",value:(t=Object(s.a)(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=n.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.next=6,O.a.setItem(r,t[r]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(e){return t.apply(this,arguments)})}]),e}(),ce=new ne,ie=(new se,new(function(){function e(){Object(c.a)(this,e)}var t;return Object(i.a)(e,[{key:"start",value:(t=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,ce.autoBackup(),e.next=4,X.isTradingDay();case 4:if(!e.sent){e.next=11;break}console.log("#Loop# core-loop start ..."),m.a.start(),N.start(),X.start(),Q.capture(),Q.trace();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.warn("#loop# ",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])}))),function(){return t.apply(this,arguments)})}]),e}())),oe=(r(270),r(80),r(72)),ue=r(685),le=r.n(ue),he=function(){function e(t,r){Object(c.a)(this,e),Object(u.a)(this,"publickey","-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDHdsyxT66pDG4p73yope7jxA92\nc0AT4qIJ/xtbBcHkFPK77upnsfDTJiVEuQDH+MiMeb+XhCLNKZGp0yaUU6GlxZdp\n+nLW8b7Kmijr3iepaDhcbVTsYBWchaWUXauj9Lrhz58/6AE/NF0aMolxIGpsi+ST\n2hSHPu3GSXMdhPCkWQIDAQAB\n-----END PUBLIC KEY-----"),Object(u.a)(this,"validatekey",""),Object(u.a)(this,"opener",null),Object(u.a)(this,"shareholder",{sz:"",sh:""}),Object(u.a)(this,"user",{id:"",password:""}),Object(u.a)(this,"tradeTypes",{B:"B",a:"0a",b:"0b",c:"0c",d:"0d",e:"0e",S:"S",f:"0f",g:"0g",h:"0h",i:"0i",j:"0j"}),Object(u.a)(this,"status",{0:"未知",1:"未报",2:"已报",3:"部成",4:"待报",5:"已受理",6:"已成",7:"已撤"}),this.user.id=t,this.user.password=r}var t,r,a,o,l,h,p,f,v,d,b,m,k,x,w,O,j;return Object(i.a)(e,[{key:"market",value:function(e){var t=e.slice(0,2);return["00","30","12"].includes(t)?"sz":["60","68","11"].includes(t)?"sh":void 0}},{key:"login",value:(j=Object(s.a)(n.a.mark((function e(){var t=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.opener){e.next=3;break}return e.abrupt("return");case 3:return this.opener=oe.a.open("https://jy.xzsec.com/Login"),e.next=6,new Promise((function(e,r){toastr.confirm("click to continue after login ...","MARKET ACCOUNT LOGIN",Object(s.a)(n.a.mark((function r(){return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.opener=null,r.prev=1,r.next=4,t.key();case 4:r.next=8;break;case 6:r.prev=6,r.t0=r.catch(1);case 8:e();case 9:case"end":return r.stop()}}),r,null,[[1,6]])}))),{timeOut:0,extendedTimeOut:0})}));case 6:console.log("#EastMoneyStockTrader# login ..."),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),console.warn("#EastMoneyStockTrader# login fail",e.t0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return j.apply(this,arguments)})},{key:"ocr",value:(O=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return O.apply(this,arguments)})},{key:"captcha",value:(w=Object(s.a)(n.a.mark((function e(){var t,r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Math.random(),r="https://jy.xzsec.com/Login/YZM?randNum=".concat(t),console.log("#EastMoneyStockTrader# captcha ...",r),e.abrupt("return",{url:r,random:t});case 7:throw e.prev=7,e.t0=e.catch(0),console.warn("#EastMoneyStockTrader# captcha fail",e.t0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(){return w.apply(this,arguments)})},{key:"auth",value:(x=Object(s.a)(n.a.mark((function e(t,r,a,s){var c,i,o,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(c=new le.a).setPublicKey(this.publickey),i=c.encrypt(r),o={userId:t,password:i,identifyCode:a,randNumber:s,duration:"1800",authCode:"",type:"Z"},e.next=8,$.a.post("https://jy.xzsec.com/Login/Authentication?validatekey=",o,{dataType:"json"});case 8:if(0!==(u=e.sent).Status){e.next=13;break}console.log("#EastMoneyStockTrader# auth ..."),e.next=14;break;case 13:throw u;case 14:e.next=20;break;case 16:throw e.prev=16,e.t0=e.catch(0),console.warn("#EastMoneyStockTrader# auth fail",e.t0),e.t0;case 20:case"end":return e.stop()}}),e,this,[[0,16]])}))),function(e,t,r,a){return x.apply(this,arguments)})},{key:"key",value:(k=Object(s.a)(n.a.mark((function e(){var t,r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,$.a.get("https://jy.xzsec.com/Trade/Buy",null);case 4:if(!(t=e.sent)){e.next=16;break}if((r=document.createElement("div")).innerHTML=t,!(a=r.querySelector("#em_validatekey"))||!a.value){e.next=13;break}this.validatekey=a.value,e.next=14;break;case 13:throw{status:-1,message:"密钥获取异常，请重新登录!"};case 14:return console.log("#EastMoneyStockTrader# load key ...",this.validatekey),e.abrupt("return",this.validatekey);case 16:e.next=22;break;case 18:throw e.prev=18,e.t0=e.catch(0),console.warn("#EastMoneyStockTrader# load key fail",e.t0),e.t0;case 22:case"end":return e.stop()}}),e,this,[[0,18]])}))),function(){return k.apply(this,arguments)})},{key:"check",value:(m=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.validatekey){e.next=4;break}return e.next=3,this.login();case 3:throw{status:-2,message:"会话已超时，请重新登录!"};case 4:return e.abrupt("return",!!this.validatekey);case 5:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"hook",value:(b=Object(s.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-2!==t.Status){e.next=3;break}throw this.validatekey="",{status:-2,message:"会话已超时，请重新登录!"};case 3:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"trade",value:(d=Object(s.a)(n.a.mark((function e(t,r,a,s,c){var i,o,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.check();case 3:return i="https://jy.xzsec.com/Trade/SubmitTrade?validatekey=".concat(this.validatekey),this.market(r),o={stockCode:r,amount:s,tradeType:t,zqmc:a},c&&(o.price=c),e.next=9,$.a.post(i,o,{dataType:"json"});case 9:if(u=e.sent,this.hook(u),0!==u.Status){e.next=16;break}return console.log("#EastMoneyStockTrader# trade-[".concat(t,"]: ").concat(r," ").concat(a," ").concat(c," ").concat(s," ")),e.abrupt("return",u.Data[0].Wtbh);case 16:throw u;case 17:e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(0),console.warn("#EastMoneyStockTrader# trade-[".concat(t,"]: ").concat(r," ").concat(a," ").concat(c," ").concat(s," fail"),e.t0),e.t0;case 23:case"end":return e.stop()}}),e,this,[[0,19]])}))),function(e,t,r,a,n){return d.apply(this,arguments)})},{key:"limitorder",value:(v=Object(s.a)(n.a.mark((function e(t,r,a,s){var c,i,o,u,l=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=l.length>4&&void 0!==l[4]?l[4]:5,e.next=3,this.position(r);case 3:return i=e.sent,o=t===this.tradeTypes.B?i.sell.price[c-1]:i.buy.price[c-1],e.next=7,this.trade(t,r,a,s,o);case 7:return u=e.sent,e.next=10,Object(y.a)(300);case 10:return e.next=12,this.revoke([u]);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,r,a){return v.apply(this,arguments)})},{key:"buy",value:(f=Object(s.a)(n.a.mark((function e(t,r,a){var s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.slice(0,2),!["11","12"].includes(s)){e.next=3;break}return e.abrupt("return",this.limitorder(this.tradeTypes.B,t,r,a));case 3:return e.abrupt("return",this.trade(this.tradeTypes.d,t,r,a));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return f.apply(this,arguments)})},{key:"sell",value:(p=Object(s.a)(n.a.mark((function e(t,r,a){var s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.slice(0,2),!["11","12"].includes(s)){e.next=3;break}return e.abrupt("return",this.limitorder(this.tradeTypes.S,t,r,a));case 3:return e.abrupt("return",this.trade(this.tradeTypes.i,t,r,a));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return p.apply(this,arguments)})},{key:"query",value:(h=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,u,l,h;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.check();case 3:return r="https://jy.xzsec.com/Search/GetOrdersData?validatekey=".concat(this.validatekey),a={qqhs:10,dwc:""},e.next=7,$.a.post(r,a,{dataType:"json"});case 7:if(s=e.sent,this.hook(s),0!==s.Status){e.next=37;break}c=!0,i=!1,o=void 0,e.prev=13,u=s.Data[Symbol.iterator]();case 15:if(c=(l=u.next()).done){e.next=23;break}if((h=l.value).Wtbh!==t){e.next=20;break}return console.log("#EastMoneyStockTrader# query ".concat(t,": code ").concat(h.Zqdm," ").concat(h.Zqmc," status ").concat(h.Mmsm,"-").concat(h.Wtzt," deal ").concat(h.Cjsl,"/").concat(h.Wtsl)),e.abrupt("return",h.Wtzt);case 20:c=!0,e.next=15;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(13),i=!0,o=e.t0;case 29:e.prev=29,e.prev=30,c||null==u.return||u.return();case 32:if(e.prev=32,!i){e.next=35;break}throw o;case 35:return e.finish(32);case 36:return e.finish(29);case 37:throw console.log("#EastMoneyStockTrader# query ".concat(t," status 未知 ")),"未知";case 41:throw e.prev=41,e.t1=e.catch(0),console.warn("#EastMoneyStockTrader# query ".concat(t," fail"),e.t1),e.t1;case 45:case"end":return e.stop()}}),e,this,[[0,41],[13,25,29,37],[30,,32,36]])}))),function(e){return h.apply(this,arguments)})},{key:"revoke",value:(l=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,u,l,h,p,f;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.check();case 3:for(r="https://jy.xzsec.com/Trade/RevokeOrders?validatekey=".concat(this.validatekey),a=g()().format("YYYYMMDD"),s=[],c=!0,i=!1,o=void 0,e.prev=9,u=t[Symbol.iterator]();!(c=(l=u.next()).done);c=!0)h=l.value,s.push("".concat(a,"_").concat(h));e.next=17;break;case 13:e.prev=13,e.t0=e.catch(9),i=!0,o=e.t0;case 17:e.prev=17,e.prev=18,c||null==u.return||u.return();case 20:if(e.prev=20,!i){e.next=23;break}throw o;case 23:return e.finish(20);case 24:return e.finish(17);case 25:return p={revokes:s.join(",")},e.next=28,$.a.post(r,p);case 28:f=e.sent,console.log("#EastMoneyStockTrader# revoke ",f),e.next=36;break;case 32:throw e.prev=32,e.t1=e.catch(0),console.warn("#EastMoneyStockTrader# revoke: ".concat(t.join(",")," fail"),e.t1),e.t1;case 36:case"end":return e.stop()}}),e,this,[[0,32],[9,13,17,25],[18,,20,24]])}))),function(e){return l.apply(this,arguments)})},{key:"revokelist",value:(o=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,u,l,h,p;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.check();case 3:return r="https://jy.xzsec.com/Trade/GetRevokeList?validatekey=".concat(this.validatekey),e.next=6,$.a.post(r,null,{dataType:"json"});case 6:if(a=e.sent,this.hook(a),0!==a.Status){e.next=34;break}for(s=null,c=[],i=!0,o=!1,u=void 0,e.prev=14,l=a.Data[Symbol.iterator]();!(i=(h=l.next()).done);i=!0)p=h.value,c.push(p.Wtbh),p.Wtbh===t&&(s=p.Wtbh);e.next=22;break;case 18:e.prev=18,e.t0=e.catch(14),o=!0,u=e.t0;case 22:e.prev=22,e.prev=23,i||null==l.return||l.return();case 25:if(e.prev=25,!o){e.next=28;break}throw u;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return console.log("#EastMoneyStockTrader# revokelist ",s||c),e.abrupt("return",t?s:c);case 34:throw a;case 35:e.next=41;break;case 37:throw e.prev=37,e.t1=e.catch(0),console.warn("#EastMoneyStockTrader# revokelist ".concat(t||""," fail"),e.t1),e.t1;case 41:case"end":return e.stop()}}),e,this,[[0,37],[14,18,22,30],[23,,25,29]])}))),function(e){return o.apply(this,arguments)})},{key:"stocklist",value:(a=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,u,l,h,p,f,v,d;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.check();case 3:return r="https://jy.xzsec.com/Search/GetStockList?validatekey=".concat(this.validatekey),e.next=6,$.a.get(r,null,{dataType:"json"});case 6:if(a=e.sent,this.hook(a),0!==a.Status){e.next=34;break}for(s={code:t,name:"",amount:{total:0,available:0,unavailable:0}},c=[],i=!0,o=!1,u=void 0,e.prev=14,l=a.Data[Symbol.iterator]();!(i=(h=l.next()).done);i=!0)p=h.value,f=p.Zqdm,v=p.Zqmc,d={total:+p.Zqsl,available:+p.Kysl,unavailable:+p.Djsl},t===f&&(s={code:f,name:v,amount:d}),c.push({code:f,name:v,amount:d});e.next=22;break;case 18:e.prev=18,e.t0=e.catch(14),o=!0,u=e.t0;case 22:e.prev=22,e.prev=23,i||null==l.return||l.return();case 25:if(e.prev=25,!o){e.next=28;break}throw u;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return console.log("#EastMoneyStockTrader# stocklist : ",s||c),e.abrupt("return",t?s:c);case 34:throw a;case 35:e.next=41;break;case 37:throw e.prev=37,e.t1=e.catch(0),console.warn("#EastMoneyStockTrader# stocklist ".concat(t||""," fail"),e.t1),e.t1;case 41:case"end":return e.stop()}}),e,this,[[0,37],[14,18,22,30],[23,,25,29]])}))),function(e){return a.apply(this,arguments)})},{key:"position",value:(r=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,u,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=this.market(t).toUpperCase(),a="https://hsmarket.eastmoney.com/api/SHSZQuoteSnapshot?id=".concat(t,"&market=").concat(r,"&callback"),e.next=5,$.a.get(a,null);case 5:for(s=(s=e.sent).slice(1,-2),c=JSON.parse(s),i={buy:{price:[],amount:[]},sell:{price:[],amount:[]}},o=0,u=[1,2,3,4,5];o<u.length;o++)l=u[o],i.buy.price.push(+c.fivequote["buy".concat(l)]),i.buy.amount.push(+c.fivequote["buy".concat(l,"_count")]),i.sell.price.push(+c.fivequote["sale".concat(l)]),i.sell.amount.push(+c.fivequote["sale".concat(l,"_count")]);return console.log("#EastMoneyStockTrader# position ".concat(t,": "),i),e.abrupt("return",i);case 14:throw e.prev=14,e.t0=e.catch(0),console.warn("#EastMoneyStockTrader# position ".concat(t," fail"),e.t0),e.t0;case 18:case"end":return e.stop()}}),e,this,[[0,14]])}))),function(e){return r.apply(this,arguments)})},{key:"account",value:(t=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.check();case 3:return t="https://jy.xzsec.com/Com/queryAssetAndPositionV1?validatekey=".concat(this.validatekey),r={moneyType:"RMB"},e.next=7,$.a.post(t,r,{dataType:"json"});case 7:return a=e.sent,this.hook(a),s={money:{available:0,unavailable:0},profit:{today:0,all:0},capital:{stock:0,money:0}},0===a.Status&&(c=a.Data[0],s.money.available=+c.Kyzj,s.money.unavailable=+c.Djzj,s.profit.today=+(c.Dryk||0),s.profit.all=+c.Ljyk,s.capital.stock=+c.Zxsz,s.capital.money=+c.Zzc,console.log("#EastMoneyStockTrader# account ",s)),e.abrupt("return",s);case 14:throw e.prev=14,e.t0=e.catch(0),console.warn("#EastMoneyStockTrader# account fail",e.t0),e.t0;case 18:case"end":return e.stop()}}),e,this,[[0,14]])}))),function(){return t.apply(this,arguments)})}]),e}(),pe=new(function(){function e(){Object(c.a)(this,e),Object(u.a)(this,"trader",new he),Object(u.a)(this,"isForceDisable",!0),this.isForceDisable="off"===v.a.trader.status}var t,r,a,o,l;return Object(i.a)(e,[{key:"login",value:(l=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.isForceDisable){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,this.trader.key();case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(3),e.next=12,this.trader.check();case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(0),console.warn("#Trader# login ",e.t1);case 17:case"end":return e.stop()}}),e,this,[[0,14],[3,8]])}))),function(){return l.apply(this,arguments)})},{key:"amount",value:function(e,t){try{if(e.startsWith("11")||e.startsWith("12")){var r=v.a.trader.bond.amount/t;return+Number(Math.floor(r/v.a.trader.bond.unit)*v.a.trader.bond.unit).toFixed(0)}var a=v.a.trader.stock.amount/t;return+Number(Math.floor(a/v.a.trader.stock.unit)*v.a.trader.stock.unit).toFixed(0)}catch(t){return e.startsWith("11")||e.startsWith("12")?10:100}}},{key:"stocklist",value:(o=Object(s.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isForceDisable){e.next=2;break}return e.abrupt("return",{code:t,name:"",amount:{total:0,available:0,unavailable:0}});case 2:return e.abrupt("return",this.trader.stocklist(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"buy",value:(a=Object(s.a)(n.a.mark((function e(t,r,a){var s,c,i,o,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.isForceDisable){e.next=3;break}return e.abrupt("return");case 3:if(a){e.next=9;break}return e.next=6,this.trader.position(t);case 6:return s=e.sent,a=this.amount(t,s.sell.price[0]),e.abrupt("return",this.trader.buy(t,r,a));case 9:return e.next=11,this.trader.stocklist(t);case 11:(c=e.sent)||(c={code:t,name:r,amount:{total:0,available:0,unavailable:0}}),i=a;case 14:return e.next=17,this.trader.buy(t,r,i);case 17:return e.next=19,this.trader.stocklist(t);case 19:if(o=e.sent,(u=o.amount.total-c.amount.total)!==a){e.next=23;break}return e.abrupt("return");case 23:i=a-u,e.next=14;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(0),console.warn("#Trader# buy ",e.t0);case 31:case"end":return e.stop()}}),e,this,[[0,28]])}))),function(e,t,r){return a.apply(this,arguments)})},{key:"sell",value:(r=Object(s.a)(n.a.mark((function e(t,r,a){var s,c,i,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.isForceDisable){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.trader.stocklist(t);case 5:if(s=e.sent){e.next=8;break}return e.abrupt("return");case 8:if(s.amount.available){e.next=10;break}return e.abrupt("return");case 10:a||(a=s.amount.available),a>s.amount.available&&(a=s.amount.available),c=a;case 13:return e.next=16,this.trader.sell(t,r,c);case 16:return e.next=18,this.trader.stocklist(t);case 18:if(i=e.sent){e.next=21;break}return e.abrupt("return");case 21:if(i.amount.available){e.next=23;break}return e.abrupt("return");case 23:if((o=s.amount.available-i.amount.available)!==a){e.next=26;break}return e.abrupt("return");case 26:c=a-o,e.next=13;break;case 29:e.next=34;break;case 31:e.prev=31,e.t0=e.catch(0),console.warn("#Trader# sell ",e.t0);case 34:case"end":return e.stop()}}),e,this,[[0,31]])}))),function(e,t,a){return r.apply(this,arguments)})},{key:"liquidation",value:(t=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.isForceDisable){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.trader.stocklist();case 5:t=e.sent,r=!0,a=!1,s=void 0,e.prev=9,c=t[Symbol.iterator]();case 11:if(r=(i=c.next()).done){e.next=18;break}return o=i.value,e.next=15,this.sell(o.code,o.name,o.amount.available);case 15:r=!0,e.next=11;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(9),a=!0,s=e.t0;case 24:e.prev=24,e.prev=25,r||null==c.return||c.return();case 27:if(e.prev=27,!a){e.next=30;break}throw s;case 30:return e.finish(27);case 31:return e.finish(24);case 32:e.next=37;break;case 34:e.prev=34,e.t1=e.catch(0),console.warn("#Trader# liquidation ",e.t1);case 37:case"end":return e.stop()}}),e,this,[[0,34],[9,20,24,32],[25,,27,31]])}))),function(){return t.apply(this,arguments)})}]),e}()),fe=r(686),ve=r.n(fe),de=(r(314),r(46),function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(c.a)(this,e),Object(u.a)(this,"multiple",void 0),Object(u.a)(this,"code",void 0),Object(u.a)(this,"prevclose",void 0),Object(u.a)(this,"details",[]),this.code=t,this.multiple=r}var t;return Object(i.a)(e,[{key:"url",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=f.a.eastmoney.marketCode(e),a="".concat(r,".").concat(e),n="http://push2.eastmoney.com/api/qt/stock/details/get?fields1=f1,f2,f3,f4&fields2=f51,f52,f53,f54,f55&pos=".concat(t,"&secid=").concat(a);return n}},{key:"prevclose",value:function(){}},{key:"trends",value:function(){var e={time:[],price:[],volume:[]},t=0,r=0,a=0,n=q()(this.details).reverse();for(var s in n){var c=n[s];t=c[0].replace(/:/g,""),r+=+c[2],0==+s&&(a=t),+t>=+a+3*this.multiple&&(a=t,e.time.unshift(t),e.price.unshift(+c[1]),e.volume.unshift(r),r=0)}return e}},{key:"isFire",value:function(){var e=0,t=0,r=!0,a=!1,n=void 0;try{for(var s,c=this.details[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){if(2==+s.value[4]?e++:e=0,t>5)break;t++}}catch(e){a=!0,n=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw n}}return e>=3}},{key:"capture",value:(t=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,u,l,h,p;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.url(this.code,t),e.next=3,$.a.get(r,null,{dataType:"json"});case 3:for(a=e.sent,s=a.data.details,c=!0,i=!1,o=void 0,e.prev=8,u=s[Symbol.iterator]();!(c=(l=u.next()).done);c=!0)h=l.value,p=h.split(","),this.details.unshift(p);e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),i=!0,o=e.t0;case 16:e.prev=16,e.prev=17,c||null==u.return||u.return();case 19:if(e.prev=19,!i){e.next=22;break}throw o;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return this.prevclose=+a.data.prePrice,e.abrupt("return",this);case 26:case"end":return e.stop()}}),e,this,[[8,12,16,24],[17,,19,23]])}))),function(e){return t.apply(this,arguments)})}]),e}()),be=function(){function e(t){Object(c.a)(this,e),Object(u.a)(this,"code",void 0),Object(u.a)(this,"prevclose",void 0),Object(u.a)(this,"details",[]),this.code=t}var t;return Object(i.a)(e,[{key:"url",value:function(e){var t=f.a.eastmoney.marketCode(e),r="".concat(t,".").concat(e),a="http://push2.eastmoney.com/api/qt/stock/trends2/get?fields1=f1,f2,f3,f4,f5,f6,f7,f8,f9,f10,f11,f12,f13&fields2=f51,f52,f53,f54,f55,f56,f57,f58&secid=".concat(r,"&ndays=1&iscr=1");return a}},{key:"trends",value:function(){var e={time:[],price:[],volume:[]},t=!0,r=!1,a=void 0;try{for(var n,s=this.details[Symbol.iterator]();!(t=(n=s.next()).done);t=!0){var c=n.value,i=g()(c[0]).format("HHmmss");e.time.push(i),e.price.push(+c[2]),e.volume.push(+c[5])}}catch(e){r=!0,a=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw a}}return e}},{key:"capture",value:(t=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i,o,u,l,h,p,f=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:-10,r=this.url(this.code,t),e.next=4,$.a.get(r,null,{dataType:"json"});case 4:for(a=e.sent,s=a.data.trends,c=!0,i=!1,o=void 0,e.prev=9,u=s[Symbol.iterator]();!(c=(l=u.next()).done);c=!0)h=l.value,p=h.split(","),this.details.unshift(p);e.next=17;break;case 13:e.prev=13,e.t0=e.catch(9),i=!0,o=e.t0;case 17:e.prev=17,e.prev=18,c||null==u.return||u.return();case 20:if(e.prev=20,!i){e.next=23;break}throw o;case 23:return e.finish(20);case 24:return e.finish(17);case 25:return this.prevclose=+a.data.preClose,e.abrupt("return",this);case 27:case"end":return e.stop()}}),e,this,[[9,13,17,25],[18,,20,24]])}))),function(){return t.apply(this,arguments)})}]),e}(),me=function e(t,r,a){return Object(c.a)(this,e),3===r?new de(t,a):60===r?new be(t):void 0};function ke(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,a=e[0],n=0;return r||(r=e.length-1),e.forEach((function(e,s){n>=r||(1===t||s%t==0)&&(a<+e&&(a=e),n++)})),a}function ye(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,a=e[0],n=0;return r||(r=e.length-1),e.forEach((function(e,s){n>=r||(1===t||s%t==0)&&(a>+e&&(a=e),n++)})),a}function xe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,a=0,n=0,s=0;return e.forEach((function(e,c){s>=r||(1===t?(a+=+e,s++):(n+=+e,c%t==0&&(a+=+n/r,s++)))})),s<r&&(r=s),+(a/r).toFixed(2)}var ge=function(){function e(t,r,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(c.a)(this,e),Object(u.a)(this,"profit",{time:{win:0,lose:0},change:{win:0,lose:0},rate:{win:0,lose:0},ratio:0}),Object(u.a)(this,"trends",{time:[],price:[],volume:[],ma5:[],ma10:[],ma20:[],change:[],rate:[]}),Object(u.a)(this,"code",void 0),Object(u.a)(this,"period",void 0),Object(u.a)(this,"multiple",void 0),Object(u.a)(this,"prevclose",void 0),Object(u.a)(this,"details",{time:[],price:[],volume:[]}),Object(u.a)(this,"index",0),Object(u.a)(this,"simulator",void 0),this.code=r,this.period=a,this.multiple=n,this.simulator=t}var t,r;return Object(i.a)(e,[{key:"capture",value:(r=Object(s.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new me(this.code,this.period,this.multiple).capture();case 2:t=e.sent,this.details=t.trends(),this.details.time.reverse(),this.details.price.reverse(),this.details.volume.reverse(),this.prevclose=t.prevclose;case 8:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"start",value:(t=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i,o,u,l,h;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.simulator,r=t.analyseOfBuy,a=t.analyseOfSell,s=t.analyseOfBuy2,c=t.analyseOfSell2,i=0,o=0,e.next=5,this.capture();case 5:if(!this.hasNext()){e.next=47;break}if(this.next(),!(+this.trends.time[0]<93e3||+this.trends.time[0]>145e3)){e.next=9;break}return e.abrupt("continue",5);case 9:if(!r(this.trends)){e.next=45;break}console.info("#analyseOfBuy# ",this.trends.time[0],this.trends.price[0],this.trends.change[0],this.trends.volume[0],this.trends.ma5[0],this.trends.ma10[0],this.trends.ma20[0]),i=this.trends.change[0];case 12:if(!this.hasNext()){e.next=22;break}if(this.next(),!a(this.trends,{change:i})){e.next=20;break}return o=this.trends.change[0],u=o-i,console.info("#analyseOfSell# ",this.trends.time[0],this.trends.price[0],this.trends.change[0],this.trends.volume[0],this.trends.ma5[0],this.trends.ma10[0],this.trends.ma20[0],u),this.update(u),e.abrupt("break",22);case 20:e.next=12;break;case 22:if(!s){e.next=45;break}l=0;case 24:if(!this.hasNext()){e.next=45;break}if(!(++l>3)){e.next=28;break}return e.abrupt("break",45);case 28:if(this.next(),!s(this.trends)){e.next=43;break}console.info("#analyseOfBuy2# ",this.trends.time[0],this.trends.price[0],this.trends.change[0],this.trends.volume[0],this.trends.ma5[0],this.trends.ma10[0],this.trends.ma20[0]),i=this.trends.change[0];case 32:if(!this.hasNext()){e.next=42;break}if(this.next(),!c(this.trends,{change:i})){e.next=40;break}return o=this.trends.change[0],h=o-i,console.info("#analyseOfSell2# ",this.trends.time[0],this.trends.price[0],this.trends.change[0],this.trends.volume[0],this.trends.ma5[0],this.trends.ma10[0],this.trends.ma20[0],h),this.update(h),e.abrupt("break",42);case 40:e.next=32;break;case 42:return e.abrupt("break",45);case 43:e.next=24;break;case 45:e.next=5;break;case 47:console.info("#Profit# ","总笔数 ",this.profit.time.win+this.profit.time.lose,"总收益 ",this.profit.change.win+this.profit.change.lose,"单笔收益 ",(this.profit.change.win+this.profit.change.lose)/(this.profit.time.win+this.profit.time.lose),this.profit),e.next=53;break;case 50:e.prev=50,e.t0=e.catch(0),console.warn("MockProcessor ",e.t0);case 53:return e.abrupt("return",this);case 54:case"end":return e.stop()}}),e,this,[[0,50]])}))),function(){return t.apply(this,arguments)})},{key:"hasNext",value:function(){var e=this.details.time.length;return this.index<e}},{key:"next",value:function(){this.index+=1;var e=this.details.time[this.index],t=this.details.price[this.index],r=this.details.volume[this.index],a=+((t-this.prevclose)/this.prevclose*100).toFixed(2);this.trends.time.unshift(e),this.trends.price.unshift(t),this.trends.volume.unshift(r),this.trends.change.unshift(a),this.trends.ma5.unshift(xe(this.trends.price,1,5)),this.trends.ma10.unshift(xe(this.trends.price,1,10)),this.trends.ma20.unshift(xe(this.trends.price,1,20)),this.trends.rate.unshift(NaN)}},{key:"update",value:function(e){e>0?(this.profit.time.win++,this.profit.change.win+=e):(this.profit.time.lose++,this.profit.change.lose+=e);var t=this.profit.time.win+this.profit.time.lose||1;this.profit.rate.win=this.profit.time.win/t,this.profit.rate.lose=this.profit.time.lose/t,this.profit.ratio=(this.profit.change.win+this.profit.change.lose)/t}}]),e}(),we=function(){function e(t,r,a,n){Object(c.a)(this,e),Object(u.a)(this,"Processor",void 0),Object(u.a)(this,"processor",void 0),Object(u.a)(this,"target",void 0),Object(u.a)(this,"key",void 0),Object(u.a)(this,"codes",[]),this.Processor=t,this.target=r,this.key=a,this.codes=n}var t,r,a;return Object(i.a)(e,[{key:"start",value:(a=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X.isTradingDay();case 3:if(!e.sent){e.next=28;break}return e.prev=4,e.next=7,pe.login();case 7:return e.next=9,pe.liquidation();case 9:if(this.codes){e.next=13;break}return e.next=12,this.capture();case 12:this.codes=e.sent;case 13:this.processor=new this.Processor(this.target,this.key,this.codes),this.processor.start(),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),console.warn("T0Controller start ",e.t0);case 20:return this._isRunning=!0,e.next=24,b.a.until("144500");case 24:return e.next=26,this.stop();case 26:return e.next=28,pe.liquidation();case 28:e.next=34;break;case 30:e.prev=30,e.t1=e.catch(0),this._isRunning=!1,console.warn("T0Controller start ",e.t1);case 34:case"end":return e.stop()}}),e,this,[[0,30],[4,17]])}))),function(){return a.apply(this,arguments)})},{key:"stop",value:(r=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.processor.stop()}catch(e){console.warn("T0Controller stop ",e)}case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"capture",value:(t=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}(),Oe=new(function(){function e(){Object(c.a)(this,e),Object(u.a)(this,"stocklist",{})}var t,r,a,o;return Object(i.a)(e,[{key:"_broadcast",value:(o=Object(s.a)(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Interval_Event",{detail:t})),(r=(window.parent||window).opener)&&["L3","L5"].includes(t.state)&&r.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Interval_Event",{detail:t}));case 3:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"broadcast",value:(a=Object(s.a)(n.a.mark((function e(t,r,a,s){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._broadcast({name:"".concat(t," - ").concat(r),vtype:"v0",stock:a,trend:s,state:r});case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return a.apply(this,arguments)})},{key:"buy",value:(r=Object(s.a)(n.a.mark((function e(t,r){var a,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,pe.stocklist(r.code);case 3:return a=e.sent,e.next=6,pe.buy(r.code,r.name);case 6:return e.next=8,pe.stocklist(r.code);case 8:s=e.sent,this.stocklist[r.code]=s.amount.available-a.amount.available,e.next=14;break;case 12:e.prev=12,e.t0=e.catch(0);case 14:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e,t){return r.apply(this,arguments)})},{key:"sell",value:(t=Object(s.a)(n.a.mark((function e(t,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,pe.sell(r.code,r.name,this.stocklist[r.code]);case 3:delete this.stocklist[r.code],e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(e,r){return t.apply(this,arguments)})}]),e}()),je="L1",Se="L2",Te="L3",Pe="L4",Ce="L5",_e=function(){function e(t){Object(c.a)(this,e),Object(u.a)(this,"sse",void 0),Object(u.a)(this,"period",void 0),Object(u.a)(this,"codes",[]),Object(u.a)(this,"_stocks",{}),Object(u.a)(this,"_trend",{}),this.codes=t}var t,r,a;return Object(i.a)(e,[{key:"init",value:(a=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=!0,r=!1,a=void 0,e.prev=3,s=this.codes[Symbol.iterator]();!(t=(c=s.next()).done);t=!0)i=c.value,this._trend[i]={time:[],price:[],volume:[],ma5:[],ma10:[],ma20:[],change:[],rate:[]};e.next=11;break;case 7:e.prev=7,e.t0=e.catch(3),r=!0,a=e.t0;case 11:e.prev=11,e.prev=12,t||null==s.return||s.return();case 14:if(e.prev=14,!r){e.next=17;break}throw a;case 17:return e.finish(14);case 18:return e.finish(11);case 19:case"end":return e.stop()}}),e,this,[[3,7,11,19],[12,,14,18]])}))),function(){return a.apply(this,arguments)})},{key:"restart",value:(r=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sse=f.a.sseStart(this.codes,{interval:1});case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"start",value:(t=Object(s.a)(n.a.mark((function e(){var t,r=this,a=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:3,e.prev=1,this.period=t,e.next=5,this.init();case 5:return e.next=7,this.restart();case 7:return b.a.interval(Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.update());case 1:case"end":return e.stop()}}),e)}))),null,this.period),e.next=10,Object(y.a)(20*this.period*1e3);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.warn("T0SSE start ",e.t0);case 15:case"end":return e.stop()}}),e,this,[[1,12]])}))),function(){return t.apply(this,arguments)})},{key:"stop",value:function(){this.sse&&this.sse.stop()}},{key:"stocks",value:function(){return this.sse.getStocks(this.codes)}},{key:"stock",value:function(e){return this.sse.getStock(e)}},{key:"trends",value:function(){return this._trend}},{key:"trend",value:function(e){return this._trend[e]}},{key:"update",value:function(){console.log("@"),2==+this.sse.state()&&(console.warn("#T0# sse restart ...",this.sse.state()),this.restart()),this._bak=this._stocks,this._stocks=this.sse.getStocks(this.codes);var e=g()().format("HHmmss");for(var t in this._stocks){var r=this._bak[t],a=this._stocks[t];this._trend[t].time.unshift(e),this._trend[t].price.unshift(+a.price),this._trend[t].change.unshift(+a.change),this._trend[t].rate.unshift(+a.rate),this._trend[t].volume.unshift(+a.volume-(r?+r.volume:+a.volume)),this._trend[t].ma5.unshift(this.maOfPrice(t,1,5)),this._trend[t].ma10.unshift(this.maOfPrice(t,1,10)),this._trend[t].ma20.unshift(this.maOfPrice(t,1,20)),this._trend[t].time=this._trend[t].time.slice(0,200),this._trend[t].price=this._trend[t].price.slice(0,200),this._trend[t].change=this._trend[t].change.slice(0,200),this._trend[t].rate=this._trend[t].rate.slice(0,200),this._trend[t].volume=this._trend[t].volume.slice(0,200),this._trend[t].ma5=this._trend[t].ma5.slice(0,200),this._trend[t].ma10=this._trend[t].ma10.slice(0,200),this._trend[t].ma20=this._trend[t].ma20.slice(0,200)}}},{key:"maOfPrice",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return xe(this._trend[e].price,t,r)}},{key:"maOfVolume",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return xe(this._trend[e].volume,t,r)}}]),e}(),Le=O.a.createInstance({name:"storage",driver:O.a.INDEXEDDB}),Fe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object(c.a)(this,e),Object(u.a)(this,"record",{code:"",name:"",trend:{time:[],ma5:[],ma10:[],ma20:[],price:[],change:[],rate:[]},monitor:{time:"",price:"",change:"",rate:""},buy:{time:"",price:"",change:"",rate:""},sell:{time:"",price:"",change:"",rate:""}}),this.record.name=r,this.record.code=t}return Object(i.a)(e,[{key:"key",value:function(){return this.record.key}},{key:"code",value:function(e){return e&&(this.record.code=e),this.record.code}},{key:"name",value:function(e){return e&&(this.record.code=e),this.record.name}},{key:"trend",value:function(e){return e&&(this.record.trend.time=e.time.slice(0,100),this.record.trend.ma5=e.ma5.slice(0,100),this.record.trend.ma10=e.ma10.slice(0,100),this.record.trend.ma20=e.ma20.slice(0,100),this.record.trend.price=e.price.slice(0,100),this.record.trend.change=e.change.slice(0,100),this.record.trend.rate=e.rate.slice(0,100)),this.record.trend}},{key:"monitor",value:function(e){if(e){var t=g()().format("HHmmss");this.record.monitor={time:t,price:e.price,change:e.change,rate:e.rate},this.record.name=e.name,this.record.code=e.code}return this.record.monitor}},{key:"buy",value:function(e){if(e){var t=g()().format("HHmmss");this.record.buy={time:t,price:e.price,change:e.change,rate:e.rate},this.record.name=e.name,this.record.code=e.code}return this.record.buy}},{key:"sell",value:function(e){if(e){var t=g()().format("HHmmss");this.record.sell={time:t,price:e.price,change:e.change,rate:e.rate},this.record.name=e.name,this.record.code=e.code}return this.record.sell}}]),e}(),Be=function(){function e(t,r){Object(c.a)(this,e),Object(u.a)(this,"records",{}),Object(u.a)(this,"target",void 0),Object(u.a)(this,"key",void 0),this.target=t,this.key=r}var t,r;return Object(i.a)(e,[{key:"name",value:function(){var e=g()().day();return"t0-".concat(e,"-").concat(this.target,"-").concat(this.key)}},{key:"record",value:function(){return new Fe}},{key:"append",value:function(e){var t=e.record,r=g()().format("HHmmss");return this.records[r]=t,this.save()}},{key:"all",value:function(){return this.records}},{key:"get",value:function(e){return this.records[e]||{}}},{key:"set",value:function(e,t){var r=t.record;return this.records[e]=r,this.save()}},{key:"load",value:(r=Object(s.a)(n.a.mark((function e(){var t,r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g()().format("YYYY-MM-DD"),e.next=3,Le.getItem(this.name());case 3:return(r=e.sent)&&r.date===t&&(this.records=r),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"save",value:(t=Object(s.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g()().format("YYYY-MM-DD"),this.records.date=t,e.abrupt("return",Le.setItem(this.name(),this.records));case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),De=function(){function e(t,r,a){Object(c.a)(this,e),Object(u.a)(this,"key",""),Object(u.a)(this,"records",void 0),Object(u.a)(this,"sse",void 0),Object(u.a)(this,"hooks",Oe),Object(u.a)(this,"current",void 0),Object(u.a)(this,"isRunning",!1),Object(u.a)(this,"isForceStop",!1),this.key=r,this.sse=new _e(a),this.records=new Be(t,r)}var t,r,a,o;return Object(i.a)(e,[{key:"start",value:(o=Object(s.a)(n.a.mark((function e(t){var r,a=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.records.load();case 3:return e.next=5,this.sse.start(t);case 5:this.isRunning=!0;case 6:return console.log("#"),e.next=10,Object(y.a)(1e3);case 10:if(!(+g()().format("HHmmss")<93e3)){e.next=13;break}return e.abrupt("continue",6);case 13:if(!this.isForceStop){e.next=16;break}return console.log("T0Processor loop force stop ..."),e.abrupt("break",55);case 16:return e.prev=16,this.current=null,r=new Fe(this.key),this.hooks.broadcast(this.key,je),e.next=22,this.monitor();case 22:if(this.current=e.sent,this.current){e.next=25;break}return e.abrupt("continue",6);case 25:return r.monitor(this.current),console.log("T0Processor loop state L1 ... ",this.current),this.hooks.broadcast(this.key,Se,this.current,this.sse.trend(this.current.code)),e.next=30,this.analyseOfBuy(this.current);case 30:if(this.current=e.sent,this.current){e.next=33;break}return e.abrupt("continue",6);case 33:return r.buy(this.current),console.log("T0Processor loop state L2 ... ",this.current),this.hooks.broadcast(this.key,Te,this.current,this.sse.trend(this.current.code)),this.hooks.buy(this.key,this.current),console.log("T0Processor loop state L3 ... ",this.current),this.hooks.broadcast(this.key,Pe,this.current,this.sse.trend(this.current.code)),e.next=41,this.analyseOfSell(this.current);case 41:this.current=e.sent,r.sell(this.current),console.log("T0Processor loop state L4 ... ",this.current),this.hooks.broadcast(this.key,Ce,this.current,this.sse.trend(this.current.code)),this.hooks.sell(this.key,this.current),console.log("T0Processor loop state L5 ... ",this.current),function(){var e=Object(s.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(y.a)(18e4);case 2:t.trend(a.sse.trend(t.code())),a.records.append(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(r),e.next=53;break;case 50:e.prev=50,e.t0=e.catch(16),console.warn("T0Processor loop ",e.t0);case 53:e.next=6;break;case 55:this.isRunning=!1,e.next=61;break;case 58:e.prev=58,e.t1=e.catch(0),console.warn("T0Processor loop ",e.t1);case 61:case"end":return e.stop()}}),e,this,[[0,58],[16,50]])}))),function(e){return o.apply(this,arguments)})},{key:"stop",value:(a=Object(s.a)(n.a.mark((function e(){var t=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isForceStop=!0,this.sse.stop(),e.abrupt("return",new Promise((function(e){setInterval((function(){t.isRunning||e()}),1e3)})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"analyseOfBuy",value:(r=Object(s.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"analyseOfSell",value:(t=Object(s.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),Me=function(e){function t(){var e,r;Object(c.a)(this,t);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return r=Object(B.a)(this,(e=Object(D.a)(t)).call.apply(e,[this].concat(n))),Object(u.a)(Object(R.a)(r),"isImpulseBoom",!1),r}var r,a,o;return Object(M.a)(t,e),Object(i.a)(t,[{key:"start",value:function(){return Object(W.a)(Object(D.a)(t.prototype),"start",this).call(this,6)}},{key:"monitor",value:(o=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=this.sse.trends();case 2:r=(new Date).getTime(),e.t0=n.a.keys(t);case 5:if((e.t1=e.t0()).done){e.next=19;break}if(a=e.t1.value,s=this.sse.trend(a),c=this.sse.stock(a),this.isImpulseBoom=!1,!(c.change-s.change[0]>2)){e.next=14;break}return console.log("T0LongImpulseProcessor analyseOfBuy impulse boom",a,c.change,c.change[0],c.change-s.change[0]),this.isImpulseBoom=!0,e.abrupt("return",c);case 14:if(!(c.change-s.change[2]>.5)){e.next=17;break}return console.log("T0LongImpulseProcessor analyseOfBuy impulse catched",a,c.change,s.change[2],c.change-s.change[2]),e.abrupt("return",c);case 17:e.next=5;break;case 19:return i=(new Date).getTime(),console.log("*",i-r+"ms"),e.next=23,Object(y.a)(1500);case 23:e.next=2;break;case 25:e.next=30;break;case 27:e.prev=27,e.t2=e.catch(0),console.warn("T0LongImpulseProcessor monitor ",e.t2);case 30:case"end":return e.stop()}}),e,this,[[0,27]])}))),function(){return o.apply(this,arguments)})},{key:"analyseOfBuy",value:(a=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,u,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.code,e.prev=1,a=this.sse.trend(r),s=this.sse.stock(r),this.analyseOfSell.high=s.change,!this.isImpulseBoom){e.next=7;break}return e.abrupt("return",s);case 7:if(a.price[0]>a.price[1]&&a.price[0]>a.ma5[0]&&a.ma5[0]>a.ma5[1]&&a.ma5[1]>a.ma5[2]&&a.ma5[2]>a.ma5[3]&&a.ma5[3]>a.ma5[4]){e.next=9;break}return e.abrupt("return");case 9:console.log("T0LongImpulseProcessor analyseOfBuy mas up",a.time[0],a.ma5[0],a.ma5[1],a.ma5[2],a.ma5[3],a.ma5[4]),c=0,i=0,e.t0=n.a.keys(a.ma5);case 12:if((e.t1=e.t0()).done){e.next=20;break}if(o=e.t1.value,c=+o,a.price[c]>i&&(i=a.price[c]),!(a.ma5[c]<a.ma5[c+1])){e.next=18;break}return e.abrupt("break",20);case 18:e.next=12;break;case 20:if(a.change[0]-a.change[c]>1&&a.price[0]>=i){e.next=22;break}return e.abrupt("return");case 22:if(console.log("T0LongImpulseProcessor analyseOfBuy impulse valid",a.time[0],"tick = ".concat(c),"+".concat(a.change[0]-a.change[c])),u=!1,l=!1,a.change[0]-a.change[c]>1.5&&a.change[0]-a.change[3]>.5&&(console.log("T0LongImpulseProcessor analyseOfBuy rise breakthrough",a.time[0],a.change[0],a.change[3],"+".concat(a.change[0]-a.change[3])),u=!0),a.change[0]-a.change[3]>.8&&(console.log("T0LongImpulseProcessor analyseOfBuy impulse breakthrough",a.time[0],a.change[0],a.change[3],"+".concat(a.change[0]-a.change[3])),l=!0),u||l){e.next=29;break}return e.abrupt("return");case 29:return e.abrupt("return",s);case 32:e.prev=32,e.t2=e.catch(1),console.warn("T0LongImpulseProcessor analyseOfBuy ",e.t2);case 35:case"end":return e.stop()}}),e,this,[[1,32]])}))),function(e){return a.apply(this,arguments)})},{key:"analyseOfSell",value:(r=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.code,a=t.change,e.prev=1;case 2:if(s=this.sse.stock(r),c=this.sse.trend(r),i=.4,s.change>this.analyseOfSell.high&&(this.analyseOfSell.high=s.change),!(a-c.change[0]>0)){e.next=10;break}return console.log("T0LongImpulseProcessor analyseOfSell stoploss",c.time[0],a,c.change[0]),e.abrupt("return",s);case 10:if(!(s.change-a>0&&this.analyseOfSell.high-s.change>=i)){e.next=13;break}return console.log("T0LongImpulseProcessor analyseOfSell drawdown",c.time[0],this.analyseOfSell.high,s.change),e.abrupt("return",s);case 13:if(c.price[0]>c.ma5[0]&&c.price[0]>c.ma10[0]){e.next=23;break}if(!(c.ma5[0]<=c.ma5[1])){e.next=17;break}return console.log("T0LongImpulseProcessor analyseOfSell ma5 reverse",c.time[0],c.ma5[0],c.ma5[1]),e.abrupt("return",s);case 17:if(!(c.ma10[0]<=c.ma10[1])){e.next=20;break}return console.log("T0LongImpulseProcessor analyseOfSell ma10 reverse",c.time[0],c.ma10[0],c.ma10[1]),e.abrupt("return",s);case 20:if(!(c.ma5[0]<=c.ma10[0])){e.next=23;break}return console.log("T0LongImpulseProcessor analyseOfSell ma down ma5 <= ma10",c.time[0],c.ma5[0],c.ma10[0]),e.abrupt("return",s);case 23:return e.next=25,Object(y.a)(1e3);case 25:e.next=2;break;case 27:e.next=33;break;case 29:return e.prev=29,e.t0=e.catch(1),console.warn("T0LongImpulseProcessor analyseOfSell ",e.t0),e.abrupt("return",this.sse.stock(r));case 33:case"end":return e.stop()}}),e,this,[[1,29]])}))),function(e){return r.apply(this,arguments)})}]),t}(De),Ie=function(e){function t(){return Object(c.a)(this,t),Object(B.a)(this,Object(D.a)(t).apply(this,arguments))}var r,a,o;return Object(M.a)(t,e),Object(i.a)(t,[{key:"start",value:function(){return Object(W.a)(Object(D.a)(t.prototype),"start",this).call(this,6)}},{key:"monitor",value:(o=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=this.sse.trends();case 2:r=(new Date).getTime(),e.t0=n.a.keys(t);case 5:if((e.t1=e.t0()).done){e.next=14;break}if(a=e.t1.value,s=this.sse.stock(a),c=this.sse.trend(a),!(s.change-c.change[2]>.5)){e.next=12;break}return console.log("T0LongPlatformProcessor analyseOfBuy speed breakthrough",a,s.change,c.change[2],s.change-c.change[2]),e.abrupt("return",s);case 12:e.next=5;break;case 14:return i=(new Date).getTime(),console.log("*",i-r+"ms"),e.next=18,Object(y.a)(1500);case 18:e.next=2;break;case 20:e.next=25;break;case 22:e.prev=22,e.t2=e.catch(0),console.warn("T0LongPlatformProcessor monitor ",e.t2);case 25:case"end":return e.stop()}}),e,this,[[0,22]])}))),function(){return o.apply(this,arguments)})},{key:"analyseOfBuy",value:(a=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.code,e.prev=1,a=this.sse.trend(r),s=this.sse.stock(r),c=100,!(a.change.length<c)){e.next=7;break}return e.abrupt("return");case 7:if(a.ma5[0]>a.ma5[1]&&a.ma5[1]>a.ma5[2]&&a.ma5[2]>a.ma5[3]&&a.ma5[3]>a.ma5[4]){e.next=9;break}return e.abrupt("return");case 9:if(console.log("T0LongPlatformProcessor analyseOfBuy mas up",a.time[0],a.ma5[0],a.ma5[1],a.ma5[2],a.ma5[3],a.ma5[4]),i=a.change.slice(5),o=ke(i,1,c),u=ye(i,1,c),o-u<1.5){e.next=15;break}return e.abrupt("return");case 15:if(console.log("T0LongPlatformProcessor analyseOfBuy platform amplitude",a.time[0],"max = "+o,"min = "+u,o-u),s.change-o>.8){e.next=18;break}return e.abrupt("return");case 18:return console.log("T0LongPlatformProcessor analyseOfBuy platform breakthrough",a.time[0],a.change[0]-o),this.analyseOfSell.high=s.change,e.abrupt("return",s);case 23:e.prev=23,e.t0=e.catch(1),console.warn("T0LongPlatformProcessor analyseOfBuy ",e.t0);case 26:case"end":return e.stop()}}),e,this,[[1,23]])}))),function(e){return a.apply(this,arguments)})},{key:"analyseOfSell",value:(r=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.code,a=t.change,e.prev=1;case 2:if(s=this.sse.stock(r),c=this.sse.trend(r),i=2,s.change>this.analyseOfSell.high&&(this.analyseOfSell.high=s.change),!(a-s.change>.3)){e.next=10;break}return console.log("T0LongPlatformProcessor analyseOfSell stoploss",c.time[0],a,s.change),e.abrupt("return",s);case 10:if(!(s.change-a>0&&this.analyseOfSell.high-s.change>=i)){e.next=13;break}return console.log("T0LongPlatformProcessor analyseOfSell drawdown",c.time[0],this.analyseOfSell.high,s.change),e.abrupt("return",s);case 13:if(!(c.ma5[0]<=c.ma20[0])){e.next=16;break}return console.log("T0LongPlatformProcessor analyseOfSell ma5&ma20 cross",c.time[0],c.ma5[0],c.ma10[0],c.ma20[0]),e.abrupt("return",s);case 16:if(!(c.ma10[0]<=c.ma20[0])){e.next=19;break}return console.log("T0LongPlatformProcessor analyseOfSell ma10&ma20 cross",c.time[0],c.ma5[0],c.ma10[0],c.ma20[0]),e.abrupt("return",s);case 19:if(!(c.ma20[0]<=c.ma20[1])){e.next=22;break}return console.log("T0LongPlatformProcessor analyseOfSell ma20 reverse",c.time[0],c.ma20[0],c.ma20[1]),e.abrupt("return",s);case 22:return e.next=24,Object(y.a)(1e3);case 24:e.next=2;break;case 26:e.next=32;break;case 28:return e.prev=28,e.t0=e.catch(1),console.warn("T0LongPlatformProcessor analyseOfSell ",e.t0),e.abrupt("return",this.sse.stock(r));case 32:case"end":return e.stop()}}),e,this,[[1,28]])}))),function(e){return r.apply(this,arguments)})}]),t}(De),Ye=(r(695),r(696),r(697),{"long-impulse":Me,"long-platform":Ie});function Ee(e,t){var r=t.change;try{var a={change:e.change[0],price:e.price[0]};if(a.change>Ee.high&&(Ee.high=a.change),r-e.change[0]>0)return console.log("T0LongImpulseProcessor analyseOfSell stoploss",e.time[0],r,e.change[0]),a;if(a.change-r>0&&Ee.high-a.change>=.4)return console.log("T0LongImpulseProcessor analyseOfSell drawdown",e.time[0],Ee.high,a.change),a;if(!(e.price[0]>e.ma5[0]&&e.price[0]>e.ma10[0])){if(e.ma5[0]<=e.ma5[1])return console.log("T0LongImpulseProcessor analyseOfSell ma5 reverse",e.time[0],e.ma5[0],e.ma5[1]),a;if(e.ma10[0]<=e.ma10[1])return console.log("T0LongImpulseProcessor analyseOfSell ma10 reverse",e.time[0],e.ma10[0],e.ma10[1]),a;if(e.ma5[0]<=e.ma10[0])return console.log("T0LongImpulseProcessor analyseOfSell ma down ma5 <= ma10",e.time[0],e.ma5[0],e.ma10[0]),a}}catch(e){console.warn("T0LongImpulseProcessor analyseOfSell ",e)}}var Re={analyseOfBuy:function(e){try{if(Ee.high=e.change[0],e.change[0]-e.change[1]>2)return console.info("T0LongImpulseProcessor analyseOfBuy impulse boom",e.time[0],e.change[0],e.change[1],"+".concat(e.change[0]-e.change[1])),!0;var t=0,r=0;for(var a in e.ma5)if(t=+a,e.price[t]>r&&(r=e.price[t]),e.ma5[t]<e.ma5[t+1])break;if(!(e.change[0]-e.change[t]>1&&e.price[0]>=r))return;console.info("T0LongImpulseProcessor analyseOfBuy impulse valid",e.time[0],"tick = ".concat(t),"+".concat(e.change[0]-e.change[t]));var n=!1,s=!1;if(e.change[0]-e.change[t]>1.5&&e.change[0]-e.change[3]>.5&&(console.info("T0LongImpulseProcessor analyseOfBuy rise breakthrough",e.time[0],e.change[0],e.change[3],"+".concat(e.change[0]-e.change[3])),n=!0),e.change[0]-e.change[3]>.8&&(console.info("T0LongImpulseProcessor analyseOfBuy impulse breakthrough",e.time[0],e.change[0],e.change[3],"+".concat(e.change[0]-e.change[3])),s=!0),!n&&!s)return;if(!(e.price[0]>e.price[1]&&e.price[0]>e.ma5[0]&&e.ma5[0]>e.ma5[1]&&e.ma5[1]>e.ma5[2]&&e.ma5[2]>e.ma5[3]&&e.ma5[3]>e.ma5[4]))return;return!0}catch(e){console.warn("T0LongImpulseProcessor analyseOfBuy ",e)}},analyseOfSell:Ee};function We(e,t){var r=t.change;try{var a={change:e.change[0],price:e.price[0]};if(a.change>We.high&&(We.high=a.change),r-a.change>.3)return console.info("T0LongPlatformProcessor analyseOfSell stoploss",e.time[0],r,a.change),a;if(a.change-r>0&&We.high-a.change>=2)return console.info("T0LongPlatformProcessor analyseOfSell drawdown",e.time[0],We.high,a.change,2),a;if(e.ma5[0]<=e.ma20[0])return console.info("T0LongPlatformProcessor analyseOfSell ma5&ma20 cross",e.time[0],e.ma5[0],e.ma10[0],e.ma20[0]),a;if(e.ma10[0]<=e.ma20[0])return console.info("T0LongPlatformProcessor analyseOfSell ma10&ma20 cross",e.time[0],e.ma5[0],e.ma10[0],e.ma20[0]),a;if(e.ma20[0]<=e.ma20[1])return console.info("T0LongPlatformProcessor analyseOfSell ma20 reverse",e.time[0],e.ma20[0],e.ma20[1]),a}catch(e){return console.warn("T0LongPlatformProcessor analyseOfSell ",e),!0}}var He={analyseOfBuy:function(e){try{if(e.change.length<100)return;if(!(e.ma5[0]>e.ma5[1]&&e.ma5[1]>e.ma5[2]&&e.ma5[2]>e.ma5[3]&&e.ma5[3]>e.ma5[4]))return;console.info("T0LongPlatformProcessor analyseOfBuy mas up",e.time[0],e.ma5[0],e.ma5[1],e.ma5[2],e.ma5[3],e.ma5[4]);var t=e.change.slice(5),r=ke(t,1,100),a=ye(t,1,100);if(!(r-a<1.5))return;if(console.info("T0LongPlatformProcessor analyseOfBuy platform amplitude",e.time[0],"max = "+r,"min = "+a,r-a),!(e.change[0]-r>.8))return;if(console.info("T0LongPlatformProcessor analyseOfBuy platform breakthrough",e.time[0],e.change[0]-r),!(e.change[0]-e.change[3]>.5))return;return console.info("T0LongPlatformProcessor analyseOfBuy speed breakthrough",e.time[0],e.change[0]-e.change[3]),We.high=e.change[0],!0}catch(e){console.warn("T0LongPlatformProcessor analyseOfBuy ",e)}},analyseOfSell:We};r(698),r(699),r(700);var qe={"long-impulse":Re,"long-platform":He},Ke=function(e){function t(){return Object(c.a)(this,t),Object(B.a)(this,Object(D.a)(t).apply(this,arguments))}var r;return Object(M.a)(t,e),Object(i.a)(t,[{key:"capture",value:(r=Object(s.a)(n.a.mark((function e(){var t,r,a,s,c,i,o,u,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,f.a.captureList(L.e.key);case 3:r=e.sent,a=!0,s=!1,c=void 0,e.prev=7,i=r[Symbol.iterator]();case 9:if(a=(o=i.next()).done){e.next=20;break}return u=o.value.code,l=d.a.stockOfBond(u),e.next=14,F.isValidStock(l,"");case 14:if(e.sent){e.next=16;break}return e.abrupt("continue",17);case 16:t.push(u);case 17:a=!0,e.next=9;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(7),s=!0,c=e.t0;case 26:e.prev=26,e.prev=27,a||null==i.return||i.return();case 29:if(e.prev=29,!s){e.next=32;break}throw c;case 32:return e.finish(29);case 33:return e.finish(26);case 34:return e.abrupt("return",t);case 35:case"end":return e.stop()}}),e,null,[[7,22,26,34],[27,,29,33]])}))),function(){return r.apply(this,arguments)})}]),t}(we);Object(u.a)(Ke,"Processors",Ye),Object(u.a)(Ke,"Simulators",qe);var Ne=function(e){function t(){return Object(c.a)(this,t),Object(B.a)(this,Object(D.a)(t).apply(this,arguments))}var r,a,o;return Object(M.a)(t,e),Object(i.a)(t,[{key:"start",value:function(){return Object(W.a)(Object(D.a)(t.prototype),"start",this).call(this,3)}},{key:"monitor",value:(o=Object(s.a)(n.a.mark((function e(){var t,r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=this.sse.trends();case 2:e.t0=n.a.keys(t);case 4:if((e.t1=e.t0()).done){e.next=14;break}if(r=e.t1.value,!((a=this.sse.trend(r)).price[0]>a.ma5[0])){e.next=12;break}if(!(a.price[0]>=a.price[1]&&a.price[1]>=a.price[2]&&a.price[2]>=a.price[3])){e.next=10;break}return e.abrupt("return",this.sse.stock(r));case 10:if(!(a.change[0]-a.change[3]>=.2)){e.next=12;break}return e.abrupt("return",this.sse.stock(r));case 12:e.next=4;break;case 14:return e.next=16,Object(y.a)(1e3);case 16:e.next=2;break;case 18:e.next=23;break;case 20:e.prev=20,e.t2=e.catch(0),console.warn("T0LongImpulseProcessor monitor ",e.t2);case 23:case"end":return e.stop()}}),e,this,[[0,20]])}))),function(){return o.apply(this,arguments)})},{key:"analyseOfBuy",value:(a=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,u,l,h,p,f,v,d,b,m;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.code,e.prev=1,a=0;case 3:if(!(++a>6)){e.next=7;break}return e.abrupt("return");case 7:if(!(a>1)){e.next=10;break}return e.next=10,Object(y.a)(1e3);case 10:if(s=this.sse.stock(r),(c=this.sse.trend(r)).price[0]>c.ma5[0]&&c.change[0]>c.change[1]){e.next=14;break}return e.abrupt("return");case 14:if(i=c.ma5[0],o=c.ma10[0],u=c.ma20[0],l=xe(c.price,1,60),i>o&&o>u&&u>l){e.next=20;break}return e.abrupt("return");case 20:if(console.log("T0LongImpulseProcessor analyseOfBuy step-1 mas up ",c.time[0],"ma5 = "+i,"ma10 = "+o,"ma20 = "+u),h=xe(c.volume,1,5),p=xe(c.volume,1,10),f=xe(c.volume,1,20),h>p&&p>f){e.next=26;break}return e.abrupt("return");case 26:for(console.log("T0LongImpulseProcessor analyseOfBuy step-2 volmue up",c.time[0],"ma5 = "+h,"ma10 = "+p,"ma20 = "+f),v=0,d=0,b=[0,1,2,3,4,5,7,8,9];d<b.length;d++)m=b[d],c.ma10[m]>c.ma10[m+1]&&v++;if(v<8){e.next=31;break}return e.abrupt("return");case 31:if(console.log("T0LongImpulseProcessor analyseOfBuy step-3 ma boot",c.time[0],"ma10ContinueRiseTick = ",v),!(c.price[0]>=c.price[1]&&c.price[1]>=c.price[2]&&c.price[2]>=c.price[3])){e.next=35;break}return console.log("T0LongImpulseProcessor analyseOfBuy change rise",c.time[0],"price += ",c.price[0],c.price[1],c.price[2]),e.abrupt("return",s);case 35:if(!(c.change[0]-c.change[3]>=.2)){e.next=38;break}return console.log("T0LongImpulseProcessor analyseOfBuy change fire",c.time[0],"change += ",c.change[0]-c.change[3]),e.abrupt("return",s);case 38:e.next=3;break;case 40:e.next=45;break;case 42:e.prev=42,e.t0=e.catch(1),console.warn("T0LongImpulseProcessor analyseOfBuy ",e.t0);case 45:case"end":return e.stop()}}),e,this,[[1,42]])}))),function(e){return a.apply(this,arguments)})},{key:"analyseOfSell",value:(r=Object(s.a)(n.a.mark((function e(t){var r,a,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.code,e.prev=1;case 2:if(a=this.sse.stock(r),!((s=this.sse.trend(r)).price[0]<s.price[1]&&s.price[1]<s.price[2])){e.next=8;break}return console.log("T0LongImpulseProcessor analyseOfSell price down x2",s.time[0],s.price[0],s.price[1],s.price[2]),e.abrupt("return",a);case 8:if(!(s.ma5[1]>s.price[1])){e.next=11;break}return console.log("T0LongImpulseProcessor analyseOfSell ma down price < ma",s.time[0],s.ma5[1],s.price[1]),e.abrupt("return",a);case 11:return e.next=13,Object(y.a)(1e3);case 13:e.next=2;break;case 15:e.next=21;break;case 17:return e.prev=17,e.t0=e.catch(1),console.warn("T0LongImpulseProcessor analyseOfSell ",e.t0),e.abrupt("return",this.sse.stock(r));case 21:case"end":return e.stop()}}),e,this,[[1,17]])}))),function(e){return r.apply(this,arguments)})}]),t}(De),Ae=function(e){function t(){return Object(c.a)(this,t),Object(B.a)(this,Object(D.a)(t).apply(this,arguments))}var r,a,o;return Object(M.a)(t,e),Object(i.a)(t,[{key:"start",value:function(){return Object(W.a)(Object(D.a)(t.prototype),"start",this).call(this,15)}},{key:"monitor",value:(o=Object(s.a)(n.a.mark((function e(){var t,r,a,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=this.sse.trends();case 2:e.t0=n.a.keys(t);case 4:if((e.t1=e.t0()).done){e.next=12;break}if(r=e.t1.value,a=this.sse.stock(r),!((s=this.sse.trend(r)).change[0]-s.change[4]>=.4)){e.next=10;break}return e.abrupt("return",a);case 10:e.next=4;break;case 12:return e.next=14,Object(y.a)(3e4);case 14:e.next=2;break;case 16:e.next=21;break;case 18:e.prev=18,e.t2=e.catch(0),console.warn("T0LongPlatformProcessor monitor ",e.t2);case 21:case"end":return e.stop()}}),e,this,[[0,18]])}))),function(){return o.apply(this,arguments)})},{key:"analyseOfBuy",value:(a=Object(s.a)(n.a.mark((function e(t){var r,a,s,c,i,o,u,l,h,p,f;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.code,e.prev=1,(a=this.sse.trend(r)).price[0]>a.ma5[0]&&a.change[0]>a.change[1]){e.next=5;break}return e.abrupt("return");case 5:if(s=a.ma5[0],c=a.ma10[0],i=a.ma20[0],s>c&&c>i){e.next=10;break}return e.abrupt("return");case 10:if(console.log("T0LongPlatformProcessor analyseOfBuy step-1 mas up ",a.time[0],"ma5 = "+s,"ma10 = "+c,"ma20 = "+i),o=xe(a.volume,1,5),u=xe(a.volume,1,10),l=xe(a.volume,1,20),o>u&&u>l){e.next=16;break}return e.abrupt("return");case 16:if(console.log("T0LongPlatformProcessor analyseOfBuy step-2 volmue up",a.time[0],"ma5 = "+o,"ma10 = "+u,"ma20 = "+l),h=a.change.slice(3),p=ke(h,1,20),f=ye(h,1,20),console.log("T0LongPlatformProcessor analyseOfBuy step-3 platform max & min",a.time[0],"max = "+p,"min = "+f),p-f<2){e.next=23;break}return e.abrupt("return");case 23:if(console.log("T0LongPlatformProcessor analyseOfBuy step-3 platform amplitude",a.time[0],p-f),a.change[0]-p>=.4){e.next=26;break}return e.abrupt("return");case 26:if(console.log("T0LongPlatformProcessor analyseOfBuy step-4 platform reakthrough ",a.time[0],a.change[0]-p),a.price[0]>a.price[1]&&a.price[1]>a.price[2]){e.next=29;break}return e.abrupt("return");case 29:return console.log("T0LongPlatformProcessor analyseOfBuy step-5 ma up",a.time[0],a.ma5[0],a.ma5[1],a.ma5[2]),e.abrupt("return",this.sse.stock(r));case 33:e.prev=33,e.t0=e.catch(1),console.warn("T0LongPlatformProcessor analyseOfBuy ",e.t0);case 36:case"end":return e.stop()}}),e,this,[[1,33]])}))),function(e){return a.apply(this,arguments)})},{key:"analyseOfSell",value:(r=Object(s.a)(n.a.mark((function e(t){var r,a,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.code,e.prev=1;case 2:if(a=this.sse.stock(r),!((s=this.sse.trend(r)).ma5[0]<=s.ma10[0])){e.next=8;break}return console.log("T0LongPlatformProcessor analyseOfSell ma down ma5 <= ma10",s.time[0],s.ma5[0],s.ma10[0]),e.abrupt("return",a);case 8:return e.next=10,Object(y.a)(1e3);case 10:e.next=2;break;case 12:e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(1),console.warn("T0LongPlatformProcessor analyseOfSell ",e.t0),e.abrupt("return",this.sse.stock(r));case 18:case"end":return e.stop()}}),e,this,[[1,14]])}))),function(e){return r.apply(this,arguments)})}]),t}(De),ze=r(701),Ge=r.n(ze),Ve=r(702),Ue=r.n(Ve),Ze=(r(703),{"long-impulse":Ne,"long-platform":Ae,"short-impulse":Ge.a,"short-platform":Ue.a});var Je={analyseOfBuy:function(e){try{if(!(e.price[0]>e.ma5[0]&&e.change[0]>e.change[1]))return;var t=e.ma5[0],r=e.ma10[0],a=e.ma20[0],n=xe(e.price,1,60);if(!(t>r&&r>a&&a>n))return;console.info("T0LongImpulseProcessor analyseOfBuy step-1 mas up ",e.time[0],"ma5 = "+t,"ma10 = "+r,"ma20 = "+a);var s=xe(e.volume,1,5),c=xe(e.volume,1,10),i=xe(e.volume,1,20);if(!(s>c&&c>i))return;console.info("T0LongImpulseProcessor analyseOfBuy step-2 volmue up",e.time[0],"ma5 = "+s,"ma10 = "+c,"ma20 = "+i);for(var o=0,u=0,l=[0,1,2,3,4,5,7,8,9];u<l.length;u++){var h=l[u];e.ma10[h]>e.ma10[h+1]&&o++}if(!(o<8))return;if(console.info("T0LongImpulseProcessor analyseOfBuy step-3 ma boot",e.time[0],"ma10ContinueRiseTick = ",o),e.price[0]>=e.price[1]&&e.price[1]>=e.price[2]&&e.price[2]>=e.price[3])return console.info("T0LongImpulseProcessor analyseOfBuy step-4 continue rise",e.time[0],"price += ",e.price[0],e.price[1],e.price[2]),!0;if(e.change[0]-e.change[3]>=.2)return console.info("T0LongImpulseProcessor analyseOfBuy step-5 change fire",e.time[0],"change += ",e.change[0]-e.change[3]),!0}catch(e){console.warn("T0LongImpulseProcessor analyseOfBuy ",e)}},analyseOfSell:function(e){try{if(e.price[0]<e.price[1]&&e.price[1]<e.price[2])return console.info("T0LongImpulseProcessor analyseOfSell price down x2",e.time[0],e.price[0],e.price[1],e.price[2]),!0;if(e.ma5[1]>e.price[1])return console.info("T0LongImpulseProcessor analyseOfSell ma down price < ma",e.time[0],e.ma5[1],e.price[1]),!0}catch(e){console.warn("T0LongImpulseProcessor analyseOfSell ",e)}}};var Qe={analyseOfBuy:function(e){try{if(!(e.price[0]>e.ma5[0]&&e.change[0]>e.change[1]))return;var t=e.ma5[0],r=e.ma10[0],a=e.ma20[0];if(!(t>r&&r>a))return;console.info("T0LongPlatformProcessor analyseOfBuy step-1 mas up ",e.time[0],"ma5 = "+t,"ma10 = "+r,"ma20 = "+a);var n=xe(e.volume,1,5),s=xe(e.volume,1,10),c=xe(e.volume,1,20);if(!(n>s&&s>c))return;console.info("T0LongPlatformProcessor analyseOfBuy step-2 volmue up",e.time[0],"ma5 = "+n,"ma10 = "+s,"ma20 = "+c);var i=e.change.slice(3),o=ke(i,1,20),u=ye(i,1,20);if(console.info("T0LongPlatformProcessor analyseOfBuy step-3 platform max & min",e.time[0],"max = "+o,"min = "+u),!(o-u<2))return;if(console.info("T0LongPlatformProcessor analyseOfBuy step-3 platform amplitude",e.time[0],o-u),!(e.change[0]-o>=.4))return;if(console.info("T0LongPlatformProcessor analyseOfBuy step-4 platform reakthrough ",e.time[0],e.change[0]-o),!(e.price[0]>e.price[1]&&e.price[1]>e.price[2]))return;return console.info("T0LongPlatformProcessor analyseOfBuy step-5 ma up",e.time[0],e.ma5[0],e.ma5[1],e.ma5[2]),!0}catch(e){console.warn("T0LongPlatformProcessor analyseOfBuy ",e)}},analyseOfSell:function(e){try{if(e.ma5[0]<=e.ma10[0])return console.info("T0LongPlatformProcessor analyseOfSell ma down ma5 <= ma10",e.time[0],e.ma5[0],e.ma10[0]),!0}catch(e){console.warn("T0LongPlatformProcessor analyseOfSell ",e)}}};var $e=r(704),Xe=r.n($e),et=r(705),tt=r.n(et),rt=(r(706),{"long-impulse":Je,"long-platform":Qe,"short-impulse":Xe.a,"short-platform":tt.a}),at=function(e){function t(){return Object(c.a)(this,t),Object(B.a)(this,Object(D.a)(t).apply(this,arguments))}var r;return Object(M.a)(t,e),Object(i.a)(t,[{key:"capture",value:(r=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})}]),t}(we);Object(u.a)(at,"Processors",Ze),Object(u.a)(at,"Simulators",rt);var nt=new(function(){function e(){Object(c.a)(this,e),Object(u.a)(this,"Controllers",{bond:Ke,future:at})}return Object(i.a)(e,[{key:"processor",value:function(e,t,r){return new(0,this.Controllers[e])(this.Controllers[e].Processors[t],e,t,r)}},{key:"simulator",value:function(e,t,r,a,n){var s=this.Controllers[e].Simulators[t];return new ge(s,r,a,n)}},{key:"processors",value:function(e){return this.Controllers[e].Processors}},{key:"simulators",value:function(e){return this.Controllers[e].Simulators}}]),e}());window.__Walle_Stock_Loop=ie,window.__Walle_Stock_Controller=Q,window.__Walle_Stock_Pool=m.a,window.__Walle_Stock_Bond=A,window.__Walle_Stock_Flow=S,window.__Walle_Stock_Gene=P,window.__Walle_Stock_Crawler=f.a,window.__Walle_Stock_Trader=pe,window.__Walle_Stock_Strategy=ve.a,window.__Walle_Stock_Define=L.lb,window.__Walle_Stock_Market=X,window.__Walle_Stock_Whitelist=d.a,window.__Walle_Stock_Cron=b.a,window.__Walle_Stock_Validator=F,window.__Walle_Stock_T0=nt}}]);