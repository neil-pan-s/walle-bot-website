(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{315:function(e,t,n){n(250);e.exports={init:function(){},process:function(e,t,n,r){var a=0;return n<-10?(a=n,e.day["open-crash"]++,e.profit["open-crash"]+=a,e.profit["open-crash"]=+e.profit["open-crash"].toFixed(2),r>0&&(e.day["reverse-crash"]++,e.profit["reverse-crash"]+=r+10,e.profit["reverse-crash"]=+e.profit["reverse-crash"].toFixed(2))):r<-10?(a=-10,e.day["stop-crash"]++,e.profit["stop-crash"]+=r+10,e.profit["stop-crash"]=+e.profit["stop-crash"].toFixed(2)):a=r,a},getPTCChange:function(e,t){return e<-10?e:t<-10?-10:t}}},321:function(e,t,n){var r=n(9),a=n(336).values;r({target:"Object",stat:!0},{values:function(e){return a(e)}})},336:function(e,t,n){var r=n(19),a=n(64),s=n(21),i=n(88).f,c=function(e){return function(t){for(var n,c=s(t),o=a(c),u=o.length,l=0,h=[];u>l;)n=o[l++],r&&!i.call(c,n)||h.push(e?[n,c[n]]:c[n]);return h}};e.exports={entries:c(!0),values:c(!1)}},401:function(e,t){var n={};e.exports={process:function(e,t,r){window?function(e,t,r){for(var a in n={},e){var s=e[a],i=+a+1+"";e[i]?r[a]>0&&r[i]>0?n[s]="+":r[a]<0&&r[i]<0?n[s]="-":n[s]="~":n[s]="~"}}(e,0,r):function(e,t,r){for(var a in n={},e){var s=e[a],i=+a+1+"",c=+a+2+"";e[i]&&e[c]?r[i]>0&&r[c]>0?n[s]="+":r[i]<0&&r[c]<0?n[s]="-":n[s]="~":n[s]="~"}}(e,0,r)},trend:function(e){return n[e]||"~"}}},499:function(e,t,n){"use strict";var r=n(9),a=n(89).filter,s=n(90),i=n(43),c=s("filter"),o=i("filter");r({target:"Array",proto:!0,forced:!c||!o},{filter:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},665:function(e,t,n){"use strict";var r=n(94),a=n(16),s=n(24),i=n(22),c=n(95),o=n(96);r("match",1,(function(e,t,n){return[function(t){var n=i(this),r=null==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;var i=a(e),u=String(this);if(!i.global)return o(i,u);var l=i.unicode;i.lastIndex=0;for(var h,p=[],f=0;null!==(h=o(i,u));){var v=String(h[0]);p[f]=v,""===v&&(i.lastIndex=c(u,s(i.lastIndex),l)),f++}return 0===f?null:p}]}))},666:function(e,t,n){"use strict";var r=n(30),a=n(16),s=n(7),i=n(259),c=RegExp.prototype,o=c.toString,u=s((function(){return"/a/b"!=o.call({source:"a",flags:"b"})})),l="toString"!=o.name;(u||l)&&r(RegExp.prototype,"toString",(function(){var e=a(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in c)?i.call(e):n)}),{unsafe:!0})},667:function(e,t,n){(function(n){var r,a,s;a=[],void 0===(s="function"==typeof(r=function(){"use strict";function t(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){i(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,i=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype?function(e,n,i){var c=s.URL||s.webkitURL,o=document.createElement("a");n=n||e.name||"download",o.download=n,o.rel="noopener","string"==typeof e?(o.href=e,o.origin===location.origin?a(o):r(o.href)?t(e,n,i):a(o,o.target="_blank")):(o.href=c.createObjectURL(e),setTimeout((function(){c.revokeObjectURL(o.href)}),4e4),setTimeout((function(){a(o)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,s){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,s),n);else if(r(e))t(e,n,s);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){a(i)}))}}:function(e,n,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,r);var i="application/octet-stream"===e.type,c=/constructor/i.test(s.HTMLElement)||s.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&c)&&"object"==typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=o?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},u.readAsDataURL(e)}else{var l=s.URL||s.webkitURL,h=l.createObjectURL(e);a?a.location=h:location.href=h,a=null,setTimeout((function(){l.revokeObjectURL(h)}),4e4)}});s.saveAs=i.saveAs=i,e.exports=i})?r.apply(t,a):r)||(e.exports=s)}).call(this,n(36))},668:function(e,t,n){n(57),n(58),n(59),n(40),n(23),n(41),n(39),n(33);var r=n(1);n(20);var a=n(669),s=n(670).generate,i=n(401),c=[n(671),n(315),n(672),n(673),n(674),n(675),n(676)];function o(){return(o=a(r.mark((function e(t,n){var a,o,u,l,h,p,f,v,d,b,k,g,x,w,y,m,O,j,C;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=s(t),e.prev=1,n){e.next=4;break}return e.abrupt("return",a);case 4:for(o=n.date,u=n.open,l=n.close,t.includes("上证指数")&&i.process(o,u,l),h=!0,p=!1,f=void 0,e.prev=11,v=c[Symbol.iterator]();!(h=(d=v.next()).done);h=!0)d.value.init();e.next=19;break;case 15:e.prev=15,e.t0=e.catch(11),p=!0,f=e.t0;case 19:e.prev=19,e.prev=20,h||null==v.return||v.return();case 22:if(e.prev=22,!p){e.next=25;break}throw f;case 25:return e.finish(22);case 26:return e.finish(19);case 27:b=o.length,k=0;case 29:if(!(k<b)){e.next=55;break}for(g=o[k],x=u[k],w=l[k],y=!0,m=!1,O=void 0,e.prev=36,j=c[Symbol.iterator]();!(y=(C=j.next()).done);y=!0)C.value.process(a,g,x,w);e.next=44;break;case 40:e.prev=40,e.t1=e.catch(36),m=!0,O=e.t1;case 44:e.prev=44,e.prev=45,y||null==j.return||j.return();case 47:if(e.prev=47,!m){e.next=50;break}throw O;case 50:return e.finish(47);case 51:return e.finish(44);case 52:k++,e.next=29;break;case 55:e.next=60;break;case 57:e.prev=57,e.t2=e.catch(1),console.log("#strategy# analyse fail: ",e.t2);case 60:return e.abrupt("return",a);case 61:case"end":return e.stop()}}),e,null,[[1,57],[11,15,19,27],[20,,22,26],[36,40,44,52],[45,,47,51]])})))).apply(this,arguments)}e.exports={analyse:function(e,t){return o.apply(this,arguments)}}},669:function(e,t){function n(e,t,n,r,a,s,i){try{var c=e[s](i),o=c.value}catch(e){return void n(e)}c.done?t(o):Promise.resolve(o).then(r,a)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(a,s){var i=e.apply(t,r);function c(e){n(i,a,s,c,o,"next",e)}function o(e){n(i,a,s,c,o,"throw",e)}c(void 0)}))}}},670:function(e,t){e.exports={generate:function(e){return{name:e,profit:{max:0,"open-crash":-0,"stop-crash":0,"reverse-crash":0,normal:0,strategy:0,compound:0,hot:0,"up-trade":0,"down-trade":0},day:{normal:0,up:0,down:0,"open-crash":0,"stop-crash":0,"reverse-crash":0,trade:0,rest:0,compound:0,hot:0,"up-trade":0,"down-trade":0},profitrate:{normal:0,strategy:0,compound:0,hot:0,"up-trade":0,"down-trade":0},winrate:{normal:0,strategy:0,compound:0,hot:0,"up-trade":0,"down-trade":0},"daily-open-profit":[],"daily-close-profit":[],"daily-open-ptcchange":[],"daily-close-ptcchange":[]}}}},671:function(e,t,n){n(250),e.exports={init:function(){},process:function(e,t,n,r){r>=0?(e.day.up++,e.profit.max+=r,e.profit.max=+e.profit.max.toFixed(2)):e.day.down++,e.day.normal++,e.profit.normal+=r,e.profit.normal=+e.profit.normal.toFixed(2),e.profitrate.normal=+(e.profit.normal/e.day.normal).toFixed(2),e.winrate.normal=+(e.day.up/e.day.normal*100).toFixed(2),e["daily-open-ptcchange"].push(t,n),e["daily-close-ptcchange"].push(t,r);var a=e["daily-open-profit"].length,s=e["daily-close-profit"].length,i=e["daily-open-profit"][a-1]||0,c=e["daily-close-profit"][s-1]||0;c+=r,i=+(i+=n).toFixed(2),c=+c.toFixed(2),e["daily-open-profit"].push(t,i),e["daily-close-profit"].push(t,c)}}},672:function(e,t,n){n(250);var r=n(315),a=0,s=0,i=!1,c={};e.exports={isPeriodRest:function(e){return i},process:function(e,t,n,o){var u=r.getPTCChange(n,o);s<2?(i=!1,e.day.trade++,e.profit.strategy+=u,e.profit.strategy=+e.profit.strategy.toFixed(2),e.profitrate.strategy=+(e.profit.strategy/e.day.trade).toFixed(2),u>0?a++:0,e.winrate.strategy=+(a/e.day.trade*100).toFixed(2)):(i=!0,e.day.rest++),window?function(e,t,n,a){(c.date?r.getPTCChange(c.open,c.close):r.getPTCChange(n,a))>=0?(s=0):(0,s++),c={date:t,open:n,close:a}}(0,t,n,o):function(e,t,n,a){r.getPTCChange(n,a)>=0?(s=0):(0,s++)}(0,0,n,o)},init:function(){a=0,0,0,s=0,i=!1,c={}}}},673:function(e,t,n){n(250);var r=n(315),a=1,s=0;e.exports={process:function(e,t,n,i){var c=r.getPTCChange(n,i);a*=1+c/100*.1,e.profit.compound=1e3*(a-1),e.profit.compound=+e.profit.compound.toFixed(2),e.day.compound++,e.profitrate.compound=+(e.profit.compound/e.day.compound).toFixed(2),c>0?s++:0,e.winrate.compound=+(s/e.day.compound*100).toFixed(2)},init:function(){s=0,0,a=1}}},674:function(e,t,n){n(250);var r=n(315),a=0,s=0,i={};e.exports={process:function(e,t,n,c){var o=r.getPTCChange(n,c);s>=2&&(e.day.hot++,e.profit.hot=+(e.profit.hot+o).toFixed(2),e.profitrate.hot=+(e.profit.hot/e.day.hot).toFixed(2),o>0?a++:0,e.winrate.hot=+(a/e.day.hot*100).toFixed(2)),window?function(e,t,n,a){(i.date?r.getPTCChange(i.open,i.close):r.getPTCChange(n,a))>=20?s++:s=0,i={date:t,open:n,close:a}}(0,t,n,c):function(e,t,n,a){r.getPTCChange(n,a)>=20?s++:s=0}(0,0,n,c)},init:function(){a=0,0,s=0,i={}}}},675:function(e,t,n){n(250);var r=n(315),a=n(401),s=0;e.exports={process:function(e,t,n,i){var c=r.getPTCChange(n,i);"+"===a.trend(t)&&(e.day["up-trade"]++,e.profit["up-trade"]=+(e.profit["up-trade"]+c).toFixed(2),e.profitrate["up-trade"]=+(e.profit["up-trade"]/e.day["up-trade"]).toFixed(2),c>0?s++:0,e.winrate["up-trade"]=+(s/e.day["up-trade"]*100).toFixed(2))},init:function(){s=0,0}}},676:function(e,t,n){n(250);var r=n(315),a=n(401),s=0;e.exports={process:function(e,t,n,i){var c=r.getPTCChange(n,i);"-"===a.trend(t)&&(e.day["down-trade"]++,e.profit["down-trade"]=+(e.profit["down-trade"]+c).toFixed(2),e.profitrate["down-trade"]=+(e.profit["down-trade"]/e.day["down-trade"]).toFixed(2),c>0?s++:0,e.winrate["down-trade"]=+(s/e.day["down-trade"]*100).toFixed(2))},init:function(){s=0,0}}},697:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),s=(n(20),n(3)),i=n(5),c=n(6),o=(n(57),n(58),n(59),n(27),n(34),n(23),n(39),n(33),n(2));function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=function e(t){var n=t.capture,r=t.trace,a=t.interval,s=t.lists,c=t.date,u=t.name;Object(i.a)(this,e),Object(o.a)(this,"capture",void 0),Object(o.a)(this,"trace",[]),Object(o.a)(this,"interval",void 0),Object(o.a)(this,"lists",void 0),Object(o.a)(this,"date",void 0),Object(o.a)(this,"name",void 0),this.capture=n,this.trace=r,this.interval=a,this.lists=s,this.name=u,this.date=c},p=(n(40),n(82),n(28),n(41),n(665),n(253),n(322)),f=(n(85),n(62),n(252),n(250),n(666),n(63),n(86),n(48)),v=n(301),d=n(442),b=(n(87),n(321),n(251),n(313)),k=n(302),g=n(309),x=n(498),w=n(317),y=n(0),m=n.n(y),O=n(11),j=n.n(O),C=j.a.createInstance({name:"flow",driver:j.a.INDEXEDDB}),F=new(function(){function e(){var t=this;Object(i.a)(this,e),Object(o.a)(this,"flows",{}),Object(o.a)(this,"continueOfFlows",{}),Object(o.a)(this,"topOfFlows",{rate:[],change:[],limitup:[]}),Object(o.a)(this,"lastFlowDate","");var n=(parent.location.hash||location.hash).includes("9529");setTimeout(Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=6;break}return console.info("#Flows# force download start ..."),e.next=4,t.downlFlows;case 4:return console.info("#Flows# force download end ..."),e.abrupt("return");case 6:return e.next=8,t.load();case 8:return e.next=10,t.calcContinue();case 10:return e.next=12,t.calcTop();case 12:return e.next=14,t.update();case 14:case"end":return e.stop()}}),e)}))))}var t,n,r,u,l,h,p,f,d,y;return Object(c.a)(e,[{key:"load",value:(y=Object(s.a)(a.a.mark((function e(){var t,n=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.length();case 3:if(t=e.sent){e.next=7;break}return console.log("#Flows# flows not exist!"),e.abrupt("return");case 7:return e.next=9,C.iterate((function(e,t){e&&(n.flows[t]=e)}));case 9:this.lastFlowDate=this.flows[1.000001][0].date,console.info("#Flows# load flows ".concat(t," date ").concat(this.lastFlowDate," ...")),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.warn("#Flows# load flows fail ",e.t0);case 16:case"end":return e.stop()}}),e,this,[[0,13]])}))),function(){return y.apply(this,arguments)})},{key:"save",value:(d=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t in this.flows)C.setItem(t,this.flows[t]);case 1:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"download",value:(f=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=b.a.stocks(),t=[].concat(t,"1.000001"),console.time("Flows Download"),n=!0,r=!1,s=void 0,e.prev=7,i=t[Symbol.iterator]();case 9:if(n=(c=i.next()).done){e.next=19;break}return o=c.value,e.next=13,v.a.captureFlows(o);case 13:return this.flows[o]=e.sent,e.next=16,Object(w.a)(50);case 16:n=!0,e.next=9;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(7),r=!0,s=e.t0;case 25:e.prev=25,e.prev=26,n||null==i.return||i.return();case 28:if(e.prev=28,!r){e.next=31;break}throw s;case 31:return e.finish(28);case 32:return e.finish(25);case 33:console.timeEnd("Flows Download"),this.save(),e.next=40;break;case 37:e.prev=37,e.t1=e.catch(0),console.warn("#Flows# download flows fail ",e.t1);case 40:case"end":return e.stop()}}),e,this,[[0,37],[7,21,25,33],[26,,28,32]])}))),function(){return f.apply(this,arguments)})},{key:"update",value:(p=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,c,o,u,l,h,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.length();case 2:if(e.sent){e.next=6;break}return console.log("#Flows# flows not exist, update exit !"),e.abrupt("return");case 6:if(k.a.isWeekend()){e.next=32;break}return e.next=9,k.a.until("150000");case 9:console.info("#Flows# auto update daily ..."),t=g.a.stocks(),n=m()().format("YYYYMMDD"),e.t0=a.a.keys(t);case 13:if((e.t1=e.t0()).done){e.next=31;break}if(r=e.t1.value,e.prev=15,s=t[r],i=s.name,c=s.price,o=s.change,u=s.netinflow,l=s.rate,!((h=this.flows[r][0])&&+h.date>=+n)){e.next=20;break}return e.abrupt("continue",13);case 20:if(h.price!==c||h.rate!==l||h.netinflow!==u){e.next=22;break}return e.abrupt("continue",13);case 22:p=new x.a({code:r,name:i,date:n,price:c,change:o,netinflow:u,netinflowrate:l}),this.flows[r].unshift(p),this.flows[r].length>200&&(this.flows[r]=this.flows[r].slice(0,200)),e.next=29;break;case 27:e.prev=27,e.t2=e.catch(15);case 29:e.next=13;break;case 31:this.save();case 32:case"end":return e.stop()}}),e,this,[[15,27]])}))),function(){return p.apply(this,arguments)})},{key:"downloadDaily",value:(h=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=m()().format("YYYYMMDD"),n=m()().format("HHmmss"),r=m()().subtract(1,"day").format("YYYYMMDD"),1==+m()().day()&&(r=m()().subtract(3,"days").format("YYYYMMDD")),!(t===this.lastFlowDate||r<=this.lastFlowDate)){e.next=6;break}return e.abrupt("return");case 6:if(!(+n>=15e4)){e.next=8;break}return e.abrupt("return");case 8:if(k.a.isWeekend()){e.next=17;break}return s=Math.floor(58*Math.random())+1,i="00".concat(s).slice(-2),c="07"+i+"00",console.info("#Flows# auto download daily at ".concat(c," ...")),e.next=15,k.a.until(c);case 15:return e.next=17,this.download();case 17:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"has",value:function(e){return!!this.flows[e]&&this.flows[e]}},{key:"flow",value:(l=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.has(t)){e.next=2;break}return e.abrupt("return",this.capture(t));case 2:return e.abrupt("return",this.flows[t]);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"capture",value:(u=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.flows[t]=v.a.captureFlows(t),e.abrupt("return",this.flows[t]);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"calcContinue",value:(r=Object(s.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=a.a.keys(this.flows);case 1:if((e.t1=e.t0()).done){e.next=12;break}return t=e.t1.value,n=this.flows[t],r=n[0]?n[0].name:"",e.next=7,L.isValidStock(t,r);case 7:if(e.sent){e.next=9;break}return e.abrupt("continue",1);case 9:this.calcContinueCore(t,r,n),e.next=1;break;case 12:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"calcContinueCore",value:function(e,t,n){this.continueOfFlows[e]={code:e,name:t,rate:0,change:0,limitup:0};var r=!0,a=!1,s=void 0;try{for(var i,c=n[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var o=i.value;o.change;if(!(o.rate>0))break;this.continueOfFlows[e].rate+=1}}catch(e){a=!0,s=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw s}}var u=!0,l=!1,h=void 0;try{for(var p,f=n[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var v=p.value,d=v.change;v.rate;if(!(d>0))break;this.continueOfFlows[e].change+=1}}catch(e){l=!0,h=e}finally{try{u||null==f.return||f.return()}finally{if(l)throw h}}var b=!0,k=!1,g=void 0;try{for(var x,w=n[Symbol.iterator]();!(b=(x=w.next()).done);b=!0){var y=x.value,m=y.change;y.rate;if(!(m>=9.8))break;this.continueOfFlows[e].limitup+=1}}catch(e){k=!0,g=e}finally{try{b||null==w.return||w.return()}finally{if(k)throw g}}}},{key:"calcTop",value:(n=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.calcTopCore("rate"),this.calcTopCore("change"),this.calcTopCore("limitup");case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"calcTopCore",value:function(e){var t=Object.values(this.continueOfFlows).sort((function(t,n){return n[e]-t[e]}));this.topOfFlows[e]=t,console.info("#Flow# top continue ".concat(e," stocks ...")),console.table(this.topOfFlows[e].slice(0,20))}},{key:"top",value:function(e){return this.topOfFlows[e]}},{key:"continue",value:(t=Object(s.a)(a.a.mark((function e(t,n){var r,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.continueOfFlows[t]){e.next=3;break}return e.abrupt("return",this.continueOfFlows[t][n]);case 3:return e.next=5,this.flow(t);case 5:return r=e.sent,s=r[0]?r[0].name:"",this.calcContinueCore(t,s,r),e.abrupt("return",this.continueOfFlows[t][n]);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e,n){return t.apply(this,arguments)})}]),e}()),S=function(){function e(t,n,r,a,s){Object(i.a)(this,e),Object(o.a)(this,"$valid",{rateRatio:.6,averageChange2:.2,bigChange:6}),Object(o.a)(this,"range",{change:[null,null],price:[null,null],rate:[null,null],amount:[null,null]}),Object(o.a)(this,"day",{rise:0,down:0,bigRise:0,bigDown:0}),Object(o.a)(this,"fundamental",{eps:0,bvps:0,roe:0}),Object(o.a)(this,"index",{days:0,daysRatio:0,changeUpRatio:0,changeDownRatio:0}),Object(o.a)(this,"ratio",{mainRatio:0,abnormalRatio:0,lockRatio:0,onePercentRate:0,onePercentAmount:0}),Object(o.a)(this,"longterm",{days:0,averagePrice:0,change:0,rate:0,amount:0}),Object(o.a)(this,"shortterm",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(o.a)(this,"limitup",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(o.a)(this,"riseup",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(o.a)(this,"rateup",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(o.a)(this,"code",void 0),Object(o.a)(this,"name",void 0),Object(o.a)(this,"stock",void 0),Object(o.a)(this,"vtype",void 0),Object(o.a)(this,"validator",void 0),Object(o.a)(this,"flow",[]),Object(o.a)(this,"gene",{}),this.code=t,this.stock=n,this.flow=r,this.vtype=s;var c=!0,u=!1,l=void 0;try{for(var h,p=d.a.validators[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var f=h.value;if(f.name===s){this.validator=new L(f);break}}}catch(e){u=!0,l=e}finally{try{c||null==p.return||p.return()}finally{if(u)throw l}}Object.assign(this,a),n&&(this.name=n.name)}var t,n,r,u;return Object(c.a)(e,[{key:"toMoney",value:function(e){return e=Math.abs(+e)>=1e8?(+e/1e8).toFixed(2)+"亿":(+e/1e4).toFixed(2)+"万"}},{key:"analyse",value:(u=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.flow||!this.flow.length){e.next=25;break}return e.next=4,this.calcFundamental();case 4:return e.next=6,this.calcDays();case 6:return e.next=8,this.calcRange();case 8:return e.next=10,this.calcLimitup();case 10:return e.next=12,this.calcRiseup();case 12:return e.next=14,this.calcRateup();case 14:return e.next=16,this.calcLongterm();case 16:return e.next=18,this.calcShortterm();case 18:return e.next=20,this.calcRatio();case 20:if("1.000001"===this.code){e.next=23;break}return e.next=23,this.calcIndex();case 23:return e.next=25,this.calcGene();case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(0),console.warn("#Gene# analyse fail ",this.code,e.t0);case 30:return e.abrupt("return",this);case 31:case"end":return e.stop()}}),e,this,[[0,27]])}))),function(){return u.apply(this,arguments)})},{key:"calcRange",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.flow[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value,i=s.price,c=s.change,o=s.rate,u=s.netinflow;null===this.range.price[0]&&(this.range.price[0]=i),null===this.range.price[1]&&(this.range.price[1]=i),i<this.range.price[0]&&(this.range.price[0]=i),i>this.range.price[1]&&(this.range.price[1]=i),null===this.range.change[0]&&(this.range.change[0]=c),null===this.range.change[1]&&(this.range.change[1]=c),c<this.range.change[0]&&(this.range.change[0]=c),c>this.range.change[1]&&(this.range.change[1]=c),null===this.range.amount[0]&&(this.range.amount[0]=u),null===this.range.amount[1]&&(this.range.amount[1]=u),u<this.range.amount[0]&&(this.range.amount[0]=u),u>this.range.amount[1]&&(this.range.amount[1]=u),null===this.range.rate[0]&&(this.range.rate[0]=o),null===this.range.rate[1]&&(this.range.rate[1]=o),o<this.range.rate[0]&&(this.range.rate[0]=o),o>this.range.rate[1]&&(this.range.rate[1]=o)}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}this.range.price[0]=+this.range.price[0].toFixed(2),this.range.price[1]=+this.range.price[1].toFixed(2),this.range.change[0]=+this.range.change[0].toFixed(2),this.range.change[1]=+this.range.change[1].toFixed(2),this.range.amount[0]=+this.range.amount[0].toFixed(2),this.range.amount[1]=+this.range.amount[1].toFixed(2),this.range.rate[0]=+this.range.rate[0].toFixed(2),this.range.rate[1]=+this.range.rate[1].toFixed(2)}},{key:"calcDays",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.flow[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value.change;s>=0?this.day.rise++:this.day.down++,s>=this.$valid.bigChange&&this.day.bigRise++,s<=-this.$valid.bigChange&&this.day.bigDown++}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}},{key:"calcIndex",value:(r=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=0,n=0,r=0,s=0,i=0,e.next=3,D.gene("1.000001",this.vtype);case 3:c=e.sent,o=c.flow,this.flow.forEach((function(e,a){var c=o[a];c&&e.date===c.date&&(e.change>0&&c.change>0&&(t++,n+=e.change,s+=c.change),e.change<0&&c.change<0&&(t++,r+=e.change,i+=c.change))})),this.index.days=t,this.index.daysRatio=+(t/this.flow.length).toFixed(2),this.index.changeUpRatio=+(n/s).toFixed(2),this.index.changeDownRatio=-(r/i).toFixed(2);case 10:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"calcFundamental",value:function(){this.fundamental.eps=+this.stock.eps.toFixed(2),this.fundamental.bvps=+this.stock.bvps.toFixed(2),this.fundamental.roe=+this.stock.roe.toFixed(2)}},{key:"calcLongterm",value:function(){var e=0,t=!0,n=!1,r=void 0;try{for(var a,s=this.flow[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var i=a.value,c=i.price,o=i.change,u=i.rate,l=i.netinflow;this.longterm.change+=o,this.longterm.rate+=u,this.longterm.amount+=l,this.longterm.days++,e+=c}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}this.longterm.averagePrice=+(e/this.flow.length).toFixed(2),this.longterm.change=+this.longterm.change.toFixed(2),this.longterm.rate=+this.longterm.rate.toFixed(2),this.longterm.amount=+this.longterm.amount.toFixed(2)}},{key:"calcShorttermFun",value:(n=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,c,o,u,l,h,p,f,v,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0,s=0,i=0,c=0,e.t0=a.a.keys(this.flow);case 2:if((e.t1=e.t0()).done){e.next=16;break}return o=e.t1.value,u=this.flow[o],l=u.code,h=u.name,p=u.price,f=u.change,v=u.rate,e.next=7,n({code:l,name:h,price:p,change:f,rate:v});case 7:if(e.sent){e.next=9;break}return e.abrupt("continue",2);case 9:r++,i+=f,s+=v,(d=this.flow[+o+1])&&(c+=+d.change),e.next=2;break;case 16:r>0&&(t.days=r,t.change=+c.toFixed(2),t.averageChange=+(i/r).toFixed(2),t.averageRate=+(s/r).toFixed(2),t.averageChange2=+(c/r).toFixed(2));case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"calcShortterm",value:function(){return this.calcShorttermFun(this.shortterm,function(){var e=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.code,t.name,t.price,n=t.change,r=t.rate,e.abrupt("return",n>0&&r>0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"calcLimitup",value:function(){return this.calcShorttermFun(this.limitup,(function(e){e.code,e.name,e.price;var t=e.change,n=e.rate;return t>=9&&n>0}))}},{key:"calcRiseup",value:function(){var e=this;return this.calcShorttermFun(this.riseup,(function(t){t.code,t.name,t.price;var n=t.change,r=t.rate;return n>=e.$valid.bigChange&&r>0}))}},{key:"calcRateup",value:function(){var e=this;return this.calcShorttermFun(this.rateup,(function(t){t.code,t.name,t.price,t.change;return t.rate>e.range.rate[1]*e.$valid.rateRatio}))}},{key:"isValidShortterm",value:(t=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.code,t.change,n=t.rate,r={},e.next=4,this.calcShorttermFun(r,(function(e){e.code,e.name,e.price,e.change;var t=e.rate;return Math.abs((t-n)/n)>=.2}));case 4:return e.abrupt("return",r.averageChange2>=this.$valid.averageChange2);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"calcRatio",value:function(){var e=0,t=0,n=0,r=this.flow.slice(-1)[0],a=!0,s=!1,i=void 0;try{for(var c,o=this.flow[Symbol.iterator]();!(a=(c=o.next()).done);a=!0){var u=c.value,l=u.change,h=u.rate,p=u.netinflow;l>0&&h>0&&(e+=h,t+=p,n+=l)}}catch(e){s=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw i}}this.ratio.onePercentRate=+(e/n).toFixed(2),this.ratio.onePercentAmount=+(t/n).toFixed(2),this.ratio.mainRatio=+(this.longterm.rate/this.longterm.days).toFixed(2),this.ratio.abnormalRatio=+((this.day.bigRise+this.day.bigDown)/this.longterm.days).toFixed(2),this.ratio.lockRatio=+(+r.price/this.longterm.averagePrice).toFixed(2)}},{key:"calcGene",value:function(){this.gene.ratio={mainRatio:this.ratio.mainRatio,abnormalRatio:this.ratio.abnormalRatio,lockRatio:this.ratio.lockRatio,onePercentRate:this.ratio.onePercentRate,onePercentAmount:this.toMoney(this.ratio.onePercentAmount)},this.gene.shortterm=this.shortterm,this.gene.longterm={days:this.longterm.days,averagePrice:this.longterm.averagePrice,change:this.longterm.change,rate:this.longterm.rate,amount:this.toMoney(this.longterm.amount)},this.gene.limitup=this.limitup,this.gene.riseup=this.riseup,this.gene.rateup=this.rateup,this.gene.day=this.day,this.gene.range={change:this.range.change.toString(),price:this.range.price.toString(),rate:this.range.rate.toString(),amount:[this.toMoney(this.range.amount[0]),this.toMoney(this.range.amount[1])]},this.gene.index=this.index,this.gene.fundamental=this.fundamental}},{key:"show",value:function(){for(var e in this.gene)console.info("%c".concat(this.code,".").concat(e.toUpperCase()),"padding-left: 45%; color:#FFC107;"),console.table(this.gene[e])}},{key:"getFlow",value:function(){return this.flow}},{key:"getGene",value:function(){return this.gene}},{key:"toString",value:function(){var e="";for(var t in this.gene){var n=this.gene[t];for(var r in n)e+="".concat(t,".").concat(r,": ").concat(n[r].toString(),"  ")}return e}}]),e}(),D=new(function(){function e(){Object(i.a)(this,e),Object(o.a)(this,"genes",{}),Object(o.a)(this,"vtypes",{});var t=!0,n=!1,r=void 0;try{for(var a,s=d.a.validators[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var c=a.value,u=c.name,l=c.rule.gene,h={};for(var p in l)if(p.startsWith("$")){var v=p.split("."),b=Object(f.a)(v,2),k=b[0],g=b[1];h[k]||(h[k]={}),h[k][g]=+l[p]}this.vtypes[u]=h}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}}var t,n,r;return Object(c.a)(e,[{key:"has",value:function(e,t){return!!this.genes[t]&&this.genes[t][e]}},{key:"param",value:(r=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.vtypes[t]||{});case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"gene",value:(n=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.has(t,n)){e.next=3;break}return e.next=3,this.capture(t,n);case 3:return e.abrupt("return",this.genes[n][t]);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"capture",value:(t=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.has(t,n)){e.next=3;break}return e.abrupt("return",this.gene(t,n));case 3:return e.next=5,Promise.all([F.flow(t),v.a.captureStock(t)]);case 5:return r=e.sent,s=Object(f.a)(r,2),i=s[0],c=s[1],e.next=11,new S(t,c,i,this.vtypes[n],n).analyse();case 11:return o=e.sent,this.genes[n]||(this.genes[n]={}),this.genes[n][t]=o,e.abrupt("return",o);case 17:e.prev=17,e.t0=e.catch(0),console.warn("#Genes# capture fail ",n,t,e.t0);case 20:case"end":return e.stop()}}),e,this,[[0,17]])}))),function(e,n){return t.apply(this,arguments)})}]),e}()),_=n(332),R=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[],values:[]};return Function.apply(void 0,Object(_.a)(t.keys).concat(['"use strict";return ('.concat(e,")")])).apply(void 0,Object(_.a)(t.values))},Y=n(297),L=function(){function e(t){Object(i.a)(this,e),this.config=t}var t,n,r,o,u,l,h,f;return Object(c.a)(e,[{key:"hasCaptureRule",value:function(e){return this.config.capture.includes(e)}},{key:"hasIntervalRule",value:function(e){return this.config.interval.includes(e)}},{key:"filter",value:(f=Object(s.a)(a.a.mark((function t(n,r){var s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r.code,r.name,r.price,r.change,r.rate,r.turnover,r.qrr,r.eps,r.bvps,r.roe,s=this.config.capture,Y.ib.getIntervalKeys().includes(n)&&(s=this.config.interval),t.next=7,e.filterOfList(r);case 7:if(t.sent){t.next=9;break}return t.abrupt("return",!1);case 9:if(![Y.F.key,Y.s.key].includes(n)){t.next=11;break}return t.abrupt("return",!0);case 11:if(!s.includes("base")){t.next=16;break}return t.next=14,this.isValidBase(r);case 14:if(t.sent){t.next=16;break}return t.abrupt("return",!1);case 16:if(!s.includes("fundamental")){t.next=21;break}return t.next=19,this.isValidFundamental(r);case 19:if(t.sent){t.next=21;break}return t.abrupt("return",!1);case 21:if(!s.includes("whitelist")){t.next=26;break}return t.next=24,this.isValidWhitelist(r);case 24:if(t.sent){t.next=26;break}return t.abrupt("return",!1);case 26:if(!s.includes("gene")){t.next=31;break}return t.next=29,this.isValidGeneAnalyse(r.code,r);case 29:if(t.sent){t.next=31;break}return t.abrupt("return",!1);case 31:return t.abrupt("return",!0);case 34:return t.prev=34,t.t0=t.catch(0),t.abrupt("return",!1);case 37:case"end":return t.stop()}}),t,this,[[0,34]])}))),function(e,t){return f.apply(this,arguments)})},{key:"filterOfPreTrace",value:(h=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,c,o,u,l,h,p,f,v,d,b,k,g;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.config.capture.includes("pre-trace")){e.next=3;break}return e.abrupt("return",!0);case 3:if(r=this.config.rule["pre-trace"]){e.next=6;break}return e.abrupt("return",!0);case 6:s=Object.keys(t),i=0,c=s;case 8:if(!(i<c.length)){e.next=22;break}if(o=c[i],![Y.F.key,Y.s.key].includes(o)){e.next=12;break}return e.abrupt("continue",19);case 12:if(u=t[o],l=n[o],u&&l){e.next=16;break}return e.abrupt("continue",19);case 16:for(f in h=u.getStocks(),p=l.getStocks(),h)for(b in v=h[f],d=p[f],r)k=(d[b]-v[b])/v[b],g="".concat(k).concat(r[b]),R(g)||(console.info("#Validator# filter stock of PreTrace",o,v.code,v.name,v.price,v.change,b,"[ ",d[b]," - ",v[b],r[b]," ]"),delete h[f]);case 19:i++,e.next=8;break;case 22:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"check",value:function(e,t,n,r){if(!e)return!0;try{for(var a=Object.keys(e),s=0,i=a;s<i.length;s++){var c=i[s],o=R("data.".concat(c),{keys:["data"],values:[t]}),u="".concat(o).concat(e[c]);if(void 0!==o&&!R(u))return!1}}catch(e){}return!0}},{key:"isFullRequiredFields",value:function(e){var t=new p.a({});for(var n in t)if(!e.hasOwnProperty(n))return!1;return!0}},{key:"isValidBase",value:(l=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.code,r=t.name,t.price,t.change,t.rate,t.turnover,t.qrr,e.abrupt("return",this.check(this.config.rule.base,t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"isValidWhitelist",value:(u=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.code,t.name,b.a.whitelist().has(n)){e.next=3;break}return e.abrupt("return",!1);case 3:return e.abrupt("return",!0);case 4:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"isValidFundamental",value:(o=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.config.rule.fundamental){e.next=3;break}return e.abrupt("return",!0);case 3:return e.abrupt("return",this.check(n,t,t.code,t.name));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"isValidGeneAnalyse",value:(r=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.config.rule.gene){e.next=3;break}return e.abrupt("return",!0);case 3:return s=this.config.name,e.next=6,D.gene(t,s);case 6:return i=e.sent,e.next=9,i.isValidShortterm(n);case 9:if(e.sent){e.next=11;break}return e.abrupt("return",!1);case 11:c={},e.t0=a.a.keys(r);case 13:if((e.t1=e.t0()).done){e.next=20;break}if(!(o=e.t1.value).startsWith("$")){e.next=17;break}return e.abrupt("continue",13);case 17:c[o]=r[o],e.next=13;break;case 20:return e.abrupt("return",this.check(c,i,i.code,i.name));case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})}],[{key:"filterOfList",value:(n=Object(s.a)(a.a.mark((function t(n){var r,s,i,c;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.code,s=n.name,i=n.price,c=n.change,n.rate,n.turnover,n.qrr,!(c>9.8||i<=0)){t.next=3;break}return t.abrupt("return",!1);case 3:return t.abrupt("return",e.isValidStock(r,s));case 4:case"end":return t.stop()}}),t)}))),function(e){return n.apply(this,arguments)})},{key:"isValidStock",value:(t=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.toUpperCase().includes("ST")){e.next=2;break}return e.abrupt("return",!1);case 2:if(!n.toUpperCase().includes("B")&&!n.toUpperCase().includes("Ｂ")){e.next=4;break}return e.abrupt("return",!1);case 4:if(!n.includes("退")){e.next=6;break}return e.abrupt("return",!1);case 6:if(!n.match(/\d+/g)){e.next=8;break}return e.abrupt("return",!1);case 8:if(!("".concat(t).startsWith("688")||"".concat(t).startsWith("300")||"".concat(t).startsWith("200")||"".concat(t).startsWith("900"))){e.next=10;break}return e.abrupt("return",!1);case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})}]),e}(),T=(n(499),n(349)),M=n(500),P=n(455),E=n(501),B=function(){function e(t){Object(i.a)(this,e),Object(o.a)(this,"name",void 0),Object(o.a)(this,"stocks",{}),this.name=t}var t,n;return Object(c.a)(e,[{key:"filter",value:(n=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"broadcast",value:function(e,t,n){window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Interval_Event",{detail:{name:e,vtype:t,stock:n}}))}},{key:"capture",value:(t=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,c,o,u,l,h,p,f,d,b,k,g,x;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.config.name,s=(new Date).getTime(),this.stocks[r]||(this.stocks[r]={}),i=!0,c=!1,o=void 0,e.prev=6,u=t[Symbol.iterator]();case 8:if(i=(l=u.next()).done){e.next=34;break}if(h=l.value,n.isFullRequiredFields(h)){e.next=14;break}return e.next=13,v.a.captureStock(h.code);case 13:h=e.sent;case 14:return e.next=16,n.filter(this.name,h);case 16:if(e.sent){e.next=18;break}return e.abrupt("continue",31);case 18:return e.next=20,this.filter(h,r);case 20:if(e.sent){e.next=22;break}return e.abrupt("continue",31);case 22:if(f=(p=h).code,d=p.name,p.price,b=p.change,k=p.netinflow,g=p.rate,p.eps,p.bvps,p.roe,p.turnover,p.qrr,console.log("#Digger# capture ".concat(this.name,"-").concat(r," stock"),f,d,b,g,k),!this.stocks[r][f]){e.next=26;break}return e.abrupt("continue",31);case 26:if(this.broadcast(this.name,r,h),!(Object.keys(this.stocks[r]).length>=10)){e.next=30;break}return e.abrupt("break",34);case 30:this.stocks[r][f]=h;case 31:i=!0,e.next=8;break;case 34:e.next=40;break;case 36:e.prev=36,e.t0=e.catch(6),c=!0,o=e.t0;case 40:e.prev=40,e.prev=41,i||null==u.return||u.return();case 43:if(e.prev=43,!c){e.next=46;break}throw o;case 46:return e.finish(43);case 47:return e.finish(40);case 48:return x=(new Date).getTime(),console.log("#diggers# list ".concat(this.name,"-").concat(r," capture stocks at ").concat(m()().format("HH:mm:ss"),": ").concat(x-s,"ms")),e.abrupt("return",Object.values(this.stocks[r]));case 51:case"end":return e.stop()}}),e,this,[[6,36,40,48],[41,,43,47]])}))),function(e,n){return t.apply(this,arguments)})}]),e}(),U=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y.W.key,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(i.a)(this,t),(e=Object(M.a)(this,Object(P.a)(t).call(this,n))).minContinueDays=r,e}var n;return Object(E.a)(t,e),Object(c.a)(t,[{key:"filter",value:(n=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",+t.change>=9.5);case 1:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})}]),t}(B),I=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y.Y.key,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(i.a)(this,t),e=Object(M.a)(this,Object(P.a)(t).call(this,n)),Object(o.a)(Object(T.a)(e),"_stocks",{}),e.minContinueDays=r,e}var n;return Object(E.a)(t,e),Object(c.a)(t,[{key:"filter",value:(n=Object(s.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._stocks[t.code]){e.next=3;break}return this._stocks[t.code]=t,e.abrupt("return",!1);case 3:return r=+t.change-this._stocks[t.code].change>=3,this._stocks[t.code]=t,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}]),t}(B),W=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y.X.key,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(i.a)(this,t),e=Object(M.a)(this,Object(P.a)(t).call(this,n)),Object(o.a)(Object(T.a)(e),"_stocks",{}),e.minContinueDays=r,e}var n;return Object(E.a)(t,e),Object(c.a)(t,[{key:"filter",value:(n=Object(s.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._stocks[t.code]){e.next=3;break}return this._stocks[t.code]=t,e.abrupt("return",!1);case 3:return r=+t.rate-this._stocks[t.code].rate>=5,this._stocks[t.code]=t,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}]),t}(B),H=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y.Z.key,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(i.a)(this,t),(e=Object(M.a)(this,Object(P.a)(t).call(this,n))).minContinueDays=r,e}var n;return Object(E.a)(t,e),Object(c.a)(t,[{key:"filter",value:(n=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.continue(t.code,"limitup");case 2:if(!(e.sent<this.minContinueDays)){e.next=5;break}return e.abrupt("return",!1);case 5:return e.abrupt("return",+t.change>=9.5);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}]),t}(B),A=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y.bb.key,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(i.a)(this,t),(e=Object(M.a)(this,Object(P.a)(t).call(this,n))).minContinueDays=r,e}var n;return Object(E.a)(t,e),Object(c.a)(t,[{key:"filter",value:(n=Object(s.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.continue(t.code,"change");case 2:if(!(e.sent<this.minContinueDays)){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,F.flow(t.code);case 7:return r=e.sent,e.abrupt("return",+t.change>=+r[0].change);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}]),t}(B),V=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y.ab.key,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(i.a)(this,t),(e=Object(M.a)(this,Object(P.a)(t).call(this,n))).minContinueDays=r,e}var n;return Object(E.a)(t,e),Object(c.a)(t,[{key:"filter",value:(n=Object(s.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.continue(t.code,"rate");case 2:if(!(e.sent<this.minContinueDays)){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,F.flow(t.code);case 7:return r=e.sent,e.abrupt("return",t.rate>=+r[0].rate);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}]),t}(B),K=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y.o.key,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(i.a)(this,t),(e=Object(M.a)(this,Object(P.a)(t).call(this,n))).minContinueDays=r,e}var n;return Object(E.a)(t,e),Object(c.a)(t,[{key:"filter",value:(n=Object(s.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.continue(t.code,"limitup");case 2:return r=e.sent,e.abrupt("return",r>=this.minContinueDays);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}]),t}(B),q=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y.n.key,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(i.a)(this,t),(e=Object(M.a)(this,Object(P.a)(t).call(this,n))).minContinueDays=r,e}var n;return Object(E.a)(t,e),Object(c.a)(t,[{key:"filter",value:(n=Object(s.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.continue(t.code,"change");case 2:return r=e.sent,e.abrupt("return",r>=this.minContinueDays);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}]),t}(B),N=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y.q.key,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(i.a)(this,t),(e=Object(M.a)(this,Object(P.a)(t).call(this,n))).minContinueDays=r,e}var n;return Object(E.a)(t,e),Object(c.a)(t,[{key:"filter",value:(n=Object(s.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.continue(t.code,"rate");case 2:return r=e.sent,e.abrupt("return",r>=this.minContinueDays);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}]),t}(B),G=new(function(){function e(){Object(i.a)(this,e),Object(o.a)(this,"t0LimitUpDigger",new U(Y.W.key,0)),Object(o.a)(this,"t0RiseUpDigger",new I(Y.Y.key,0)),Object(o.a)(this,"t0RateUpDigger",new W(Y.X.key,0)),Object(o.a)(this,"t1LimitUpDigger",new H(Y.Z.key,1)),Object(o.a)(this,"t1RiseUpDigger",new A(Y.bb.key,1)),Object(o.a)(this,"t1RateUpDigger",new V(Y.ab.key,1)),Object(o.a)(this,"continueLimitUpDigger",new K(Y.o.key,2)),Object(o.a)(this,"continueChangeDigger",new q(Y.n.key,2)),Object(o.a)(this,"continueRateDigger",new N(Y.q.key,2)),Object(o.a)(this,"topContinueLimitUpDigger",new K(Y.db.key,2)),Object(o.a)(this,"topContinueChangeDigger",new q(Y.cb.key,2)),Object(o.a)(this,"topContinueRateDigger",new N(Y.eb.key,2)),Object(o.a)(this,"stocks",[])}return Object(c.a)(e,[{key:"start",value:function(){var e=this;k.a.interval(Object(s.a)(a.a.mark((function t(){var n,r,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=(new Date).getTime(),t.prev=1,r=[],!g.a.isRunning){t.next=9;break}return t.next=6,g.a.listOfStocks("netinflow");case 6:r=t.sent,t.next=12;break;case 9:return t.next=11,v.a.captureList(Y.N.key);case 11:r=t.sent;case 12:e.stocks=r.slice(0,200),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(1),console.warn("#diggers# capture fail",t.t0);case 18:s=(new Date).getTime(),console.log("#diggers# update stocks ".concat(s-n,"ms"));case 20:case"end":return t.stop()}}),t,null,[[1,15]])}))),void 0,30,"diggers")}},{key:"list",value:function(e,t){var n,r=(n={},Object(o.a)(n,Y.W.key,this.t0LimitUpDigger),Object(o.a)(n,Y.Y.key,this.t0RiseUpDigger),Object(o.a)(n,Y.X.key,this.t0RateUpDigger),Object(o.a)(n,Y.Z.key,this.t1LimitUpDigger),Object(o.a)(n,Y.bb.key,this.t1RiseUpDigger),Object(o.a)(n,Y.ab.key,this.t1RateUpDigger),Object(o.a)(n,Y.o.key,this.continueLimitUpDigger),Object(o.a)(n,Y.n.key,this.continueChangeDigger),Object(o.a)(n,Y.q.key,this.continueRateDigger),Object(o.a)(n,Y.db.key,this.topContinueLimitUpDigger),Object(o.a)(n,Y.cb.key,this.topContinueChangeDigger),Object(o.a)(n,Y.eb.key,this.topContinueRateDigger),n),a=this.stocks;return e===Y.db.key&&(a=F.top("limitup")),e===Y.cb.key&&(a=F.top("change")),e===Y.eb.key&&(a=F.top("rate")),r[e].capture(a,t)}}]),e}()),X=new(function(){function e(){Object(i.a)(this,e)}var t,n,r;return Object(c.a)(e,[{key:"list",value:(r=Object(s.a)(a.a.mark((function e(t){var n,r,s=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},Object(o.a)(n,Y.f.key,(function(){return s.listOfBond("rate")})),Object(o.a)(n,Y.e.key,(function(){return s.listOfStock("rate")})),Object(o.a)(n,Y.g.key,(function(){return s.listOfBond("netinflow")})),Object(o.a)(n,Y.d.key,(function(){return s.listOfStock("netinflow")})),r=n,e.abrupt("return",r[t]());case 2:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"listOfBond",value:(n=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,c,o,u,l,h,p,f,v;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=b.a.stocksOfBonds(),r=g.a.stocks(n),s=g.a.listOfBonds(t),i=[],c=!0,o=!1,u=void 0,e.prev=7,l=s[Symbol.iterator]();case 9:if(c=(h=l.next()).done){e.next=23;break}return p=h.value,f=b.a.stockOfBond(p.code),v=r[f],e.next=15,window.__Walle_Stock_Validator.isValidStock(v.code,v.name);case 15:if(e.sent){e.next=17;break}return e.abrupt("continue",20);case 17:if(!(p.change>5||p.price<=0)){e.next=19;break}return e.abrupt("continue",20);case 19:i.push(p);case 20:c=!0,e.next=9;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(7),o=!0,u=e.t0;case 29:e.prev=29,e.prev=30,c||null==l.return||l.return();case 32:if(e.prev=32,!o){e.next=35;break}throw u;case 35:return e.finish(32);case 36:return e.finish(29);case 37:return e.abrupt("return",i);case 38:case"end":return e.stop()}}),e,null,[[7,25,29,37],[30,,32,36]])}))),function(e){return n.apply(this,arguments)})},{key:"listOfStock",value:(t=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,c,o,u,l,h,p,f,v,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=b.a.stocksOfBonds(),r=g.a.stocks(n),s=g.a.bonds(),i=g.a.list(r,t),c=[],o=!0,u=!1,l=void 0,e.prev=8,h=i[Symbol.iterator]();case 10:if(o=(p=h.next()).done){e.next=24;break}return f=p.value,e.next=14,window.__Walle_Stock_Validator.isValidStock(f.code,f.name);case 14:if(e.sent){e.next=16;break}return e.abrupt("continue",21);case 16:if(v=b.a.bondOfStock(f.code),!((d=s[v]).change>5||d.price<=0)){e.next=20;break}return e.abrupt("continue",21);case 20:c.push(d);case 21:o=!0,e.next=10;break;case 24:e.next=30;break;case 26:e.prev=26,e.t0=e.catch(8),u=!0,l=e.t0;case 30:e.prev=30,e.prev=31,o||null==h.return||h.return();case 33:if(e.prev=33,!u){e.next=36;break}throw l;case 36:return e.finish(33);case 37:return e.finish(30);case 38:return e.abrupt("return",c);case 39:case"end":return e.stop()}}),e,null,[[8,26,30,38],[31,,33,37]])}))),function(e){return t.apply(this,arguments)})}]),e}()),$=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(i.a)(this,e),Object(o.a)(this,"stocks",{}),this.stocks=t}return Object(c.a)(e,[{key:"getStocks",value:function(){return this.stocks}},{key:"setStocks",value:function(e){this.stocks=e}},{key:"getStockCodes",value:function(){return Object.keys(this.stocks)}},{key:"clone",value:function(){var t=Object.assign({},t);return new e(t)}},{key:"merge",value:function(e){for(var t in e.stocks){if(Object.keys(this.stocks).length>9)return;this.stocks[t]||(this.stocks[t]=e.stocks[t])}}},{key:"recover",value:function(e){return this.stocks=e.stocks,this}},{key:"get",value:function(e){return this.stocks[e]}},{key:"upsert",value:function(e){this.stocks[e.code]=e}},{key:"remove",value:function(e){delete this.stocks[e]}}]),e}(),J=function(){function e(t,n){Object(i.a)(this,e),Object(o.a)(this,"oldlist",void 0),Object(o.a)(this,"newlist",void 0),Object(o.a)(this,"openChange",void 0),Object(o.a)(this,"closeChange",void 0),this.oldlist=t,this.newlist=n,this.calc()}return Object(c.a)(e,[{key:"calc",value:function(){var e=this.oldlist.getStockCodes(),t=0,n=0,r=!0,a=!1,s=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var o=i.value;0!==this.newlist.get(o).price?(t+=(this.newlist.get(o).price-this.oldlist.get(o).price)/this.oldlist.get(o).price,n+=(this.newlist.get(o).open-this.oldlist.get(o).price)/this.oldlist.get(o).price):console.info("#Statement# suspension stock consider as change 0% ...",o,this.newlist.get(o).name)}}catch(e){a=!0,s=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw s}}this.closeChange=(100*t).toFixed(2),this.openChange=(100*n).toFixed(2)}},{key:"getOpenChange",value:function(){return this.openChange}},{key:"getCloseChange",value:function(){return this.closeChange}},{key:"getChange",value:function(){return this.closeChange}},{key:"getProfit",value:function(e){return(this.closeChange*e).toFixed(2)}}]),e}(),z=j.a.createInstance({name:"trace",driver:j.a.INDEXEDDB}),Z=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{isToday:!1};Object(i.a)(this,e),Object(o.a)(this,"isToday",void 0),Object(o.a)(this,"record",{change:{},capture:{},trace:{}}),Object(o.a)(this,"name",void 0),Object(o.a)(this,"rule",void 0),Object(o.a)(this,"listController",void 0),Object(o.a)(this,"oldlists",void 0),Object(o.a)(this,"newlists",void 0),Object(o.a)(this,"openChanges",{}),Object(o.a)(this,"closeChanges",{}),this.rule=n,this.listController=t,this.isToday=r.isToday,this.name=(this.isToday?"t0-".concat(this.rule.name):this.rule.name).toLowerCase(),this.deprecated()}var t,n,r,u,l,h,p;return Object(c.a)(e,[{key:"start",value:(p=Object(s.a)(a.a.mark((function e(){var t,n=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=300,e.prev=2,e.next=5,this.load();case 5:k.a.interval(Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("#StatementController# ".concat(n.name," capture start ...")),e.next=3,n.capture();case 3:console.log("#StatementController# ".concat(n.name," capture end ..."));case 4:case"end":return e.stop()}}),e)}))),null,t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.warn("#StatementController# ",e.t0);case 11:case"end":return e.stop()}}),e,this,[[2,8]])}))),function(){return p.apply(this,arguments)})},{key:"deprecated",value:(h=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.until("150000");case 2:return e.next=5,z.length();case 5:if(!(e.sent<=200)){e.next=8;break}return e.abrupt("break",15);case 8:return e.next=10,z.key(0);case 10:return t=e.sent,e.next=13,z.removeItem(t);case 13:e.next=2;break;case 15:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"load",value:(l=Object(s.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=m()().format("YYYYMMDD"),e.next=4,z.getItem(t);case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return");case 7:n[this.name]&&(this.record=n[this.name]),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(){return l.apply(this,arguments)})},{key:"save",value:(u=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m()().format("YYYYMMDD"),e.next=3,z.getItem(n);case 3:return(r=e.sent)||(r={}),this.record={change:t.change,trace:t.trace,capture:t.capture},r[this.name]=this.record,e.abrupt("return",z.setItem(n,r));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"capture",value:(r=Object(s.a)(a.a.mark((function e(t){var n,r,s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.newlists=null,this.oldlists=null,!t){e.next=7;break}this.oldlists=t,e.next=16;break;case 7:if(!this.isToday){e.next=13;break}return e.next=10,this.listController.getTodayLists();case 10:this.oldlists=e.sent,e.next=16;break;case 13:return e.next=15,this.listController.getYesterdayLists();case 15:this.oldlists=e.sent;case 16:if(this.oldlists){e.next=18;break}return e.abrupt("return");case 18:this.newlists={},n=Object.keys(this.oldlists),r=0,s=n;case 21:if(!(r<s.length)){e.next=37;break}if(i=s[r],e.prev=23,Y.ib.get(i)){e.next=26;break}return e.abrupt("continue",34);case 26:return e.next=28,this.captureList(this.oldlists[i]);case 28:this.newlists[i]=e.sent,e.next=34;break;case 31:e.prev=31,e.t0=e.catch(23),console.warn("#StatementController# ",e.t0);case 34:r++,e.next=21;break;case 37:this.calc(),this.broadcast(),e.next=44;break;case 41:e.prev=41,e.t1=e.catch(0),console.warn("#StatementController# capture",e.t1);case 44:return e.abrupt("return",this.newlists);case 45:case"end":return e.stop()}}),e,this,[[0,41],[23,31]])}))),function(e){return r.apply(this,arguments)})},{key:"calc",value:function(){if(this.newlists)for(var e=0,t=Object.keys(this.newlists);e<t.length;e++){var n=t[e],r=new J(this.oldlists[n],this.newlists[n]);this.closeChanges[n]=r.getCloseChange(),this.openChanges[n]=r.getOpenChange()}}},{key:"broadcast",value:(n=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,c,o,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={name:this.name,change:{},trace:{},capture:{}},n=Object.keys(this.newlists),r=0,s=n;r<s.length;r++)i=s[r],c=Y.ib.name(i),o=m()().format("HH:mm"),u=this.closeChanges[i],this.record.change[c]||(this.record.change[c]=[]),this.record.change[c].unshift(u,o),t.change[c]=this.record.change[c],t.trace[c]=this.newlists[i].getStocks(),t.capture[c]=this.oldlists[i].getStocks();return e.next=5,this.save(t);case 5:console.log("#StatementController# list trace [".concat(this.name,"] at ").concat(m()().format("HH:mm:ss")," ...")),window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Trace_Event",{detail:t}));case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"captureList",value:(t=Object(s.a)(a.a.mark((function e(t){var n,r,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new $,r=Object.keys(t.getStocks()),e.next=4,v.a.captureStocks(r);case 4:return s=e.sent,n.setStocks(s),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),Q=j.a.createInstance({name:"capture",driver:j.a.INDEXEDDB}),ee=function(){function e(t,n){Object(i.a)(this,e),Object(o.a)(this,"rule",void 0),Object(o.a)(this,"validator",void 0),Object(o.a)(this,"lists",void 0),Object(o.a)(this,"listKeys",void 0),Object(o.a)(this,"statement",void 0),Object(o.a)(this,"t0Statement",void 0),Object(o.a)(this,"blocks",{concept:[],industry:[]}),this.rule=t,this.validator=n,this.statement=new Z(this,t),this.t0Statement=new Z(this,t,{isToday:!0}),this.listKeys=t.interval?Y.ib.getIntervalKeys():Y.ib.getNormalKeys(),this.reset(),this.deprecated()}var t,n,r,u,l,h,p,f,d,b,g,x,y;return Object(c.a)(e,[{key:"all",value:function(){return this.lists}},{key:"get",value:function(e){return this.lists[e]}},{key:"ignore",value:(y=Object(s.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(r=Y.ib.keyOf(t),this.lists[r]){e.next=5;break}return e.abrupt("return");case 5:return this.lists[r].remove("".concat(n)),e.next=8,this.save();case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"load",value:(x=Object(s.a)(a.a.mark((function e(t){var n,r,s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m()().format("YYYYMMDD"),t=t||n,r=this.rule.name,e.next=5,Q.getItem(t);case 5:if(s=e.sent){e.next=9;break}return console.log("#ListController# ".concat(r," ").concat(t," lists not exist!")),e.abrupt("return");case 9:if(s[r]){e.next=12;break}return console.log("#ListController# ".concat(r," ").concat(t," lists not exist!")),e.abrupt("return");case 12:return i=this.recover(s[r]),t===n&&(this.lists=i),e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"getTodayLists",value:(g=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.load(m()().format("YYYYMMDD")));case 1:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"getYesterdayLists",value:(b=Object(s.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.length();case 2:return t=e.sent,e.next=5,Q.key(t-2);case 5:return n=e.sent,e.abrupt("return",this.load(n));case 7:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"recover",value:function(e){for(var t in e)e[t]=(new $).recover(e[t]);return e}},{key:"deprecated",value:(d=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.until("150000");case 2:return e.next=5,Q.length();case 5:if(!(e.sent<=200)){e.next=8;break}return e.abrupt("break",15);case 8:return e.next=10,Q.key(0);case 10:return t=e.sent,e.next=13,Q.removeItem(t);case 13:e.next=2;break;case 15:case"end":return e.stop()}}),e)}))),function(){return d.apply(this,arguments)})},{key:"save",value:(f=Object(s.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m()().format("YYYYMMDD"),n=this.rule.name,e.next=4,Q.getItem(t);case 4:return(r=e.sent)||(r={}),r[n]=this.lists,e.abrupt("return",Q.setItem(t,r));case 8:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"reset",value:function(){var e=this.listKeys;this.lists={};var t=!0,n=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var i=a.value;this.lists[i]=new $}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}}},{key:"captureHotBlocks",value:(p=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.captureBlock();case 2:return this.blocks=e.sent,console.info("#EastMoneyBlockCrawler# Hot Concept Blocks ..."),console.table(this.blocks.concept),console.info("#EastMoneyBlockCrawler# Hot Industry Blocks ..."),console.table(this.blocks.industry),e.abrupt("return",this.blocks);case 8:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"createHotBlocksList",value:(h=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,c,o,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={concept:[Y.k.key,Y.l.key,Y.m.key],industry:[Y.v.key,Y.w.key,Y.x.key]},e.next=4,this.captureHotBlocks();case 4:for(n in t)for(s in r=t[n])for(u in i=r[s],c=this.lists[i],o=c.getStocks())o[u].block=this.blocks[n][s].name;e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn("#ListController# ",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return h.apply(this,arguments)})},{key:"createHotStocksList",value:(l=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,c,o,u,l,h,p,f,v,d,b,k,g,x,w,y,m,O,j;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.listKeys,n=Y.ib.getBondKeys(),r={},s={},i=[],c=0,o=!0,u=!1,l=void 0,e.prev=9,h=t[Symbol.iterator]();case 11:if(o=(p=h.next()).done){e.next=22;break}if(f=p.value,!n.includes(f)){e.next=15;break}return e.abrupt("continue",19);case 15:for(b in v=this.lists[f],d=v.getStocks(),Object.assign(r,d),d)k=d[b],i[b]||(i[b]={name:k.name,count:0}),i[b].count++;case 19:o=!0,e.next=11;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(9),u=!0,l=e.t0;case 28:e.prev=28,e.prev=29,o||null==h.return||h.return();case 31:if(e.prev=31,!u){e.next=34;break}throw l;case 34:return e.finish(31);case 35:return e.finish(28);case 36:for(g=Object.keys(i).sort((function(e,t){return i[t].count-i[e].count})),x=!0,w=!1,y=void 0,e.prev=40,m=g[Symbol.iterator]();!(x=(O=m.next()).done);x=!0)j=O.value,i[j].count>=3&&c<10&&(s[j]=Object.assign({},r[j],{hot:i[j].count}),c++);e.next=48;break;case 44:e.prev=44,e.t1=e.catch(40),w=!0,y=e.t1;case 48:e.prev=48,e.prev=49,x||null==m.return||m.return();case 51:if(e.prev=51,!w){e.next=54;break}throw y;case 54:return e.finish(51);case 55:return e.finish(48);case 56:console.log("#ListController# list ".concat(this.rule.name," capture hot stcoks ...")),console.table(i),this.lists[Y.u.key].setStocks(s);case 59:case"end":return e.stop()}}),e,this,[[9,24,28,36],[29,,31,35],[40,44,48,56],[49,,51,55]])}))),function(){return l.apply(this,arguments)})},{key:"start",value:(u=Object(s.a)(a.a.mark((function e(){var t,n=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.rule.interval?void 0:[this.rule.capture],e.prev=1,e.next=4,this.load();case 4:k.a.interval(Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("#ListController# list ".concat(n.rule.name," capture start ...")),e.next=3,n.capture();case 3:n.rule.interval||(console.info("=================================================="),console.info("#ListController# today list capture [".concat(n.rule.name,"] at ").concat(m()().format("HH:mm:ss"),": "),n.lists),console.info("==================================================")),console.log("#ListController# list ".concat(n.rule.name," capture end ..."));case 5:case"end":return e.stop()}}),e)}))),t,this.rule.interval),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.warn("#ListController# ",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])}))),function(){return u.apply(this,arguments)})},{key:"captureList",value:(r=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,c,o,u,l,h,p,f,d,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Y.ib.getIntervalKeys(),r=Y.ib.getBondKeys(),s=[],!n.includes(t)){e.next=9;break}return e.next=6,G.list(t,this.validator);case 6:s=e.sent,e.next=18;break;case 9:if(!r.includes(t)){e.next=15;break}return e.next=12,X.list(t);case 12:s=e.sent,e.next=18;break;case 15:return e.next=17,v.a.captureList(t);case 17:s=e.sent;case 18:if(s&&s.length){e.next=20;break}return e.abrupt("return",new $);case 20:i={},c=0,o=!0,u=!1,l=void 0,e.prev=24,h=s[Symbol.iterator]();case 26:if(o=(p=h.next()).done){e.next=49;break}if(f=p.value,b=(d=f).code,d.name,d.change,n.includes(t)){e.next=38;break}if(this.validator.isFullRequiredFields(f)){e.next=34;break}return e.next=33,v.a.captureStock(b);case 33:f=e.sent;case 34:return e.next=36,this.validator.filter(t,f);case 36:if(e.sent){e.next=38;break}return e.abrupt("continue",46);case 38:if(!i[b]){e.next=40;break}return e.abrupt("continue",46);case 40:if(!(f.price<=0||f.change>9.8)){e.next=42;break}return e.abrupt("continue",46);case 42:if(i[b]=f,10!=++c){e.next=46;break}return e.abrupt("break",49);case 46:o=!0,e.next=26;break;case 49:e.next=55;break;case 51:e.prev=51,e.t0=e.catch(24),u=!0,l=e.t0;case 55:e.prev=55,e.prev=56,o||null==h.return||h.return();case 58:if(e.prev=58,!u){e.next=61;break}throw l;case 61:return e.finish(58);case 62:return e.finish(55);case 63:return console.log("#ListController# list ".concat(this.rule.name," capture ").concat(t," "),i),e.abrupt("return",new $(i));case 65:case"end":return e.stop()}}),e,this,[[24,51,55,63],[56,,58,62]])}))),function(e){return r.apply(this,arguments)})},{key:"capture",value:(n=Object(s.a)(a.a.mark((function e(){var t,n,r,i,c,o=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object.keys(this.lists),n=0,r=t;case 2:if(!(n<r.length)){e.next=21;break}if(i=r[n],e.prev=4,i!==Y.u.key){e.next=7;break}return e.abrupt("continue",18);case 7:return e.next=9,this.captureList(i);case 9:return c=e.sent,this.lists[i].merge(c),e.next=13,Object(w.a)(500);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),console.warn("#ListController# ",e.t0);case 18:n++,e.next=2;break;case 21:if(e.prev=21,!this.rule.interval){e.next=28;break}return this.broadcast(),e.next=26,this.save();case 26:e.next=34;break;case 28:return this.createHotStocksList(),this.createHotBlocksList(),this.broadcast(),e.next=33,this.save();case 33:setTimeout(Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,Object(w.a)(15e4);case 3:return e.next=5,o.t0Statement.capture(o.lists);case 5:if(t=e.sent,console.log("#ListController# [".concat(o.rule.name,"] t0Statement pre-trace "),t),!o.validator.hasCaptureRule("pre-trace")){e.next=13;break}return e.next=10,o.validator.filterOfPreTrace(o.lists,t);case 10:return o.broadcast(),e.next=13,o.save();case 13:case"end":return e.stop()}}),e)}))));case 34:e.next=39;break;case 36:e.prev=36,e.t1=e.catch(21),console.warn("#ListController# ",e.t1);case 39:case"end":return e.stop()}}),e,this,[[4,15],[21,36]])}))),function(){return n.apply(this,arguments)})},{key:"broadcast",value:(t=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={name:this.rule.name,lists:this.lists},window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Capture_Event",{detail:t}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),te=new(function(){function e(){Object(i.a)(this,e),Object(o.a)(this,"listControllers",[]),this.clearTempCapture();var t=[].concat(d.a.captures||[],d.a.temps||[],d.a.intervals||[]),n=d.a.validators,r=!0,a=!1,s=void 0;try{for(var c,u=t[Symbol.iterator]();!(r=(c=u.next()).done);r=!0){var p=c.value,f=!0,v=!1,b=void 0;try{for(var k,g=n[Symbol.iterator]();!(f=(k=g.next()).done);f=!0){var x=k.value,w="".concat(p.capture,"-").concat(x.name).toLowerCase(),y=new h(l({},p,{name:w})),m=new L(x),O=new ee(y,m);this.listControllers.push(O)}}catch(e){v=!0,b=e}finally{try{f||null==g.return||g.return()}finally{if(v)throw b}}}}catch(e){a=!0,s=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw s}}}var t,n,r,u,p,f;return Object(c.a)(e,[{key:"capture",value:(f=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=m()().format("YYYYMMDD"),n=!0,r=!1,s=void 0,e.prev=5,i=this.listControllers[Symbol.iterator]();case 7:if(n=(c=i.next()).done){e.next=16;break}if(!(o=c.value).rule.date||o.rule.date===t){e.next=12;break}return console.log("#controllers# ignore temp capture rule ",o.rule.capture,o.rule.date),e.abrupt("continue",13);case 12:o.start();case 13:n=!0,e.next=7;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(5),r=!0,s=e.t0;case 22:e.prev=22,e.prev=23,n||null==i.return||i.return();case 25:if(e.prev=25,!r){e.next=28;break}throw s;case 28:return e.finish(25);case 29:return e.finish(22);case 30:e.next=35;break;case 32:e.prev=32,e.t1=e.catch(0),console.warn("#controllers# capture",e.t1);case 35:case"end":return e.stop()}}),e,this,[[0,32],[5,18,22,30],[23,,25,29]])}))),function(){return f.apply(this,arguments)})},{key:"trace",value:(p=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=!0,n=!1,r=void 0,e.prev=4,s=this.listControllers[Symbol.iterator]();case 6:if(t=(i=s.next()).done){e.next=15;break}return c=i.value,e.next=10,c.statement.start();case 10:return e.next=12,c.t0Statement.start();case 12:t=!0,e.next=6;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),n=!0,r=e.t0;case 21:e.prev=21,e.prev=22,t||null==s.return||s.return();case 24:if(e.prev=24,!n){e.next=27;break}throw r;case 27:return e.finish(24);case 28:return e.finish(21);case 29:e.next=34;break;case 31:e.prev=31,e.t1=e.catch(0),console.warn("#controllers# trace ",e.t1);case 34:case"end":return e.stop()}}),e,this,[[0,31],[4,17,21,29],[22,,24,28]])}))),function(){return p.apply(this,arguments)})},{key:"clearTempCapture",value:(u=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,c,o,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d.a.temps){e.next=2;break}return e.abrupt("return");case 2:if(d.a.temps.length){e.next=4;break}return e.abrupt("return");case 4:for(t=[],n=m()().subtract(2,"days").format("YYYYMMDD"),1!=+m()().day()&&2!=+m()().day()||(n=m()().subtract(4,"days").format("YYYYMMDD")),r=!0,s=!1,i=void 0,e.prev=10,c=d.a.temps[Symbol.iterator]();!(r=(o=c.next()).done);r=!0)+(u=o.value).date>n&&t.push(u);e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),s=!0,i=e.t0;case 18:e.prev=18,e.prev=19,r||null==c.return||c.return();case 21:if(e.prev=21,!s){e.next=24;break}throw i;case 24:return e.finish(21);case 25:return e.finish(18);case 26:d.a.temps=t;case 27:case"end":return e.stop()}}),e,null,[[10,14,18,26],[19,,21,25]])}))),function(){return u.apply(this,arguments)})},{key:"setTempCapture",value:(r=Object(s.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=m()().format("YYYYMMDD"),n=m()().add(1,"minutes").format("HH:mm"),r=new h({capture:n,trace:["14:40"],date:t}),d.a.temps=[].concat(d.a.temps,r);case 4:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"removeTempCapture",value:(n=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,c,o,u,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],s=!0,i=!1,c=void 0,e.prev=4,o=d.a.temps[Symbol.iterator]();case 6:if(s=(u=o.next()).done){e.next=14;break}if((l=u.value).capture!==t||l.date!==n){e.next=10;break}return e.abrupt("continue",11);case 10:r.push(l);case 11:s=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),i=!0,c=e.t0;case 20:e.prev=20,e.prev=21,s||null==o.return||o.return();case 23:if(e.prev=23,!i){e.next=26;break}throw c;case 26:return e.finish(23);case 27:return e.finish(20);case 28:d.a.temps=r;case 29:case"end":return e.stop()}}),e,null,[[4,16,20,28],[21,,23,27]])}))),function(e,t){return n.apply(this,arguments)})},{key:"ignore",value:(t=Object(s.a)(a.a.mark((function e(t,n,r,s){var i,c,o,u,l,h,p,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=!0,c=!1,o=void 0,e.prev=3,u=this.listControllers[Symbol.iterator]();!(i=(l=u.next()).done);i=!0)h=l.value,p=h.rule,f=h.validator.config,p.capture===t&&f.name===n&&h.ignore(r,s);e.next=11;break;case 7:e.prev=7,e.t0=e.catch(3),c=!0,o=e.t0;case 11:e.prev=11,e.prev=12,i||null==u.return||u.return();case 14:if(e.prev=14,!c){e.next=17;break}throw o;case 17:return e.finish(14);case 18:return e.finish(11);case 19:case"end":return e.stop()}}),e,this,[[3,7,11,19],[12,,14,18]])}))),function(e,n,r,a){return t.apply(this,arguments)})}]),e}()),ne=n(300),re=new(function(){function e(){Object(i.a)(this,e),Object(o.a)(this,"index",{sse:{price:0,change:0,volume:0,amount:0,netinflow:0,rate:0},szse:{price:0,change:0,volume:0,amount:0,netinflow:0,rate:0},north:{}}),Object(o.a)(this,"number",{full:0,rise:0,down:0,limitup:0,limitdown:0,prelimitup:0,prelimitdown:0}),Object(o.a)(this,"strength",{full:0,netinflow:0,rise:0,down:0}),Object(o.a)(this,"changes",{index:[],netinflow:[],full:[],rise:[],down:[]}),Object(o.a)(this,"rates",{index:[],netinflow:[],full:[],rise:[],down:[]})}var t,n,r,u,l;return Object(c.a)(e,[{key:"start",value:function(){var e=this;k.a.interval((function(){e.process()}),null,180,"market-analyse")}},{key:"process",value:(l=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.calcIndex();case 3:return e.next=5,this.calcIndexOfNorth();case 5:return e.next=7,this.calcStocks();case 7:return e.next=9,this.broadcast();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.warn("#Market-Trend# ",e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(){return l.apply(this,arguments)})},{key:"broadcast",value:function(){window.dispatchEvent(new CustomEvent("__Walle_Stock_Market_Analyse_Event",{detail:{index:this.index,number:this.number,strength:this.strength,changes:this.changes,rates:this.rates}}))}},{key:"calcStocks",value:(u=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s in t=g.a.stocks(),n={full:0,rise:0,down:0},r={full:0,rise:0,down:0},this.number.full=0,this.number.rise=0,this.number.down=0,this.number.limitup=0,this.number.limitdown=0,this.number.prelimitup=0,this.number.prelimitdown=0,t)(i=t[s]).change>0&&(this.number.rise++,n.rise+=i.change,r.rise+=i.rate),i.change<0&&(this.number.down++,n.down+=i.change,r.down+=i.rate),i.change>=9.8&&this.number.limitup++,i.change<=-9.8&&this.number.limitdown++,i.change>5&&i.change<9.8&&this.number.prelimitup++,i.change<-5&&i.change>-9.8&&this.number.prelimitdown++,this.number.full++;n.rise=+n.rise.toFixed(2),n.down=+n.down.toFixed(2),n.full=+(n.rise+n.down).toFixed(2),r.rise=+r.rise.toFixed(2),r.down=+r.down.toFixed(2),r.full=+(r.rise+r.down).toFixed(2),this.strength.rise=+(r.rise/this.number.rise).toFixed(2),this.strength.down=+(r.down/this.number.down).toFixed(2),this.strength.full=+(this.strength.rise+this.strength.down).toFixed(2),c=m()().format("HH:mm"),this.changes.rise.unshift(n.rise,c),this.changes.down.unshift(n.down,c),this.changes.full.unshift(n.full,c),this.changes.index.unshift(+this.index.sse.price+this.index.szse.price,c),this.rates.rise.unshift(+(r.rise/this.number.rise).toFixed(2),c),this.rates.down.unshift(+(r.down/this.number.down).toFixed(2),c),this.rates.full.unshift(+(r.rise/this.number.rise+r.down/this.number.down).toFixed(2),c),this.rates.index.unshift(+this.index.sse.rate+this.index.szse.rate,c),this.calcNetinflow(c);case 30:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"calcNetinflow",value:(r=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,c,o,u,l,h,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=400,r=g.a.listOfStocks("netinflow",1,n),s=0,i=0,c=!0,o=!1,u=void 0,e.prev=7,l=r[Symbol.iterator]();!(c=(h=l.next()).done);c=!0)p=h.value,s+=p.change,i+=p.rate;e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),o=!0,u=e.t0;case 15:e.prev=15,e.prev=16,c||null==l.return||l.return();case 18:if(e.prev=18,!o){e.next=21;break}throw u;case 21:return e.finish(18);case 22:return e.finish(15);case 23:this.strength.netinflow=+(i/n).toFixed(2),this.changes.netinflow.unshift(+s.toFixed(2),t),this.rates.netinflow.unshift(+(i/n).toFixed(2),t);case 26:case"end":return e.stop()}}),e,this,[[7,11,15,23],[16,,18,22]])}))),function(e){return r.apply(this,arguments)})},{key:"calcIndexOfNorth",value:(n=Object(s.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,ne.a.get("http://push2.eastmoney.com/api/qt/kamt/get?fields1=f1,f2,f3,f4&fields2=f51,f52,f53,f54",null);case 4:t=e.sent,n=JSON.parse(t),this.index.north=n.data,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return n.apply(this,arguments)})},{key:"calcIndex",value:(t=Object(s.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.captureStocks(["1.000001","399001"]);case 2:t=e.sent,n=t[1.000001],r=t[399001],this.index={sse:n,szse:r};case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}()),ae=n(667),se=n.n(ae),ie=n(247),ce=n(443),oe=function(){function e(){var t=this;Object(i.a)(this,e),ie.a.listen("KeyB",(function(){var e={timeOut:5e3,extendedTimeOut:5e3,closeButton:!0,positionClass:"toast-bottom-left"};ce.a.clear(),ce.a.confirm("click to backup trace file","BACKUP",(function(){return t.trace()}),e),ce.a.confirm("click to backup capture file","BACKUP",(function(){return t.capture()}),e),ce.a.confirm("click to backup flow file","BACKUP",(function(){return t.flow()}),e),ce.a.confirm("click to backup storage file","BACKUP",(function(){return t.storage()}),e)}))}var t,n,r,o,u,l,h;return Object(c.a)(e,[{key:"download",value:(h=Object(s.a)(a.a.mark((function e(t,n){var r,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=m()().format("YYYYMMDD"),s=new Blob([JSON.stringify(n,null,"\t")],{type:"application/json;charset=utf-8"}),e.next=4,Object(w.a)(1e3);case 4:return e.abrupt("return",se.a.saveAs(s,"".concat(r,"-").concat(t)));case 5:case"end":return e.stop()}}),e)}))),function(e,t){return h.apply(this,arguments)})},{key:"trace",value:(l=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,z.iterate((function(e,n){t[n]=e}));case 4:return e.next=6,this.download("walle-stocks-trace.json",t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return l.apply(this,arguments)})},{key:"capture",value:(u=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,Q.iterate((function(e,n){t[n]=e}));case 4:return e.next=6,this.download("walle-stocks-capture.json",t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return u.apply(this,arguments)})},{key:"flow",value:(o=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,C.iterate((function(e,n){t[n]=e}));case 4:return e.next=6,this.download("walle-stocks-flow.json",t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return o.apply(this,arguments)})},{key:"storage",value:(r=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,j.a.iterate((function(e,n){t[n]=e}));case 4:return e.next=6,this.download("walle-stocks-storage.json",t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return r.apply(this,arguments)})},{key:"all",value:(n=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage();case 2:return e.next=4,this.capture();case 4:return e.next=6,this.flow();case 6:return e.next=8,this.trace();case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"autoBackup",value:(t=Object(s.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=m()().endOf("month").format("YYYYMMDD"),n=m()().format("YYYYMMDD"),t!==n){e.next=8;break}return e.next=5,k.a.until("233000");case 5:return e.next=7,this.all();case 7:console.info("#Backup# auto backup storage & records at ".concat(n," ..."));case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),ue=function(){function e(){var t=this;Object(i.a)(this,e),ie.a.listen("KeyR",(function(){return t.upload()}))}var t,n,r,u,l,h;return Object(c.a)(e,[{key:"upload",value:(h=Object(s.a)(a.a.mark((function e(){var t,n=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=document.createElement("input")).type="file",t.multiple="multiple",t.onchange=function(){n.recover(t.files)},t.click();case 5:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"recover",value:(l=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,c,u,l,h,p,f,v,d=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n={},Object(o.a)(n,"walle-stocks-trace.json",(function(e){return d.trace(e)})),Object(o.a)(n,"walle-stocks-capture.json",(function(e){return d.capture(e)})),Object(o.a)(n,"walle-stocks-flow.json",(function(e){return d.flow(e)})),Object(o.a)(n,"walle-stocks-storage.json",(function(e){return d.storage(e)})),r=n,s=!0,i=!1,c=void 0,e.prev=5,u=t[Symbol.iterator]();case 7:if(s=(l=u.next()).done){e.next=20;break}if(h=l.value,p=h.name.slice(9),!r[p]){e.next=17;break}return e.next=13,h.text();case 13:return f=e.sent,v=JSON.parse(f),e.next=17,r[p](v);case 17:s=!0,e.next=7;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(5),i=!0,c=e.t0;case 26:e.prev=26,e.prev=27,s||null==u.return||u.return();case 29:if(e.prev=29,!i){e.next=32;break}throw c;case 32:return e.finish(29);case 33:return e.finish(26);case 34:window.alert("Walle Recover Success ..."),e.next=41;break;case 37:e.prev=37,e.t1=e.catch(0),console.info("#Recover# fail ",e.t1),window.alert("Walle Recover Fail, Try Aagin ...");case 41:case"end":return e.stop()}}),e,null,[[0,37],[5,22,26,34],[27,,29,33]])}))),function(e){return l.apply(this,arguments)})},{key:"trace",value:(u=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return n=e.t1.value,e.next=6,z.setItem(n,t[n]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(e){return u.apply(this,arguments)})},{key:"capture",value:(r=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return n=e.t1.value,e.next=6,Q.setItem(n,t[n]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(e){return r.apply(this,arguments)})},{key:"flow",value:(n=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return n=e.t1.value,e.next=6,C.setItem(n,t[n]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(e){return n.apply(this,arguments)})},{key:"storage",value:(t=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return n=e.t1.value,e.next=6,j.a.setItem(n,t[n]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(e){return t.apply(this,arguments)})}]),e}(),le=new oe,he=(new ue,new(function(){function e(){Object(i.a)(this,e)}var t,n;return Object(c.a)(e,[{key:"isTradingDay",value:(n=Object(s.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:if(t=+m()().format("HHmmss"),n="092500",!(t<92500)){e.next=8;break}n="092510",e.next=14;break;case 8:if(!(t>113e3)){e.next=12;break}n="130010",e.next=14;break;case 12:if(!(t>15e4)){e.next=14;break}return e.abrupt("return",!1);case 14:return console.log("#Loop# core-loop will start at ".concat(n," ...")),e.next=17,k.a.until(n);case 17:return e.next=19,v.a.isTrading();case 19:if(r=e.sent,console.info("#Loop# stock market trading status ".concat(r?"open":"close"," ...")),r){e.next=26;break}if(!(t>=92500&&t<=113e3||t>=13e4&&t<=15e4)){e.next=26;break}return e.next=25,toastr.loading("Market Closed","Holidays");case 25:console.info("#Loop# stock market closed for holidays ...");case 26:return e.abrupt("return",r);case 27:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"start",value:(t=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,le.autoBackup(),e.next=4,this.isTradingDay();case 4:if(!e.sent){e.next=11;break}console.log("#Loop# core-loop start ..."),g.a.start(),G.start(),re.start(),te.capture(),te.trace();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.warn("#loop# ",e.t0);case 16:case"end":return e.stop()}}),e,this,[[0,13]])}))),function(){return t.apply(this,arguments)})}]),e}())),pe=n(668),fe=n.n(pe);window.__Walle_Stock_Loop=he,window.__Walle_Stock_Controller=te,window.__Walle_Stock_Pool=g.a,window.__Walle_Stock_Bond=X,window.__Walle_Stock_Flow=F,window.__Walle_Stock_Gene=D,window.__Walle_Stock_Crawler=v.a,window.__Walle_Stock_Strategy=fe.a,window.__Walle_Stock_Define=Y.ib,window.__Walle_Stock_Market=re,window.__Walle_Stock_Markets=b.a,window.__Walle_Stock_Cron=k.a,window.__Walle_Stock_Validator=L}}]);