(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3d1c3939"],{"07ac":function(e,t,r){var n=r("23e7"),a=r("6f53").values;n({target:"Object",stat:!0},{values:function(e){return a(e)}})},"12e9":function(e,t){function r(e){return{name:e,profit:{max:0,normal:0,strategy:0,"compound-interest":0,"open-crash":-0,"stop-crash":0,"reverse-crash":0},day:{total:0,trade:0,rest:0,up:0,down:0,"open-crash":0,"stop-crash":0,"reverse-crash":0},"daily-open-profit":[],"daily-close-profit":[],"daily-open-ptcchange":[],"daily-close-ptcchange":[]}}e.exports={generate:r}},"1d1c":function(e,t,r){var n=r("23e7"),a=r("83ab"),c=r("37e8");n({target:"Object",stat:!0,forced:!a,sham:!a},{defineProperties:c})},"21a6":function(e,t,r){(function(r){var n,a,c;(function(r,s){a=[],n=s,c="function"===typeof n?n.apply(t,a):n,void 0===c||(e.exports=c)})(0,(function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function n(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){i(n.response,t,r)},n.onerror=function(){console.error("could not download file")},n.send()}function a(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function c(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof r&&r.global===r?r:void 0,i=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype?function(e,t,r){var i=s.URL||s.webkitURL,o=document.createElement("a");t=t||e.name||"download",o.download=t,o.rel="noopener","string"==typeof e?(o.href=e,o.origin===location.origin?c(o):a(o.href)?n(e,t,r):c(o,o.target="_blank")):(o.href=i.createObjectURL(e),setTimeout((function(){i.revokeObjectURL(o.href)}),4e4),setTimeout((function(){c(o)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,r,s){if(r=r||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,s),r);else if(a(e))n(e,r,s);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){c(i)}))}}:function(e,t,r,a){if(a=a||open("","_blank"),a&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return n(e,t,r);var c="application/octet-stream"===e.type,i=/constructor/i.test(s.HTMLElement)||s.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||c&&i)&&"object"==typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=o?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},u.readAsDataURL(e)}else{var l=s.URL||s.webkitURL,h=l.createObjectURL(e);a?a.location=h:location.href=h,a=null,setTimeout((function(){l.revokeObjectURL(h)}),4e4)}});s.saveAs=i.saveAs=i,e.exports=i}))}).call(this,r("c8ba"))},"25f0":function(e,t,r){"use strict";var n=r("6eeb"),a=r("825a"),c=r("d039"),s=r("ad6d"),i="toString",o=RegExp.prototype,u=o[i],l=c((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),h=u.name!=i;(l||h)&&n(RegExp.prototype,i,(function(){var e=a(this),t=String(e.source),r=e.flags,n=String(void 0===r&&e instanceof RegExp&&!("flags"in o)?s.call(e):r);return"/"+t+"/"+n}),{unsafe:!0})},3645:function(e,t,r){"use strict";r.r(t);r("d3b7");var n=r("a34a"),a=r.n(n),c=r("c964"),s=(r("96cf"),r("a4d3"),r("e01a"),r("d28b"),r("99af"),r("4de4"),r("4160"),r("b0c0"),r("1d1c"),r("7a82"),r("e439"),r("dbb4"),r("b64b"),r("3ca3"),r("159b"),r("ddb0"),r("276c")),i=r("e954"),o=r("fc11"),u=function e(t){var r=t.capture,n=t.trace,a=t.interval,c=t.lists,i=t.date,u=t.name;Object(s["a"])(this,e),Object(o["a"])(this,"capture",void 0),Object(o["a"])(this,"trace",[]),Object(o["a"])(this,"interval",void 0),Object(o["a"])(this,"lists",void 0),Object(o["a"])(this,"date",void 0),Object(o["a"])(this,"name",void 0),this.capture=r,this.trace=n,this.interval=a,this.lists=c,this.name=u,this.date=i},l=(r("caad"),r("ac1f"),r("2532"),r("466d"),r("2ca0"),r("0cae")),h=(r("fb6a"),r("0d03"),r("b680"),r("25f0"),r("4795"),r("d0af")),p=r("90d5"),f=r("1797"),v=r("1e4d"),d=r("9313"),b=r("2894"),g=r("a37f"),k=r("127d"),w=r("c1df"),y=r.n(w),x=r("a002"),m=r.n(x),O=.8,j=1,S=6;(function(){try{var e=f["a"].params.gene;e&&(e["baseValidRateRatio"]&&(O=+e["baseValidRateRatio"]),e["baseValidAverageChange2"]&&(j=+e["baseValidAverageChange2"]),e["baseValidBigChange"]&&(S=+e["baseValidBigChange"]))}catch(t){}})();var D="1.000001",C=m.a.createInstance({name:"gene",driver:m.a.INDEXEDDB}),Y=function(){function e(t,r,n){Object(s["a"])(this,e),Object(o["a"])(this,"range",{change:[null,null],price:[null,null],rate:[null,null],amount:[null,null]}),Object(o["a"])(this,"day",{rise:0,down:0,bigRise:0,bigDown:0}),Object(o["a"])(this,"fundamental",{eps:0,bvps:0,roe:0}),Object(o["a"])(this,"index",{days:0,daysRatio:0,changeUpRatio:0,changeDownRatio:0}),Object(o["a"])(this,"ratio",{mainRatio:0,abnormalRatio:0,lockRatio:0,onePercentRate:0,onePercentAmount:0}),Object(o["a"])(this,"longterm",{days:0,averagePrice:0,change:0,rate:0,amount:0}),Object(o["a"])(this,"shortterm",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(o["a"])(this,"limitup",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(o["a"])(this,"riseup",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(o["a"])(this,"rateup",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(o["a"])(this,"code",void 0),Object(o["a"])(this,"name",void 0),Object(o["a"])(this,"stock",void 0),Object(o["a"])(this,"flows",[]),Object(o["a"])(this,"gene",{}),this.code=t,this.stock=r,this.flows=n,r&&(this.name=r.name)}return Object(i["a"])(e,[{key:"toMoney",value:function(e){return e=Math.abs(+e)>=1e8?(+e/1e8).toFixed(2)+"亿":(+e/1e4).toFixed(2)+"万",e}},{key:"analyse",value:function(){var e=Object(c["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!this.flows||!this.flows.length){e.next=25;break}return e.next=4,this.calcFundamental();case 4:return e.next=6,this.calcDays();case 6:return e.next=8,this.calcRange();case 8:return e.next=10,this.calcLimitup();case 10:return e.next=12,this.calcRiseup();case 12:return e.next=14,this.calcRateup();case 14:return e.next=16,this.calcLongterm();case 16:return e.next=18,this.calcShortterm();case 18:return e.next=20,this.calcRatio();case 20:if(this.code===D){e.next=23;break}return e.next=23,this.calcIndex();case 23:return e.next=25,this.calcGene();case 25:e.next=30;break;case 27:e.prev=27,e.t0=e["catch"](0),console.warn("#Gene# analyse fail ",this.code,e.t0);case 30:return e.abrupt("return",this);case 31:case"end":return e.stop()}}),e,this,[[0,27]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"calcRange",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,a=this.flows[Symbol.iterator]();!(e=(n=a.next()).done);e=!0){var c=n.value,s=c.price,i=c.change,o=c.rate,u=c.netinflow;null===this.range.price[0]&&(this.range.price[0]=s),null===this.range.price[1]&&(this.range.price[1]=s),s<this.range.price[0]&&(this.range.price[0]=s),s>this.range.price[1]&&(this.range.price[1]=s),null===this.range.change[0]&&(this.range.change[0]=i),null===this.range.change[1]&&(this.range.change[1]=i),i<this.range.change[0]&&(this.range.change[0]=i),i>this.range.change[1]&&(this.range.change[1]=i),null===this.range.amount[0]&&(this.range.amount[0]=u),null===this.range.amount[1]&&(this.range.amount[1]=u),u<this.range.amount[0]&&(this.range.amount[0]=u),u>this.range.amount[1]&&(this.range.amount[1]=u),null===this.range.rate[0]&&(this.range.rate[0]=o),null===this.range.rate[1]&&(this.range.rate[1]=o),o<this.range.rate[0]&&(this.range.rate[0]=o),o>this.range.rate[1]&&(this.range.rate[1]=o)}}catch(l){t=!0,r=l}finally{try{e||null==a["return"]||a["return"]()}finally{if(t)throw r}}this.range.price[0]=+this.range.price[0].toFixed(2),this.range.price[1]=+this.range.price[1].toFixed(2),this.range.change[0]=+this.range.change[0].toFixed(2),this.range.change[1]=+this.range.change[1].toFixed(2),this.range.amount[0]=+this.range.amount[0].toFixed(2),this.range.amount[1]=+this.range.amount[1].toFixed(2),this.range.rate[0]=+this.range.rate[0].toFixed(2),this.range.rate[1]=+this.range.rate[1].toFixed(2)}},{key:"calcDays",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,a=this.flows[Symbol.iterator]();!(e=(n=a.next()).done);e=!0){var c=n.value.change;c>=0?this.day.rise++:this.day.down++,c>=S&&this.day.bigRise++,c<=-S&&this.day.bigDown++}}catch(s){t=!0,r=s}finally{try{e||null==a["return"]||a["return"]()}finally{if(t)throw r}}}},{key:"calcIndex",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n,c,s,i,o;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=0,r=0,n=0,c=0,s=0,e.next=3,F.gene(D);case 3:i=e.sent,o=i.flows,this.flows.forEach((function(e,a){var i=o[a];e.date===i.date&&(e.change>0&&i.change>0&&(t++,r+=e.change,c+=i.change),e.change<0&&i.change<0&&(t++,n+=e.change,s+=i.change))})),this.index.days=t,this.index.daysRatio=+(t/this.flows.length).toFixed(2),this.index.changeUpRatio=+(r/c).toFixed(2),this.index.changeDownRatio=-(n/s).toFixed(2);case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"calcFundamental",value:function(){this.fundamental.eps=+this.stock.eps.toFixed(2),this.fundamental.bvps=+this.stock.bvps.toFixed(2),this.fundamental.roe=+this.stock.roe.toFixed(2)}},{key:"calcLongterm",value:function(){var e=0,t=!0,r=!1,n=void 0;try{for(var a,c=this.flows[Symbol.iterator]();!(t=(a=c.next()).done);t=!0){var s=a.value,i=s.price,o=s.change,u=s.rate,l=s.netinflow;this.longterm.change+=o,this.longterm.rate+=u,this.longterm.amount+=l,this.longterm.days++,e+=i}}catch(h){r=!0,n=h}finally{try{t||null==c["return"]||c["return"]()}finally{if(r)throw n}}this.longterm.averagePrice=+(e/this.flows.length).toFixed(2),this.longterm.change=+this.longterm.change.toFixed(2),this.longterm.rate=+this.longterm.rate.toFixed(2),this.longterm.amount=+this.longterm.amount.toFixed(2)}},{key:"calcShorttermFun",value:function(){var e=Object(c["a"])(a.a.mark((function e(t,r){var n,c,s,i,o,u,l,h,p,f,v,d;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=0,c=0,s=0,i=0,e.t0=a.a.keys(this.flows);case 2:if((e.t1=e.t0()).done){e.next=16;break}return o=e.t1.value,u=this.flows[o],l=u.code,h=u.name,p=u.price,f=u.change,v=u.rate,e.next=7,r({code:l,name:h,price:p,change:f,rate:v});case 7:if(e.sent){e.next=9;break}return e.abrupt("continue",2);case 9:n++,s+=f,c+=v,d=this.flows[+o+1],d&&(i+=+d.change),e.next=2;break;case 16:n>0&&(t.days=n,t.change=+i.toFixed(2),t.averageChange=+(s/n).toFixed(2),t.averageRate=+(c/n).toFixed(2),t.averageChange2=+(i/n).toFixed(2));case 17:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"calcShortterm",value:function(){return this.calcShorttermFun(this.shortterm,function(){var e=Object(c["a"])(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.code,t.name,t.price,r=t.change,n=t.rate,e.abrupt("return",r>0&&n>0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"calcLimitup",value:function(){return this.calcShorttermFun(this.limitup,(function(e){e.code,e.name,e.price;var t=e.change,r=e.rate;return t>=9&&r>0}))}},{key:"calcRiseup",value:function(){return this.calcShorttermFun(this.riseup,(function(e){e.code,e.name,e.price;var t=e.change,r=e.rate;return t>=S&&r>0}))}},{key:"calcRateup",value:function(){var e=this;return this.calcShorttermFun(this.rateup,(function(t){t.code,t.name,t.price,t.change;var r=t.rate;return r>e.range.rate[1]*O}))}},{key:"isValidShortterm",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.code,t.change,r=t.rate,n={},e.next=4,this.calcShorttermFun(n,(function(e){e.code,e.name,e.price,e.change;var t=e.rate;return Math.abs((t-r)/r)>=.2}));case 4:return e.abrupt("return",n.averageChange2>=j);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"isValidLimitup",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r,n,c,s;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.code,r=t.change,n=t.rate,c=this.limitup.averageRate&&n/this.limitup.averageRate>O,s=this.limitup.averageChange2>=j,e.abrupt("return",c&&s&&r>=9);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"isValidRiseup",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r,n,c,s;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.code,r=t.change,n=t.rate,c=this.riseup.averageRate&&n/this.riseup.averageRate>O,s=this.riseup.averageChange2>=j,e.abrupt("return",c&&s&&r>=S);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"isValidRateup",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r,n,c,s;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.code,r=t.change,n=t.rate,c=this.rateup.averageRate&&n/this.rateup.averageRate>O,s=this.rateup.averageChange2>=j,e.abrupt("return",c&&s&&r>=this.rateup.averageChange);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"calcRatio",value:function(){var e=0,t=0,r=0,n=this.flows.slice(-1)[0],a=!0,c=!1,s=void 0;try{for(var i,o=this.flows[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var u=i.value,l=u.change,h=u.rate,p=u.netinflow;l>0&&h>0&&(e+=h,t+=p,r+=l)}}catch(f){c=!0,s=f}finally{try{a||null==o["return"]||o["return"]()}finally{if(c)throw s}}this.ratio.onePercentRate=+(e/r).toFixed(2),this.ratio.onePercentAmount=+(t/r).toFixed(2),this.ratio.mainRatio=+(this.longterm.rate/this.longterm.days).toFixed(2),this.ratio.abnormalRatio=+((this.day.bigRise+this.day.bigDown)/this.longterm.days).toFixed(2),this.ratio.lockRatio=+(+n.price/this.longterm.averagePrice).toFixed(2)}},{key:"calcGene",value:function(){this.gene.ratio={mainRatio:this.ratio.mainRatio,abnormalRatio:this.ratio.abnormalRatio,lockRatio:this.ratio.lockRatio,onePercentRate:this.ratio.onePercentRate,onePercentAmount:this.toMoney(this.ratio.onePercentAmount)},this.gene.shortterm=this.shortterm,this.gene.longterm={days:this.longterm.days,averagePrice:this.longterm.averagePrice,change:this.longterm.change,rate:this.longterm.rate,amount:this.toMoney(this.longterm.amount)},this.gene.limitup=this.limitup,this.gene.riseup=this.riseup,this.gene.rateup=this.rateup,this.gene.day=this.day,this.gene.range={change:this.range.change.toString(),price:this.range.price.toString(),rate:this.range.rate.toString(),amount:[this.toMoney(this.range.amount[0]),this.toMoney(this.range.amount[1])]},this.gene.index=this.index,this.gene.fundamental=this.fundamental}},{key:"show",value:function(){for(var e in this.gene)console.info("%c".concat(this.code,".").concat(e.toUpperCase()),"padding-left: 45%; color:#FFC107;"),console.table(this.gene[e])}},{key:"getFlows",value:function(){return this.flows}},{key:"getGene",value:function(){return this.gene}},{key:"toString",value:function(){var e="";for(var t in this.gene){var r=this.gene[t];for(var n in r)e+="".concat(t,".").concat(n,": ").concat(r[n].toString(),"  ")}return e}}]),e}(),R=function(){function e(){var t=this;Object(s["a"])(this,e),Object(o["a"])(this,"genes",{}),Object(o["a"])(this,"flows",{}),Object(o["a"])(this,"lastFlowDate","");var r=parent.location.hash||location.hash,n=r.includes("#9529");setTimeout(Object(c["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n){e.next=6;break}return console.info("#Genes# force download start ..."),e.next=4,t.download();case 4:return console.info("#Genes# force download end ..."),e.abrupt("return");case 6:return e.next=8,t.load();case 8:return e.next=10,t.update();case 10:case"end":return e.stop()}}),e)}))))}return Object(i["a"])(e,[{key:"load",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.keys();case 3:if(t=e.sent,t&&t.length){e.next=7;break}return console.log("#Genes# flows not exist!"),e.abrupt("return");case 7:return e.next=9,C.iterate((function(e,t){e&&(r.flows[t]=e)}));case 9:this.lastFlowDate=this.flows[D][0].date,console.info("#Genes# load flows ".concat(t.length," date ").concat(this.lastFlowDate," ...")),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](0),console.warn("#Genes# load flows fail ",e.t0);case 16:case"end":return e.stop()}}),e,this,[[0,13]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"save",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(t in this.flows)C.setItem(t,this.flows[t]);case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"download",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n,c,s,i,o;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,t=v["a"].getAllStockCodes(),t=[].concat(t,D),console.time("Genes Flows Download"),r=!0,n=!1,c=void 0,e.prev=7,s=t[Symbol.iterator]();case 9:if(r=(i=s.next()).done){e.next=19;break}return o=i.value,e.next=13,p["a"].captureFlows(o);case 13:return this.flows[o]=e.sent,e.next=16,Object(k["a"])(50);case 16:r=!0,e.next=9;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e["catch"](7),n=!0,c=e.t0;case 25:e.prev=25,e.prev=26,r||null==s["return"]||s["return"]();case 28:if(e.prev=28,!n){e.next=31;break}throw c;case 31:return e.finish(28);case 32:return e.finish(25);case 33:console.timeEnd("Genes Flows Download"),this.save(),e.next=40;break;case 37:e.prev=37,e.t1=e["catch"](0),console.warn("#Genes# download flows fail ",e.t1);case 40:case"end":return e.stop()}}),e,this,[[0,37],[7,21,25,33],[26,,28,32]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"update",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n,c,s,i,o,u,l,h,p,f;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,C.keys();case 2:if(t=e.sent,t&&t.length){e.next=6;break}return console.log("#Genes# flows not exist, update exit !"),e.abrupt("return");case 6:if(d["a"].isWeekend()){e.next=32;break}return e.next=9,d["a"].until("150000");case 9:console.info("#Genes# auto update daily ..."),r=b["a"].all(),n=y()().format("YYYYMMDD"),e.t0=a.a.keys(r);case 13:if((e.t1=e.t0()).done){e.next=31;break}if(c=e.t1.value,e.prev=15,s=r[c],i=s.name,o=s.price,u=s.change,l=s.netinflow,h=s.rate,p=this.flows[c][0],!(p&&+p.date>=+n)){e.next=20;break}return e.abrupt("continue",13);case 20:if(p.price!==o||p.rate!==h||p.netinflow!==l){e.next=22;break}return e.abrupt("continue",13);case 22:f=new g["a"]({code:c,name:i,date:n,price:o,change:u,netinflow:l,netinflowrate:h}),this.flows[c].unshift(f),this.flows[c].length>200&&(this.flows[c]=this.flows[c].slice(0,200)),e.next=29;break;case 27:e.prev=27,e.t2=e["catch"](15);case 29:e.next=13;break;case 31:this.save();case 32:case"end":return e.stop()}}),e,this,[[15,27]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"downloadDaily",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n,c,s,i;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=y()().format("YYYYMMDD"),r=y()().format("HHmmss"),n=y()().subtract(1,"day").format("YYYYMMDD"),1===+y()().day()&&(n=y()().subtract(3,"days").format("YYYYMMDD")),!(t===this.lastFlowDate||n<=this.lastFlowDate)){e.next=6;break}return e.abrupt("return");case 6:if(!(+r>=15e4)){e.next=8;break}return e.abrupt("return");case 8:if(d["a"].isWeekend()){e.next=17;break}return c=Math.floor(58*Math.random())+1,s="00".concat(c).slice(-2),i="07"+s+"00",console.info("#Genes# auto download daily at ".concat(i," ...")),e.next=15,d["a"].until(i);case 15:return e.next=17,this.download();case 17:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"has",value:function(e){return this.genes[e]}},{key:"gene",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.genes[t]){e.next=3;break}return e.next=3,this.capture(t);case 3:return e.abrupt("return",this.genes[t]);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r,n,c,s,i;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!this.has(t)){e.next=3;break}return e.abrupt("return",this.gene(t));case 3:return e.next=5,Promise.all([this.flows[t]||p["a"].captureFlows(t),p["a"].captureStock(t)]);case 5:return r=e.sent,n=Object(h["a"])(r,2),c=n[0],s=n[1],e.next=11,new Y(t,s,c).analyse();case 11:return i=e.sent,this.genes[t]=i,e.abrupt("return",i);case 16:e.prev=16,e.t0=e["catch"](0),console.warn("#Genes# capture fail ",t,e.t0);case 19:case"end":return e.stop()}}),e,this,[[0,16]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),F=new R;function M(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function _(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function L(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function P(e){return M(e)||_(e)||L()}var T=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[],values:[]};return Function.apply(void 0,P(t.keys).concat(['"use strict";return ('.concat(e,")")])).apply(void 0,P(t.values))},E=T,A=r("776f"),I=9.8,V=function(){function e(t){Object(s["a"])(this,e),this.config=t}return Object(i["a"])(e,[{key:"filter",value:function(){var e=Object(c["a"])(a.a.mark((function e(t,r){var n,c;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.code,r.name,r.price,r.change,r.rate,r.turnover,r.qrr,r.eps,r.bvps,r.roe,n=this.config.capture,c=A["D"].getIntervalKeys(),c.includes(t)&&(n=this.config.interval),e.next=6,this.filterOfList(r);case 6:if(e.sent){e.next=8;break}return e.abrupt("return",!1);case 8:if(![A["m"].key,A["g"].key].includes(t)){e.next=10;break}return e.abrupt("return",!0);case 10:if(!n.includes("base")){e.next=15;break}return e.next=13,this.isValidBase(r);case 13:if(e.sent){e.next=15;break}return e.abrupt("return",!1);case 15:if(!n.includes("fundamental")){e.next=20;break}return e.next=18,this.isValidFundamental(r);case 18:if(e.sent){e.next=20;break}return e.abrupt("return",!1);case 20:if(!n.includes("whitelist")){e.next=25;break}return e.next=23,this.isValidWhitelist(r);case 23:if(e.sent){e.next=25;break}return e.abrupt("return",!1);case 25:if(!n.includes("gene-analyse")){e.next=30;break}return e.next=28,this.isValidGeneAnalyse(r.code,r);case 28:if(e.sent){e.next=30;break}return e.abrupt("return",!1);case 30:return e.abrupt("return",!0);case 31:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"filterOfPreTrace",value:function(){var e=Object(c["a"])(a.a.mark((function e(t,r){var n,c,s,i,o,u,l,h,p,f,v,d,b,g,k,w;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.config.capture,n.includes("pre-trace")){e.next=3;break}return e.abrupt("return",!0);case 3:if(c=this.config.rule["pre-trace"],c){e.next=6;break}return e.abrupt("return",!0);case 6:s=Object.keys(t),i=0,o=s;case 8:if(!(i<o.length)){e.next=22;break}if(u=o[i],![A["m"].key,A["g"].key].includes(u)){e.next=12;break}return e.abrupt("continue",19);case 12:if(l=t[u],h=r[u],l&&h){e.next=16;break}return e.abrupt("continue",19);case 16:for(v in p=l.getStocks(),f=h.getStocks(),p)for(g in d=p[v],b=f[v],c)k=(b[g]-d[g])/d[g],w="".concat(k).concat(c[g]),E(w)||(console.info("#Validator# filter stock of PreTrace",u,d.code,d.name,d.price,d.change,g,"[ ",b[g]," - ",d[g],c[g]," ]"),delete p[v]);case 19:i++,e.next=8;break;case 22:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"check",value:function(e,t,r,n){if(!e)return!0;try{for(var a=Object.keys(e),c=0,s=a;c<s.length;c++){var i=s[c],o=E("data.".concat(i),{keys:["data"],values:[t]}),u="".concat(o).concat(e[i]);if(void 0!==o&&!E(u))return!1}}catch(l){}return!0}},{key:"isFullRequiredFields",value:function(e){var t=new l["a"]({});for(var r in t)if(!e.hasOwnProperty(r))return!1;return!0}},{key:"isValidBase",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.code,n=t.name,t.price,t.change,t.rate,t.turnover,t.qrr,e.abrupt("return",this.check(this.config.rule.base,t,r,n));case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"isValidWhitelist",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.code,t.name,v["a"].has(r)){e.next=3;break}return e.abrupt("return",!1);case 3:return e.abrupt("return",!0);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"isValidFundamental",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=this.config.rule.fundamental,r){e.next=3;break}return e.abrupt("return",!0);case 3:return e.abrupt("return",this.check(r,t,t.code,t.name));case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"isValidGeneAnalyse",value:function(){var e=Object(c["a"])(a.a.mark((function e(t,r){var n,c;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.config.rule["gene-analyse"],n){e.next=3;break}return e.abrupt("return",!0);case 3:return e.next=5,F.gene(t);case 5:return c=e.sent,e.next=8,c.isValidShortterm(r);case 8:if(e.sent){e.next=10;break}return e.abrupt("return",!1);case 10:return e.abrupt("return",this.check(n,c,c.code,c.name));case 11:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"filterOfList",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r,n,c,s;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.code,n=t.name,c=t.price,s=t.change,t.rate,t.turnover,t.qrr,!(s>I||c<=0)){e.next=3;break}return e.abrupt("return",!1);case 3:return e.abrupt("return",this.isValidStock(r,n));case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"isValidStock",value:function(){var e=Object(c["a"])(a.a.mark((function e(t,r){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r.toUpperCase().includes("ST")){e.next=2;break}return e.abrupt("return",!1);case 2:if(!r.includes("退")){e.next=4;break}return e.abrupt("return",!1);case 4:if(!r.match(/\d+/g)){e.next=6;break}return e.abrupt("return",!1);case 6:if(!"".concat(t).startsWith("688")&&!"".concat(t).startsWith("300")){e.next=8;break}return e.abrupt("return",!1);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}(),B=(r("4e82"),r("5319"),r("07ac"),r("e1a7")),U=r("f20d"),G=r("920b"),H=r("32d2"),W=function(){function e(t,r){Object(s["a"])(this,e),Object(o["a"])(this,"name",void 0),Object(o["a"])(this,"color",void 0),Object(o["a"])(this,"toastType",{red:"error",orange:"warning",yellow:"info",green:"success"}),this.name=t,this.color=r}return Object(i["a"])(e,[{key:"filter",value:function(){var e=Object(c["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(c["a"])(a.a.mark((function e(t,r){var n,s,i,o,u,l,h,f,v,d,b,g,k,w,y,x;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=this.toastType[this.color],s={},H["a"].clear(n),i=!0,o=!1,u=void 0,e.prev=6,l=t[Symbol.iterator]();case 8:if(i=(h=l.next()).done){e.next=32;break}if(f=h.value,v=f,d=v.code,b=v.name,g=v.price,k=v.change,w=v.netinflow,y=v.rate,v.eps,v.bvps,v.roe,v.turnover,v.qrr,r.isFullRequiredFields(f)){e.next=15;break}return e.next=14,p["a"].captureStock(f.code);case 14:f=e.sent;case 15:return e.next=17,r.filter(this.name,f);case 17:if(e.sent){e.next=19;break}return e.abrupt("continue",29);case 19:return e.next=21,this.filter(f);case 21:if(e.sent){e.next=23;break}return e.abrupt("continue",29);case 23:if(console.log("#Digger# capture ".concat(this.name," stock"),d,b,k,y,w),x="".concat(this.name," Stock").toUpperCase(),H["a"].confirm("".concat(d," ").concat(b," ").concat(g," ").concat(k,"%"),x,Object(c["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),{type:n,timeOut:5e3,extendedTimeOut:5e3}),!s[d]){e.next=28;break}return e.abrupt("continue",29);case 28:s[d]=f;case 29:i=!0,e.next=8;break;case 32:e.next=38;break;case 34:e.prev=34,e.t0=e["catch"](6),o=!0,u=e.t0;case 38:e.prev=38,e.prev=39,i||null==l["return"]||l["return"]();case 41:if(e.prev=41,!o){e.next=44;break}throw u;case 44:return e.finish(41);case 45:return e.finish(38);case 46:return e.abrupt("return",Object.values(s));case 47:case"end":return e.stop()}}),e,this,[[6,34,38,46],[39,,41,45]])})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}(),K=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A["j"].key;return Object(s["a"])(this,t),Object(B["a"])(this,Object(U["a"])(t).call(this,e,"red"))}return Object(G["a"])(t,e),Object(i["a"])(t,[{key:"filter",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,F.gene(t.code);case 2:return r=e.sent,e.abrupt("return",r.isValidLimitup(t));case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),t}(W),q=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A["x"].key;return Object(s["a"])(this,t),Object(B["a"])(this,Object(U["a"])(t).call(this,e,"orange"))}return Object(G["a"])(t,e),Object(i["a"])(t,[{key:"filter",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,F.gene(t.code);case 2:return r=e.sent,e.abrupt("return",r.isValidRiseup(t));case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),t}(W),N=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A["w"].key;return Object(s["a"])(this,t),Object(B["a"])(this,Object(U["a"])(t).call(this,e,"yellow"))}return Object(G["a"])(t,e),Object(i["a"])(t,[{key:"filter",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,F.gene(t.code);case 2:return r=e.sent,e.abrupt("return",r.isValidRateup(t));case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),t}(W),J=function(){function e(){Object(s["a"])(this,e),Object(o["a"])(this,"limitUpDigger",new K),Object(o["a"])(this,"riseUpDigger",new q),Object(o["a"])(this,"rateUpDigger",new N),Object(o["a"])(this,"stocks",[])}return Object(i["a"])(e,[{key:"start",value:function(){var e=this;d["a"].interval(Object(c["a"])(a.a.mark((function t(){return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!b["a"].isRunning){t.next=7;break}return t.next=4,b["a"].list("netinflow");case 4:e.stocks=t.sent,t.next=10;break;case 7:return t.next=9,p["a"].captureList(A["t"].key);case 9:e.stocks=t.sent;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),console.warn("#diggers# capture fail",t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])}))),void 0,50,"diggers")}},{key:"list",value:function(e,t){var r,n=(r={},Object(o["a"])(r,A["j"].key,this.limitUpDigger),Object(o["a"])(r,A["x"].key,this.riseUpDigger),Object(o["a"])(r,A["w"].key,this.rateUpDigger),r);return n[e].capture(this.stocks,t)}}]),e}(),X=new J,z=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s["a"])(this,e),Object(o["a"])(this,"stocks",{}),this.stocks=t}return Object(i["a"])(e,[{key:"getStocks",value:function(){return this.stocks}},{key:"setStocks",value:function(e){this.stocks=e}},{key:"getStockCodes",value:function(){return Object.keys(this.stocks)}},{key:"clone",value:function(){var t=Object.assign({},t);return new e(t)}},{key:"merge",value:function(e){for(var t in e.stocks){Object.keys(this.stocks).length;this.stocks[t]||(this.stocks[t]=e.stocks[t])}}},{key:"recover",value:function(e){return this.stocks=e.stocks,this}},{key:"get",value:function(e){return this.stocks[e]}},{key:"upsert",value:function(e){this.stocks[e.code]=e}},{key:"remove",value:function(e){delete this.stocks[e]}}]),e}(),Q=r("21a6"),Z=r.n(Q),$=function(){function e(t,r){Object(s["a"])(this,e),Object(o["a"])(this,"oldlist",void 0),Object(o["a"])(this,"newlist",void 0),Object(o["a"])(this,"openChange",void 0),Object(o["a"])(this,"closeChange",void 0),this.oldlist=t,this.newlist=r,this.calc()}return Object(i["a"])(e,[{key:"calc",value:function(){var e=this.oldlist.getStockCodes(),t=0,r=0,n=!0,a=!1,c=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var o=s.value;0!==this.newlist.get(o).price?(t+=(this.newlist.get(o).price-this.oldlist.get(o).price)/this.oldlist.get(o).price,r+=(this.newlist.get(o).open-this.oldlist.get(o).price)/this.oldlist.get(o).price):console.info("#Statement# suspension stock consider as change 0% ...",o,this.newlist.get(o).name)}}catch(u){a=!0,c=u}finally{try{n||null==i["return"]||i["return"]()}finally{if(a)throw c}}this.closeChange=(100*t).toFixed(2),this.openChange=(100*r).toFixed(2)}},{key:"getOpenChange",value:function(){return this.openChange}},{key:"getCloseChange",value:function(){return this.closeChange}},{key:"getChange",value:function(){return this.closeChange}},{key:"getProfit",value:function(e){return(this.closeChange*e).toFixed(2)}}]),e}(),ee=m.a.createInstance({name:"trace",driver:m.a.INDEXEDDB}),te=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{isToday:!1};Object(s["a"])(this,e),Object(o["a"])(this,"isToday",void 0),Object(o["a"])(this,"rule",void 0),Object(o["a"])(this,"listController",void 0),Object(o["a"])(this,"oldlists",void 0),Object(o["a"])(this,"newlists",void 0),Object(o["a"])(this,"openChanges",{}),Object(o["a"])(this,"closeChanges",{}),this.rule=r,this.listController=t,this.isToday=n.isToday,this.deprecated()}return Object(i["a"])(e,[{key:"start",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{d["a"].interval(Object(c["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("#StatementController# capture start ..."),e.next=3,t.capture();case 3:console.log("#StatementController# capture end ...");case 4:case"end":return e.stop()}}),e)}))),this.rule.trace)}catch(r){console.warn("#StatementController# ",r)}case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"deprecated",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n,c,s,i,o,u;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ee.keys();case 2:if(t=e.sent,!(t.length<200)){e.next=5;break}return e.abrupt("return");case 5:r=!0,n=!1,c=void 0,e.prev=8,s=t[Symbol.iterator]();case 10:if(r=(i=s.next()).done){e.next=22;break}return o=i.value,e.next=14,ee.length();case 14:if(u=e.sent,!(u<200)){e.next=17;break}return e.abrupt("break",22);case 17:return e.next=19,ee.removeItem(o);case 19:r=!0,e.next=10;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e["catch"](8),n=!0,c=e.t0;case 28:e.prev=28,e.prev=29,r||null==s["return"]||s["return"]();case 31:if(e.prev=31,!n){e.next=34;break}throw c;case 34:return e.finish(31);case 35:return e.finish(28);case 36:case"end":return e.stop()}}),e,null,[[8,24,28,36],[29,,31,35]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"save",value:function(){var e=Object(c["a"])(a.a.mark((function e(t,r){var n,c,s,i,o;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=y()().format("YYYYMMDD"),e.next=3,ee.getItem(n);case 3:for(s in c=e.sent,c||(c={}),c[t]||(c[t]={}),c[t].change||(c[t].change={}),r.change)c[t].change[s]||(c[t].change[s]=[]),i=y()().format("HH:mm"),o=r.change[s],c[t].change[s].unshift(o,i);return c[t].trace=r.trace,c[t].capture=r.capture,e.abrupt("return",ee.setItem(n,c));case 11:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r,n,c,s;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.newlists=null,this.oldlists=null,!t){e.next=6;break}this.oldlists=t,e.next=15;break;case 6:if(!this.isToday){e.next=12;break}return e.next=9,this.listController.getTodayLists();case 9:this.oldlists=e.sent,e.next=15;break;case 12:return e.next=14,this.listController.getYesterdayLists();case 14:this.oldlists=e.sent;case 15:if(this.oldlists){e.next=17;break}return e.abrupt("return");case 17:this.newlists={},r=Object.keys(this.oldlists),n=0,c=r;case 20:if(!(n<c.length)){e.next=36;break}if(s=c[n],e.prev=22,A["D"].get(s)){e.next=25;break}return e.abrupt("continue",33);case 25:return e.next=27,this.captureList(this.oldlists[s]);case 27:this.newlists[s]=e.sent,e.next=33;break;case 30:e.prev=30,e.t0=e["catch"](22),console.warn("#StatementController# ",e.t0);case 33:n++,e.next=20;break;case 36:return this.calc(),this.broadcast(),e.abrupt("return",this.newlists);case 39:case"end":return e.stop()}}),e,this,[[22,30]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"calc",value:function(){if(this.newlists)for(var e=Object.keys(this.newlists),t=0,r=e;t<r.length;t++){var n=r[t],a=new $(this.oldlists[n],this.newlists[n]);this.closeChanges[n]=a.getCloseChange(),this.openChanges[n]=a.getOpenChange()}}},{key:"broadcast",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n,c,s,i,o;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(t=(this.isToday?"T0-".concat(this.rule.name):this.rule.name).toLowerCase(),r={name:t,change:{},trace:{},capture:{}},n=Object.keys(this.newlists),c=0,s=n;c<s.length;c++)i=s[c],o=A["D"].name(i),r.change[o]=this.closeChanges[i],r.trace[o]=this.newlists[i].getStocks(),r.capture[o]=this.oldlists[i].getStocks();return e.next=6,this.save(t,r);case 6:window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Trace_Event",{detail:r}));case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"captureList",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r,n,c;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=new z,n=Object.keys(t.getStocks()),e.next=4,p["a"].captureStocks(n);case 4:return c=e.sent,r.setStocks(c),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"downloadAll",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n,c;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.newlists){e.next=2;break}return e.abrupt("return");case 2:t=Object.keys(this.newlists),r=0,n=t;case 4:if(!(r<n.length)){e.next=13;break}return c=n[r],e.next=8,this.download(c);case 8:return e.next=10,Object(k["a"])(500);case 10:r++,e.next=4;break;case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"listsStringify",value:function(e,t,r){var n="{\n";n+='\t"'.concat(r,'": [ ');for(var a=this.oldlists[e].getStocks(),c=0,s=Object.values(a);c<s.length;c++){var i=s[c];n+="\n\t\t"+JSON.stringify(i,null,null)+","}n=n.slice(0,-1),n+="\n\t],\n",n+='\t"'.concat(t,'": [ ');for(var o=this.newlists[e].getStocks(),u=0,l=Object.values(o);u<l.length;u++){var h=l[u];n+="\n\t\t"+JSON.stringify(h,null,null)+","}return n=n.slice(0,-1),n+="\n\t]",n+="\n}",n}},{key:"download",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r,n,c,s,i,o,u,l,h,p,f;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=A["D"].name(t),n=this.closeChanges[t],c=this.openChanges[t],s=y()().format("YYYYMMDD"),i=y()().format("HHmmss"),o=y()().subtract(1,"day").format("YYYYMMDD"),u=y()().subtract(2,"days").format("YYYYMMDD"),1===+y()().day()?(o=y()().subtract(3,"days").format("YYYYMMDD"),u=y()().subtract(4,"days").format("YYYYMMDD")):2===+y()().day()&&(u=y()().subtract(4,"days").format("YYYYMMDD")),l="",l=A["g"].key===t?this.listsStringify(t,s,u):this.listsStringify(t,s,o),h=this.rule.name.replace(":",""),p="".concat(h,"@").concat(r,"-").concat(s,"-").concat(i,"-开盘%").concat(c,"-涨跌%").concat(n,".json"),f=new Blob([l],{type:"application/json;charset=utf-8"}),e.abrupt("return",Z.a.saveAs(f,p));case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),re=m.a.createInstance({name:"capture",driver:m.a.INDEXEDDB}),ne=10,ae=function(){function e(t,r){Object(s["a"])(this,e),Object(o["a"])(this,"rule",void 0),Object(o["a"])(this,"validator",void 0),Object(o["a"])(this,"lists",void 0),Object(o["a"])(this,"listKeys",void 0),Object(o["a"])(this,"statement",void 0),Object(o["a"])(this,"t0Statement",void 0),this.rule=t,this.validator=r,this.statement=new te(this,t),this.t0Statement=new te(this,t,{isToday:!0}),this.listKeys=t.interval?A["D"].getIntervalKeys():A["D"].getNormalKeys(),this.reset(),this.deprecated()}return Object(i["a"])(e,[{key:"all",value:function(){return this.lists}},{key:"get",value:function(e){return this.lists[e]}},{key:"ignore",value:function(e,t){var r=A["D"].keyOf(e);this.lists[r]&&(this.lists[r].remove("".concat(t)),this.save())}},{key:"load",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r,n,c,s;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=y()().format("YYYYMMDD"),t=t||r,n=this.rule.name,e.next=5,re.getItem(t);case 5:if(c=e.sent,c){e.next=9;break}return console.log("#ListController# ".concat(t," lists not exist!")),e.abrupt("return");case 9:if(c[n]){e.next=12;break}return console.log("#ListController# ".concat(t,"-").concat(n," lists not exist!")),e.abrupt("return");case 12:return s=this.recover(c[n]),t===r&&(this.lists=s),e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getTodayLists",value:function(){var e=Object(c["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.load(y()().format("YYYYMMDD")));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getYesterdayLists",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=y()().subtract(1,"day").format("YYYYMMDD"),1===+y()().day()&&(t=y()().subtract(3,"days").format("YYYYMMDD")),e.abrupt("return",this.load(t));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"recover",value:function(e){for(var t in e)e[t]=(new z).recover(e[t]);return e}},{key:"deprecated",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n,c,s,i,o,u;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,re.keys();case 2:if(t=e.sent,!(t.length<10)){e.next=5;break}return e.abrupt("return");case 5:r=!0,n=!1,c=void 0,e.prev=8,s=t[Symbol.iterator]();case 10:if(r=(i=s.next()).done){e.next=22;break}return o=i.value,e.next=14,re.length();case 14:if(u=e.sent,!(u<10)){e.next=17;break}return e.abrupt("break",22);case 17:return e.next=19,re.removeItem(o);case 19:r=!0,e.next=10;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e["catch"](8),n=!0,c=e.t0;case 28:e.prev=28,e.prev=29,r||null==s["return"]||s["return"]();case 31:if(e.prev=31,!n){e.next=34;break}throw c;case 34:return e.finish(31);case 35:return e.finish(28);case 36:case"end":return e.stop()}}),e,null,[[8,24,28,36],[29,,31,35]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"save",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=y()().format("YYYYMMDD"),r=this.rule.name,e.next=4,re.getItem(t);case 4:return n=e.sent,n||(n={}),n[r]=this.lists,e.abrupt("return",re.setItem(t,n));case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"reset",value:function(){var e=this.listKeys;this.lists={};var t=!0,r=!1,n=void 0;try{for(var a,c=e[Symbol.iterator]();!(t=(a=c.next()).done);t=!0){var s=a.value;this.lists[s]=new z}}catch(i){r=!0,n=i}finally{try{t||null==c["return"]||c["return"]()}finally{if(r)throw n}}}},{key:"createHotStocksList",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n,c,s,i,o,u,l,h,p,f,v,d,b,g,k,w,y,x,m,O;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(t=this.listKeys,r={},n={},c=[],s=0,i=!0,o=!1,u=void 0,e.prev=8,l=t[Symbol.iterator]();!(i=(h=l.next()).done);i=!0)for(d in p=h.value,f=this.lists[p],v=f.getStocks(),Object.assign(r,v),v)b=v[d],c[d]||(c[d]={name:b.name,count:0}),c[d].count++;e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](8),o=!0,u=e.t0;case 16:e.prev=16,e.prev=17,i||null==l["return"]||l["return"]();case 19:if(e.prev=19,!o){e.next=22;break}throw u;case 22:return e.finish(19);case 23:return e.finish(16);case 24:for(g=Object.keys(c).sort((function(e,t){return c[t].count-c[e].count})),k=!0,w=!1,y=void 0,e.prev=28,x=g[Symbol.iterator]();!(k=(m=x.next()).done);k=!0)O=m.value,c[O].count>=3&&s<ne&&(n[O]=Object.assign({},r[O],{hot:c[O].count}),s++);e.next=36;break;case 32:e.prev=32,e.t1=e["catch"](28),w=!0,y=e.t1;case 36:e.prev=36,e.prev=37,k||null==x["return"]||x["return"]();case 39:if(e.prev=39,!w){e.next=42;break}throw y;case 42:return e.finish(39);case 43:return e.finish(36);case 44:console.log("#ListController# list capture hot stcoks: ",n),console.table(c),this.lists[A["h"].key].setStocks(n);case 47:case"end":return e.stop()}}),e,this,[[8,12,16,24],[17,,19,23],[28,32,36,44],[37,,39,43]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"start",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.rule.interval?void 0:[this.rule.capture],e.prev=1,e.next=4,this.load();case 4:d["a"].interval(Object(c["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("#ListController# list capture start ..."),e.next=3,r.capture();case 3:r.rule.interval||(console.info("=================================================="),console.info("#ListController# today list capture [".concat(r.rule.name,"] at ").concat(y()().format("HH:mm:ss"),": "),r.lists),console.info("==================================================")),console.log("#ListController# list capture end ...");case 5:case"end":return e.stop()}}),e)}))),t,this.rule.interval),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),console.warn("#ListController# ",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"captureList",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r,n,c,s,i,o,u,l,h,f,v,d;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=A["D"].getIntervalKeys(),n=[],!r.includes(t)){e.next=8;break}return e.next=5,X.list(t,this.validator);case 5:n=e.sent,e.next=11;break;case 8:return e.next=10,p["a"].captureList(t);case 10:n=e.sent;case 11:if(n.length){e.next=13;break}return e.abrupt("return",new z);case 13:c={},s=0,i=!0,o=!1,u=void 0,e.prev=17,l=n[Symbol.iterator]();case 19:if(i=(h=l.next()).done){e.next=42;break}if(f=h.value,v=f,d=v.code,v.name,v.change,r.includes(t)){e.next=31;break}if(this.validator.isFullRequiredFields(f)){e.next=27;break}return e.next=26,p["a"].captureStock(d);case 26:f=e.sent;case 27:return e.next=29,this.validator.filter(t,f);case 29:if(e.sent){e.next=31;break}return e.abrupt("continue",39);case 31:if(!c[d]){e.next=33;break}return e.abrupt("continue",39);case 33:if(!(f.price<=0||f.change>9.8)){e.next=35;break}return e.abrupt("continue",39);case 35:if(c[d]=f,s++,s!==ne){e.next=39;break}return e.abrupt("break",42);case 39:i=!0,e.next=19;break;case 42:e.next=48;break;case 44:e.prev=44,e.t0=e["catch"](17),o=!0,u=e.t0;case 48:e.prev=48,e.prev=49,i||null==l["return"]||l["return"]();case 51:if(e.prev=51,!o){e.next=54;break}throw u;case 54:return e.finish(51);case 55:return e.finish(48);case 56:return console.log("#ListController# capture list ".concat(t," "),c),e.abrupt("return",new z(c));case 58:case"end":return e.stop()}}),e,this,[[17,44,48,56],[49,,51,55]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n,s,i,o,u=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=Object.keys(this.lists),r=0,n=t;case 2:if(!(r<n.length)){e.next=21;break}if(s=n[r],e.prev=4,s!==A["h"].key){e.next=7;break}return e.abrupt("continue",18);case 7:return e.next=9,this.captureList(s);case 9:return i=e.sent,this.lists[s].merge(i),e.next=13,Object(k["a"])(500);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](4),console.warn("#ListController# ",e.t0);case 18:r++,e.next=2;break;case 21:if(e.prev=21,!this.rule.interval){e.next=29;break}return e.next=25,this.t0Statement.capture(this.lists);case 25:return this.broadcast(),e.next=28,this.save();case 28:return e.abrupt("return");case 29:return o={},this.createHotStocksList(),this.broadcast(),e.next=34,this.save();case 34:setTimeout(Object(c["a"])(a.a.mark((function e(){var t,r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=0,r=[1,2,3];case 1:if(!(t<r.length)){e.next=12;break}return n=r[t],e.next=5,u.t0Statement.capture(u.lists);case 5:return o=e.sent,console.log("#ListController# [".concat(u.rule.name,"] t0Statement pre-trace ").concat(n," "),o),e.next=9,Object(k["a"])(6e4);case 9:t++,e.next=1;break;case 12:return e.next=14,u.validator.filterOfPreTrace(u.lists,o);case 14:return u.broadcast(),e.next=17,u.save();case 17:case"end":return e.stop()}}),e)})))),e.next=40;break;case 37:e.prev=37,e.t1=e["catch"](21),console.warn("#ListController# ",e.t1);case 40:case"end":return e.stop()}}),e,this,[[4,15],[21,37]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"broadcast",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n,c,s,i;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(t={name:this.rule.name,lists:{}},r=Object.keys(this.lists),n=0,c=r;n<c.length;n++)s=c[n],i=A["D"].name(s),this.lists[s]&&(t.lists[i]=this.lists[s].getStocks());window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Capture_Event",{detail:t}));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"downloadAll",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n,c;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=Object.keys(this.lists),r=0,n=t;case 2:if(!(r<n.length)){e.next=11;break}return c=n[r],e.next=6,this.download(c);case 6:return e.next=8,Object(k["a"])(500);case 8:r++,e.next=2;break;case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"download",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r,n,c,s,i,o;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=y()().format("YYYYMMDD"),n=y()().format("HHmmss"),c=A["D"].name(t),s=this.rule.name.replace(":",""),i="".concat(s,"@").concat(c,"-").concat(r,"-").concat(n,".json"),o=new Blob([JSON.stringify(this.lists[t],null,"\t")],{type:"application/json;charset=utf-8"}),e.abrupt("return",Z.a.saveAs(o,i));case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}();function ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ie=function(){function e(){Object(s["a"])(this,e),Object(o["a"])(this,"listControllers",[]),this.clearTempCapture();var t=[].concat(f["a"].captures||[],f["a"].temps||[],f["a"].intervals||[]),r=f["a"].validators,n=!0,a=!1,c=void 0;try{for(var i,l=t[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var h=i.value,p=!0,v=!1,d=void 0;try{for(var b,g=r[Symbol.iterator]();!(p=(b=g.next()).done);p=!0){var k=b.value,w="".concat(h.capture,"-").concat(k.name).toLowerCase(),y=new u(se({},h,{name:w})),x=new V(k),m=new ae(y,x);this.listControllers.push(m)}}catch(O){v=!0,d=O}finally{try{p||null==g["return"]||g["return"]()}finally{if(v)throw d}}}}catch(O){a=!0,c=O}finally{try{n||null==l["return"]||l["return"]()}finally{if(a)throw c}}}return Object(i["a"])(e,[{key:"capture",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n,c,s,i,o;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,t=y()().format("YYYYMMDD"),r=!0,n=!1,c=void 0,e.prev=5,s=this.listControllers[Symbol.iterator]();case 7:if(r=(i=s.next()).done){e.next=16;break}if(o=i.value,!o.rule.date||o.rule.date===t){e.next=12;break}return console.log("#controllers# ignore temp capture rule ",o.rule.capture,o.rule.date),e.abrupt("continue",13);case 12:o.start();case 13:r=!0,e.next=7;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](5),n=!0,c=e.t0;case 22:e.prev=22,e.prev=23,r||null==s["return"]||s["return"]();case 25:if(e.prev=25,!n){e.next=28;break}throw c;case 28:return e.finish(25);case 29:return e.finish(22);case 30:e.next=35;break;case 32:e.prev=32,e.t1=e["catch"](0),console.warn("#controllers# capture",e.t1);case 35:case"end":return e.stop()}}),e,this,[[0,32],[5,18,22,30],[23,,25,29]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"trace",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n,c,s,i;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(e.prev=0,t=!0,r=!1,n=void 0,e.prev=4,c=this.listControllers[Symbol.iterator]();!(t=(s=c.next()).done);t=!0)i=s.value,i.statement.start();e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](4),r=!0,n=e.t0;case 12:e.prev=12,e.prev=13,t||null==c["return"]||c["return"]();case 15:if(e.prev=15,!r){e.next=18;break}throw n;case 18:return e.finish(15);case 19:return e.finish(12);case 20:e.next=25;break;case 22:e.prev=22,e.t1=e["catch"](0),console.warn("#controllers# trace ",e.t1);case 25:case"end":return e.stop()}}),e,this,[[0,22],[4,8,12,20],[13,,15,19]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"traceOnly",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=window.__Walle_Bot_Debug,r=t?120:300;try{d["a"].interval(Object(c["a"])(a.a.mark((function e(){var t,r,c,s,i,o;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=!0,r=!1,c=void 0,e.prev=3,s=n.listControllers[Symbol.iterator]();case 5:if(t=(i=s.next()).done){e.next=14;break}return o=i.value,e.next=9,o.statement.capture();case 9:return e.next=11,o.t0Statement.capture();case 11:t=!0,e.next=5;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](3),r=!0,c=e.t0;case 20:e.prev=20,e.prev=21,t||null==s["return"]||s["return"]();case 23:if(e.prev=23,!r){e.next=26;break}throw c;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}}),e,null,[[3,16,20,28],[21,,23,27]])}))),null,r)}catch(s){console.warn("#controllers# traceOnly ",s)}case 3:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"clearTempCapture",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n,c,s,i,o,u;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(f["a"].temps){e.next=2;break}return e.abrupt("return");case 2:if(f["a"].temps.length){e.next=4;break}return e.abrupt("return");case 4:for(t=[],r=y()().subtract(2,"days").format("YYYYMMDD"),1!==+y()().day()&&2!==+y()().day()||(r=y()().subtract(4,"days").format("YYYYMMDD")),n=!0,c=!1,s=void 0,e.prev=10,i=f["a"].temps[Symbol.iterator]();!(n=(o=i.next()).done);n=!0)u=o.value,+u.date>r&&t.push(u);e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](10),c=!0,s=e.t0;case 18:e.prev=18,e.prev=19,n||null==i["return"]||i["return"]();case 21:if(e.prev=21,!c){e.next=24;break}throw s;case 24:return e.finish(21);case 25:return e.finish(18);case 26:f["a"].temps=t;case 27:case"end":return e.stop()}}),e,null,[[10,14,18,26],[19,,21,25]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"setTempCapture",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=y()().format("YYYYMMDD"),r=y()().add(1,"minutes").format("HH:mm"),n=new u({capture:r,trace:["14:40"],date:t}),f["a"].temps=[].concat(f["a"].temps,n);case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"removeTempCapture",value:function(){var e=Object(c["a"])(a.a.mark((function e(t,r){var n,c,s,i,o,u,l;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=[],c=!0,s=!1,i=void 0,e.prev=4,o=f["a"].temps[Symbol.iterator]();case 6:if(c=(u=o.next()).done){e.next=14;break}if(l=u.value,l.capture!==t||l.date!==r){e.next=10;break}return e.abrupt("continue",11);case 10:n.push(l);case 11:c=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](4),s=!0,i=e.t0;case 20:e.prev=20,e.prev=21,c||null==o["return"]||o["return"]();case 23:if(e.prev=23,!s){e.next=26;break}throw i;case 26:return e.finish(23);case 27:return e.finish(20);case 28:f["a"].temps=n;case 29:case"end":return e.stop()}}),e,null,[[4,16,20,28],[21,,23,27]])})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"ignore",value:function(){var e=Object(c["a"])(a.a.mark((function e(t,r,n,c){var s,i,o,u,l,h,p,f;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(s=!0,i=!1,o=void 0,e.prev=3,u=this.listControllers[Symbol.iterator]();!(s=(l=u.next()).done);s=!0)h=l.value,p=h.rule,f=h.validator.config,p.capture===t&&f.name===r&&h.ignore(n,c);e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](3),i=!0,o=e.t0;case 11:e.prev=11,e.prev=12,s||null==u["return"]||u["return"]();case 14:if(e.prev=14,!i){e.next=17;break}throw o;case 17:return e.finish(14);case 18:return e.finish(11);case 19:case"end":return e.stop()}}),e,this,[[3,7,11,19],[12,,14,18]])})));function t(t,r,n,a){return e.apply(this,arguments)}return t}()}]),e}(),oe=new ie,ue=r("5ca6"),le=r.n(ue),he=r("1157"),pe=r.n(he),fe=function(){function e(){var t=this;Object(s["a"])(this,e),Object(o["a"])(this,"keycodes",{}),pe()(document).keydown((function(e){if(e.ctrlKey){var r=Object.keys(t.keycodes);r.includes(e.code)&&(t.fire(e.code),e.preventDefault())}}))}return Object(i["a"])(e,[{key:"listen",value:function(e,t){if(this.keycodes[e])throw Error("Shortcut ".concat(e," Exist"));this.keycodes[e]=t}},{key:"fire",value:function(e){try{this.keycodes[e]()}catch(t){}}}]),e}(),ve=new fe,de="walle-stocks-trace.json",be="walle-stocks-capture.json",ge="walle-stocks-storage.json",ke="walle-stocks-gene.json",we=function(){function e(){var t=this;Object(s["a"])(this,e),ve.listen("KeyB",(function(){var e={timeOut:3e3,extendedTimeOut:3e3,closeButton:!0,positionClass:"toast-bottom-left"};H["a"].clear(),H["a"].confirm("click to backup trace file","BACKUP",(function(){return t.trace()}),e),H["a"].confirm("click to backup capture file","BACKUP",(function(){return t.capture()}),e),H["a"].confirm("click to backup gene file","BACKUP",(function(){return t.gene()}),e),H["a"].confirm("click to backup storage file","BACKUP",(function(){return t.storage()}),e)}))}return Object(i["a"])(e,[{key:"download",value:function(){var e=Object(c["a"])(a.a.mark((function e(t,r){var n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new Blob([JSON.stringify(r,null,"\t")],{type:"application/json;charset=utf-8"}),e.abrupt("return",Z.a.saveAs(n,t));case 2:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"trace",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,ee.iterate((function(e,r){t[r]=e}));case 4:return e.next=6,this.download(de,t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,re.iterate((function(e,r){t[r]=e}));case 4:return e.next=6,this.download(be,t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"gene",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,C.iterate((function(e,r){t[r]=e}));case 4:return e.next=6,this.download(ke,t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"storage",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,m.a.iterate((function(e,r){t[r]=e}));case 4:return e.next=6,this.download(ge,t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"all",value:function(){var e=Object(c["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.storage();case 2:return e.next=4,this.capture();case 4:return e.next=6,this.gene();case 6:return e.next=8,this.trace();case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),ye=function(){function e(){var t=this;Object(s["a"])(this,e),ve.listen("KeyR",(function(){return t.upload()}))}return Object(i["a"])(e,[{key:"upload",value:function(){var e=Object(c["a"])(a.a.mark((function e(){var t,r=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=document.createElement("input"),t.type="file",t.multiple="multiple",t.onchange=function(){r.recover(t.files)},t.click();case 5:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"recover",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r,n,c,s,i,u,l,h,p,f,v=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,r={},Object(o["a"])(r,de,(function(e){return v.trace(e)})),Object(o["a"])(r,be,(function(e){return v.capture(e)})),Object(o["a"])(r,ke,(function(e){return v.gene(e)})),Object(o["a"])(r,ge,(function(e){return v.storage(e)})),n=r,c=!0,s=!1,i=void 0,e.prev=5,u=t[Symbol.iterator]();case 7:if(c=(l=u.next()).done){e.next=19;break}if(h=l.value,!n[h.name]){e.next=16;break}return e.next=12,h.text();case 12:return p=e.sent,f=JSON.parse(p),e.next=16,n[h.name](f);case 16:c=!0,e.next=7;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e["catch"](5),s=!0,i=e.t0;case 25:e.prev=25,e.prev=26,c||null==u["return"]||u["return"]();case 28:if(e.prev=28,!s){e.next=31;break}throw i;case 31:return e.finish(28);case 32:return e.finish(25);case 33:window.alert("Walle Recover Success ..."),e.next=40;break;case 36:e.prev=36,e.t1=e["catch"](0),console.info("#Recover# fail ",e.t1),window.alert("Walle Recover Fail, Try Aagin ...");case 40:case"end":return e.stop()}}),e,null,[[0,36],[5,21,25,33],[26,,28,32]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"trace",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.next=6,ee.setItem(r,t[r]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e["catch"](0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.next=6,re.setItem(r,t[r]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e["catch"](0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"gene",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.next=6,C.setItem(r,t[r]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e["catch"](0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"storage",value:function(){var e=Object(c["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.next=6,m.a.setItem(r,t[r]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e["catch"](0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),xe={backup:new we,recover:new ye};window.__Walle_Stock_Controller=oe,window.__Walle_Stock_Pool=b["a"],window.__Walle_Stock_Gene=F,window.__Walle_Stock_Crawler=p["a"],window.__Walle_Stock_Strategy=le.a,window.__Walle_Stock_Define=A["D"],window.__Walle_Stock_Backup=xe,Object(c["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{b["a"].start(),X.start(),oe.capture(),oe.trace(),oe.traceOnly()}catch(t){console.warn("#loop# ",t)}case 1:case"end":return e.stop()}}),e)})))()},"466d":function(e,t,r){"use strict";var n=r("d784"),a=r("825a"),c=r("50c4"),s=r("1d80"),i=r("8aa5"),o=r("14c3");n("match",1,(function(e,t,r){return[function(t){var r=s(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,r):new RegExp(t)[e](String(r))},function(e){var n=r(t,e,this);if(n.done)return n.value;var s=a(e),u=String(this);if(!s.global)return o(s,u);var l=s.unicode;s.lastIndex=0;var h,p=[],f=0;while(null!==(h=o(s,u))){var v=String(h[0]);p[f]=v,""===v&&(s.lastIndex=i(u,c(s.lastIndex),l)),f++}return 0===f?null:p}]}))},"4de4":function(e,t,r){"use strict";var n=r("23e7"),a=r("b727").filter,c=r("d039"),s=r("1dde"),i=s("filter"),o=i&&!c((function(){[].filter.call({length:-1,0:1},(function(e){throw e}))}));n({target:"Array",proto:!0,forced:!i||!o},{filter:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},"5ca6":function(e,t,r){r("a4d3"),r("e01a"),r("d28b"),r("d3b7"),r("3ca3"),r("ddb0");var n=r("a34a"),a=r("9705");r("96cf");var c=r("12e9"),s=c.generate,i=[r("870f"),r("71cc"),r("6b86")];function o(e,t){return u.apply(this,arguments)}function u(){return u=a(n.mark((function e(t,r){var a,c,o,u,l,h,p,f,v,d,b,g,k,w,y;return n.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=s(t),e.prev=1,c=r.date,o=r.open,u=r.close,l=c.length,h=l-1;case 7:if(!(h>=0)){e.next=33;break}for(p=c[h],f=o[h],v=u[h],d=!0,b=!1,g=void 0,e.prev=14,k=i[Symbol.iterator]();!(d=(w=k.next()).done);d=!0)y=w.value,y.process(a,p,f,v);e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](14),b=!0,g=e.t0;case 22:e.prev=22,e.prev=23,d||null==k["return"]||k["return"]();case 25:if(e.prev=25,!b){e.next=28;break}throw g;case 28:return e.finish(25);case 29:return e.finish(22);case 30:h--,e.next=7;break;case 33:e.next=38;break;case 35:e.prev=35,e.t1=e["catch"](1),console.log("#strategy# analyse fail: ",e.t1);case 38:return e.abrupt("return",a);case 39:case"end":return e.stop()}}),e,null,[[1,35],[14,18,22,30],[23,,25,29]])}))),u.apply(this,arguments)}e.exports={analyse:o}},"6b86":function(e,t,r){r("b680");var n=r("870f"),a=r("71cc"),c=1,s=0,i=1e5;function o(e,t,r,o){var u=n.getPTCChange(r,o),l=a.isPeriodRest(t);l||(s=i/10*(u/100-.015),i+=s,c*=1+u/100*.1,e.profit["compound-interest"]=1e3*(c-1),e.profit["compound-interest"]=+e.profit["compound-interest"].toFixed(2),console.log("strategy-compound-interest-trade ".concat(t)," 当日涨幅:",u," 当日收益:",s," 累加收益:",i))}e.exports={process:o}},"6f53":function(e,t,r){var n=r("83ab"),a=r("df75"),c=r("fc6a"),s=r("d1e7").f,i=function(e){return function(t){var r,i=c(t),o=a(i),u=o.length,l=0,h=[];while(u>l)r=o[l++],n&&!s.call(i,r)||h.push(e?[r,i[r]]:i[r]);return h}};e.exports={entries:i(!0),values:i(!1)}},"71cc":function(e,t,r){r("b680");var n=r("870f"),a=2,c=0,s=!1;function i(e){return s}function o(e,t,r,i){var o=n.getPTCChange(r,i);if(i>=0?(c=0):(0,c++),c<a){s=!1,e.day.trade++,e.profit.strategy+=o,e.profit.strategy=+e.profit.strategy.toFixed(2),e["daily-open-ptcchange"].push(t,r),e["daily-close-ptcchange"].push(t,o);var u=e["daily-open-profit"].length,l=e["daily-close-profit"].length,h=e["daily-open-profit"][u-1]||0,p=e["daily-close-profit"][l-1]||0;h+=r,p+=o,h=+h.toFixed(2),p=+p.toFixed(2),e["daily-open-profit"].push(t,h),e["daily-close-profit"].push(t,p)}else s=!0,e.day.rest++,console.log("strategy-rest ".concat(t))}e.exports={isPeriodRest:i,process:o}},"7a82":function(e,t,r){var n=r("23e7"),a=r("83ab"),c=r("9bf2");n({target:"Object",stat:!0,forced:!a,sham:!a},{defineProperty:c.f})},"870f":function(e,t,r){r("99af"),r("b680");var n=-10;function a(e,t){return e<n?e:t<n?n:t}function c(e,t,r,a){var c=0;return r<n?(c=r,e.day["open-crash"]++,e.profit["open-crash"]+=c,e.profit["open-crash"]=+e.profit["open-crash"].toFixed(2),console.log("open-crash ".concat(t," open: ").concat(r," close: ").concat(a)),a>0&&(e.day["reverse-crash"]++,e.profit["reverse-crash"]+=a+-n,e.profit["reverse-crash"]=+e.profit["reverse-crash"].toFixed(2),console.log("reverse-crash ".concat(t," open: ").concat(r," close: ").concat(a)))):a<n?(c=n,e.day["stop-crash"]++,e.profit["stop-crash"]+=a+-n,e.profit["stop-crash"]=+e.profit["stop-crash"].toFixed(2),console.log("stop-crash ".concat(t," open: ").concat(r," close: ").concat(a))):c=a,a>=0?(e.day.up++,e.profit.max+=a,e.profit.max=+e.profit.max.toFixed(2)):e.day.down++,e.day.total++,e.profit.normal+=a,e.profit.normal=+e.profit.normal.toFixed(2),c}e.exports={process:c,getPTCChange:a}},9705:function(e,t){function r(e,t,r,n,a,c,s){try{var i=e[c](s),o=i.value}catch(u){return void r(u)}i.done?t(o):Promise.resolve(o).then(n,a)}function n(e){return function(){var t=this,n=arguments;return new Promise((function(a,c){var s=e.apply(t,n);function i(e){r(s,a,c,i,o,"next",e)}function o(e){r(s,a,c,i,o,"throw",e)}i(void 0)}))}}e.exports=n},dbb4:function(e,t,r){var n=r("23e7"),a=r("83ab"),c=r("56ef"),s=r("fc6a"),i=r("06cf"),o=r("8418");n({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(e){var t,r,n=s(e),a=i.f,u=c(n),l={},h=0;while(u.length>h)r=a(n,t=u[h++]),void 0!==r&&o(l,t,r);return l}})},e439:function(e,t,r){var n=r("23e7"),a=r("d039"),c=r("fc6a"),s=r("06cf").f,i=r("83ab"),o=a((function(){s(1)})),u=!i||o;n({target:"Object",stat:!0,forced:u,sham:!i},{getOwnPropertyDescriptor:function(e,t){return s(c(e),t)}})}}]);