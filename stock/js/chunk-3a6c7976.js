(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a6c7976"],{"0ae6":function(e,t,r){"use strict";r.r(t);var n=r("a34a"),a=r.n(n),s=(r("96cf"),r("1da1")),i=r("d4ec"),c=r("bee2"),o=(r("a4d3"),r("e01a"),r("d28b"),r("99af"),r("b0c0"),r("d3b7"),r("3ca3"),r("ddb0"),r("5530")),u=r("ade3"),l=function e(t){var r=t.capture,n=t.trace,a=t.interval,s=t.lists,c=t.date,o=t.name;Object(i["a"])(this,e),Object(u["a"])(this,"capture",void 0),Object(u["a"])(this,"trace",[]),Object(u["a"])(this,"interval",void 0),Object(u["a"])(this,"lists",void 0),Object(u["a"])(this,"date",void 0),Object(u["a"])(this,"name",void 0),this.capture=r,this.trace=n,this.interval=a,this.lists=s,this.name=o,this.date=c},h=(r("caad"),r("fb6a"),r("b64b"),r("ac1f"),r("2532"),r("466d"),r("2ca0"),r("0cae")),p=(r("4160"),r("0d03"),r("a9e3"),r("9129"),r("b680"),r("25f0"),r("1276"),r("159b"),r("3835")),f=r("90d5"),v=r("1797"),d=(r("4795"),r("1e4d")),b=r("9313"),k=r("2894"),m=r("a37f"),y=r("127d"),w=r("c1df"),x=r.n(w),g=r("a002"),O=r.n(g),j="1.000001",S=O.a.createInstance({name:"flow",driver:O.a.INDEXEDDB}),_=function(){function e(){var t=this;Object(i["a"])(this,e),Object(u["a"])(this,"keys",[]),Object(u["a"])(this,"lastFlowDate","");var r=parent.location.hash||location.hash,n=r.includes("9529");setTimeout(Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.load();case 2:if(!n){e.next=8;break}return console.info("#Flows# force download start ..."),e.next=6,t.download();case 6:return console.info("#Flows# force download end ..."),e.abrupt("return");case 8:return e.next=10,t.update();case 10:case"end":return e.stop()}}),e)}))))}return Object(c["a"])(e,[{key:"load",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.codes();case 3:if(this.keys&&this.keys.length){e.next=6;break}return console.log("#Flows# flows not exist!"),e.abrupt("return");case 6:return e.next=8,this.flow(j);case 8:t=e.sent,this.lastFlowDate=t[0].date,console.info("#Flows# load flows ".concat(this.keys.length," date ").concat(this.lastFlowDate," ...")),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](0),console.warn("#Flows# load flows fail ",e.t0);case 16:case"end":return e.stop()}}),e,this,[[0,13]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"save",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.length>300&&(r=r.slice(0,300)),e.abrupt("return",S.setItem(t,r));case 2:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"download",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c,o,u;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,t=[].concat(d["a"].stocks(),d["a"].bonds()),t=[].concat(t,j),console.time("Flows Download"),r=!0,n=!1,s=void 0,e.prev=7,i=t[Symbol.iterator]();case 9:if(r=(c=i.next()).done){e.next=28;break}if(o=c.value,e.prev=11,!this.keys.includes(o)){e.next=14;break}return e.abrupt("continue",25);case 14:return e.next=16,this.capture(o);case 16:return u=e.sent,e.next=19,this.save(o,u);case 19:return e.next=21,Object(y["a"])(50);case 21:e.next=25;break;case 23:e.prev=23,e.t0=e["catch"](11);case 25:r=!0,e.next=9;break;case 28:e.next=34;break;case 30:e.prev=30,e.t1=e["catch"](7),n=!0,s=e.t1;case 34:e.prev=34,e.prev=35,r||null==i["return"]||i["return"]();case 37:if(e.prev=37,!n){e.next=40;break}throw s;case 40:return e.finish(37);case 41:return e.finish(34);case 42:console.timeEnd("Flows Download"),e.next=48;break;case 45:e.prev=45,e.t2=e["catch"](0),console.warn("#Flows# download flows fail ",e.t2);case 48:case"end":return e.stop()}}),e,this,[[0,45],[7,30,34,42],[11,23],[35,,37,41]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"update",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c,o,u,l,h,p,f,v,d,y,w,g,O;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.keys&&this.keys.length){e.next=3;break}return console.log("#Flows# flows not exist, update exit !"),e.abrupt("return");case 3:if(t=x()().format("YYYYMMDD"),r=x()().format("HHmmss"),b["a"].isWeekend()||!(+r<15e4)){e.next=33;break}return e.next=8,b["a"].until("150000");case 8:console.info("#Flows# auto update daily ..."),n=k["a"].all(),e.t0=a.a.keys(n);case 11:if((e.t1=e.t0()).done){e.next=33;break}return s=e.t1.value,e.prev=13,i=n[s],c=i.name,o=i.price,u=i.change,l=i.netinflow,h=i.rate,p=i.open,f=i.close,v=i.high,d=i.low,y=i.volume,e.next=17,this.flow(s);case 17:if(w=e.sent,g=w[0],!(g&&+g.date>=+t)){e.next=21;break}return e.abrupt("continue",11);case 21:if(g.price!==o||g.rate!==h||g.netinflow!==l){e.next=23;break}return e.abrupt("continue",11);case 23:return O=new m["a"]({code:s,name:c,date:t,price:o,change:u,open:p,close:f,high:v,low:d,volume:y,netinflow:l,netinflowrate:h}),w.unshift(O),e.next=27,this.save(s,w);case 27:e.next=31;break;case 29:e.prev=29,e.t2=e["catch"](13);case 31:e.next=11;break;case 33:case"end":return e.stop()}}),e,this,[[13,29]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"codes",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.keys||!this.keys.length){e.next=2;break}return e.abrupt("return",this.keys);case 2:return e.next=4,S.keys();case 4:return t=e.sent,this.keys=t||[],e.abrupt("return",this.keys);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"has",value:function(e){return this.keys.includes(e)}},{key:"flow",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.has(t)){e.next=2;break}return e.abrupt("return",this.capture(t));case 2:return e.abrupt("return",S.getItem(t));case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"kline2flow",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r,n){var s,i,c,o,u,l,h,p,f,v,d,b,k,y,w,g,O,j,S,_,C,T,F,L;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(s=[],i={},c=null,o=!0,u=!1,l=void 0,e.prev=4,h=r[Symbol.iterator]();!(o=(p=h.next()).done);o=!0)f=p.value,i[f.date]=f;e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](4),u=!0,l=e.t0;case 12:e.prev=12,e.prev=13,o||null==h["return"]||h["return"]();case 15:if(e.prev=15,!u){e.next=18;break}throw l;case 18:return e.finish(15);case 19:return e.finish(12);case 20:v=!0,d=!1,b=void 0,e.prev=23,k=n[Symbol.iterator]();case 25:if(v=(y=k.next()).done){e.next=40;break}if(w=y.value,c){e.next=30;break}return c=w,e.abrupt("continue",37);case 30:g=w.high,O=w.low,j=w.open,S=w.close,_=w.volume,C=x()(w.day).format("YYYYMMDD"),T=+((w.close-c.close)/c.close*100).toFixed(2),F=i[C]||{},L=new m["a"]({code:t,name:F.name||"",date:C,price:w.close,change:T,netinflow:F.netinflow||NaN,netinflowrate:F.netinflowrate||NaN,high:g,low:O,open:j,close:S,volume:+(_/100).toFixed(2)}),s.unshift(L),c=w;case 37:v=!0,e.next=25;break;case 40:e.next=46;break;case 42:e.prev=42,e.t1=e["catch"](23),d=!0,b=e.t1;case 46:e.prev=46,e.prev=47,v||null==k["return"]||k["return"]();case 49:if(e.prev=49,!d){e.next=52;break}throw b;case 52:return e.finish(49);case 53:return e.finish(46);case 54:return e.abrupt("return",s);case 55:case"end":return e.stop()}}),e,null,[[4,8,12,20],[13,,15,19],[23,42,46,54],[47,,49,53]])})));function t(t,r,n){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([f["a"].captureFlows(t),f["a"].captureKline(t,"day",300)]);case 2:return r=e.sent,n=Object(p["a"])(r,2),s=n[0],i=n[1],e.abrupt("return",this.kline2flow(t,s,i));case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"ma",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i,c,o,u,l,h,p,f,v,d,b,m=arguments;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=m.length>1&&void 0!==m[1]?m[1]:5,e.prev=1,n=0,s=0,e.next=5,this.flow(t);case 5:i=e.sent,c=k["a"].stocks([t])[t],o=x()().format("YYYYMMDD"),n+=+c.price,s++,u=!0,l=!1,h=void 0,e.prev=13,p=i[Symbol.iterator]();case 15:if(u=(f=p.next()).done){e.next=26;break}if(v=f.value,d=v.price,b=v.date,o!==b){e.next=19;break}return e.abrupt("continue",23);case 19:if(n+=d,s++,s!==r){e.next=23;break}return e.abrupt("break",26);case 23:u=!0,e.next=15;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e["catch"](13),l=!0,h=e.t0;case 32:e.prev=32,e.prev=33,u||null==p["return"]||p["return"]();case 35:if(e.prev=35,!l){e.next=38;break}throw h;case 38:return e.finish(35);case 39:return e.finish(32);case 40:return e.abrupt("return",+(n/s).toFixed(2));case 43:return e.prev=43,e.t1=e["catch"](1),e.abrupt("return",0);case 46:case"end":return e.stop()}}),e,this,[[1,43],[13,28,32,40],[33,,35,39]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),C=new _,T="1.000001",F=function(){function e(t,r,n,a,s){Object(i["a"])(this,e),Object(u["a"])(this,"$valid",{rateRatio:.6,averageChange2:.2,bigChange:6}),Object(u["a"])(this,"range",{change:[null,null],price:[null,null],rate:[null,null],amount:[null,null]}),Object(u["a"])(this,"day",{rise:0,down:0,bigRise:0,bigDown:0}),Object(u["a"])(this,"fundamental",{eps:0,bvps:0,roe:0}),Object(u["a"])(this,"index",{days:0,daysRatio:0,changeUpRatio:0,changeDownRatio:0}),Object(u["a"])(this,"ratio",{mainRatio:0,abnormalRatio:0,lockRatio:0,onePercentRate:0,onePercentAmount:0}),Object(u["a"])(this,"longterm",{days:0,averagePrice:0,change:0,rate:0,amount:0}),Object(u["a"])(this,"shortterm",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(u["a"])(this,"limitup",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(u["a"])(this,"riseup",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(u["a"])(this,"rateup",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(u["a"])(this,"code",void 0),Object(u["a"])(this,"name",void 0),Object(u["a"])(this,"stock",void 0),Object(u["a"])(this,"vtype",void 0),Object(u["a"])(this,"validator",void 0),Object(u["a"])(this,"flow",[]),Object(u["a"])(this,"gene",{}),this.code=t,this.stock=r,this.flow=n,this.vtype=s;var c=!0,o=!1,l=void 0;try{for(var h,p=v["a"].validators[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var f=h.value;if(f.name===s){this.validator=new M(f);break}}}catch(d){o=!0,l=d}finally{try{c||null==p["return"]||p["return"]()}finally{if(o)throw l}}Object.assign(this,a),r&&(this.name=r.name)}return Object(c["a"])(e,[{key:"toMoney",value:function(e){return e=Math.abs(+e)>=1e8?(+e/1e8).toFixed(2)+"亿":(+e/1e4).toFixed(2)+"万",e}},{key:"analyse",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!this.flow||!this.flow.length){e.next=25;break}return e.next=4,this.calcFundamental();case 4:return e.next=6,this.calcDays();case 6:return e.next=8,this.calcRange();case 8:return e.next=10,this.calcLimitup();case 10:return e.next=12,this.calcRiseup();case 12:return e.next=14,this.calcRateup();case 14:return e.next=16,this.calcLongterm();case 16:return e.next=18,this.calcShortterm();case 18:return e.next=20,this.calcRatio();case 20:if(this.code===T){e.next=23;break}return e.next=23,this.calcIndex();case 23:return e.next=25,this.calcGene();case 25:e.next=30;break;case 27:e.prev=27,e.t0=e["catch"](0),console.warn("#Gene# analyse fail ",this.code,e.t0);case 30:return e.abrupt("return",this);case 31:case"end":return e.stop()}}),e,this,[[0,27]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"calcRange",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,a=this.flow[Symbol.iterator]();!(e=(n=a.next()).done);e=!0){var s=n.value,i=s.price,c=s.change,o=s.rate,u=s.netinflow;null===this.range.price[0]&&(this.range.price[0]=i),null===this.range.price[1]&&(this.range.price[1]=i),i<this.range.price[0]&&(this.range.price[0]=i),i>this.range.price[1]&&(this.range.price[1]=i),null===this.range.change[0]&&(this.range.change[0]=c),null===this.range.change[1]&&(this.range.change[1]=c),c<this.range.change[0]&&(this.range.change[0]=c),c>this.range.change[1]&&(this.range.change[1]=c),null===this.range.amount[0]&&(this.range.amount[0]=u),null===this.range.amount[1]&&(this.range.amount[1]=u),u<this.range.amount[0]&&(this.range.amount[0]=u),u>this.range.amount[1]&&(this.range.amount[1]=u),null===this.range.rate[0]&&(this.range.rate[0]=o),null===this.range.rate[1]&&(this.range.rate[1]=o),o<this.range.rate[0]&&(this.range.rate[0]=o),o>this.range.rate[1]&&(this.range.rate[1]=o)}}catch(l){t=!0,r=l}finally{try{e||null==a["return"]||a["return"]()}finally{if(t)throw r}}this.range.price[0]=+this.range.price[0].toFixed(2),this.range.price[1]=+this.range.price[1].toFixed(2),this.range.change[0]=+this.range.change[0].toFixed(2),this.range.change[1]=+this.range.change[1].toFixed(2),this.range.amount[0]=+this.range.amount[0].toFixed(2),this.range.amount[1]=+this.range.amount[1].toFixed(2),this.range.rate[0]=+this.range.rate[0].toFixed(2),this.range.rate[1]=+this.range.rate[1].toFixed(2)}},{key:"calcDays",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,a=this.flow[Symbol.iterator]();!(e=(n=a.next()).done);e=!0){var s=n.value.change;s>=0?this.day.rise++:this.day.down++,s>=this.$valid.bigChange&&this.day.bigRise++,s<=-this.$valid.bigChange&&this.day.bigDown++}}catch(i){t=!0,r=i}finally{try{e||null==a["return"]||a["return"]()}finally{if(t)throw r}}}},{key:"calcIndex",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c,o;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=0,r=0,n=0,s=0,i=0,e.next=3,P.gene(T,this.vtype);case 3:c=e.sent,o=c.flow,this.flow.forEach((function(e,a){var c=o[a];c&&e.date===c.date&&(e.change>0&&c.change>0&&(t++,r+=e.change,s+=c.change),e.change<0&&c.change<0&&(t++,n+=e.change,i+=c.change))})),this.index.days=t,this.index.daysRatio=+(t/this.flow.length).toFixed(2),this.index.changeUpRatio=+(r/s).toFixed(2),this.index.changeDownRatio=-(n/i).toFixed(2);case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"calcFundamental",value:function(){this.fundamental.eps=+this.stock.eps.toFixed(2),this.fundamental.bvps=+this.stock.bvps.toFixed(2),this.fundamental.roe=+this.stock.roe.toFixed(2)}},{key:"calcLongterm",value:function(){var e=0,t=!0,r=!1,n=void 0;try{for(var a,s=this.flow[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var i=a.value,c=i.price,o=i.change,u=i.rate,l=i.netinflow;Number.isNaN(u)&&(u=0),Number.isNaN(l)&&(l=0),this.longterm.change+=o,this.longterm.rate+=u,this.longterm.amount+=l,this.longterm.days++,e+=c}}catch(h){r=!0,n=h}finally{try{t||null==s["return"]||s["return"]()}finally{if(r)throw n}}this.longterm.averagePrice=+(e/this.flow.length).toFixed(2),this.longterm.change=+this.longterm.change.toFixed(2),this.longterm.rate=+this.longterm.rate.toFixed(2),this.longterm.amount=+this.longterm.amount.toFixed(2)}},{key:"calcShorttermFun",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){var n,s,i,c,o,u,l,h,p,f,v,d;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=0,s=0,i=0,c=0,e.t0=a.a.keys(this.flow);case 2:if((e.t1=e.t0()).done){e.next=16;break}return o=e.t1.value,u=this.flow[o],l=u.code,h=u.name,p=u.price,f=u.change,v=u.rate,e.next=7,r({code:l,name:h,price:p,change:f,rate:v});case 7:if(e.sent){e.next=9;break}return e.abrupt("continue",2);case 9:n++,i+=f,s+=v,d=this.flow[+o+1],d&&(c+=+d.change),e.next=2;break;case 16:n>0&&(t.days=n,t.change=+c.toFixed(2),t.averageChange=+(i/n).toFixed(2),t.averageRate=+(s/n).toFixed(2),t.averageChange2=+(c/n).toFixed(2));case 17:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"calcShortterm",value:function(){return this.calcShorttermFun(this.shortterm,function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.code,t.name,t.price,r=t.change,n=t.rate,e.abrupt("return",r>0&&n>0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"calcLimitup",value:function(){return this.calcShorttermFun(this.limitup,(function(e){e.code,e.name,e.price;var t=e.change,r=e.rate;return t>=9&&r>0}))}},{key:"calcRiseup",value:function(){var e=this;return this.calcShorttermFun(this.riseup,(function(t){t.code,t.name,t.price;var r=t.change,n=t.rate;return r>=e.$valid.bigChange&&n>0}))}},{key:"calcRateup",value:function(){var e=this;return this.calcShorttermFun(this.rateup,(function(t){t.code,t.name,t.price,t.change;var r=t.rate;return r>e.range.rate[1]*e.$valid.rateRatio}))}},{key:"isValidShortterm",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.code,t.change,r=t.rate,n={},e.next=4,this.calcShorttermFun(n,(function(e){e.code,e.name,e.price,e.change;var t=e.rate;return Math.abs((t-r)/r)>=.2}));case 4:return e.abrupt("return",n.averageChange2>=this.$valid.averageChange2);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"calcRatio",value:function(){var e=0,t=0,r=0,n=this.flow.slice(-1)[0],a=!0,s=!1,i=void 0;try{for(var c,o=this.flow[Symbol.iterator]();!(a=(c=o.next()).done);a=!0){var u=c.value,l=u.change,h=u.rate,p=u.netinflow;Number.isNaN(h)&&(h=0),Number.isNaN(p)&&(p=0),l>0&&h>0&&(e+=h,t+=p,r+=l)}}catch(f){s=!0,i=f}finally{try{a||null==o["return"]||o["return"]()}finally{if(s)throw i}}this.ratio.onePercentRate=+(e/r).toFixed(2),this.ratio.onePercentAmount=+(t/r).toFixed(2),this.ratio.mainRatio=+(this.longterm.rate/this.longterm.days).toFixed(2),this.ratio.abnormalRatio=+((this.day.bigRise+this.day.bigDown)/this.longterm.days).toFixed(2),this.ratio.lockRatio=+(+n.price/this.longterm.averagePrice).toFixed(2)}},{key:"calcGene",value:function(){this.gene.ratio={mainRatio:this.ratio.mainRatio,abnormalRatio:this.ratio.abnormalRatio,lockRatio:this.ratio.lockRatio,onePercentRate:this.ratio.onePercentRate,onePercentAmount:this.toMoney(this.ratio.onePercentAmount)},this.gene.shortterm=this.shortterm,this.gene.longterm={days:this.longterm.days,averagePrice:this.longterm.averagePrice,change:this.longterm.change,rate:this.longterm.rate,amount:this.toMoney(this.longterm.amount)},this.gene.limitup=this.limitup,this.gene.riseup=this.riseup,this.gene.rateup=this.rateup,this.gene.day=this.day,this.gene.range={change:this.range.change.toString(),price:this.range.price.toString(),rate:this.range.rate.toString(),amount:[this.toMoney(this.range.amount[0]),this.toMoney(this.range.amount[1])]},this.gene.index=this.index,this.gene.fundamental=this.fundamental}},{key:"show",value:function(){for(var e in this.gene)console.info("%c".concat(this.code,".").concat(e.toUpperCase()),"padding-left: 45%; color:#FFC107;"),console.table(this.gene[e])}},{key:"getFlow",value:function(){return this.flow}},{key:"getGene",value:function(){return this.gene}},{key:"toString",value:function(){var e="";for(var t in this.gene){var r=this.gene[t];for(var n in r)e+="".concat(t,".").concat(n,": ").concat(r[n].toString(),"  ")}return e}}]),e}(),L=function(){function e(){Object(i["a"])(this,e),Object(u["a"])(this,"genes",{}),Object(u["a"])(this,"vtypes",{});var t=!0,r=!1,n=void 0;try{for(var a,s=v["a"].validators[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var c=a.value,o=c.name,l=c.rule["gene"],h={};for(var f in l)if(f.startsWith("$")){var d=f.split("."),b=Object(p["a"])(d,2),k=b[0],m=b[1];h[k]||(h[k]={}),h[k][m]=+l[f]}this.vtypes[o]=h}}catch(y){r=!0,n=y}finally{try{t||null==s["return"]||s["return"]()}finally{if(r)throw n}}}return Object(c["a"])(e,[{key:"has",value:function(e,t){return!!this.genes[t]&&this.genes[t][e]}},{key:"param",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.vtypes[t]||{});case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"gene",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.has(t,r)){e.next=3;break}return e.next=3,this.capture(t,r);case 3:return e.abrupt("return",this.genes[r][t]);case 4:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){var n,s,i,c,o;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!this.has(t,r)){e.next=3;break}return e.abrupt("return",this.gene(t,r));case 3:return e.next=5,Promise.all([C.flow(t),f["a"].captureStock(t)]);case 5:return n=e.sent,s=Object(p["a"])(n,2),i=s[0],c=s[1],e.next=11,new F(t,c,i,this.vtypes[r],r).analyse();case 11:return o=e.sent,this.genes[r]||(this.genes[r]={}),this.genes[r][t]=o,e.abrupt("return",o);case 17:e.prev=17,e.t0=e["catch"](0),console.warn("#Genes# capture fail ",r,t,e.t0);case 20:case"end":return e.stop()}}),e,this,[[0,17]])})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}(),P=new L,D=r("2909"),Y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[],values:[]};return Function.apply(void 0,Object(D["a"])(t.keys).concat(['"use strict";return ('.concat(e,")")])).apply(void 0,Object(D["a"])(t.values))},B=Y,I=r("776f"),R=9.8,M=function(){function e(t){Object(i["a"])(this,e),this.config=t}return Object(c["a"])(e,[{key:"hasCaptureRule",value:function(e){return this.config.capture.includes(e)}},{key:"hasIntervalRule",value:function(e){return this.config.interval.includes(e)}},{key:"filter",value:function(){var t=Object(s["a"])(a.a.mark((function t(r,n){var s,i,c;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,n.code,n.name,n.price,n.change,n.rate,n.turnover,n.qrr,n.eps,n.bvps,n.roe,s=this.config.capture,i=I["qb"].getIntervalKeys(),i.includes(r)&&(s=this.config.interval),c=I["qb"].getBondKeys(),c.includes(r)){t.next=11;break}return t.next=9,e.filterOfList(n);case 9:if(t.sent){t.next=11;break}return t.abrupt("return",!1);case 11:if(![I["F"].key,I["t"].key].includes(r)){t.next=13;break}return t.abrupt("return",!0);case 13:if(!s.includes("base")){t.next=18;break}return t.next=16,this.isValidBase(n);case 16:if(t.sent){t.next=18;break}return t.abrupt("return",!1);case 18:if(!s.includes("fundamental")){t.next=23;break}return t.next=21,this.isValidFundamental(n);case 21:if(t.sent){t.next=23;break}return t.abrupt("return",!1);case 23:if(!s.includes("whitelist")){t.next=28;break}return t.next=26,this.isValidWhitelist(n);case 26:if(t.sent){t.next=28;break}return t.abrupt("return",!1);case 28:if(!s.includes("gene")){t.next=33;break}return t.next=31,this.isValidGeneAnalyse(n.code,n);case 31:if(t.sent){t.next=33;break}return t.abrupt("return",!1);case 33:return t.abrupt("return",!0);case 36:return t.prev=36,t.t0=t["catch"](0),t.abrupt("return",!1);case 39:case"end":return t.stop()}}),t,this,[[0,36]])})));function r(e,r){return t.apply(this,arguments)}return r}()},{key:"filterOfPreTrace",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){var n,s,i,c,o,u,l,h,p,f,v,d,b,k,m,y;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.config.capture,n.includes("pre-trace")){e.next=3;break}return e.abrupt("return",!0);case 3:if(s=this.config.rule["pre-trace"],s){e.next=6;break}return e.abrupt("return",!0);case 6:i=Object.keys(t),c=0,o=i;case 8:if(!(c<o.length)){e.next=22;break}if(u=o[c],![I["F"].key,I["t"].key].includes(u)){e.next=12;break}return e.abrupt("continue",19);case 12:if(l=t[u],h=r[u],l&&h){e.next=16;break}return e.abrupt("continue",19);case 16:for(v in p=l.getStocks(),f=h.getStocks(),p)for(k in d=p[v],b=f[v],s)m=(b[k]-d[k])/d[k],y="".concat(m).concat(s[k]),B(y)||(console.info("#Validator# filter stock of PreTrace",u,d.code,d.name,d.price,d.change,k,"[ ",b[k]," - ",d[k],s[k]," ]"),delete p[v]);case 19:c++,e.next=8;break;case 22:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"check",value:function(e,t,r,n){if(!e)return!0;try{for(var a=Object.keys(e),s=0,i=a;s<i.length;s++){var c=i[s],o=B("data.".concat(c),{keys:["data"],values:[t]}),u="".concat(o).concat(e[c]);if(void 0!==o&&!B(u))return!1}}catch(l){}return!0}},{key:"isFullRequiredFields",value:function(e){var t=new h["a"]({});for(var r in t)if(!e.hasOwnProperty(r))return!1;return!0}},{key:"isValidBase",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.code,n=t.name,t.price,t.change,t.rate,t.turnover,t.qrr,e.abrupt("return",this.check(this.config.rule.base,t,r,n));case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"isValidWhitelist",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.code,t.name,d["a"].whitelist().has(r)){e.next=3;break}return e.abrupt("return",!1);case 3:return e.abrupt("return",!0);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"isValidFundamental",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=this.config.rule.fundamental,r){e.next=3;break}return e.abrupt("return",!0);case 3:return e.abrupt("return",this.check(r,t,t.code,t.name));case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"isValidGeneAnalyse",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){var n,s,i,c,o;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.config.rule["gene"],n){e.next=3;break}return e.abrupt("return",!0);case 3:return s=this.config.name,e.next=6,P.gene(t,s);case 6:return i=e.sent,e.next=9,i.isValidShortterm(r);case 9:if(e.sent){e.next=11;break}return e.abrupt("return",!1);case 11:c={},e.t0=a.a.keys(n);case 13:if((e.t1=e.t0()).done){e.next=20;break}if(o=e.t1.value,!o.startsWith("$")){e.next=17;break}return e.abrupt("continue",13);case 17:c[o]=n[o],e.next=13;break;case 20:return e.abrupt("return",this.check(c,i,i.code,i.name));case 21:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()}],[{key:"filterOfList",value:function(){var t=Object(s["a"])(a.a.mark((function t(r){var n,s,i,c;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=r.code,s=r.name,i=r.price,c=r.change,r.rate,r.turnover,r.qrr,!(c>R||i<=0)){t.next=3;break}return t.abrupt("return",!1);case 3:return t.abrupt("return",e.isValidStock(n,s));case 4:case"end":return t.stop()}}),t)})));function r(e){return t.apply(this,arguments)}return r}()},{key:"isValidStock",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){var n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r.toUpperCase().includes("ST")){e.next=2;break}return e.abrupt("return",!1);case 2:if(!r.toUpperCase().includes("B")&&!r.toUpperCase().includes("Ｂ")){e.next=4;break}return e.abrupt("return",!1);case 4:if(!r.includes("退")){e.next=6;break}return e.abrupt("return",!1);case 6:if(!r.match(/\d+/g)){e.next=8;break}return e.abrupt("return",!1);case 8:if(n=v["a"].markets||["60","00"],n.includes("".concat(t).slice(0,2))){e.next=11;break}return e.abrupt("return",!1);case 11:if(!"".concat(t).startsWith("200")&&!"".concat(t).startsWith("900")){e.next=13;break}return e.abrupt("return",!1);case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}(),E=(r("4de4"),r("4e82"),r("99de")),N=r("7e84"),H=r("262e"),W=function(){function e(t){Object(i["a"])(this,e),Object(u["a"])(this,"name",void 0),this.name=t}return Object(c["a"])(e,[{key:"filter",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"start",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"broadcast",value:function(e,t,r){window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Interval_Event",{detail:{name:e,vtype:t,stock:r}}))}},{key:"monitor",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){var n,s,i,c,o,u,l;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,r||(r=new M(v["a"].validators[0])),n=r.config.name,s=!0,i=!1,c=void 0,e.prev=6,o=t[Symbol.iterator]();case 8:if(s=(u=o.next()).done){e.next=25;break}if(l=u.value,r.isFullRequiredFields(l)){e.next=14;break}return e.next=13,f["a"].captureStock(l.code);case 13:l=e.sent;case 14:return e.next=16,r.filter(this.name,l);case 16:if(e.sent){e.next=18;break}return e.abrupt("continue",22);case 18:return e.next=20,this.filter(l);case 20:if(!e.sent){e.next=22;break}this.broadcast(this.name,n,l);case 22:s=!0,e.next=8;break;case 25:e.next=31;break;case 27:e.prev=27,e.t0=e["catch"](6),i=!0,c=e.t0;case 31:e.prev=31,e.prev=32,s||null==o["return"]||o["return"]();case 34:if(e.prev=34,!i){e.next=37;break}throw c;case 37:return e.finish(34);case 38:return e.finish(31);case 39:e.next=43;break;case 41:e.prev=41,e.t1=e["catch"](0);case 43:case"end":return e.stop()}}),e,this,[[0,41],[6,27,31,39],[32,,34,38]])})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}(),q=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I["K"].key;return Object(i["a"])(this,t),Object(E["a"])(this,Object(N["a"])(t).call(this,e))}return Object(H["a"])(t,e),Object(c["a"])(t,[{key:"filter",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",+t.change>=9.5);case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"start",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{b["a"].interval(Object(s["a"])(a.a.mark((function e(){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.prev=1,e.next=4,k["a"].listOfStocks("netinflow");case 4:return r=e.sent,r=r.slice(0,200),e.next=8,t.monitor(r);case 8:e.next=12;break;case 10:e.prev=10,e.t0=e["catch"](1);case 12:e.next=17;break;case 14:e.prev=14,e.t1=e["catch"](0),console.warn("#diggers# capture fail",e.t1);case 17:case"end":return e.stop()}}),e,null,[[0,14],[1,10]])}))),null,30)}catch(r){}case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}]),t}(W),A=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I["M"].key,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return Object(i["a"])(this,t),e=Object(E["a"])(this,Object(N["a"])(t).call(this,r)),e.dayOfMa=n,e}return Object(H["a"])(t,e),Object(c["a"])(t,[{key:"filter",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,C.ma(t.code,this.dayOfMa);case 2:return r=e.sent,e.abrupt("return",+t.price<r);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),t}(W),K=(r("07ac"),r("257e")),U=r("45eb"),V=r("9596"),G=r("0d3b"),$=r("7366"),X=r.n($),z=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(i["a"])(this,e),Object(u["a"])(this,"name",void 0),Object(u["a"])(this,"origin",{}),Object(u["a"])(this,"stocks",{}),this.name=t,this.origin=X()(n),this.stocks=X()(a),window.addEventListener("__Walle_Stock_Ignore_Event",(function(e){var t=e.detail;r.ignore(t)}))}return Object(c["a"])(e,[{key:"filter",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"start",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"broadcast",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"buy";window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Interval_Event",{detail:{name:e,vtype:t,stock:r,tradetype:n}}))}},{key:"hook",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c,o,u,l,h,f;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t=v["a"].trader.interval.target,r=t.split("/"),n=Object(p["a"])(r,2),n[0],s=n[1],this.name===s){e.next=5;break}return e.abrupt("return");case 5:for(V["a"].notification("Walle Stock Interval Notification",t,this.origin,this.stocks),i={},c={},o=Object.values(this.stocks),u=0,l=o;u<l.length;u++)h=l[u],f=h.code,h.name,this.origin[f]&&!this.stocks[f]&&(c[f]=h),!this.origin[f]&&this.stocks[f]&&(i[f]=h);return e.next=11,G["a"].buyStocks("interval",i);case 11:return e.next=13,G["a"].sellStocks("interval",c);case 13:e.next=17;break;case 15:e.prev=15,e.t0=e["catch"](0);case 17:case"end":return e.stop()}}),e,this,[[0,15]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"ignore",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.time,n=t.vtype,s=t.listkey,i=t.code,e.prev=1,"interval"!==r||"v0"!==n||s!==this.name){e.next=9;break}if(!this.origin[i]){e.next=8;break}return e.next=6,this.deliver(i);case 6:e.next=9;break;case 8:delete this.stocks[i];case 9:e.next=13;break;case 11:e.prev=11,e.t0=e["catch"](1);case 13:case"end":return e.stop()}}),e,this,[[1,11]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deliver",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,r=ve.controller("interval","v0"),!this.origin[t]){e.next=15;break}return console.log("#Digger# filter ".concat(this.name," stock"),t),e.next=6,f["a"].captureStock(t);case 6:return n=e.sent,s=this.origin[t],e.next=10,r.ignore(this.name,t);case 10:return e.next=12,r.t0Statement.remove(this.name,t);case 12:return e.next=14,r.t1Statement.update(this.name,s,n);case 14:delete this.stocks[t];case 15:e.next=19;break;case 17:e.prev=17,e.t0=e["catch"](0);case 19:case"end":return e.stop()}}),e,this,[[0,17]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"update",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i,c,o,u;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,r=Object.keys(this.stocks),r.length){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,f["a"].captureStocks(r);case 6:this.stocks=e.sent,n=!0,s=!1,i=void 0,e.prev=10,c=t[Symbol.iterator]();case 12:if(n=(o=c.next()).done){e.next=19;break}return u=o.value,e.next=16,u.monitor(this.stocks,this.validator);case 16:n=!0,e.next=12;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e["catch"](10),s=!0,i=e.t0;case 25:e.prev=25,e.prev=26,n||null==c["return"]||c["return"]();case 28:if(e.prev=28,!s){e.next=31;break}throw i;case 31:return e.finish(28);case 32:return e.finish(25);case 33:e.next=37;break;case 35:e.prev=35,e.t1=e["catch"](0);case 37:return e.abrupt("return",Object.values(this.stocks));case 38:case"end":return e.stop()}}),e,this,[[0,35],[10,21,25,33],[26,,28,32]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){var n,s,i,c,o,u,l,h,p,d,b,k,m,y,w;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,r||(r=new M(v["a"].validators[0])),n=r.config.name,s=!0,i=!1,c=void 0,e.prev=6,o=t[Symbol.iterator]();case 8:if(s=(u=o.next()).done){e.next=34;break}if(l=u.value,r.isFullRequiredFields(l)){e.next=14;break}return e.next=13,f["a"].captureStock(l.code);case 13:l=e.sent;case 14:return e.next=16,r.filter(this.name,l);case 16:if(e.sent){e.next=18;break}return e.abrupt("continue",31);case 18:return e.next=20,this.filter(l);case 20:if(e.sent){e.next=22;break}return e.abrupt("continue",31);case 22:if(h=l,p=h.code,d=h.name,h.price,b=h.change,k=h.netinflow,m=h.rate,h.eps,h.bvps,h.roe,h.turnover,h.qrr,console.log("#Digger# capture ".concat(this.name,"-").concat(n," stock"),p,d,b,m,k),!this.stocks[p]&&!this.origin[p]){e.next=26;break}return e.abrupt("continue",31);case 26:if(y=Object.keys(this.stocks).length,!(y>=10)){e.next=29;break}return e.abrupt("break",34);case 29:this.broadcast(this.name,"v0",l,"buy"),this.stocks[p]=l;case 31:s=!0,e.next=8;break;case 34:e.next=40;break;case 36:e.prev=36,e.t0=e["catch"](6),i=!0,c=e.t0;case 40:e.prev=40,e.prev=41,s||null==o["return"]||o["return"]();case 43:if(e.prev=43,!i){e.next=46;break}throw c;case 46:return e.finish(43);case 47:return e.finish(40);case 48:return w=ve.controller("interval","v0"),e.next=51,w.update(this.name,this.stocks);case 51:this.hook(),e.next=56;break;case 54:e.prev=54,e.t1=e["catch"](0);case 56:return e.abrupt("return",Object.values(this.stocks));case 57:case"end":return e.stop()}}),e,this,[[0,54],[6,36,40,48],[41,,43,47]])})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}(),J=function(e){function t(){var e,r;Object(i["a"])(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Object(E["a"])(this,(e=Object(N["a"])(t)).call.apply(e,[this].concat(a))),Object(u["a"])(Object(K["a"])(r),"ma5Monitor",new A(I["M"].key,5)),Object(u["a"])(Object(K["a"])(r),"ma7Monitor",new A(I["N"].key,7)),Object(u["a"])(Object(K["a"])(r),"ma10Monitor",new A(I["L"].key,10)),r}return Object(H["a"])(t,e),Object(c["a"])(t,[{key:"start",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{t=v["a"].intervals[0],b["a"].interval(Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.clear();case 2:return e.next=4,r.capture(r.name);case 4:case"end":return e.stop()}}),e)}))),t.trace)}catch(n){}case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"update",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=[],e.abrupt("return",Object(U["a"])(Object(N["a"])(t.prototype),"update",this).call(this,r));case 2:case"end":return e.stop()}}),e,this)})));function r(){return e.apply(this,arguments)}return r}()},{key:"clear",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(this.stocks);case 2:if((e.t1=e.t0()).done){e.next=13;break}return t=e.t1.value,r=this.stocks[t],e.next=7,this.filter(r);case 7:if(e.sent){e.next=11;break}return this.broadcast(this.name,"v0",r,"sell"),e.next=11,this.deliver(r.code);case 11:e.next=2;break;case 13:e.next=17;break;case 15:e.prev=15,e.t2=e["catch"](0);case 17:case"end":return e.stop()}}),e,this,[[0,15]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(r,n){var s;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f["a"].captureList(r);case 3:return s=e.sent,e.abrupt("return",Object(U["a"])(Object(N["a"])(t.prototype),"capture",this).call(this,s,n));case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",[]);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function r(t,r){return e.apply(this,arguments)}return r}()},{key:"filter",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,C.ma(t.code,5);case 2:return r=e.sent,e.next=5,C.ma(t.code,7);case 5:return n=e.sent,e.abrupt("return",+t.price>r&&+t.price>n);case 7:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),t}(z),Q=(r("26e9"),function(){function e(){Object(i["a"])(this,e),Object(u["a"])(this,"_points",{}),Object(u["a"])(this,"_stocks",{}),Object(u["a"])(this,"_diff",{}),Object(u["a"])(this,"_expiry",{}),Object(u["a"])(this,"_today",{}),Object(u["a"])(this,"_timestamp",0),Object(u["a"])(this,"_defaultExpiry",7200)}return Object(c["a"])(e,[{key:"start",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.pull();case 3:b["a"].interval(Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.update();case 2:case"end":return e.stop()}}),e)}))),null,180),e.next=8;break;case 6:e.prev=6,e.t0=e["catch"](0);case 8:case"end":return e.stop()}}),e,this,[[0,6]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"process",value:function(e){var t=(new Date).getTime(),r=x()().format("YYYYMMDD");this._diff={},this._expiry={};var n=!0,a=!1,s=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){var o=i.value,u=o.code.slice(0,-3),l=+o.findTime,h=+(o.findTime+"000");this._points[l]=o,this._stocks[u]?+o.findTime>+this._stocks[u].findTime&&(this._stocks[u]=o):this._stocks[u]=o,this._timestamp&&l>this._timestamp&&(this._diff[u]?+o.findTime>+this._diff[u].findTime&&(this._diff[u]=o):this._diff[u]=o),t-h<=1e3*this._defaultExpiry&&(this._expiry[l]=o);var p=x()(h).format("YYYYMMDD");p===r&&(this._today[u]?+o.findTime>+this._today[u].findTime&&(this._today[u]=o):this._today[u]=o),o.barTime=x()(+(o.barTime+"000")).format("YYYY-MM-DD HH:mm:ss"),o.confirmTime=x()(+(o.confirmTime+"000")).format("YYYY-MM-DD HH:mm:ss"),delete o.strategyName,delete o.clickImage,delete o.id}}catch(f){a=!0,s=f}finally{try{n||null==c["return"]||c["return"]()}finally{if(a)throw s}}this._timestamp=+e[0].findTime}},{key:"pull",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f["a"].gap.captureList(1,500);case 2:t=e.sent,this.process(t);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"update",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f["a"].gap.captureList(1,30);case 2:t=e.sent,this.process(t);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"isBuy",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){var n,s=arguments;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=s.length>2&&void 0!==s[2]?s[2]:"1",e.abrupt("return",t.signalType===r&&t.signalStatus===n&&"1"===t.direction);case 2:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"isSell",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){var n,s=arguments;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=s.length>2&&void 0!==s[2]?s[2]:"1",e.abrupt("return",t.signalType===r&&t.signalStatus===n&&"-1"===t.direction);case 2:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"diff",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object.values(this._diff));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"expiry",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object.values(this._expiry));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"today",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object.values(this._today));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"points",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object.values(this._points));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"stock",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){var n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!this._stocks[t]){e.next=3;break}return e.abrupt("return",this._stocks[t]);case 3:if(!r){e.next=9;break}return e.next=6,f["a"].gap.captureStock(t);case 6:return n=e.sent,this._stocks[t]=n[0],e.abrupt("return",n[0]);case 9:e.next=13;break;case 11:e.prev=11,e.t0=e["catch"](0);case 13:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"list",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i,c,o,u,l,h,p,f,v,d,b,k,m,y,w;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(r=t.type,n=void 0===r?"3":r,s=t.status,i=void 0===s?"1":s,c=t.direction,o=void 0===c?"1":c,u=t.expiry,l=void 0===u?Object.values(this._expiry).reverse():Object.values(this._points).reverse(),h=(new Date).getTime(),p={},f=!0,v=!1,d=void 0,e.prev=7,b=l[Symbol.iterator]();!(f=(k=b.next()).done);f=!0)m=k.value,y=m.code.slice(0,-3),w=+(m.findTime+"000"),m.direction===o&&m.signalType===n&&m.signalStatus===i&&(u?h-w<=1e3*u&&(p[y]={code:y,name:m.name}):p[y]={code:y,name:m.name});e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](7),v=!0,d=e.t0;case 15:e.prev=15,e.prev=16,f||null==b["return"]||b["return"]();case 18:if(e.prev=18,!v){e.next=21;break}throw d;case 21:return e.finish(18);case 22:return e.finish(15);case 23:return e.abrupt("return",Object.values(p));case 24:case"end":return e.stop()}}),e,this,[[7,11,15,23],[16,,18,22]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}()),Z=new Q,ee=function(e){function t(){return Object(i["a"])(this,t),Object(E["a"])(this,Object(N["a"])(t).apply(this,arguments))}return Object(H["a"])(t,e),Object(c["a"])(t,[{key:"start",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{b["a"].interval(Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.clear();case 2:return e.next=4,t.capture(t.name);case 4:case"end":return e.stop()}}),e)}))),null,60)}catch(r){}case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"update",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(U["a"])(Object(N["a"])(t.prototype),"update",this).call(this,[]));case 1:case"end":return e.stop()}}),e,this)})));function r(){return e.apply(this,arguments)}return r}()},{key:"clear",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(this.stocks);case 2:if((e.t1=e.t0()).done){e.next=13;break}return t=e.t1.value,r=this.stocks[t],e.next=7,this.filterOfSell(r);case 7:if(!e.sent){e.next=11;break}return this.broadcast(this.name,"v0",r,"sell"),e.next=11,this.deliver(r.code);case 11:e.next=2;break;case 13:e.next=17;break;case 15:e.prev=15,e.t2=e["catch"](0);case 17:case"end":return e.stop()}}),e,this,[[0,15]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(r,n){var s,i,c;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,s={},Object(u["a"])(s,I["kb"].key,{type:"1",status:"1",direction:"1"}),Object(u["a"])(s,I["lb"].key,{type:"2",status:"1",direction:"1"}),Object(u["a"])(s,I["mb"].key,{type:"3",status:"1",direction:"1"}),i=s,e.next=4,Z.list(i[r]);case 4:return c=e.sent,e.abrupt("return",Object(U["a"])(Object(N["a"])(t.prototype),"capture",this).call(this,c,n));case 8:return e.prev=8,e.t0=e["catch"](0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function r(t,r){return e.apply(this,arguments)}return r}()},{key:"filter",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={},Object(u["a"])(r,I["kb"].key,"1"),Object(u["a"])(r,I["lb"].key,"2"),Object(u["a"])(r,I["mb"].key,"3"),n=r,e.next=3,Z.stock(t.code,!0);case 3:return s=e.sent,e.abrupt("return",Z.isBuy(s,n[this.name]));case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"filterOfSell",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r={},Object(u["a"])(r,I["kb"].key,"1"),Object(u["a"])(r,I["lb"].key,"2"),Object(u["a"])(r,I["mb"].key,"3"),r,n=t.code,!this.origin[n]){e.next=9;break}if(0!==this.stocks[n].price){e.next=5;break}return e.abrupt("return",!1);case 5:if(s=(this.stocks[n].price-this.origin[n].price)/this.origin[n].price*100,i=this.stocks[n].change,!(+s<=-3&&+i<-1)){e.next=9;break}return e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),t}(z),te=function(e){function t(e){return Object(i["a"])(this,t),Object(E["a"])(this,Object(N["a"])(t).call(this,e))}return Object(H["a"])(t,e),Object(c["a"])(t,[{key:"start",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{b["a"].interval(Object(s["a"])(a.a.mark((function e(){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z.diff();case 3:return r=e.sent,e.next=6,t.monitor(r);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])}))),null,60)}catch(r){}case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"monitor",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i,c,o,u,l;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,r=!0,n=!1,s=void 0,e.prev=4,i=t[Symbol.iterator]();case 6:if(r=(c=i.next()).done){e.next=17;break}return o=c.value,u=o.code.slice(0,-3),e.next=11,f["a"].captureStock(u);case 11:l=e.sent,l.name+=" ".concat(o.text,",").concat(o.barSize),this.broadcast("monitor-twist-digger","v0",l);case 14:r=!0,e.next=6;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e["catch"](4),n=!0,s=e.t0;case 23:e.prev=23,e.prev=24,r||null==i["return"]||i["return"]();case 26:if(e.prev=26,!n){e.next=29;break}throw s;case 29:return e.finish(26);case 30:return e.finish(23);case 31:e.next=35;break;case 33:e.prev=33,e.t1=e["catch"](0);case 35:case"end":return e.stop()}}),e,this,[[0,33],[4,19,23,31],[24,,26,30]])})));function t(t){return e.apply(this,arguments)}return t}()}]),t}(W),re=function(){function e(){Object(i["a"])(this,e),Object(u["a"])(this,"diggers",{})}return Object(c["a"])(e,[{key:"load",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c,o,u,l,h,f,v,d;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=ve.controller("interval","v0"),e.next=4,Promise.all([t.getYesterdayLists(),t.getTodayLists()]);case 4:if(r=e.sent,n=Object(p["a"])(r,2),s=n[0],i=n[1],i){e.next=11;break}return e.next=11,t.override(s);case 11:for(c=t.lists,o=[I["cb"].key,I["db"].key,I["eb"].key],u=[I["kb"].key,I["lb"].key,I["mb"].key],l=0,h=[].concat(o,u);l<h.length;l++){f=h[l],v={},d={};try{v=s[f].stocks,d=c[f].stocks}catch(a){}o.includes(f)&&(this.diggers[f]=new J(f,v,d)),u.includes(f)&&(this.diggers[f]=new ee(f,v,d))}e.next=19;break;case 17:e.prev=17,e.t0=e["catch"](0);case 19:case"end":return e.stop()}}),e,this,[[0,17]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"start",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c,o;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:e.prev=2,t=I["qb"].getIntervalKeys(),r=!0,n=!1,s=void 0,e.prev=7,i=t[Symbol.iterator]();case 9:if(r=(c=i.next()).done){e.next=16;break}return o=c.value,e.next=13,this.diggers[o].start();case 13:r=!0,e.next=9;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](7),n=!0,s=e.t0;case 22:e.prev=22,e.prev=23,r||null==i["return"]||i["return"]();case 25:if(e.prev=25,!n){e.next=28;break}throw s;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return e.next=32,(new q).start();case 32:return e.next=34,(new te).start();case 34:e.next=38;break;case 36:e.prev=36,e.t1=e["catch"](2);case 38:case"end":return e.stop()}}),e,this,[[2,36],[7,18,22,30],[23,,25,29]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"list",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.diggers[t].update());case 1:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}(),ne=new re,ae=function(){function e(){Object(i["a"])(this,e)}return Object(c["a"])(e,[{key:"list",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={},Object(u["a"])(r,I["f"].key,(function(){return s.listOfBond("change")})),Object(u["a"])(r,I["e"].key,(function(){return s.listOfStock("change")})),Object(u["a"])(r,I["i"].key,(function(){return s.listOfBond("rate")})),Object(u["a"])(r,I["h"].key,(function(){return s.listOfStock("rate")})),Object(u["a"])(r,I["j"].key,(function(){return s.listOfBond("netinflow")})),Object(u["a"])(r,I["g"].key,(function(){return s.listOfStock("netinflow")})),n=r,e.abrupt("return",n[t]());case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"listOfBond",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i,c,o,u,l,h,p,f,v;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=d["a"].stocksOfBonds(),n=k["a"].stocks(r),s=k["a"].listOfBonds(t),i=[],c=!0,o=!1,u=void 0,e.prev=7,l=s[Symbol.iterator]();case 9:if(c=(h=l.next()).done){e.next=25;break}if(p=h.value,f=d["a"].stockOfBond(p.code),v=n[f],v){e.next=15;break}return e.abrupt("continue",22);case 15:return e.next=17,M.isValidStock(v.code,v.name);case 17:if(e.sent){e.next=19;break}return e.abrupt("continue",22);case 19:if(!(p.price<=0)){e.next=21;break}return e.abrupt("continue",22);case 21:i.push(p);case 22:c=!0,e.next=9;break;case 25:e.next=31;break;case 27:e.prev=27,e.t0=e["catch"](7),o=!0,u=e.t0;case 31:e.prev=31,e.prev=32,c||null==l["return"]||l["return"]();case 34:if(e.prev=34,!o){e.next=37;break}throw u;case 37:return e.finish(34);case 38:return e.finish(31);case 39:return e.abrupt("return",i);case 40:case"end":return e.stop()}}),e,null,[[7,27,31,39],[32,,34,38]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"listOfStock",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i,c,o,u,l,h,p,f,v,b;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=d["a"].stocksOfBonds(),n=k["a"].stocks(r),s=k["a"].bonds(),i=k["a"].list(n,t),c=[],o=!0,u=!1,l=void 0,e.prev=8,h=i[Symbol.iterator]();case 10:if(o=(p=h.next()).done){e.next=26;break}return f=p.value,e.next=14,M.isValidStock(f.code,f.name);case 14:if(e.sent){e.next=16;break}return e.abrupt("continue",23);case 16:if(v=d["a"].bondOfStock(f.code),b=s[v],b){e.next=20;break}return e.abrupt("continue",23);case 20:if(!(b.price<=0)){e.next=22;break}return e.abrupt("continue",23);case 22:c.push(b);case 23:o=!0,e.next=10;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e["catch"](8),u=!0,l=e.t0;case 32:e.prev=32,e.prev=33,o||null==h["return"]||h["return"]();case 35:if(e.prev=35,!u){e.next=38;break}throw l;case 38:return e.finish(35);case 39:return e.finish(32);case 40:return e.abrupt("return",c);case 41:case"end":return e.stop()}}),e,null,[[8,28,32,40],[33,,35,39]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),se=new ae,ie=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(i["a"])(this,e),Object(u["a"])(this,"stocks",{}),this.stocks=t}return Object(c["a"])(e,[{key:"getStocks",value:function(){return this.stocks}},{key:"setStocks",value:function(e){this.stocks=e}},{key:"getStockCodes",value:function(){return Object.keys(this.stocks)}},{key:"clone",value:function(){var t=Object.assign({},t);return new e(t)}},{key:"merge",value:function(e){for(var t in e.stocks){var r=Object.keys(this.stocks).length;if(r>9)return;this.stocks[t]||(this.stocks[t]=e.stocks[t])}}},{key:"recover",value:function(e){return this.stocks=e.stocks,this}},{key:"get",value:function(e){return this.stocks[e]}},{key:"upsert",value:function(e){this.stocks[e.code]=e}},{key:"remove",value:function(e){delete this.stocks[e]}}]),e}(),ce=r("faf5"),oe=O.a.createInstance({name:"trace",driver:O.a.INDEXEDDB}),ue=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{isToday:!1};Object(i["a"])(this,e),Object(u["a"])(this,"isToday",void 0),Object(u["a"])(this,"record",{change:{},capture:{},trace:{}}),Object(u["a"])(this,"name",void 0),Object(u["a"])(this,"rule",void 0),Object(u["a"])(this,"listController",void 0),Object(u["a"])(this,"oldlists",void 0),Object(u["a"])(this,"newlists",void 0),Object(u["a"])(this,"openChanges",{}),Object(u["a"])(this,"closeChanges",{}),this.rule=r,this.listController=t,this.isToday=n.isToday,this.name=(this.isToday?"t0-".concat(this.rule.name):this.rule.name).toLowerCase(),this.reset(),this.deprecated()}return Object(c["a"])(e,[{key:"start",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=!1,r=t?120:300,e.prev=2,e.next=5,this.load();case 5:if(!this.rule.name.includes("interval")||this.isToday){e.next=7;break}return e.abrupt("return");case 7:b["a"].interval(Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("#StatementController# ".concat(n.name," capture start ...")),e.next=3,n.capture();case 3:console.log("#StatementController# ".concat(n.name," capture end ..."));case 4:case"end":return e.stop()}}),e)}))),null,r),this.hook(),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](2),console.warn("#StatementController# ",e.t0);case 14:case"end":return e.stop()}}),e,this,[[2,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"hook",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,i,c,o=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t=v["a"].trader.capture.target,r=t.split("/"),n=Object(p["a"])(r,2),i=n[0],c=n[1],i===this.name){e.next=5;break}return e.abrupt("return");case 5:b["a"].interval(Object(s["a"])(a.a.mark((function e(){var r,n,s,i,u,l,h,p;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:V["a"].notification("Walle Stock Clear Notification",t,o.oldlists[c].stocks,o.newlists[c].stocks),r={},e.t0=a.a.keys(o.newlists[c].stocks);case 3:if((e.t1=e.t0()).done){e.next=25;break}if(n=e.t1.value,e.prev=5,s=o.newlists[c].stocks[n],i=s.change,u=s.name,l=+o.oldlists[c].stocks[n].price,h=+o.newlists[c].stocks[n].price,0!==h){e.next=11;break}return e.abrupt("continue",3);case 11:if(p=(h-l)/l*100,!(+p>=5&&+i>-1)){e.next=15;break}return console.info("#StatementController# ".concat(t," reverse high-value stock"),n,u,i),e.abrupt("continue",3);case 15:if(!(i>=9.88)){e.next=18;break}return console.info("#StatementController# ".concat(t," reverse limitup stock"),n,u,i),e.abrupt("continue",3);case 18:r[n]=o.newlists[c].stocks[n],e.next=23;break;case 21:e.prev=21,e.t2=e["catch"](5);case 23:e.next=3;break;case 25:G["a"].sellStocks("capture",r);case 26:case"end":return e.stop()}}),e,null,[[5,21]])}))),this.rule.trace),e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"deprecated",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].until("150000");case 2:return e.next=5,oe.length();case 5:if(t=e.sent,!(t<=200)){e.next=8;break}return e.abrupt("break",15);case 8:return e.next=10,oe.key(0);case 10:return r=e.sent,e.next=13,oe.removeItem(r);case 13:e.next=2;break;case 15:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"load",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c,o,u,l,h;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=x()().format("YYYYMMDD"),e.next=4,oe.getItem(t);case 4:if(r=e.sent,r){e.next=7;break}return e.abrupt("return");case 7:for(r[this.name]&&(this.record=r[this.name]),n=this.rule.interval?I["qb"].getIntervalKeys():I["qb"].getNormalKeys(),s=!0,i=!1,c=void 0,e.prev=12,o=n[Symbol.iterator]();!(s=(u=o.next()).done);s=!0)l=u.value,h=I["qb"].name(l),this.oldlists[l]=new ie(this.record.capture[h]),this.newlists[l]=new ie(this.record.trace[h]);e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](12),i=!0,c=e.t0;case 20:e.prev=20,e.prev=21,s||null==o["return"]||o["return"]();case 23:if(e.prev=23,!i){e.next=26;break}throw c;case 26:return e.finish(23);case 27:return e.finish(20);case 28:e.next=32;break;case 30:e.prev=30,e.t1=e["catch"](0);case 32:case"end":return e.stop()}}),e,this,[[0,30],[12,16,20,28],[21,,23,27]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"save",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=x()().format("YYYYMMDD"),e.next=3,oe.getItem(r);case 3:return n=e.sent,n||(n={}),this.record={change:t.change,trace:t.trace,capture:t.capture},n[this.name]=this.record,e.abrupt("return",oe.setItem(r,n));case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"reset",value:function(){var e=this.rule.interval?I["qb"].getIntervalKeys():I["qb"].getNormalKeys();this.oldlists={},this.newlists={};var t=!0,r=!1,n=void 0;try{for(var a,s=e[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var i=a.value;this.newlists[i]=new ie,this.oldlists[i]=new ie}}catch(c){r=!0,n=c}finally{try{t||null==s["return"]||s["return"]()}finally{if(r)throw n}}}},{key:"remove",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.load();case 3:this.newlists[t]&&this.newlists[t].remove(r),this.oldlists[t]&&this.oldlists[t].remove(r),this.calc(),this.broadcast(),e.next=11;break;case 9:e.prev=9,e.t0=e["catch"](0);case 11:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"update",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r,n){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.load();case 3:this.newlists[t]||(this.newlists[t]=new ie),this.oldlists[t]||(this.oldlists[t]=new ie),this.oldlists[t].upsert(r),this.newlists[t].upsert(n),this.calc(),this.broadcast(),e.next=13;break;case 11:e.prev=11,e.t0=e["catch"](0);case 13:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(t,r,n){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.newlists=null,this.oldlists=null,!t){e.next=7;break}this.oldlists=t,e.next=16;break;case 7:if(!this.isToday){e.next=13;break}return e.next=10,this.listController.getTodayLists();case 10:this.oldlists=e.sent,e.next=16;break;case 13:return e.next=15,this.listController.getYesterdayLists();case 15:this.oldlists=e.sent;case 16:if(this.oldlists){e.next=18;break}return e.abrupt("return");case 18:this.newlists={},r=Object.keys(this.oldlists),n=0,s=r;case 21:if(!(n<s.length)){e.next=37;break}if(i=s[n],e.prev=23,I["qb"].get(i)){e.next=26;break}return e.abrupt("continue",34);case 26:return e.next=28,this.captureList(this.oldlists[i]);case 28:this.newlists[i]=e.sent,e.next=34;break;case 31:e.prev=31,e.t0=e["catch"](23),console.warn("#StatementController# ",e.t0);case 34:n++,e.next=21;break;case 37:this.calc(),this.broadcast(),e.next=44;break;case 41:e.prev=41,e.t1=e["catch"](0),console.warn("#StatementController# capture",e.t1);case 44:return e.abrupt("return",this.newlists);case 45:case"end":return e.stop()}}),e,this,[[0,41],[23,31]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"calc",value:function(){if(this.newlists)for(var e=Object.keys(this.newlists),t=0,r=e;t<r.length;t++){var n=r[t];try{var a=new ce["a"](this.oldlists[n].stocks,this.newlists[n].stocks);this.closeChanges[n]=a.getCloseChange(),this.openChanges[n]=a.getOpenChange()}catch(s){}}}},{key:"broadcast",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c,o,u;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(t={name:this.name,change:{},trace:{},capture:{}},r=Object.keys(this.newlists),n=0,s=r;n<s.length;n++)i=s[n],c=I["qb"].name(i),o=x()().format("HH:mm"),u=this.closeChanges[i],this.record.change[c]||(this.record.change[c]=[]),this.record.change[c].unshift(u,o),t.change[c]=this.record.change[c],t.trace[c]=this.newlists[i].getStocks(),t.capture[c]=this.oldlists[i].getStocks();return e.next=5,this.save(t);case 5:console.log("#StatementController# list trace [".concat(this.name,"] at ").concat(x()().format("HH:mm:ss")," ...")),window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Trace_Event",{detail:t}));case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"captureList",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=new ie,n=Object.keys(t.getStocks()),e.next=4,f["a"].captureStocks(n);case 4:return s=e.sent,r.setStocks(s),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),le=O.a.createInstance({name:"capture",driver:O.a.INDEXEDDB}),he=10,pe=function(){function e(t,r){Object(i["a"])(this,e),Object(u["a"])(this,"rule",void 0),Object(u["a"])(this,"validator",void 0),Object(u["a"])(this,"lists",void 0),Object(u["a"])(this,"listKeys",void 0),Object(u["a"])(this,"statement",void 0),Object(u["a"])(this,"t0Statement",void 0),Object(u["a"])(this,"blocks",{concept:[],industry:[]}),this.rule=t,this.validator=r,this.t1Statement=new ue(this,t),this.t0Statement=new ue(this,t,{isToday:!0}),this.listKeys=t.interval?I["qb"].getIntervalKeys():I["qb"].getNormalKeys(),this.reset(),this.deprecated()}return Object(c["a"])(e,[{key:"all",value:function(){return this.lists}},{key:"list",value:function(e){return this.lists[e]}},{key:"stocks",value:function(e){return this.lists[e].getStocks()}},{key:"ignore",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(this.lists[t]){e.next=4;break}return e.abrupt("return");case 4:return this.lists[t].remove("".concat(r)),this.broadcast(),e.next=8,this.save();case 8:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"update",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.lists[t]||(this.lists[t]=new ie),this.lists[t].merge({stocks:r}),this.broadcast(),e.next=5,this.save();case 5:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"override",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.lists=t,this.broadcast(),e.next=4,this.save();case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"load",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=x()().format("YYYYMMDD"),e.next=3,this.loadListsOf(t);case 3:r=e.sent,r&&(this.lists=r);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"loadListsOf",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=this.rule.name,e.next=3,le.getItem(t);case 3:if(n=e.sent,n){e.next=7;break}return console.log("#ListController# ".concat(r," ").concat(t," lists not exist!")),e.abrupt("return");case 7:if(n[r]){e.next=10;break}return console.log("#ListController# ".concat(r," ").concat(t," lists not exist!")),e.abrupt("return");case 10:return e.abrupt("return",this.recover(n[r]));case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getTodayLists",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=x()().format("YYYYMMDD"),e.abrupt("return",this.loadListsOf(t));case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getYesterdayLists",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,le.length();case 2:return t=e.sent,r=x()().format("YYYYMMDD"),e.next=6,le.key(t-1);case 6:if(n=e.sent,n!==r){e.next=13;break}return e.next=10,le.key(t-2);case 10:n=e.sent,e.next=16;break;case 13:return e.next=15,le.key(t-1);case 15:n=e.sent;case 16:return e.abrupt("return",this.loadListsOf(n));case 17:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"recover",value:function(e){for(var t in e)e[t]=(new ie).recover(e[t]);return e}},{key:"deprecated",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].until("150000");case 2:return e.next=5,le.length();case 5:if(t=e.sent,!(t<=200)){e.next=8;break}return e.abrupt("break",15);case 8:return e.next=10,le.key(0);case 10:return r=e.sent,e.next=13,le.removeItem(r);case 13:e.next=2;break;case 15:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"save",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=x()().format("YYYYMMDD"),r=this.rule.name,e.next=4,le.getItem(t);case 4:return n=e.sent,n||(n={}),n[r]=this.lists,e.abrupt("return",le.setItem(t,n));case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"reset",value:function(){var e=this.listKeys;this.lists={};var t=!0,r=!1,n=void 0;try{for(var a,s=e[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var i=a.value;this.lists[i]=new ie}}catch(c){r=!0,n=c}finally{try{t||null==s["return"]||s["return"]()}finally{if(r)throw n}}}},{key:"captureHotBlocks",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f["a"].captureBlock();case 2:return this.blocks=e.sent,console.info("#EastMoneyBlockCrawler# Hot Concept Blocks ..."),console.table(this.blocks.concept),console.info("#EastMoneyBlockCrawler# Hot Industry Blocks ..."),console.table(this.blocks.industry),e.abrupt("return",this.blocks);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"createHotBlocksList",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c,o,u,l;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t={concept:[I["n"].key,I["o"].key,I["p"].key],industry:[I["w"].key,I["x"].key,I["y"].key]},e.next=4,this.captureHotBlocks();case 4:for(r in t)for(s in n=t[r],n)for(u in i=n[s],c=this.lists[i],o=c.getStocks(),o)l=o[u],l.block=this.blocks[r][s]["name"];e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.warn("#ListController# ",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"createHotStocksList",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c,o,u,l,h,p,f,v,d,b,k,m,y,w,x,g,O,j;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=this.listKeys,r=I["qb"].getBondKeys(),n={},s={},i=[],c=0,o=!0,u=!1,l=void 0,e.prev=9,h=t[Symbol.iterator]();case 11:if(o=(p=h.next()).done){e.next=22;break}if(f=p.value,!r.includes(f)){e.next=15;break}return e.abrupt("continue",19);case 15:for(b in v=this.lists[f],d=v.getStocks(),Object.assign(n,d),d)k=d[b],i[b]||(i[b]={name:k.name,count:0}),i[b].count++;case 19:o=!0,e.next=11;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e["catch"](9),u=!0,l=e.t0;case 28:e.prev=28,e.prev=29,o||null==h["return"]||h["return"]();case 31:if(e.prev=31,!u){e.next=34;break}throw l;case 34:return e.finish(31);case 35:return e.finish(28);case 36:for(m=Object.keys(i).sort((function(e,t){return i[t].count-i[e].count})),y=!0,w=!1,x=void 0,e.prev=40,g=m[Symbol.iterator]();!(y=(O=g.next()).done);y=!0)j=O.value,i[j].count>=3&&c<he&&(s[j]=Object.assign({},n[j],{hot:i[j].count}),c++);e.next=48;break;case 44:e.prev=44,e.t1=e["catch"](40),w=!0,x=e.t1;case 48:e.prev=48,e.prev=49,y||null==g["return"]||g["return"]();case 51:if(e.prev=51,!w){e.next=54;break}throw x;case 54:return e.finish(51);case 55:return e.finish(48);case 56:console.log("#ListController# list ".concat(this.rule.name," capture hot stcoks ...")),console.table(i),this.lists[I["v"].key].setStocks(s);case 59:case"end":return e.stop()}}),e,this,[[9,24,28,36],[29,,31,35],[40,44,48,56],[49,,51,55]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"start",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.rule.interval?void 0:[this.rule.capture],e.prev=1,e.next=4,this.load();case 4:b["a"].interval(Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("#ListController# list ".concat(r.rule.name," capture start ...")),e.next=3,r.capture();case 3:r.rule.interval||(console.info("=================================================="),console.info("#ListController# today list capture [".concat(r.rule.name,"] at ").concat(x()().format("HH:mm:ss"),": "),r.lists),console.info("==================================================")),console.log("#ListController# list ".concat(r.rule.name," capture end ..."));case 5:case"end":return e.stop()}}),e)}))),t,this.rule.interval),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),console.warn("#ListController# ",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"captureList",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i,c,o,u,l,h,p,v,d,b;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=I["qb"].getIntervalKeys(),n=I["qb"].getBondKeys(),s=[],!r.includes(t)){e.next=9;break}return e.next=6,ne.list(t,this.validator);case 6:s=e.sent,e.next=18;break;case 9:if(!n.includes(t)){e.next=15;break}return e.next=12,se.list(t);case 12:s=e.sent,e.next=18;break;case 15:return e.next=17,f["a"].captureList(t);case 17:s=e.sent;case 18:if(s&&s.length){e.next=20;break}return e.abrupt("return",new ie);case 20:i={},c=0,o=!0,u=!1,l=void 0,e.prev=24,h=s[Symbol.iterator]();case 26:if(o=(p=h.next()).done){e.next=53;break}if(v=p.value,d=v,b=d.code,d.name,d.change,t===I["F"].key){e.next=39;break}if(r.includes(t)){e.next=39;break}if(this.validator.isFullRequiredFields(v)){e.next=35;break}return e.next=34,f["a"].captureStock(b);case 34:v=e.sent;case 35:return e.next=37,this.validator.filter(t,v);case 37:if(e.sent){e.next=39;break}return e.abrupt("continue",50);case 39:if(!i[b]){e.next=41;break}return e.abrupt("continue",50);case 41:if(!(v.price<=0)){e.next=43;break}return e.abrupt("continue",50);case 43:if(n.includes(t)){e.next=46;break}if(!(v.change>9.8)){e.next=46;break}return e.abrupt("continue",50);case 46:if(i[b]=v,c++,c!==he){e.next=50;break}return e.abrupt("break",53);case 50:o=!0,e.next=26;break;case 53:e.next=59;break;case 55:e.prev=55,e.t0=e["catch"](24),u=!0,l=e.t0;case 59:e.prev=59,e.prev=60,o||null==h["return"]||h["return"]();case 62:if(e.prev=62,!u){e.next=65;break}throw l;case 65:return e.finish(62);case 66:return e.finish(59);case 67:return console.log("#ListController# list ".concat(this.rule.name," capture ").concat(t," "),i),e.abrupt("return",new ie(i));case 69:case"end":return e.stop()}}),e,this,[[24,55,59,67],[60,,62,66]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,i,c,o=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=Object.keys(this.lists),r=0,n=t;case 2:if(!(r<n.length)){e.next=23;break}if(i=n[r],e.prev=4,i!==I["v"].key){e.next=7;break}return e.abrupt("continue",20);case 7:if(this.listKeys.includes(i)){e.next=9;break}return e.abrupt("continue",20);case 9:return e.next=11,this.captureList(i);case 11:return c=e.sent,this.lists[i].merge(c),e.next=15,Object(y["a"])(500);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](4),console.warn("#ListController# ",e.t0);case 20:r++,e.next=2;break;case 23:if(e.prev=23,!this.rule.interval){e.next=30;break}return this.broadcast(),e.next=28,this.save();case 28:e.next=37;break;case 30:return this.createHotStocksList(),this.createHotBlocksList(),this.broadcast(),this.hook(),e.next=36,this.save();case 36:setTimeout(Object(s["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={},e.next=3,Object(y["a"])(15e4);case 3:return e.next=5,o.t0Statement.capture(o.lists);case 5:if(t=e.sent,console.log("#ListController# [".concat(o.rule.name,"] t0Statement pre-trace "),t),!o.validator.hasCaptureRule("pre-trace")){e.next=13;break}return e.next=10,o.validator.filterOfPreTrace(o.lists,t);case 10:return o.broadcast(),e.next=13,o.save();case 13:case"end":return e.stop()}}),e)}))));case 37:e.next=42;break;case 39:e.prev=39,e.t1=e["catch"](23),console.warn("#ListController# ",e.t1);case 42:case"end":return e.stop()}}),e,this,[[4,17],[23,39]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"broadcast",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t={name:this.rule.name,lists:this.lists},window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Capture_Event",{detail:t}));case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"hook",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t=v["a"].trader.capture.target,r=t.split("/"),n=Object(p["a"])(r,2),s=n[0],i=n[1],s===this.rule.name){e.next=5;break}return e.abrupt("return");case 5:V["a"].notification("Walle Stock Capture Notification",t,this.lists[i].stocks),G["a"].buyStocks("capture",this.lists[i].stocks),e.next=11;break;case 9:e.prev=9,e.t0=e["catch"](0);case 11:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),fe=function(){function e(){Object(i["a"])(this,e),Object(u["a"])(this,"listControllers",[]),this.clearTempCapture();var t=[].concat(v["a"].captures||[],v["a"].temps||[]),r=v["a"].validators,n=!0,a=!1,s=void 0;try{for(var c,o=t[Symbol.iterator]();!(n=(c=o.next()).done);n=!0){var l=c.value,h=!0,p=!1,f=void 0;try{for(var d,b=r[Symbol.iterator]();!(h=(d=b.next()).done);h=!0){var k=d.value,m=this.create(l,k);this.listControllers.push(m)}}catch(w){p=!0,f=w}finally{try{h||null==b["return"]||b["return"]()}finally{if(p)throw f}}}}catch(w){a=!0,s=w}finally{try{n||null==o["return"]||o["return"]()}finally{if(a)throw s}}var y=this.create(v["a"].intervals[0],r[0]);this.listControllers.push(y)}return Object(c["a"])(e,[{key:"create",value:function(e,t){var r="".concat(e.capture,"-").concat(t.name).toLowerCase(),n=new l(Object(o["a"])({},e,{name:r})),a=new M(t);return new pe(n,a)}},{key:"controller",value:function(e,t){var r=!0,n=!1,a=void 0;try{for(var s,i=this.listControllers[Symbol.iterator]();!(r=(s=i.next()).done);r=!0){var c=s.value,o=c.rule,u=c.validator.config;if(o.capture===e&&u.name===t)return c}}catch(l){n=!0,a=l}finally{try{r||null==i["return"]||i["return"]()}finally{if(n)throw a}}}},{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c,o;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,t=x()().format("YYYYMMDD"),r=!0,n=!1,s=void 0,e.prev=5,i=this.listControllers[Symbol.iterator]();case 7:if(r=(c=i.next()).done){e.next=16;break}if(o=c.value,!o.rule.date||o.rule.date===t){e.next=12;break}return console.log("#controllers# ignore temp capture rule ",o.rule.capture,o.rule.date),e.abrupt("continue",13);case 12:o.start();case 13:r=!0,e.next=7;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](5),n=!0,s=e.t0;case 22:e.prev=22,e.prev=23,r||null==i["return"]||i["return"]();case 25:if(e.prev=25,!n){e.next=28;break}throw s;case 28:return e.finish(25);case 29:return e.finish(22);case 30:e.next=35;break;case 32:e.prev=32,e.t1=e["catch"](0),console.warn("#controllers# capture",e.t1);case 35:case"end":return e.stop()}}),e,this,[[0,32],[5,18,22,30],[23,,25,29]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"trace",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,t=!0,r=!1,n=void 0,e.prev=4,s=this.listControllers[Symbol.iterator]();case 6:if(t=(i=s.next()).done){e.next=15;break}return c=i.value,e.next=10,c.t1Statement.start();case 10:return e.next=12,c.t0Statement.start();case 12:t=!0,e.next=6;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](4),r=!0,n=e.t0;case 21:e.prev=21,e.prev=22,t||null==s["return"]||s["return"]();case 24:if(e.prev=24,!r){e.next=27;break}throw n;case 27:return e.finish(24);case 28:return e.finish(21);case 29:e.next=34;break;case 31:e.prev=31,e.t1=e["catch"](0),console.warn("#controllers# trace ",e.t1);case 34:case"end":return e.stop()}}),e,this,[[0,31],[4,17,21,29],[22,,24,28]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"clearTempCapture",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c,o,u;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(v["a"].temps){e.next=2;break}return e.abrupt("return");case 2:if(v["a"].temps.length){e.next=4;break}return e.abrupt("return");case 4:for(t=[],r=x()().subtract(2,"days").format("YYYYMMDD"),1!==+x()().day()&&2!==+x()().day()||(r=x()().subtract(4,"days").format("YYYYMMDD")),n=!0,s=!1,i=void 0,e.prev=10,c=v["a"].temps[Symbol.iterator]();!(n=(o=c.next()).done);n=!0)u=o.value,+u.date>r&&t.push(u);e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](10),s=!0,i=e.t0;case 18:e.prev=18,e.prev=19,n||null==c["return"]||c["return"]();case 21:if(e.prev=21,!s){e.next=24;break}throw i;case 24:return e.finish(21);case 25:return e.finish(18);case 26:v["a"].temps=t;case 27:case"end":return e.stop()}}),e,null,[[10,14,18,26],[19,,21,25]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"setTempCapture",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=x()().format("YYYYMMDD"),r=x()().add(1,"minutes").format("HH:mm"),n=new l({capture:r,trace:["14:40"],date:t}),v["a"].temps=[].concat(v["a"].temps,n);case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"removeTempCapture",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){var n,s,i,c,o,u,l;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=[],s=!0,i=!1,c=void 0,e.prev=4,o=v["a"].temps[Symbol.iterator]();case 6:if(s=(u=o.next()).done){e.next=14;break}if(l=u.value,l.capture!==t||l.date!==r){e.next=10;break}return e.abrupt("continue",11);case 10:n.push(l);case 11:s=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](4),i=!0,c=e.t0;case 20:e.prev=20,e.prev=21,s||null==o["return"]||o["return"]();case 23:if(e.prev=23,!i){e.next=26;break}throw c;case 26:return e.finish(23);case 27:return e.finish(20);case 28:v["a"].temps=n;case 29:case"end":return e.stop()}}),e,null,[[4,16,20,28],[21,,23,27]])})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"ignore",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r,n,s){var i,c,o,u,l,h,p,f,v;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=!0,c=!1,o=void 0,e.prev=3,u=this.listControllers[Symbol.iterator]();case 5:if(i=(l=u.next()).done){e.next=19;break}if(h=l.value,p=h.rule,f=h.validator.config,v=I["qb"].keyOf(n),p.capture!==t||f.name!==r){e.next=16;break}return e.next=13,h.ignore(v,s);case 13:return e.next=15,h.t0Statement.remove(v,s);case 15:window.dispatchEvent(new CustomEvent("__Walle_Stock_Ignore_Event",{detail:{time:t,vtype:r,listkey:v,code:s}}));case 16:i=!0,e.next=5;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e["catch"](3),c=!0,o=e.t0;case 25:e.prev=25,e.prev=26,i||null==u["return"]||u["return"]();case 28:if(e.prev=28,!c){e.next=31;break}throw o;case 31:return e.finish(28);case 32:return e.finish(25);case 33:case"end":return e.stop()}}),e,this,[[3,21,25,33],[26,,28,32]])})));function t(t,r,n,a){return e.apply(this,arguments)}return t}()}]),e}(),ve=new fe,de=r("b868"),be=function(){function e(){Object(i["a"])(this,e),Object(u["a"])(this,"index",{sse:{price:0,change:0,volume:0,amount:0,netinflow:0,rate:0},szse:{price:0,change:0,volume:0,amount:0,netinflow:0,rate:0},north:{}}),Object(u["a"])(this,"number",{full:0,rise:0,down:0,limitup:0,limitdown:0,prelimitup:0,prelimitdown:0}),Object(u["a"])(this,"strength",{full:0,netinflow:0,rise:0,down:0}),Object(u["a"])(this,"changes",{index:[],netinflow:[],full:[],rise:[],down:[]}),Object(u["a"])(this,"rates",{index:[],netinflow:[],full:[],rise:[],down:[]})}return Object(c["a"])(e,[{key:"start",value:function(){var e=this;b["a"].interval((function(){e.process()}),null,180,"market-analyse")}},{key:"process",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.calcIndex();case 3:return e.next=5,this.calcIndexOfNorth();case 5:return e.next=7,this.calcStocks();case 7:return e.next=9,this.broadcast();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),console.warn("#Market-Trend# ",e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"broadcast",value:function(){window.dispatchEvent(new CustomEvent("__Walle_Stock_Market_Analyse_Event",{detail:{index:this.index,number:this.number,strength:this.strength,changes:this.changes,rates:this.rates}}))}},{key:"calcStocks",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(s in t=k["a"].stocks(),r={full:0,rise:0,down:0},n={full:0,rise:0,down:0},this.number.full=0,this.number.rise=0,this.number.down=0,this.number.limitup=0,this.number.limitdown=0,this.number.prelimitup=0,this.number.prelimitdown=0,t)i=t[s],i.change>0&&(this.number.rise++,r.rise+=i.change,n.rise+=i.rate),i.change<0&&(this.number.down++,r.down+=i.change,n.down+=i.rate),i.change>=9.8&&this.number.limitup++,i.change<=-9.8&&this.number.limitdown++,i.change>5&&i.change<9.8&&this.number.prelimitup++,i.change<-5&&i.change>-9.8&&this.number.prelimitdown++,this.number.full++;r.rise=+r.rise.toFixed(2),r.down=+r.down.toFixed(2),r.full=+(r.rise+r.down).toFixed(2),n.rise=+n.rise.toFixed(2),n.down=+n.down.toFixed(2),n.full=+(n.rise+n.down).toFixed(2),this.strength.rise=+(n.rise/this.number.rise).toFixed(2),this.strength.down=+(n.down/this.number.down).toFixed(2),this.strength.full=+(this.strength.rise+this.strength.down).toFixed(2),c=x()().format("HH:mm"),this.changes.rise.unshift(r.rise,c),this.changes.down.unshift(r.down,c),this.changes.full.unshift(r.full,c),this.changes.index.unshift(+this.index.sse.price+this.index.szse.price,c),this.rates.rise.unshift(+(n.rise/this.number.rise).toFixed(2),c),this.rates.down.unshift(+(n.down/this.number.down).toFixed(2),c),this.rates.full.unshift(+(n.rise/this.number.rise+n.down/this.number.down).toFixed(2),c),this.rates.index.unshift(+this.index.sse.rate+this.index.szse.rate,c),this.calcNetinflow(c);case 30:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"calcNetinflow",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i,c,o,u,l,h,p;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(r=400,n=k["a"].listOfStocks("netinflow",1,r),s=0,i=0,c=!0,o=!1,u=void 0,e.prev=7,l=n[Symbol.iterator]();!(c=(h=l.next()).done);c=!0)p=h.value,s+=p.change,i+=p.rate;e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](7),o=!0,u=e.t0;case 15:e.prev=15,e.prev=16,c||null==l["return"]||l["return"]();case 18:if(e.prev=18,!o){e.next=21;break}throw u;case 21:return e.finish(18);case 22:return e.finish(15);case 23:this.strength.netinflow=+(i/r).toFixed(2),this.changes.netinflow.unshift(+s.toFixed(2),t),this.rates.netinflow.unshift(+(i/r).toFixed(2),t);case 26:case"end":return e.stop()}}),e,this,[[7,11,15,23],[16,,18,22]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"calcIndexOfNorth",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t="http://push2.eastmoney.com/api/qt/kamt/get?fields1=f1,f2,f3,f4&fields2=f51,f52,f53,f54",e.next=4,de["a"].get(t,null);case 4:r=e.sent,n=JSON.parse(r),this.index.north=n.data,e.next=11;break;case 9:e.prev=9,e.t0=e["catch"](0);case 11:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"calcIndex",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f["a"].captureStocks(["1.000001","399001"]);case 2:t=e.sent,r=t["1.000001"],n=t["399001"],this.index={sse:r,szse:n};case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"isTradingDay",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;break;case 2:if(t=+x()().format("HHmmss"),r="092500",!(t<92500)){e.next=8;break}r="092510",e.next=14;break;case 8:if(!(t>113e3)){e.next=12;break}r="130010",e.next=14;break;case 12:if(!(t>15e4)){e.next=14;break}return e.abrupt("return",!1);case 14:return console.log("#Markets# will start at ".concat(r," ...")),e.next=17,b["a"].until(r);case 17:return e.next=19,f["a"].isTrading();case 19:if(n=e.sent,console.info("#Markets# stock market trading status ".concat(n?"open":"close"," ...")),n){e.next=28;break}if(!(t>=92500&&t<=113e3||t>=13e4&&t<=15e4)){e.next=28;break}return e.next=25,toastr.clearAll();case 25:return e.next=27,toastr.loading("Market Closed","Holidays");case 27:console.info("#Markets# stock market closed for holidays ...");case 28:return e.abrupt("return",n);case 29:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),ke=new be,me=r("21a6"),ye=r.n(me),we=r("b5ee"),xe=r("32d2"),ge="walle-stocks-trace.json",Oe="walle-stocks-capture.json",je="walle-stocks-storage.json",Se="walle-stocks-flow.json",_e=function(){function e(){var t=this;Object(i["a"])(this,e),we["a"].listen("KeyB",(function(){var e={timeOut:5e3,extendedTimeOut:5e3,closeButton:!0,positionClass:"toast-bottom-left"};xe["a"].clear(),xe["a"].confirm("click to backup trace file","BACKUP",(function(){return t.trace()}),e),xe["a"].confirm("click to backup capture file","BACKUP",(function(){return t.capture()}),e),xe["a"].confirm("click to backup flow file","BACKUP",(function(){return t.flow()}),e),xe["a"].confirm("click to backup storage file","BACKUP",(function(){return t.storage()}),e)}))}return Object(c["a"])(e,[{key:"download",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){var n,s;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=x()().format("YYYYMMDD"),s=new Blob([JSON.stringify(r,null,"\t")],{type:"application/json;charset=utf-8"}),e.next=4,Object(y["a"])(1e3);case 4:return e.abrupt("return",ye.a.saveAs(s,"".concat(n,"-").concat(t)));case 5:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"trace",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,oe.iterate((function(e,r){t[r]=e}));case 4:r={},n="",e.t0=a.a.keys(t);case 6:if((e.t1=e.t0()).done){e.next=23;break}if(s=e.t1.value,e.prev=8,i=s.slice(0,6),n||(n=i),n===i){e.next=16;break}return e.next=14,this.download(n+"-"+ge,r);case 14:n=i,r={};case 16:r[s]=t[s],e.next=21;break;case 19:e.prev=19,e.t2=e["catch"](8);case 21:e.next=6;break;case 23:if(!Object.keys(r).length){e.next=26;break}return e.next=26,this.download(n+"-"+ge,r);case 26:e.next=30;break;case 28:e.prev=28,e.t3=e["catch"](0);case 30:case"end":return e.stop()}}),e,this,[[0,28],[8,19]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,le.iterate((function(e,r){t[r]=e}));case 4:return e.next=6,this.download(Oe,t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"flow",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,S.iterate((function(e,r){t[r]=e}));case 4:r={},n=1,e.t0=a.a.keys(t);case 6:if((e.t1=e.t0()).done){e.next=21;break}if(s=e.t1.value,e.prev=8,n%1e3!==0){e.next=13;break}return e.next=12,this.download(n+"-"+Se,r);case 12:r={};case 13:n++,r[s]=t[s],e.next=19;break;case 17:e.prev=17,e.t2=e["catch"](8);case 19:e.next=6;break;case 21:if(!Object.keys(r).length){e.next=24;break}return e.next=24,this.download(n+"-"+Se,r);case 24:e.next=28;break;case 26:e.prev=26,e.t3=e["catch"](0);case 28:case"end":return e.stop()}}),e,this,[[0,26],[8,17]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"storage",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,O.a.iterate((function(e,r){t[r]=e}));case 4:return e.next=6,this.download(je,t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"all",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.storage();case 2:return e.next=4,this.capture();case 4:return e.next=6,this.flow();case 6:return e.next=8,this.trace();case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"autoBackup",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=x()().endOf("month").format("YYYYMMDD"),r=x()().format("YYYYMMDD"),t!==r){e.next=8;break}return e.next=5,b["a"].until("233000");case 5:return e.next=7,this.all();case 7:console.info("#Backup# auto backup storage & records at ".concat(r," ..."));case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),Ce=function(){function e(){var t=this;Object(i["a"])(this,e),we["a"].listen("KeyR",(function(){return t.upload()}))}return Object(c["a"])(e,[{key:"upload",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=document.createElement("input"),t.type="file",t.multiple="multiple",t.onchange=function(){r.recover(t.files)},t.click();case 5:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"recover",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i,c,o,l,h,p,f,v,d=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,r={},Object(u["a"])(r,ge,(function(e){return d.trace(e)})),Object(u["a"])(r,Oe,(function(e){return d.capture(e)})),Object(u["a"])(r,Se,(function(e){return d.flow(e)})),Object(u["a"])(r,je,(function(e){return d.storage(e)})),n=r,s=!0,i=!1,c=void 0,e.prev=5,o=t[Symbol.iterator]();case 7:if(s=(l=o.next()).done){e.next=21;break}if(h=l.value,p="",h.name.includes(ge)?p=ge:h.name.includes(Oe)?p=Oe:h.name.includes(Se)?p=Se:h.name.includes(je)&&(p=je),!n[p]){e.next=18;break}return e.next=14,h.text();case 14:return f=e.sent,v=JSON.parse(f),e.next=18,n[p](v);case 18:s=!0,e.next=7;break;case 21:e.next=27;break;case 23:e.prev=23,e.t0=e["catch"](5),i=!0,c=e.t0;case 27:e.prev=27,e.prev=28,s||null==o["return"]||o["return"]();case 30:if(e.prev=30,!i){e.next=33;break}throw c;case 33:return e.finish(30);case 34:return e.finish(27);case 35:window.alert("Walle Recover Success ..."),e.next=42;break;case 38:e.prev=38,e.t1=e["catch"](0),console.info("#Recover# fail ",e.t1),window.alert("Walle Recover Fail, Try Aagin ...");case 42:case"end":return e.stop()}}),e,null,[[0,38],[5,23,27,35],[28,,30,34]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"trace",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.next=6,oe.setItem(r,t[r]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e["catch"](0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.next=6,le.setItem(r,t[r]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e["catch"](0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"flow",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.next=6,S.setItem(r,t[r]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e["catch"](0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"storage",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.next=6,O.a.setItem(r,t[r]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e["catch"](0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),Te=new _e,Fe=(new Ce,function(){function e(){Object(i["a"])(this,e)}return Object(c["a"])(e,[{key:"start",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,Te.autoBackup(),e.next=4,ke.isTradingDay();case 4:if(!e.sent){e.next=13;break}console.log("#Loop# core-loop start ..."),k["a"].start(),ne.start(),ke.start(),G["a"].start(),Z.start(),ve.capture(),ve.trace();case 13:e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](0),console.warn("#loop# ",e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));function t(){return e.apply(this,arguments)}return t}()}]),e}()),Le=new Fe,Pe=r("5ca6"),De=r.n(Pe),Ye=r("4712"),Be=(r("5319"),function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(i["a"])(this,e),Object(u["a"])(this,"multiple",void 0),Object(u["a"])(this,"code",void 0),Object(u["a"])(this,"prevclose",void 0),Object(u["a"])(this,"details",[]),this.code=t,this.multiple=r}return Object(c["a"])(e,[{key:"url",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=f["a"].eastmoney.marketCode(e),n="".concat(r,".").concat(e),a="http://push2.eastmoney.com/api/qt/stock/details/get?fields1=f1,f2,f3,f4&fields2=f51,f52,f53,f54,f55&pos=".concat(t,"&secid=").concat(n);return a}},{key:"prevclose",value:function(){}},{key:"trends",value:function(){var e={time:[],price:[],volume:[]},t=0,r=0,n=0,a=X()(this.details).reverse();for(var s in a){var i=a[s];t=i[0].replace(/:/g,""),r+=+i[2],0===+s&&(n=t),+t>=+n+3*this.multiple&&(n=t,e.time.unshift(t),e.price.unshift(+i[1]),e.volume.unshift(r),r=0)}return e}},{key:"isFire",value:function(){var e=0,t=0,r=!0,n=!1,a=void 0;try{for(var s,i=this.details[Symbol.iterator]();!(r=(s=i.next()).done);r=!0){var c=s.value,o=c[4];if(2===+o?e++:e=0,t>5)break;t++}}catch(u){n=!0,a=u}finally{try{r||null==i["return"]||i["return"]()}finally{if(n)throw a}}return e>=3}},{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i,c,o,u,l,h,p;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=this.url(this.code,t),e.next=3,de["a"].get(r,null,{dataType:"json"});case 3:for(n=e.sent,s=n.data.details,i=!0,c=!1,o=void 0,e.prev=8,u=s[Symbol.iterator]();!(i=(l=u.next()).done);i=!0)h=l.value,p=h.split(","),this.details.unshift(p);e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](8),c=!0,o=e.t0;case 16:e.prev=16,e.prev=17,i||null==u["return"]||u["return"]();case 19:if(e.prev=19,!c){e.next=22;break}throw o;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return this.prevclose=+n.data.prePrice,e.abrupt("return",this);case 26:case"end":return e.stop()}}),e,this,[[8,12,16,24],[17,,19,23]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}()),Ie=function(){function e(t){Object(i["a"])(this,e),Object(u["a"])(this,"code",void 0),Object(u["a"])(this,"prevclose",void 0),Object(u["a"])(this,"details",[]),this.code=t}return Object(c["a"])(e,[{key:"url",value:function(e){var t=f["a"].eastmoney.marketCode(e),r="".concat(t,".").concat(e),n="http://push2.eastmoney.com/api/qt/stock/trends2/get?fields1=f1,f2,f3,f4,f5,f6,f7,f8,f9,f10,f11,f12,f13&fields2=f51,f52,f53,f54,f55,f56,f57,f58&secid=".concat(r,"&ndays=1&iscr=1");return n}},{key:"trends",value:function(){var e={time:[],price:[],volume:[]},t=!0,r=!1,n=void 0;try{for(var a,s=this.details[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var i=a.value,c=x()(i[0]).format("HHmmss");e.time.push(c),e.price.push(+i[2]),e.volume.push(+i[5])}}catch(o){r=!0,n=o}finally{try{t||null==s["return"]||s["return"]()}finally{if(r)throw n}}return e}},{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c,o,u,l,h,p,f=arguments;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:-10,r=this.url(this.code,t),e.next=4,de["a"].get(r,null,{dataType:"json"});case 4:for(n=e.sent,s=n.data.trends,i=!0,c=!1,o=void 0,e.prev=9,u=s[Symbol.iterator]();!(i=(l=u.next()).done);i=!0)h=l.value,p=h.split(","),this.details.unshift(p);e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](9),c=!0,o=e.t0;case 17:e.prev=17,e.prev=18,i||null==u["return"]||u["return"]();case 20:if(e.prev=20,!c){e.next=23;break}throw o;case 23:return e.finish(20);case 24:return e.finish(17);case 25:return this.prevclose=+n.data.preClose,e.abrupt("return",this);case 27:case"end":return e.stop()}}),e,this,[[9,13,17,25],[18,,20,24]])})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),Re=function e(t,r,n){return Object(i["a"])(this,e),3===r?new Be(t,n):60===r?new Ie(t):void 0};function Me(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,n=0,a=0,s=0;return e.forEach((function(e,i){s>=r||(1===t?(n+=+e,s++):(a+=+e,i%t===0&&(n+=+a/r,s++)))})),s<r&&(r=s),+(n/r).toFixed(2)}var Ee=function(){function e(t,r,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(i["a"])(this,e),Object(u["a"])(this,"profit",{time:{win:0,lose:0},change:{win:0,lose:0},rate:{win:0,lose:0},ratio:0}),Object(u["a"])(this,"trends",{time:[],price:[],volume:[],ma5:[],ma10:[],ma20:[],change:[],rate:[]}),Object(u["a"])(this,"code",void 0),Object(u["a"])(this,"period",void 0),Object(u["a"])(this,"multiple",void 0),Object(u["a"])(this,"prevclose",void 0),Object(u["a"])(this,"details",{time:[],price:[],volume:[]}),Object(u["a"])(this,"index",0),Object(u["a"])(this,"simulator",void 0),this.code=r,this.period=n,this.multiple=a,this.simulator=t}return Object(c["a"])(e,[{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,new Re(this.code,this.period,this.multiple).capture();case 2:t=e.sent,this.details=t.trends(),this.details.time.reverse(),this.details.price.reverse(),this.details.volume.reverse(),this.prevclose=t.prevclose;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"start",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c,o,u,l,h,p;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=this.simulator,r=t.analyseOfBuy,n=t.analyseOfSell,s=t.analyseOfBuy2,i=t.analyseOfSell2,c=0,o=0,e.next=5,this.capture();case 5:r[this.code]={times:0};case 6:if(!this.hasNext()){e.next=51;break}if(this.next(),!(+this.trends.time[0]<93e3||+this.trends.time[0]>145e3)){e.next=10;break}return e.abrupt("continue",6);case 10:if(!r(this.trends,this.code)){e.next=49;break}console.info("#analyseOfBuy# ",this.trends.time[0],this.trends.price[0],this.trends.change[0],this.trends.volume[0],this.trends.ma5[0],this.trends.ma10[0],this.trends.ma20[0]),c=this.trends.change[0];case 13:if(!this.hasNext()){e.next=26;break}if(this.next(),u=+this.trends.time[0]>145e3,!n(this.trends,{change:c},u)){e.next=22;break}return o=this.trends.change[0],l=o-c,console.info("#analyseOfSell# ",this.trends.time[0],this.trends.price[0],this.trends.change[0],this.trends.volume[0],this.trends.ma5[0],this.trends.ma10[0],this.trends.ma20[0],l),this.update(l),e.abrupt("break",26);case 22:if(!u){e.next=24;break}return e.abrupt("break",26);case 24:e.next=13;break;case 26:if(!s){e.next=49;break}h=0;case 28:if(!this.hasNext()){e.next=49;break}if(h++,!(h>3)){e.next=32;break}return e.abrupt("break",49);case 32:if(this.next(),!s(this.trends)){e.next=47;break}console.info("#analyseOfBuy2# ",this.trends.time[0],this.trends.price[0],this.trends.change[0],this.trends.volume[0],this.trends.ma5[0],this.trends.ma10[0],this.trends.ma20[0]),c=this.trends.change[0];case 36:if(!this.hasNext()){e.next=46;break}if(this.next(),!i(this.trends,{change:c})){e.next=44;break}return o=this.trends.change[0],p=o-c,console.info("#analyseOfSell2# ",this.trends.time[0],this.trends.price[0],this.trends.change[0],this.trends.volume[0],this.trends.ma5[0],this.trends.ma10[0],this.trends.ma20[0],p),this.update(p),e.abrupt("break",46);case 44:e.next=36;break;case 46:return e.abrupt("break",49);case 47:e.next=28;break;case 49:e.next=6;break;case 51:console.info("#Profit# ","总笔数 ",this.profit.time.win+this.profit.time.lose,"总收益 ",this.profit.change.win+this.profit.change.lose,"单笔收益 ",(this.profit.change.win+this.profit.change.lose)/(this.profit.time.win+this.profit.time.lose),this.profit),e.next=57;break;case 54:e.prev=54,e.t0=e["catch"](0),console.warn("MockProcessor ",e.t0);case 57:return e.abrupt("return",this);case 58:case"end":return e.stop()}}),e,this,[[0,54]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"hasNext",value:function(){var e=this.details.time.length;return this.index<e}},{key:"next",value:function(){this.index+=1;var e=this.details.time[this.index],t=this.details.price[this.index],r=this.details.volume[this.index],n=+((t-this.prevclose)/this.prevclose*100).toFixed(2);this.trends.time.unshift(e),this.trends.price.unshift(t),this.trends.volume.unshift(r),this.trends.change.unshift(n),this.trends.ma5.unshift(Me(this.trends.price,1,5)),this.trends.ma10.unshift(Me(this.trends.price,1,10)),this.trends.ma20.unshift(Me(this.trends.price,1,20)),this.trends.rate.unshift(NaN)}},{key:"update",value:function(e){e>0?(this.profit.time.win++,this.profit.change.win+=e):(this.profit.time.lose++,this.profit.change.lose+=e);var t=this.profit.time.win+this.profit.time.lose||1;this.profit.rate.win=this.profit.time.win/t,this.profit.rate.lose=this.profit.time.lose/t,this.profit.ratio=(this.profit.change.win+this.profit.change.lose)/t}}]),e}(),Ne=function(){function e(t,r,n,a){Object(i["a"])(this,e),Object(u["a"])(this,"Processor",void 0),Object(u["a"])(this,"processor",void 0),Object(u["a"])(this,"target",void 0),Object(u["a"])(this,"key",void 0),Object(u["a"])(this,"codes",[]),this.Processor=t,this.target=r,this.key=n,this.codes=a}return Object(c["a"])(e,[{key:"start",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ke.isTradingDay();case 3:if(!e.sent){e.next=26;break}if(e.prev=4,Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,G["a"].liquidation("t0");case 2:case"end":return e.stop()}}),e)})))(),this.codes){e.next=11;break}return e.next=10,this.capture();case 10:this.codes=e.sent;case 11:this.processor=new this.Processor(this.target,this.key,this.codes),this.processor.start(),e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](4),console.warn("T0Controller start ",e.t0);case 18:return this._isRunning=!0,e.next=22,b["a"].until("145000");case 22:return e.next=24,this.stop();case 24:return e.next=26,G["a"].liquidation("t0");case 26:e.next=32;break;case 28:e.prev=28,e.t1=e["catch"](0),this._isRunning=!1,console.warn("T0Controller start ",e.t1);case 32:case"end":return e.stop()}}),e,this,[[0,28],[4,15]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"stop",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{this.processor.stop()}catch(t){console.warn("T0Controller stop ",t)}case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),He=(r("13d5"),function(){function e(){Object(i["a"])(this,e)}return Object(c["a"])(e,[{key:"_broadcast",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Interval_Event",{detail:t})),r=(window.parent||window).opener,r&&["L3","L5"].includes(t.state)&&r.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Interval_Event",{detail:t}));case 3:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"broadcast",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r,n,s){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this._broadcast({name:"".concat(t," - ").concat(r),vtype:"v0",stock:n,trend:s,state:r});case 1:case"end":return e.stop()}}),e,this)})));function t(t,r,n,a){return e.apply(this,arguments)}return t}()},{key:"buy",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G["a"].buy("t0",r);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e["catch"](0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"sell",value:function(){var e=Object(s["a"])(a.a.mark((function e(t,r){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G["a"].sell("t0",r);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e["catch"](0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}()),We=new He,qe={L1:"L1",L2:"L2",L3:"L3",L4:"L4",L5:"L5"},Ae=function(){function e(t){Object(i["a"])(this,e),Object(u["a"])(this,"sse",void 0),Object(u["a"])(this,"period",void 0),Object(u["a"])(this,"codes",[]),Object(u["a"])(this,"_stocks",{}),Object(u["a"])(this,"_trend",{}),this.codes=t}return Object(c["a"])(e,[{key:"init",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(t=!0,r=!1,n=void 0,e.prev=3,s=this.codes[Symbol.iterator]();!(t=(i=s.next()).done);t=!0)c=i.value,this._trend[c]={time:[],price:[],volume:[],ma5:[],ma10:[],ma20:[],change:[],rate:[]};e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](3),r=!0,n=e.t0;case 11:e.prev=11,e.prev=12,t||null==s["return"]||s["return"]();case 14:if(e.prev=14,!r){e.next=17;break}throw n;case 17:return e.finish(14);case 18:return e.finish(11);case 19:case"end":return e.stop()}}),e,this,[[3,7,11,19],[12,,14,18]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"restart",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.sse=f["a"].sseStart(this.codes,{interval:1});case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"start",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r=this,n=arguments;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:3,e.prev=1,this.period=t,e.next=5,this.init();case 5:return e.next=7,this.restart();case 7:return b["a"].interval(Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",r.update());case 1:case"end":return e.stop()}}),e)}))),null,this.period),e.next=10,Object(y["a"])(20*this.period*1e3);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](1),console.warn("T0SSE start ",e.t0);case 15:case"end":return e.stop()}}),e,this,[[1,12]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"stop",value:function(){this.sse&&this.sse.stop()}},{key:"stocks",value:function(){return this.sse.getStocks(this.codes)}},{key:"stock",value:function(e){return this.sse.getStock(e)}},{key:"trends",value:function(){return this._trend}},{key:"trend",value:function(e){return this._trend[e]}},{key:"update",value:function(){console.log("@"),2===+this.sse.state()&&(console.warn("#T0# sse restart ...",this.sse.state()),this.restart()),this._bak=this._stocks,this._stocks=this.sse.getStocks(this.codes);var e=x()().format("HHmmss");for(var t in this._stocks){var r=this._bak[t],n=this._stocks[t];this._trend[t].time.unshift(e),this._trend[t].price.unshift(+n.price),this._trend[t].change.unshift(+n.change),this._trend[t].rate.unshift(+n.rate),this._trend[t].volume.unshift(+n.volume-(r?+r.volume:+n.volume)),this._trend[t].ma5.unshift(this.maOfPrice(t,1,5)),this._trend[t].ma10.unshift(this.maOfPrice(t,1,10)),this._trend[t].ma20.unshift(this.maOfPrice(t,1,20))}}},{key:"maOfPrice",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return Me(this._trend[e].price,t,r)}},{key:"maOfVolume",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return Me(this._trend[e].volume,t,r)}}]),e}(),Ke=O.a.createInstance({name:"storage",driver:O.a.INDEXEDDB}),Ue=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object(i["a"])(this,e),Object(u["a"])(this,"record",{code:"",name:"",trend:{time:[],ma5:[],ma10:[],ma20:[],price:[],change:[],rate:[]},monitor:{time:"",price:"",change:"",rate:""},buy:{time:"",price:"",change:"",rate:""},sell:{time:"",price:"",change:"",rate:""}}),this.record.name=r,this.record.code=t}return Object(c["a"])(e,[{key:"key",value:function(){return this.record.key}},{key:"code",value:function(e){return e&&(this.record.code=e),this.record.code}},{key:"name",value:function(e){return e&&(this.record.code=e),this.record.name}},{key:"trend",value:function(e){return e&&(this.record.trend.time=e.time.slice(0,100),this.record.trend.ma5=e.ma5.slice(0,100),this.record.trend.ma10=e.ma10.slice(0,100),this.record.trend.ma20=e.ma20.slice(0,100),this.record.trend.price=e.price.slice(0,100),this.record.trend.change=e.change.slice(0,100),this.record.trend.rate=e.rate.slice(0,100)),this.record.trend}},{key:"monitor",value:function(e){if(e){var t=x()().format("HHmmss");this.record.monitor={time:t,price:e.price,change:e.change,rate:e.rate},this.record.name=e.name,this.record.code=e.code}return this.record.monitor}},{key:"buy",value:function(e){if(e){var t=x()().format("HHmmss");this.record.buy={time:t,price:e.price,change:e.change,rate:e.rate},this.record.name=e.name,this.record.code=e.code}return this.record.buy}},{key:"sell",value:function(e){if(e){var t=x()().format("HHmmss");this.record.sell={time:t,price:e.price,change:e.change,rate:e.rate},this.record.name=e.name,this.record.code=e.code}return this.record.sell}}]),e}(),Ve=function(){function e(t,r){Object(i["a"])(this,e),Object(u["a"])(this,"records",{}),Object(u["a"])(this,"target",void 0),Object(u["a"])(this,"key",void 0),this.target=t,this.key=r}return Object(c["a"])(e,[{key:"name",value:function(){var e=x()().day();return"t0-".concat(e,"-").concat(this.target,"-").concat(this.key)}},{key:"record",value:function(){return new Ue}},{key:"append",value:function(e){var t=e.record,r=x()().format("HHmmss");return this.records[r]=t,this.save()}},{key:"all",value:function(){return this.records}},{key:"get",value:function(e){return this.records[e]||{}}},{key:"set",value:function(e,t){var r=t.record;return this.records[e]=r,this.save()}},{key:"load",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=x()().format("YYYY-MM-DD"),e.next=3,Ke.getItem(this.name());case 3:return r=e.sent,r&&r.date===t&&(this.records=r),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"save",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=x()().format("YYYY-MM-DD"),this.records.date=t,e.abrupt("return",Ke.setItem(this.name(),this.records));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),Ge=function(){function e(t,r,n){Object(i["a"])(this,e),Object(u["a"])(this,"key",""),Object(u["a"])(this,"records",void 0),Object(u["a"])(this,"sse",void 0),Object(u["a"])(this,"hooks",We),Object(u["a"])(this,"current",void 0),Object(u["a"])(this,"profit",{change:0,high:0,low:0}),Object(u["a"])(this,"isRunning",!1),Object(u["a"])(this,"isForceStop",!1),this.key=r,this.sse=new Ae(n),this.records=new Ve(t,r)}return Object(c["a"])(e,[{key:"start",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.records.load();case 3:return e.next=5,this.sse.start(t);case 5:this.isRunning=!0;case 6:return console.log("#"),e.next=10,Object(y["a"])(1e3);case 10:if(r=x()().format("HHmmss"),!(+r<93e3)){e.next=13;break}return e.abrupt("continue",6);case 13:if(!this.isForceStop){e.next=16;break}return console.log("T0Processor loop force stop ..."),e.abrupt("break",55);case 16:return e.prev=16,this.current=null,n=new Ue(this.key),this.hooks.broadcast(this.key,qe.L1),e.next=22,this.monitor();case 22:if(this.current=e.sent,this.current){e.next=25;break}return e.abrupt("continue",6);case 25:return n.monitor(this.current),console.log("T0Processor loop state L1 ... ",this.current),this.hooks.broadcast(this.key,qe.L2,this.current,this.sse.trend(this.current.code)),e.next=30,this.analyseOfBuy(this.current);case 30:if(this.current=e.sent,this.current){e.next=33;break}return e.abrupt("continue",6);case 33:return n.buy(this.current),console.log("T0Processor loop state L2 ... ",this.current),this.hooks.broadcast(this.key,qe.L3,this.current,this.sse.trend(this.current.code)),this.hooks.buy(this.key,this.current),console.log("T0Processor loop state L3 ... ",this.current),this.hooks.broadcast(this.key,qe.L4,this.current,this.sse.trend(this.current.code)),e.next=41,this.analyseOfSell(this.current);case 41:this.current=e.sent,n.sell(this.current),console.log("T0Processor loop state L4 ... ",this.current),this.hooks.broadcast(this.key,qe.L5,this.current,this.sse.trend(this.current.code)),this.hooks.sell(this.key,this.current),console.log("T0Processor loop state L5 ... ",this.current),this.updateRecord(n),e.next=53;break;case 50:e.prev=50,e.t0=e["catch"](16),console.warn("T0Processor loop ",e.t0);case 53:e.next=6;break;case 55:this.isRunning=!1,e.next=61;break;case 58:e.prev=58,e.t1=e["catch"](0),console.warn("T0Processor loop ",e.t1);case 61:case"end":return e.stop()}}),e,this,[[0,58],[16,50]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"updateProfit",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{this.profit.change+=t.sell().change-t.buy().change,this.profit.change>this.profit.high&&(this.profit.high=this.profit.change),this.profit.change<this.profit.low&&(this.profit.low=this.profit.change),(this.profit.change>5||this.profit.high-this.profit.change>2)&&(console.info("T0Processor stop-profit",this.profit.change,"high = ",this.profit.high,"low = ",this.profit.low),this.stop())}catch(r){console.warn("T0Processor update profit",r)}case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"updateRecord",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(y["a"])(18e4);case 3:t.trend(this.sse.trend(t.code())),this.records.append(t),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.warn("T0Processor update record",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"stop",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.isForceStop=!0,this.sse.stop(),e.abrupt("return",new Promise((function(e){setInterval((function(){t.isRunning||e()}),1e3)})));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"analyseOfBuy",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"analyseOfSell",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),$e=function(e){function t(){var e,r;Object(i["a"])(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Object(E["a"])(this,(e=Object(N["a"])(t)).call.apply(e,[this].concat(a))),Object(u["a"])(Object(K["a"])(r),"period",9),r}return Object(H["a"])(t,e),Object(c["a"])(t,[{key:"start",value:function(){return Object(U["a"])(Object(N["a"])(t.prototype),"start",this).call(this,this.period)}},{key:"monitor",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,t=this.sse.trends();case 2:0,r=(new Date).getTime(),e.t0=a.a.keys(t);case 5:if((e.t1=e.t0()).done){e.next=17;break}if(n=e.t1.value,s=this.sse.trend(n),i=this.sse.stock(n),!(i.change-s.change[0]>3)){e.next=12;break}return console.log("T0LongImpulseProcessor analyseOfBuy",s.time[0],"impulse boom",n,i.change,s.change[0],i.change-s.change[0]),e.abrupt("return",i);case 12:if(!(i.change-s.change[2]>.2)){e.next=15;break}return console.log("T0LongImpulseProcessor analyseOfBuy",s.time[0],"impulse catched",n,i.change,s.change[2],i.change-s.change[2]),e.abrupt("return",i);case 15:e.next=5;break;case 17:return c=(new Date).getTime(),console.log("*",c-r+"ms"),e.next=21,Object(y["a"])(1500);case 21:e.next=2;break;case 23:e.next=28;break;case 25:e.prev=25,e.t2=e["catch"](0),console.warn("T0LongImpulseProcessor monitor ",e.t2);case 28:case"end":return e.stop()}}),e,this,[[0,25]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"analyseOfBuy",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i,c,o,u,l,h,p,f,v,d,b,k,m,y,w,x,g;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.code,e.prev=1,n=this.sse.trend(r),s=this.sse.stock(r),i=.3,c=!1,n.change[0]-n.change[1]>3&&(console.log("T0LongImpulseProcessor analyseOfBuy",n.time[0],"impulse boom",n.change[0],n.change[1],"+".concat(n.change[0]-n.change[1])),c=!0),c){e.next=52;break}if(n.price[0]>=n.ma5[0]&&n.price[0]>n.price[1]&&n.ma5[0]>n.ma5[1]&&n.ma5[1]>n.ma5[2]&&n.ma5[2]>n.ma5[3]){e.next=10;break}return e.abrupt("return");case 10:console.log("T0LongImpulseProcessor analyseOfBuy",n.time[0],"mas valid",n.price[0],n.ma5[0],n.ma5[1],n.ma5[2],n.ma5[3]),o=0,u=0,l=0,0,e.t0=a.a.keys(n.ma5);case 13:if((e.t1=e.t0()).done){e.next=22;break}if(h=e.t1.value,o=+h,+n.volume[o],n.price[o]>u&&(u=n.price[o]),!(n.ma5[o]<n.ma5[o+1])){e.next=20;break}return e.abrupt("break",22);case 20:e.next=13;break;case 22:if(l=n.change[0]-n.change[o],o>=3&&n.price[0]>=u&&l>i){e.next=25;break}return e.abrupt("return");case 25:if(console.log("T0LongImpulseProcessor analyseOfBuy",n.time[0],"impulse valid","tick = ".concat(o),"+".concat(l)),p=!1,f=!1,v=!1,l>i+.3&&n.change[0]-n.change[3]>.8&&(console.log("T0LongImpulseProcessor analyseOfBuy",n.time[0],"impulse L1 breakthrough",n.change[0],n.change[3],"+".concat(n.change[0]-n.change[3])),p=!0),l>i+.5&&n.change[0]-n.change[3]>.5&&(console.log("T0LongImpulseProcessor analyseOfBuy",n.time[0],"impulse L2 breakthrough",n.change[0],n.change[3],"+".concat(n.change[0]-n.change[3])),f=!0),l>i+.7&&n.change[0]-n.change[3]>.2&&(console.log("T0LongImpulseProcessor analyseOfBuy",n.time[0],"impulse L3 breakthrough",n.change[0],n.change[3],"+".concat(n.change[0]-n.change[3])),v=!0),p||f||v){e.next=32;break}return e.abrupt("return");case 32:d=0,b=0,k=0,m=0,y=!0,e.t2=a.a.keys(n.ma20);case 34:if((e.t3=e.t2()).done){e.next=48;break}if(w=e.t3.value,o=+w,0===b&&0===k&&(m=n.volume.slice(0,3).reduce((function(e,t){return e+t})),b=m,k=m),!(n.ma20.length<o+6+1)){e.next=40;break}return e.abrupt("break",48);case 40:x=n.volume.slice(o,o+3).reduce((function(e,t){return e+t})),g=n.volume.slice(o+3,o+6).reduce((function(e,t){return e+t})),b<x&&(b=x),k>x&&(k=x),y&&x>=8*g&&d++,n.ma20[o]<n.ma20[o+1]&&(y=!1),e.next=34;break;case 48:if(m===b&&b>=8*k&&d++,d>=1){e.next=51;break}return e.abrupt("return");case 51:console.log("T0LongImpulseProcessor analyseOfBuy",n.time[0],"volume valid","now = ".concat(m),"high = ".concat(b),"low = ".concat(k),"times = ".concat(d));case 52:return this.analyseOfBuy.change=n.change[0],this.analyseOfSell.high=n.change[0],e.abrupt("return",s);case 57:e.prev=57,e.t4=e["catch"](1),console.warn("T0LongImpulseProcessor analyseOfBuy",e.t4);case 60:case"end":return e.stop()}}),e,this,[[1,57]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"analyseOfSell",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){var r,n,s,i,c,o,u;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=t.code,t.change,e.prev=1,n=0;case 3:if(s=this.sse.stock(r),i=this.sse.trend(r),c=.6,o=.2,s.change>this.analyseOfSell.high&&(this.analyseOfSell.high=s.change),n%this.period!==0){e.next=26;break}if(!(this.analyseOfSell.high-s.change>=c)){e.next=12;break}return console.log("T0LongImpulseProcessor analyseOfSell",i.time[0],"drawdown",this.analyseOfSell.high,s.change),e.abrupt("return",s);case 12:if(!(i.price[0]<i.ma5[0])){e.next=19;break}if(u=!1,this.analyseOfBuy.change-i.change[0]>o&&(u=!0),this.analyseOfSell.high>this.analyseOfBuy.change+o+.1&&i.change[0]-this.analyseOfBuy.change<.1&&(u=!0),!u){e.next=19;break}return console.log("T0LongImpulseProcessor analyseOfSell",i.time[0],"stoploss",this.analyseOfBuy.change,i.change[0]),e.abrupt("return",s);case 19:if(i.price[0]>i.ma5[0]&&i.price[0]>i.ma10[0]){e.next=26;break}if(!(i.ma10[0]<=i.ma10[1])){e.next=23;break}return console.log("T0LongImpulseProcessor analyseOfSell",i.time[0],"ma10 reverse",i.ma10[0],i.ma10[1]),e.abrupt("return",s);case 23:if(!(i.ma5[0]<=i.ma10[0])){e.next=26;break}return console.log("T0LongImpulseProcessor analyseOfSell",i.time[0],"ma down ma5 <= ma10",i.ma5[0],i.ma10[0]),e.abrupt("return",s);case 26:return n++,e.next=29,Object(y["a"])(1e3);case 29:e.next=3;break;case 31:e.next=37;break;case 33:return e.prev=33,e.t0=e["catch"](1),console.warn("T0LongImpulseProcessor analyseOfSell",e.t0),e.abrupt("return",this.sse.stock(r));case 37:case"end":return e.stop()}}),e,this,[[1,33]])})));function t(t){return e.apply(this,arguments)}return t}()}]),t}(Ge),Xe=function(e){function t(){return Object(i["a"])(this,t),Object(E["a"])(this,Object(N["a"])(t).apply(this,arguments))}return Object(H["a"])(t,e),Object(c["a"])(t,[{key:"start",value:function(){return Object(U["a"])(Object(N["a"])(t.prototype),"start",this).call(this,6)}},{key:"monitor",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"analyseOfBuy",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.code;case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"analyseOfSell",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.code,t.change;case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),t}(Ge),ze={"long-impulse":$e,"short-impulse":Xe};function Je(e,t){try{var r=.3,n=!1;if(e.change[0]-e.change[1]>3&&(console.info("T0LongImpulseProcessor analyseOfBuy",e.time[0],"impulse boom",e.change[0],e.change[1],"+".concat(e.change[0]-e.change[1])),n=!0),!n){if(!(e.price[0]>=e.ma5[0]&&e.price[0]>e.price[1]&&e.ma5[0]>e.ma5[1]&&e.ma5[1]>e.ma5[2]&&e.ma5[2]>e.ma5[3]))return;console.info("T0LongImpulseProcessor analyseOfBuy",e.time[0],"mas valid",e.price[0],e.ma5[0],e.ma5[1],e.ma5[2],e.ma5[3]);var a=0,s=0,i=0;for(var c in e.ma5)if(a=+c,+e.volume[a],e.price[a]>s&&(s=e.price[a]),e.ma5[a]<e.ma5[a+1])break;if(i=e.change[0]-e.change[a],!(a>=3&&e.price[0]>=s&&i>r))return;console.info("T0LongImpulseProcessor analyseOfBuy",e.time[0],"impulse valid","tick = ".concat(a),"+".concat(i));var o=!1,u=!1,l=!1;if(i>r+.3&&e.change[0]-e.change[3]>.8&&(console.info("T0LongImpulseProcessor analyseOfBuy",e.time[0],"impulse L1 breakthrough",e.change[0],e.change[3],"+".concat(e.change[0]-e.change[3])),o=!0),i>r+.5&&e.change[0]-e.change[3]>.5&&(console.info("T0LongImpulseProcessor analyseOfBuy",e.time[0],"impulse L2 breakthrough",e.change[0],e.change[3],"+".concat(e.change[0]-e.change[3])),u=!0),i>r+.7&&e.change[0]-e.change[3]>.2&&(console.info("T0LongImpulseProcessor analyseOfBuy",e.time[0],"impulse L3 breakthrough",e.change[0],e.change[3],"+".concat(e.change[0]-e.change[3])),l=!0),!(o||u||l))return;var h=0,p=0,f=0,v=0,d=!0;for(var b in e.ma20){if(a=+b,0===p&&0===f&&(v=e.volume.slice(0,3).reduce((function(e,t){return e+t})),p=v,f=v),e.ma20.length<a+6+1)break;var k=e.volume.slice(a,a+3).reduce((function(e,t){return e+t})),m=e.volume.slice(a+3,a+6).reduce((function(e,t){return e+t}));p<k&&(p=k),f>k&&(f=k),d&&k>=8*m&&h++,e.ma20[a]<e.ma20[a+1]&&(d=!1)}if(v===p&&p>=8*f&&h++,!(h>=1))return;console.info("T0LongImpulseProcessor analyseOfBuy",e.time[0],"volume valid","now = ".concat(v),"high = ".concat(p),"low = ".concat(f),"times = ".concat(h))}return Je.change=e.change[0],Qe.high=e.change[0],!0}catch(y){console.warn("T0LongImpulseProcessor analyseOfBuy",y)}}function Qe(e,t){t.change;try{var r={change:e.change[0],price:e.price[0]},n=.6,a=.2;if(r.change>Qe.high&&(Qe.high=r.change),Qe.high-r.change>=n)return console.info("T0LongImpulseProcessor analyseOfSell",e.time[0],"period drawdown",Qe.high,r.change),r;if(e.price[0]<e.ma5[0]){var s=!1;if(Je.change-e.change[0]>a&&(s=!0),Qe.high>Je.change+a+.1&&e.change[0]-Je.change<.1&&(s=!0),s)return console.info("T0LongImpulseProcessor analyseOfSell",e.time[0],"stoploss",Je.change,e.change[0]),r}if(!(e.price[0]>e.ma5[0]&&e.price[0]>e.ma10[0])){if(e.ma10[0]<=e.ma10[1])return console.info("T0LongImpulseProcessor analyseOfSell",e.time[0],"ma10 reverse",e.ma10[0],e.ma10[1]),r;if(e.ma5[0]<=e.ma10[0])return console.info("T0LongImpulseProcessor analyseOfSell",e.time[0],"ma down ma5 <= ma10",e.ma5[0],e.ma10[0]),r}}catch(i){console.warn("T0LongImpulseProcessor analyseOfSell",i)}}var Ze={analyseOfBuy:Je,analyseOfSell:Qe};function et(e){}function tt(e){}var rt={analyseOfBuy:et,analyseOfSell:tt},nt={"long-impulse":Ze,"short-impulse":rt},at=function(e){function t(){return Object(i["a"])(this,t),Object(E["a"])(this,Object(N["a"])(t).apply(this,arguments))}return Object(H["a"])(t,e),Object(c["a"])(t,[{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(){var t,r,n,s,i,c,o,u,l;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[],e.next=3,f["a"].captureList(I["pb"].key);case 3:r=e.sent,n=!0,s=!1,i=void 0,e.prev=7,c=r[Symbol.iterator]();case 9:if(n=(o=c.next()).done){e.next=20;break}return u=o.value.code,l=d["a"].stockOfBond(u),e.next=14,M.isValidStock(l,"");case 14:if(e.sent){e.next=16;break}return e.abrupt("continue",17);case 16:t.push(u);case 17:n=!0,e.next=9;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e["catch"](7),s=!0,i=e.t0;case 26:e.prev=26,e.prev=27,n||null==c["return"]||c["return"]();case 29:if(e.prev=29,!s){e.next=32;break}throw i;case 32:return e.finish(29);case 33:return e.finish(26);case 34:return e.abrupt("return",t);case 35:case"end":return e.stop()}}),e,null,[[7,22,26,34],[27,,29,33]])})));function t(){return e.apply(this,arguments)}return t}()}]),t}(Ne);Object(u["a"])(at,"Processors",ze),Object(u["a"])(at,"Simulators",nt);var st=function(e){function t(){return Object(i["a"])(this,t),Object(E["a"])(this,Object(N["a"])(t).apply(this,arguments))}return Object(H["a"])(t,e),Object(c["a"])(t,[{key:"start",value:function(){return Object(U["a"])(Object(N["a"])(t.prototype),"start",this).call(this,6)}},{key:"monitor",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"analyseOfBuy",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.code;case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"analyseOfSell",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.code,t.change;case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),t}(Ge),it=function(e){function t(){return Object(i["a"])(this,t),Object(E["a"])(this,Object(N["a"])(t).apply(this,arguments))}return Object(H["a"])(t,e),Object(c["a"])(t,[{key:"start",value:function(){return Object(U["a"])(Object(N["a"])(t.prototype),"start",this).call(this,6)}},{key:"monitor",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"analyseOfBuy",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.code;case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"analyseOfSell",value:function(){var e=Object(s["a"])(a.a.mark((function e(t){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.code,t.change;case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),t}(Ge),ct={"long-impulse":st,"short-impulse":it};function ot(e){}function ut(e){}var lt={analyseOfBuy:ot,analyseOfSell:ut};function ht(e){}function pt(e){}var ft={analyseOfBuy:ht,analyseOfSell:pt},vt={"long-impulse":lt,"short-impulse":ft},dt=function(e){function t(){return Object(i["a"])(this,t),Object(E["a"])(this,Object(N["a"])(t).apply(this,arguments))}return Object(H["a"])(t,e),Object(c["a"])(t,[{key:"capture",value:function(){var e=Object(s["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}]),t}(Ne);Object(u["a"])(dt,"Processors",ct),Object(u["a"])(dt,"Simulators",vt);var bt=function(){function e(){Object(i["a"])(this,e),Object(u["a"])(this,"Controllers",{bond:at,future:dt})}return Object(c["a"])(e,[{key:"processor",value:function(e,t,r){var n=this.Controllers[e],a=this.Controllers[e].Processors[t];return new n(a,e,t,r)}},{key:"simulator",value:function(e,t,r,n,a){var s=this.Controllers[e].Simulators[t];return new Ee(s,r,n,a)}},{key:"processors",value:function(e){return this.Controllers[e].Processors}},{key:"simulators",value:function(e){return this.Controllers[e].Simulators}}]),e}(),kt=new bt;window.__Walle_Stock_Loop=Le,window.__Walle_Stock_Controller=ve,window.__Walle_Stock_Pool=k["a"],window.__Walle_Stock_Bond=se,window.__Walle_Stock_Flow=C,window.__Walle_Stock_Gene=P,window.__Walle_Stock_Crawler=f["a"],window.__Walle_Stock_Trader=G["a"],window.__Walle_Stock_Twist=Z,window.__Walle_Stock_Strategy=De.a,window.__Walle_Stock_Define=I["qb"],window.__Walle_Stock_Market=ke,window.__Walle_Stock_Whitelist=d["a"],window.__Walle_Stock_Cron=b["a"],window.__Walle_Stock_Validator=M,window.__Walle_Stock_Mail=V["a"],window.__Walle_Stock_Captcha=Ye["a"],window.__Walle_Stock_Config=v["a"],window.__Walle_Stock_T0=kt},"13d5":function(e,t,r){"use strict";var n=r("23e7"),a=r("d58f").left,s=r("a640"),i=r("ae40"),c=s("reduce"),o=i("reduce",{1:0});n({target:"Array",proto:!0,forced:!c||!o},{reduce:function(e){return a(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"1ba9":function(e,t,r){function n(){}function a(e,t,r,n){n>=0?(e.day.up++,e.profit.max+=n,e.profit.max=+e.profit.max.toFixed(2)):e.day.down++,e.day.normal++,e.profit.normal+=n,e.profit.normal=+e.profit.normal.toFixed(2),e.profitrate.normal=+(e.profit.normal/e.day.normal).toFixed(2),e.winrate.normal=+(e.day.up/e.day.normal*100).toFixed(2),e["daily-open-ptcchange"].push(t,r),e["daily-close-ptcchange"].push(t,n);var a=e["daily-open-profit"].length,s=e["daily-close-profit"].length,i=e["daily-open-profit"][a-1]||0,c=e["daily-close-profit"][s-1]||0;i+=r,c+=n,i=+i.toFixed(2),c=+c.toFixed(2),e["daily-open-profit"].push(t,i),e["daily-close-profit"].push(t,c)}r("b680"),e.exports={init:n,process:a}},"21a6":function(e,t,r){(function(r){var n,a,s;(function(r,i){a=[],n=i,s="function"===typeof n?n.apply(t,a):n,void 0===s||(e.exports=s)})(0,(function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function n(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){c(n.response,t,r)},n.onerror=function(){console.error("could not download file")},n.send()}function a(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function s(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof r&&r.global===r?r:void 0,c=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype?function(e,t,r){var c=i.URL||i.webkitURL,o=document.createElement("a");t=t||e.name||"download",o.download=t,o.rel="noopener","string"==typeof e?(o.href=e,o.origin===location.origin?s(o):a(o.href)?n(e,t,r):s(o,o.target="_blank")):(o.href=c.createObjectURL(e),setTimeout((function(){c.revokeObjectURL(o.href)}),4e4),setTimeout((function(){s(o)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,r,i){if(r=r||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,i),r);else if(a(e))n(e,r,i);else{var c=document.createElement("a");c.href=e,c.target="_blank",setTimeout((function(){s(c)}))}}:function(e,t,r,a){if(a=a||open("","_blank"),a&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return n(e,t,r);var s="application/octet-stream"===e.type,c=/constructor/i.test(i.HTMLElement)||i.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&c)&&"object"==typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=o?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},u.readAsDataURL(e)}else{var l=i.URL||i.webkitURL,h=l.createObjectURL(e);a?a.location=h:location.href=h,a=null,setTimeout((function(){l.revokeObjectURL(h)}),4e4)}});i.saveAs=c.saveAs=c,e.exports=c}))}).call(this,r("c8ba"))},"25f0":function(e,t,r){"use strict";var n=r("6eeb"),a=r("825a"),s=r("d039"),i=r("ad6d"),c="toString",o=RegExp.prototype,u=o[c],l=s((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),h=u.name!=c;(l||h)&&n(RegExp.prototype,c,(function(){var e=a(this),t=String(e.source),r=e.flags,n=String(void 0===r&&e instanceof RegExp&&!("flags"in o)?i.call(e):r);return"/"+t+"/"+n}),{unsafe:!0})},"26e9":function(e,t,r){"use strict";var n=r("23e7"),a=r("e8b5"),s=[].reverse,i=[1,2];n({target:"Array",proto:!0,forced:String(i)===String(i.reverse())},{reverse:function(){return a(this)&&(this.length=this.length),s.call(this)}})},"29b1":function(e,t,r){r("b680");var n=r("870f"),a=20,s=0,i=0,c={};function o(){s=0,0,i=0,c={}}function u(e,t,r,s){var o=0;o=c.date?n.getPTCChange(c.open,c.close):n.getPTCChange(r,s),o>=a?i++:i=0,c={date:t,open:r,close:s}}function l(e,t,r,s){var c=n.getPTCChange(r,s);c>=a?i++:i=0}function h(e,t,r,a){var c=n.getPTCChange(r,a);i>=2&&(e.day.hot++,e.profit["hot"]=+(e.profit["hot"]+c).toFixed(2),e.profitrate["hot"]=+(e.profit["hot"]/e.day["hot"]).toFixed(2),c>0?s++:0,e.winrate["hot"]=+(s/e.day["hot"]*100).toFixed(2)),window?u(e,t,r,a):l(e,t,r,a)}e.exports={process:h,init:o}},"2c5c":function(e,t){var r={};function n(e,t,n){for(var a in r={},e){var s=e[a],i=+a+1+"";e[i]?n[a]>0&&n[i]>0?r[s]="+":n[a]<0&&n[i]<0?r[s]="-":r[s]="~":r[s]="~"}}function a(e,t,n){for(var a in r={},e){var s=e[a],i=+a+1+"",c=+a+2+"";e[i]&&e[c]?n[i]>0&&n[c]>0?r[s]="+":n[i]<0&&n[c]<0?r[s]="-":r[s]="~":r[s]="~"}}function s(e,t,r){window?n(e,t,r):a(e,t,r)}function i(e){return r[e]||"~"}e.exports={process:s,trend:i}},"32a9":function(e,t,r){r("b680");var n=r("870f"),a=r("2c5c"),s=0;function i(){s=0,0}function c(e,t,r,i){var c=n.getPTCChange(r,i),o=a.trend(t);"+"===o&&(e.day["up-trade"]++,e.profit["up-trade"]=+(e.profit["up-trade"]+c).toFixed(2),e.profitrate["up-trade"]=+(e.profit["up-trade"]/e.day["up-trade"]).toFixed(2),c>0?s++:0,e.winrate["up-trade"]=+(s/e.day["up-trade"]*100).toFixed(2))}e.exports={process:c,init:i}},"3f62":function(e,t,r){r("b680");var n=r("870f"),a=1,s=0;function i(){s=0,0,a=1}function c(e,t,r,i){var c=n.getPTCChange(r,i);a*=1+c/100*.1,e.profit["compound"]=1e3*(a-1),e.profit["compound"]=+e.profit["compound"].toFixed(2),e.day["compound"]++,e.profitrate["compound"]=+(e.profit["compound"]/e.day["compound"]).toFixed(2),c>0?s++:0,e.winrate["compound"]=+(s/e.day["compound"]*100).toFixed(2)}e.exports={process:c,init:i}},"466d":function(e,t,r){"use strict";var n=r("d784"),a=r("825a"),s=r("50c4"),i=r("1d80"),c=r("8aa5"),o=r("14c3");n("match",1,(function(e,t,r){return[function(t){var r=i(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,r):new RegExp(t)[e](String(r))},function(e){var n=r(t,e,this);if(n.done)return n.value;var i=a(e),u=String(this);if(!i.global)return o(i,u);var l=i.unicode;i.lastIndex=0;var h,p=[],f=0;while(null!==(h=o(i,u))){var v=String(h[0]);p[f]=v,""===v&&(i.lastIndex=c(u,s(i.lastIndex),l)),f++}return 0===f?null:p}]}))},"4de4":function(e,t,r){"use strict";var n=r("23e7"),a=r("b727").filter,s=r("1dde"),i=r("ae40"),c=s("filter"),o=i("filter");n({target:"Array",proto:!0,forced:!c||!o},{filter:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},5530:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("ade3");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){Object(n["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}},"5ca6":function(e,t,r){r("a4d3"),r("e01a"),r("d28b"),r("caad"),r("a9e3"),r("9129"),r("d3b7"),r("2532"),r("3ca3"),r("ddb0");var n=r("a34a");r("96cf");var a=r("c973"),s=r("ce69"),i=s.generate,c=r("2c5c"),o=[r("1ba9"),r("870f"),r("71cc"),r("3f62"),r("29b1"),r("32a9"),r("c116")];function u(e,t){return l.apply(this,arguments)}function l(){return l=a(n.mark((function e(t,r){var a,s,u,l,h,p,f,v,d,b,k,m,y,w,x,g,O,j,S,_,C;return n.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=i(t),e.prev=1,r){e.next=4;break}return e.abrupt("return",a);case 4:for(s=r.date,u=r.open,l=r.close,t.includes("上证指数")&&c.process(s,u,l),h=!0,p=!1,f=void 0,e.prev=11,v=o[Symbol.iterator]();!(h=(d=v.next()).done);h=!0)b=d.value,b.init();e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](11),p=!0,f=e.t0;case 19:e.prev=19,e.prev=20,h||null==v["return"]||v["return"]();case 22:if(e.prev=22,!p){e.next=25;break}throw f;case 25:return e.finish(22);case 26:return e.finish(19);case 27:k=s.length,m=0;case 29:if(!(m<k)){e.next=57;break}for(y=s[m],w=u[m],x=l[m],Number.isNaN(+w)&&(w=0),Number.isNaN(+x)&&(x=0),g=!0,O=!1,j=void 0,e.prev=38,S=o[Symbol.iterator]();!(g=(_=S.next()).done);g=!0)C=_.value,C.process(a,y,w,x);e.next=46;break;case 42:e.prev=42,e.t1=e["catch"](38),O=!0,j=e.t1;case 46:e.prev=46,e.prev=47,g||null==S["return"]||S["return"]();case 49:if(e.prev=49,!O){e.next=52;break}throw j;case 52:return e.finish(49);case 53:return e.finish(46);case 54:m++,e.next=29;break;case 57:e.next=62;break;case 59:e.prev=59,e.t2=e["catch"](1),console.log("#strategy# analyse fail: ",e.t2);case 62:return e.abrupt("return",a);case 63:case"end":return e.stop()}}),e,null,[[1,59],[11,15,19,27],[20,,22,26],[38,42,46,54],[47,,49,53]])}))),l.apply(this,arguments)}e.exports={analyse:u}},"71cc":function(e,t,r){r("b680");var n=r("870f"),a=2,s=0,i=0,c=!1,o={};function u(){s=0,0,0,i=0,c=!1,o={}}function l(e){return c}function h(e,t,r,a){var s=0;s=o.date?n.getPTCChange(o.open,o.close):n.getPTCChange(r,a),s>=0?(i=0):(0,i++),o={date:t,open:r,close:a}}function p(e,t,r,a){var s=n.getPTCChange(r,a);s>=0?(i=0):(0,i++)}function f(e,t,r,o){var u=n.getPTCChange(r,o);i<a?(c=!1,e.day.trade++,e.profit.strategy+=u,e.profit.strategy=+e.profit.strategy.toFixed(2),e.profitrate["strategy"]=+(e.profit["strategy"]/e.day["trade"]).toFixed(2),u>0?s++:0,e.winrate["strategy"]=+(s/e.day["trade"]*100).toFixed(2)):(c=!0,e.day.rest++),window?h(e,t,r,o):p(e,t,r,o)}e.exports={isPeriodRest:l,process:f,init:u}},"870f":function(e,t,r){r("b680");var n=-10;function a(){}function s(e,t){return e<n?e:t<n?n:t}function i(e,t,r,a){var s=0;return r<n?(s=r,e.day["open-crash"]++,e.profit["open-crash"]+=s,e.profit["open-crash"]=+e.profit["open-crash"].toFixed(2),a>0&&(e.day["reverse-crash"]++,e.profit["reverse-crash"]+=a+-n,e.profit["reverse-crash"]=+e.profit["reverse-crash"].toFixed(2))):a<n?(s=n,e.day["stop-crash"]++,e.profit["stop-crash"]+=a+-n,e.profit["stop-crash"]=+e.profit["stop-crash"].toFixed(2)):s=a,s}e.exports={init:a,process:i,getPTCChange:s}},9129:function(e,t,r){var n=r("23e7");n({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})},c116:function(e,t,r){r("b680");var n=r("870f"),a=r("2c5c"),s=0;function i(){s=0,0}function c(e,t,r,i){var c=n.getPTCChange(r,i),o=a.trend(t);"-"===o&&(e.day["down-trade"]++,e.profit["down-trade"]=+(e.profit["down-trade"]+c).toFixed(2),e.profitrate["down-trade"]=+(e.profit["down-trade"]/e.day["down-trade"]).toFixed(2),c>0?s++:0,e.winrate["down-trade"]=+(s/e.day["down-trade"]*100).toFixed(2))}e.exports={process:c,init:i}},c973:function(e,t){function r(e,t,r,n,a,s,i){try{var c=e[s](i),o=c.value}catch(u){return void r(u)}c.done?t(o):Promise.resolve(o).then(n,a)}function n(e){return function(){var t=this,n=arguments;return new Promise((function(a,s){var i=e.apply(t,n);function c(e){r(i,a,s,c,o,"next",e)}function o(e){r(i,a,s,c,o,"throw",e)}c(void 0)}))}}e.exports=n},ce69:function(e,t){function r(e){return{name:e,profit:{max:0,"open-crash":-0,"stop-crash":0,"reverse-crash":0,normal:0,strategy:0,compound:0,hot:0,"up-trade":0,"down-trade":0},day:{normal:0,up:0,down:0,"open-crash":0,"stop-crash":0,"reverse-crash":0,trade:0,rest:0,compound:0,hot:0,"up-trade":0,"down-trade":0},profitrate:{normal:0,strategy:0,compound:0,hot:0,"up-trade":0,"down-trade":0},winrate:{normal:0,strategy:0,compound:0,hot:0,"up-trade":0,"down-trade":0},"daily-open-profit":[],"daily-close-profit":[],"daily-open-ptcchange":[],"daily-close-ptcchange":[]}}e.exports={generate:r}},d58f:function(e,t,r){var n=r("1c0b"),a=r("7b0b"),s=r("44ad"),i=r("50c4"),c=function(e){return function(t,r,c,o){n(r);var u=a(t),l=s(u),h=i(u.length),p=e?h-1:0,f=e?-1:1;if(c<2)while(1){if(p in l){o=l[p],p+=f;break}if(p+=f,e?p<0:h<=p)throw TypeError("Reduce of empty array with no initial value")}for(;e?p>=0:h>p;p+=f)p in l&&(o=r(o,l[p],p,u));return o}};e.exports={left:c(!1),right:c(!0)}}}]);