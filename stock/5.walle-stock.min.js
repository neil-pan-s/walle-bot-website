(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{561:function(e,t,n){n(98);e.exports={init:function(){},process:function(e,t,n,r){var a=0;return n<-10?(a=n,e.day["open-crash"]++,e.profit["open-crash"]+=a,e.profit["open-crash"]=+e.profit["open-crash"].toFixed(2),r>0&&(e.day["reverse-crash"]++,e.profit["reverse-crash"]+=r+10,e.profit["reverse-crash"]=+e.profit["reverse-crash"].toFixed(2))):r<-10?(a=-10,e.day["stop-crash"]++,e.profit["stop-crash"]+=r+10,e.profit["stop-crash"]=+e.profit["stop-crash"].toFixed(2)):a=r,a},getPTCChange:function(e,t){return e<-10?e:t<-10?-10:t}}},654:function(e,t){var n={};e.exports={process:function(e,t,r){window?function(e,t,r){for(var a in n={},e){var s=e[a],i=+a+1+"";e[i]?r[a]>0&&r[i]>0?n[s]="+":r[a]<0&&r[i]<0?n[s]="-":n[s]="~":n[s]="~"}}(e,0,r):function(e,t,r){for(var a in n={},e){var s=e[a],i=+a+1+"",o=+a+2+"";e[i]&&e[o]?r[i]>0&&r[o]>0?n[s]="+":r[i]<0&&r[o]<0?n[s]="-":n[s]="~":n[s]="~"}}(e,0,r)},trend:function(e){return n[e]||"~"}}},963:function(e,t,n){n(49),n(50),n(51),n(40),n(148),n(791),n(24),n(52),n(39),n(30);var r=n(1);n(21);var a=n(964),s=n(965).generate,i=n(654),o=[n(966),n(561),n(967),n(968),n(969),n(970),n(971)];function c(){return(c=a(r.mark((function e(t,n){var a,c,u,h,l,p,f,g,d,v,k,y,b,m,A,w,x,O,j;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=s(t),e.prev=1,n){e.next=4;break}return e.abrupt("return",a);case 4:for(c=n.date,u=n.open,h=n.close,t.includes("上证指数")&&i.process(c,u,h),l=!0,p=!1,f=void 0,e.prev=11,g=o[Symbol.iterator]();!(l=(d=g.next()).done);l=!0)d.value.init();e.next=19;break;case 15:e.prev=15,e.t0=e.catch(11),p=!0,f=e.t0;case 19:e.prev=19,e.prev=20,l||null==g.return||g.return();case 22:if(e.prev=22,!p){e.next=25;break}throw f;case 25:return e.finish(22);case 26:return e.finish(19);case 27:v=c.length,k=0;case 29:if(!(k<v)){e.next=57;break}for(y=c[k],b=u[k],m=h[k],Number.isNaN(+b)&&(b=0),Number.isNaN(+m)&&(m=0),A=!0,w=!1,x=void 0,e.prev=38,O=o[Symbol.iterator]();!(A=(j=O.next()).done);A=!0)j.value.process(a,y,b,m);e.next=46;break;case 42:e.prev=42,e.t1=e.catch(38),w=!0,x=e.t1;case 46:e.prev=46,e.prev=47,A||null==O.return||O.return();case 49:if(e.prev=49,!w){e.next=52;break}throw x;case 52:return e.finish(49);case 53:return e.finish(46);case 54:k++,e.next=29;break;case 57:e.next=62;break;case 59:e.prev=59,e.t2=e.catch(1),console.log("#strategy# analyse fail: ",e.t2);case 62:return e.abrupt("return",a);case 63:case"end":return e.stop()}}),e,null,[[1,59],[11,15,19,27],[20,,22,26],[38,42,46,54],[47,,49,53]])})))).apply(this,arguments)}e.exports={analyse:function(e,t){return c.apply(this,arguments)}}},965:function(e,t){e.exports={generate:function(e){return{name:e,profit:{max:0,"open-crash":-0,"stop-crash":0,"reverse-crash":0,normal:0,strategy:0,compound:0,hot:0,"up-trade":0,"down-trade":0},day:{normal:0,up:0,down:0,"open-crash":0,"stop-crash":0,"reverse-crash":0,trade:0,rest:0,compound:0,hot:0,"up-trade":0,"down-trade":0},profitrate:{normal:0,strategy:0,compound:0,hot:0,"up-trade":0,"down-trade":0},winrate:{normal:0,strategy:0,compound:0,hot:0,"up-trade":0,"down-trade":0},"daily-open-profit":[],"daily-close-profit":[],"daily-open-ptcchange":[],"daily-close-ptcchange":[]}}}},966:function(e,t,n){n(98),e.exports={init:function(){},process:function(e,t,n,r){r>=0?(e.day.up++,e.profit.max+=r,e.profit.max=+e.profit.max.toFixed(2)):e.day.down++,e.day.normal++,e.profit.normal+=r,e.profit.normal=+e.profit.normal.toFixed(2),e.profitrate.normal=+(e.profit.normal/e.day.normal).toFixed(2),e.winrate.normal=+(e.day.up/e.day.normal*100).toFixed(2),e["daily-open-ptcchange"].push(t,n),e["daily-close-ptcchange"].push(t,r);var a=e["daily-open-profit"].length,s=e["daily-close-profit"].length,i=e["daily-open-profit"][a-1]||0,o=e["daily-close-profit"][s-1]||0;o+=r,i=+(i+=n).toFixed(2),o=+o.toFixed(2),e["daily-open-profit"].push(t,i),e["daily-close-profit"].push(t,o)}}},967:function(e,t,n){n(98);var r=n(561),a=0,s=0,i=!1,o={};e.exports={isPeriodRest:function(e){return i},process:function(e,t,n,c){var u=r.getPTCChange(n,c);s<2?(i=!1,e.day.trade++,e.profit.strategy+=u,e.profit.strategy=+e.profit.strategy.toFixed(2),e.profitrate.strategy=+(e.profit.strategy/e.day.trade).toFixed(2),u>0?a++:0,e.winrate.strategy=+(a/e.day.trade*100).toFixed(2)):(i=!0,e.day.rest++),window?function(e,t,n,a){(o.date?r.getPTCChange(o.open,o.close):r.getPTCChange(n,a))>=0?(s=0):(0,s++),o={date:t,open:n,close:a}}(0,t,n,c):function(e,t,n,a){r.getPTCChange(n,a)>=0?(s=0):(0,s++)}(0,0,n,c)},init:function(){a=0,0,0,s=0,i=!1,o={}}}},968:function(e,t,n){n(98);var r=n(561),a=1,s=0;e.exports={process:function(e,t,n,i){var o=r.getPTCChange(n,i);a*=1+o/100*.1,e.profit.compound=1e3*(a-1),e.profit.compound=+e.profit.compound.toFixed(2),e.day.compound++,e.profitrate.compound=+(e.profit.compound/e.day.compound).toFixed(2),o>0?s++:0,e.winrate.compound=+(s/e.day.compound*100).toFixed(2)},init:function(){s=0,0,a=1}}},969:function(e,t,n){n(98);var r=n(561),a=0,s=0,i={};e.exports={process:function(e,t,n,o){var c=r.getPTCChange(n,o);s>=2&&(e.day.hot++,e.profit.hot=+(e.profit.hot+c).toFixed(2),e.profitrate.hot=+(e.profit.hot/e.day.hot).toFixed(2),c>0?a++:0,e.winrate.hot=+(a/e.day.hot*100).toFixed(2)),window?function(e,t,n,a){(i.date?r.getPTCChange(i.open,i.close):r.getPTCChange(n,a))>=20?s++:s=0,i={date:t,open:n,close:a}}(0,t,n,o):function(e,t,n,a){r.getPTCChange(n,a)>=20?s++:s=0}(0,0,n,o)},init:function(){a=0,0,s=0,i={}}}},970:function(e,t,n){n(98);var r=n(561),a=n(654),s=0;e.exports={process:function(e,t,n,i){var o=r.getPTCChange(n,i);"+"===a.trend(t)&&(e.day["up-trade"]++,e.profit["up-trade"]=+(e.profit["up-trade"]+o).toFixed(2),e.profitrate["up-trade"]=+(e.profit["up-trade"]/e.day["up-trade"]).toFixed(2),o>0?s++:0,e.winrate["up-trade"]=+(s/e.day["up-trade"]*100).toFixed(2))},init:function(){s=0,0}}},971:function(e,t,n){n(98);var r=n(561),a=n(654),s=0;e.exports={process:function(e,t,n,i){var o=r.getPTCChange(n,i);"-"===a.trend(t)&&(e.day["down-trade"]++,e.profit["down-trade"]=+(e.profit["down-trade"]+o).toFixed(2),e.profitrate["down-trade"]=+(e.profit["down-trade"]/e.day["down-trade"]).toFixed(2),o>0?s++:0,e.winrate["down-trade"]=+(s/e.day["down-trade"]*100).toFixed(2))},init:function(){s=0,0}}},998:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),s=(n(21),n(2)),i=n(5),o=n(6),c=(n(49),n(50),n(51),n(27),n(41),n(24),n(39),n(30),n(562)),u=n(3),h=function e(t){var n=t.capture,r=t.trace,a=t.interval,s=t.lists,o=t.date,c=t.name;Object(i.a)(this,e),Object(u.a)(this,"capture",void 0),Object(u.a)(this,"trace",[]),Object(u.a)(this,"interval",void 0),Object(u.a)(this,"lists",void 0),Object(u.a)(this,"date",void 0),Object(u.a)(this,"name",void 0),this.capture=n,this.trace=r,this.interval=a,this.lists=s,this.name=c,this.date=o},l=(n(40),n(62),n(64),n(28),n(52),n(601),n(357),n(577)),p=(n(146),n(527),n(148),n(791),n(98),n(557),n(63),n(147),n(44)),f=n(539),g=n(544),d=(n(42),n(552)),v=n(541),k=n(554),y=n(747),b=n(546),m=n(0),A=n.n(m),w=n(7),x=n.n(w),O=x.a.createInstance({name:"flow",driver:x.a.INDEXEDDB}),j=new(function(){function e(){Object(i.a)(this,e),Object(u.a)(this,"keys",[]),Object(u.a)(this,"lastFlowDate","");(parent.location.hash||location.hash).includes("9529")}var t,n,r,c,h,l,g,m,w;return Object(o.a)(e,[{key:"load",value:(w=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.codes();case 3:if(this.keys&&this.keys.length){e.next=6;break}return console.log("#Flows# flows not exist!"),e.abrupt("return");case 6:return e.next=8,this.flow("1.000001");case 8:t=e.sent,this.lastFlowDate=t[0].date,console.info("#Flows# load flows ".concat(this.keys.length," date ").concat(this.lastFlowDate," ...")),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.warn("#Flows# load flows fail ",e.t0);case 16:case"end":return e.stop()}}),e,this,[[0,13]])}))),function(){return w.apply(this,arguments)})},{key:"save",value:(m=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.length>300&&(n=n.slice(0,300)),e.abrupt("return",O.setItem(t,n));case 2:case"end":return e.stop()}}),e)}))),function(e,t){return m.apply(this,arguments)})},{key:"download",value:(g=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o,c,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=[].concat(d.a.stocks(),d.a.bonds()),t=[].concat(t,"1.000001"),console.time("Flows Download"),n=!0,r=!1,s=void 0,e.prev=7,i=t[Symbol.iterator]();case 9:if(n=(o=i.next()).done){e.next=28;break}if(c=o.value,e.prev=11,!this.keys.includes(c)){e.next=14;break}return e.abrupt("continue",25);case 14:return e.next=16,this.capture(c);case 16:return u=e.sent,e.next=19,this.save(c,u);case 19:return e.next=21,Object(b.a)(50);case 21:e.next=25;break;case 23:e.prev=23,e.t0=e.catch(11);case 25:n=!0,e.next=9;break;case 28:e.next=34;break;case 30:e.prev=30,e.t1=e.catch(7),r=!0,s=e.t1;case 34:e.prev=34,e.prev=35,n||null==i.return||i.return();case 37:if(e.prev=37,!r){e.next=40;break}throw s;case 40:return e.finish(37);case 41:return e.finish(34);case 42:console.timeEnd("Flows Download"),e.next=48;break;case 45:e.prev=45,e.t2=e.catch(0),console.warn("#Flows# download flows fail ",e.t2);case 48:case"end":return e.stop()}}),e,this,[[0,45],[7,30,34,42],[11,23],[35,,37,41]])}))),function(){return g.apply(this,arguments)})},{key:"update",value:(l=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o,c,u,h,l,p,f,g,d,b,m,w,x;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.keys&&this.keys.length){e.next=3;break}return console.log("#Flows# flows not exist, update exit !"),e.abrupt("return");case 3:if(t=A()().format("YYYYMMDD"),n=A()().format("HHmmss"),v.a.isWeekend()||!(+n<15e4)){e.next=33;break}return e.next=8,v.a.when("150000");case 8:console.info("#Flows# auto update daily ..."),r=k.a.all(),e.t0=a.a.keys(r);case 11:if((e.t1=e.t0()).done){e.next=33;break}return s=e.t1.value,e.prev=13,i=r[s],o=i.name,c=i.price,u=i.change,h=i.netinflow,l=i.rate,p=i.open,f=i.close,g=i.high,d=i.low,b=i.volume,e.next=17,this.flow(s);case 17:if(m=e.sent,!((w=m[0])&&+w.date>=+t)){e.next=21;break}return e.abrupt("continue",11);case 21:if(w.price!==c||w.rate!==l||w.netinflow!==h){e.next=23;break}return e.abrupt("continue",11);case 23:return x=new y.a({code:s,name:o,date:t,price:c,change:u,open:p,close:f,high:g,low:d,volume:b,netinflow:h,netinflowrate:l}),m.unshift(x),e.next=27,this.save(s,m);case 27:e.next=31;break;case 29:e.prev=29,e.t2=e.catch(13);case 31:e.next=11;break;case 33:case"end":return e.stop()}}),e,this,[[13,29]])}))),function(){return l.apply(this,arguments)})},{key:"codes",value:(h=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.keys||!this.keys.length){e.next=2;break}return e.abrupt("return",this.keys);case 2:return e.next=4,O.keys();case 4:return t=e.sent,this.keys=t||[],e.abrupt("return",this.keys);case 7:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"has",value:function(e){return this.keys.includes(e)}},{key:"flow",value:(c=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.has(t)){e.next=2;break}return e.abrupt("return",this.capture(t));case 2:return e.abrupt("return",O.getItem(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"kline2flow",value:(r=Object(s.a)(a.a.mark((function e(t,n,r){var s,i,o,c,u,h,l,p,f,g,d,v,k,b,m,w,x,O,j,B,C,Y,D,V;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s=[],i={},o=null,c=!0,u=!1,h=void 0,e.prev=4,l=n[Symbol.iterator]();!(c=(p=l.next()).done);c=!0)f=p.value,i[f.date]=f;e.next=12;break;case 8:e.prev=8,e.t0=e.catch(4),u=!0,h=e.t0;case 12:e.prev=12,e.prev=13,c||null==l.return||l.return();case 15:if(e.prev=15,!u){e.next=18;break}throw h;case 18:return e.finish(15);case 19:return e.finish(12);case 20:g=!0,d=!1,v=void 0,e.prev=23,k=r[Symbol.iterator]();case 25:if(g=(b=k.next()).done){e.next=40;break}if(m=b.value,o){e.next=30;break}return o=m,e.abrupt("continue",37);case 30:w=m.high,x=m.low,O=m.open,j=m.close,B=m.volume,C=A()(m.day).format("YYYYMMDD"),Y=+((m.close-o.close)/o.close*100).toFixed(2),D=i[C]||{},V=new y.a({code:t,name:D.name||"",date:C,price:m.close,change:Y,netinflow:D.netinflow||NaN,netinflowrate:D.netinflowrate||NaN,high:w,low:x,open:O,close:j,volume:+(B/100).toFixed(2)}),s.unshift(V),o=m;case 37:g=!0,e.next=25;break;case 40:e.next=46;break;case 42:e.prev=42,e.t1=e.catch(23),d=!0,v=e.t1;case 46:e.prev=46,e.prev=47,g||null==k.return||k.return();case 49:if(e.prev=49,!d){e.next=52;break}throw v;case 52:return e.finish(49);case 53:return e.finish(46);case 54:return e.abrupt("return",s);case 55:case"end":return e.stop()}}),e,null,[[4,8,12,20],[13,,15,19],[23,42,46,54],[47,,49,53]])}))),function(e,t,n){return r.apply(this,arguments)})},{key:"capture",value:(n=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,n=t.startsWith("1.")?t.replace("1.","sh"):["00","30","39","12"].includes(t.slice(0,2))?"sz"+t:"sh"+t,e.next=4,Promise.all([f.a.captureFlows(t),f.a.captureKline(n,"day",300)]);case 4:return r=e.sent,s=Object(p.a)(r,2),i=s[0],o=s[1],e.abrupt("return",this.kline2flow(t,i,o));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"ma",value:(t=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,o,c,u,h,l,p,f,g,d,v,y=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.length>1&&void 0!==y[1]?y[1]:5,e.prev=1,r=0,s=0,e.next=5,this.flow(t);case 5:i=e.sent,o=k.a.stocks([t])[t],c=A()().format("YYYYMMDD"),r+=+o.price,s++,u=!0,h=!1,l=void 0,e.prev=13,p=i[Symbol.iterator]();case 15:if(u=(f=p.next()).done){e.next=26;break}if(g=f.value,d=g.price,v=g.date,c!==v){e.next=19;break}return e.abrupt("continue",23);case 19:if(r+=d,++s!==n){e.next=23;break}return e.abrupt("break",26);case 23:u=!0,e.next=15;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(13),h=!0,l=e.t0;case 32:e.prev=32,e.prev=33,u||null==p.return||p.return();case 35:if(e.prev=35,!h){e.next=38;break}throw l;case 38:return e.finish(35);case 39:return e.finish(32);case 40:return e.abrupt("return",+(r/s).toFixed(2));case 43:return e.prev=43,e.t1=e.catch(1),e.abrupt("return",0);case 46:case"end":return e.stop()}}),e,this,[[1,43],[13,28,32,40],[33,,35,39]])}))),function(e){return t.apply(this,arguments)})}]),e}()),B=function(){function e(t,n,r,a,s){Object(i.a)(this,e),Object(u.a)(this,"$valid",{rateRatio:.6,averageChange2:.2,bigChange:6}),Object(u.a)(this,"range",{change:[null,null],price:[null,null],rate:[null,null],amount:[null,null]}),Object(u.a)(this,"day",{rise:0,down:0,bigRise:0,bigDown:0}),Object(u.a)(this,"fundamental",{eps:0,bvps:0,roe:0}),Object(u.a)(this,"index",{days:0,daysRatio:0,changeUpRatio:0,changeDownRatio:0}),Object(u.a)(this,"ratio",{mainRatio:0,abnormalRatio:0,lockRatio:0,onePercentRate:0,onePercentAmount:0}),Object(u.a)(this,"longterm",{days:0,averagePrice:0,change:0,rate:0,amount:0}),Object(u.a)(this,"shortterm",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(u.a)(this,"limitup",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(u.a)(this,"riseup",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(u.a)(this,"rateup",{days:0,change:0,averageChange:0,averageRate:0,averageChange2:0}),Object(u.a)(this,"code",void 0),Object(u.a)(this,"name",void 0),Object(u.a)(this,"stock",void 0),Object(u.a)(this,"vtype",void 0),Object(u.a)(this,"validator",void 0),Object(u.a)(this,"flow",[]),Object(u.a)(this,"gene",{}),this.code=t,this.stock=n,this.flow=r,this.vtype=s;var o=!0,c=!1,h=void 0;try{for(var l,p=g.a.validators[Symbol.iterator]();!(o=(l=p.next()).done);o=!0){var f=l.value;if(f.name===s){this.validator=new M(f);break}}}catch(e){c=!0,h=e}finally{try{o||null==p.return||p.return()}finally{if(c)throw h}}Object.assign(this,a),n&&(this.name=n.name)}var t,n,r,c;return Object(o.a)(e,[{key:"toMoney",value:function(e){return e=Math.abs(+e)>=1e8?(+e/1e8).toFixed(2)+"亿":(+e/1e4).toFixed(2)+"万"}},{key:"analyse",value:(c=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.flow||!this.flow.length){e.next=25;break}return e.next=4,this.calcFundamental();case 4:return e.next=6,this.calcDays();case 6:return e.next=8,this.calcRange();case 8:return e.next=10,this.calcLimitup();case 10:return e.next=12,this.calcRiseup();case 12:return e.next=14,this.calcRateup();case 14:return e.next=16,this.calcLongterm();case 16:return e.next=18,this.calcShortterm();case 18:return e.next=20,this.calcRatio();case 20:if("1.000001"===this.code){e.next=23;break}return e.next=23,this.calcIndex();case 23:return e.next=25,this.calcGene();case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(0),console.warn("#Gene# analyse fail ",this.code,e.t0);case 30:return e.abrupt("return",this);case 31:case"end":return e.stop()}}),e,this,[[0,27]])}))),function(){return c.apply(this,arguments)})},{key:"calcRange",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.flow[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value,i=s.price,o=s.change,c=s.rate,u=s.netinflow;null===this.range.price[0]&&(this.range.price[0]=i),null===this.range.price[1]&&(this.range.price[1]=i),i<this.range.price[0]&&(this.range.price[0]=i),i>this.range.price[1]&&(this.range.price[1]=i),null===this.range.change[0]&&(this.range.change[0]=o),null===this.range.change[1]&&(this.range.change[1]=o),o<this.range.change[0]&&(this.range.change[0]=o),o>this.range.change[1]&&(this.range.change[1]=o),null===this.range.amount[0]&&(this.range.amount[0]=u),null===this.range.amount[1]&&(this.range.amount[1]=u),u<this.range.amount[0]&&(this.range.amount[0]=u),u>this.range.amount[1]&&(this.range.amount[1]=u),null===this.range.rate[0]&&(this.range.rate[0]=c),null===this.range.rate[1]&&(this.range.rate[1]=c),c<this.range.rate[0]&&(this.range.rate[0]=c),c>this.range.rate[1]&&(this.range.rate[1]=c)}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}this.range.price[0]=+this.range.price[0].toFixed(2),this.range.price[1]=+this.range.price[1].toFixed(2),this.range.change[0]=+this.range.change[0].toFixed(2),this.range.change[1]=+this.range.change[1].toFixed(2),this.range.amount[0]=+this.range.amount[0].toFixed(2),this.range.amount[1]=+this.range.amount[1].toFixed(2),this.range.rate[0]=+this.range.rate[0].toFixed(2),this.range.rate[1]=+this.range.rate[1].toFixed(2)}},{key:"calcDays",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.flow[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value.change;s>=0?this.day.rise++:this.day.down++,s>=this.$valid.bigChange&&this.day.bigRise++,s<=-this.$valid.bigChange&&this.day.bigDown++}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}},{key:"calcIndex",value:(r=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=0,n=0,r=0,s=0,i=0,e.next=3,C.gene("1.000001",this.vtype);case 3:o=e.sent,c=o.flow,this.flow.forEach((function(e,a){var o=c[a];o&&e.date===o.date&&(e.change>0&&o.change>0&&(t++,n+=e.change,s+=o.change),e.change<0&&o.change<0&&(t++,r+=e.change,i+=o.change))})),this.index.days=t,this.index.daysRatio=+(t/this.flow.length).toFixed(2),this.index.changeUpRatio=+(n/s).toFixed(2),this.index.changeDownRatio=-(r/i).toFixed(2);case 10:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"calcFundamental",value:function(){this.fundamental.eps=+this.stock.eps.toFixed(2),this.fundamental.bvps=+this.stock.bvps.toFixed(2),this.fundamental.roe=+this.stock.roe.toFixed(2)}},{key:"calcLongterm",value:function(){var e=0,t=!0,n=!1,r=void 0;try{for(var a,s=this.flow[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var i=a.value,o=i.price,c=i.change,u=i.rate,h=i.netinflow;Number.isNaN(u)&&(u=0),Number.isNaN(h)&&(h=0),this.longterm.change+=c,this.longterm.rate+=u,this.longterm.amount+=h,this.longterm.days++,e+=o}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}this.longterm.averagePrice=+(e/this.flow.length).toFixed(2),this.longterm.change=+this.longterm.change.toFixed(2),this.longterm.rate=+this.longterm.rate.toFixed(2),this.longterm.amount=+this.longterm.amount.toFixed(2)}},{key:"calcShorttermFun",value:(n=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,o,c,u,h,l,p,f,g,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0,s=0,i=0,o=0,e.t0=a.a.keys(this.flow);case 2:if((e.t1=e.t0()).done){e.next=16;break}return c=e.t1.value,u=this.flow[c],h=u.code,l=u.name,p=u.price,f=u.change,g=u.rate,e.next=7,n({code:h,name:l,price:p,change:f,rate:g});case 7:if(e.sent){e.next=9;break}return e.abrupt("continue",2);case 9:r++,i+=f,s+=g,(d=this.flow[+c+1])&&(o+=+d.change),e.next=2;break;case 16:r>0&&(t.days=r,t.change=+o.toFixed(2),t.averageChange=+(i/r).toFixed(2),t.averageRate=+(s/r).toFixed(2),t.averageChange2=+(o/r).toFixed(2));case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"calcShortterm",value:function(){return this.calcShorttermFun(this.shortterm,function(){var e=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.code,t.name,t.price,n=t.change,r=t.rate,e.abrupt("return",n>0&&r>0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"calcLimitup",value:function(){return this.calcShorttermFun(this.limitup,(function(e){e.code,e.name,e.price;var t=e.change,n=e.rate;return t>=9&&n>0}))}},{key:"calcRiseup",value:function(){var e=this;return this.calcShorttermFun(this.riseup,(function(t){t.code,t.name,t.price;var n=t.change,r=t.rate;return n>=e.$valid.bigChange&&r>0}))}},{key:"calcRateup",value:function(){var e=this;return this.calcShorttermFun(this.rateup,(function(t){t.code,t.name,t.price,t.change;return t.rate>e.range.rate[1]*e.$valid.rateRatio}))}},{key:"isValidShortterm",value:(t=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.code,t.change,n=t.rate,r={},e.next=4,this.calcShorttermFun(r,(function(e){e.code,e.name,e.price,e.change;var t=e.rate;return Math.abs((t-n)/n)>=.2}));case 4:return e.abrupt("return",r.averageChange2>=this.$valid.averageChange2);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"calcRatio",value:function(){var e=0,t=0,n=0,r=this.flow.slice(-1)[0],a=!0,s=!1,i=void 0;try{for(var o,c=this.flow[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var u=o.value,h=u.change,l=u.rate,p=u.netinflow;Number.isNaN(l)&&(l=0),Number.isNaN(p)&&(p=0),h>0&&l>0&&(e+=l,t+=p,n+=h)}}catch(e){s=!0,i=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw i}}this.ratio.onePercentRate=+(e/n).toFixed(2),this.ratio.onePercentAmount=+(t/n).toFixed(2),this.ratio.mainRatio=+(this.longterm.rate/this.longterm.days).toFixed(2),this.ratio.abnormalRatio=+((this.day.bigRise+this.day.bigDown)/this.longterm.days).toFixed(2),this.ratio.lockRatio=+(+r.price/this.longterm.averagePrice).toFixed(2)}},{key:"calcGene",value:function(){this.gene.ratio={mainRatio:this.ratio.mainRatio,abnormalRatio:this.ratio.abnormalRatio,lockRatio:this.ratio.lockRatio,onePercentRate:this.ratio.onePercentRate,onePercentAmount:this.toMoney(this.ratio.onePercentAmount)},this.gene.shortterm=this.shortterm,this.gene.longterm={days:this.longterm.days,averagePrice:this.longterm.averagePrice,change:this.longterm.change,rate:this.longterm.rate,amount:this.toMoney(this.longterm.amount)},this.gene.limitup=this.limitup,this.gene.riseup=this.riseup,this.gene.rateup=this.rateup,this.gene.day=this.day,this.gene.range={change:this.range.change.toString(),price:this.range.price.toString(),rate:this.range.rate.toString(),amount:[this.toMoney(this.range.amount[0]),this.toMoney(this.range.amount[1])]},this.gene.index=this.index,this.gene.fundamental=this.fundamental}},{key:"show",value:function(){for(var e in this.gene)console.info("%c".concat(this.code,".").concat(e.toUpperCase()),"padding-left: 45%; color:#FFC107;"),console.table(this.gene[e])}},{key:"getFlow",value:function(){return this.flow}},{key:"getGene",value:function(){return this.gene}},{key:"toString",value:function(){var e="";for(var t in this.gene){var n=this.gene[t];for(var r in n)e+="".concat(t,".").concat(r,": ").concat(n[r].toString(),"  ")}return e}}]),e}(),C=new(function(){function e(){Object(i.a)(this,e),Object(u.a)(this,"genes",{}),Object(u.a)(this,"vtypes",{});var t=!0,n=!1,r=void 0;try{for(var a,s=g.a.validators[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var o=a.value,c=o.name,h=o.rule.gene,l={};for(var f in h)if(f.startsWith("$")){var d=f.split("."),v=Object(p.a)(d,2),k=v[0],y=v[1];l[k]||(l[k]={}),l[k][y]=+h[f]}this.vtypes[c]=l}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}}var t,n,r;return Object(o.a)(e,[{key:"has",value:function(e,t){return!!this.genes[t]&&this.genes[t][e]}},{key:"param",value:(r=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.vtypes[t]||{});case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"gene",value:(n=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.has(t,n)){e.next=3;break}return e.next=3,this.capture(t,n);case 3:return e.abrupt("return",this.genes[n][t]);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"capture",value:(t=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,o,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.has(t,n)){e.next=3;break}return e.abrupt("return",this.gene(t,n));case 3:return e.next=5,Promise.all([j.flow(t),f.a.captureStock(t)]);case 5:return r=e.sent,s=Object(p.a)(r,2),i=s[0],o=s[1],e.next=11,new B(t,o,i,this.vtypes[n],n).analyse();case 11:return c=e.sent,this.genes[n]||(this.genes[n]={}),this.genes[n][t]=c,e.abrupt("return",c);case 17:e.prev=17,e.t0=e.catch(0),console.warn("#Genes# capture fail ",n,t,e.t0);case 20:case"end":return e.stop()}}),e,this,[[0,17]])}))),function(e,n){return t.apply(this,arguments)})}]),e}()),Y=n(534),D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[],values:[]};return Function.apply(void 0,Object(Y.a)(t.keys).concat(['"use strict";return ('.concat(e,")")])).apply(void 0,Object(Y.a)(t.values))},V=n(538),M=function(){function e(t){Object(i.a)(this,e),this.config=t}var t,n,r,c,u,h,p,f;return Object(o.a)(e,[{key:"hasCaptureRule",value:function(e){return this.config.capture.includes(e)}},{key:"hasIntervalRule",value:function(e){return this.config.interval.includes(e)}},{key:"filter",value:(f=Object(s.a)(a.a.mark((function t(n,r){var s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r.code,r.name,r.price,r.change,r.rate,r.turnover,r.qrr,r.eps,r.bvps,r.roe,s=this.config.capture,V.rb.getIntervalKeys().includes(n)&&(s=this.config.interval),V.rb.getBondKeys().includes(n)){t.next=11;break}return t.next=9,e.filterOfList(r);case 9:if(t.sent){t.next=11;break}return t.abrupt("return",!1);case 11:if(![V.F.key,V.t.key].includes(n)){t.next=13;break}return t.abrupt("return",!0);case 13:if(!s.includes("base")){t.next=18;break}return t.next=16,this.isValidBase(r);case 16:if(t.sent){t.next=18;break}return t.abrupt("return",!1);case 18:if(!s.includes("fundamental")){t.next=23;break}return t.next=21,this.isValidFundamental(r);case 21:if(t.sent){t.next=23;break}return t.abrupt("return",!1);case 23:if(!s.includes("whitelist")){t.next=28;break}return t.next=26,this.isValidWhitelist(r);case 26:if(t.sent){t.next=28;break}return t.abrupt("return",!1);case 28:if(!s.includes("gene")){t.next=33;break}return t.next=31,this.isValidGeneAnalyse(r.code,r);case 31:if(t.sent){t.next=33;break}return t.abrupt("return",!1);case 33:return t.abrupt("return",!0);case 36:return t.prev=36,t.t0=t.catch(0),t.abrupt("return",!1);case 39:case"end":return t.stop()}}),t,this,[[0,36]])}))),function(e,t){return f.apply(this,arguments)})},{key:"filterOfPreTrace",value:(p=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,o,c,u,h,l,p,f,g,d,v,k,y;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.config.capture.includes("pre-trace")){e.next=3;break}return e.abrupt("return",!0);case 3:if(r=this.config.rule["pre-trace"]){e.next=6;break}return e.abrupt("return",!0);case 6:s=Object.keys(t),i=0,o=s;case 8:if(!(i<o.length)){e.next=22;break}if(c=o[i],![V.F.key,V.t.key].includes(c)){e.next=12;break}return e.abrupt("continue",19);case 12:if(u=t[c],h=n[c],u&&h){e.next=16;break}return e.abrupt("continue",19);case 16:for(f in l=u.getStocks(),p=h.getStocks(),l)for(v in g=l[f],d=p[f],r)k=(d[v]-g[v])/g[v],y="".concat(k).concat(r[v]),D(y)||(console.info("#Validator# filter stock of PreTrace",c,g.code,g.name,g.price,g.change,v,"[ ",d[v]," - ",g[v],r[v]," ]"),delete l[f]);case 19:i++,e.next=8;break;case 22:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"check",value:function(e,t,n,r){if(!e)return!0;try{for(var a=Object.keys(e),s=0,i=a;s<i.length;s++){var o=i[s],c=D("data.".concat(o),{keys:["data"],values:[t]}),u="".concat(c).concat(e[o]);if(void 0!==c&&!D(u))return!1}}catch(e){}return!0}},{key:"isFullRequiredFields",value:function(e){var t=new l.a({});for(var n in t)if(!e.hasOwnProperty(n))return!1;return!0}},{key:"isValidBase",value:(h=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.code,r=t.name,t.price,t.change,t.rate,t.turnover,t.qrr,e.abrupt("return",this.check(this.config.rule.base,t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"isValidWhitelist",value:(u=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.code,t.name,d.a.whitelist().has(n)){e.next=3;break}return e.abrupt("return",!1);case 3:return e.abrupt("return",!0);case 4:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"isValidFundamental",value:(c=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.config.rule.fundamental){e.next=3;break}return e.abrupt("return",!0);case 3:return e.abrupt("return",this.check(n,t,t.code,t.name));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"isValidGeneAnalyse",value:(r=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,o,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.config.rule.gene){e.next=3;break}return e.abrupt("return",!0);case 3:return s=this.config.name,e.next=6,C.gene(t,s);case 6:return i=e.sent,e.next=9,i.isValidShortterm(n);case 9:if(e.sent){e.next=11;break}return e.abrupt("return",!1);case 11:o={},e.t0=a.a.keys(r);case 13:if((e.t1=e.t0()).done){e.next=20;break}if(!(c=e.t1.value).startsWith("$")){e.next=17;break}return e.abrupt("continue",13);case 17:o[c]=r[c],e.next=13;break;case 20:return e.abrupt("return",this.check(o,i,i.code,i.name));case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})}],[{key:"filterOfList",value:(n=Object(s.a)(a.a.mark((function t(n){var r,s,i,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.code,s=n.name,i=n.price,o=n.change,n.rate,n.turnover,n.qrr,!(o>9.8||i<=0)){t.next=3;break}return t.abrupt("return",!1);case 3:return t.abrupt("return",e.isValidStock(r,s));case 4:case"end":return t.stop()}}),t)}))),function(e){return n.apply(this,arguments)})},{key:"isValidStock",value:(t=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.toUpperCase().includes("ST")){e.next=2;break}return e.abrupt("return",!1);case 2:if(!n.toUpperCase().includes("B")&&!n.toUpperCase().includes("Ｂ")){e.next=4;break}return e.abrupt("return",!1);case 4:if(!n.includes("退")){e.next=6;break}return e.abrupt("return",!1);case 6:if(!n.match(/\d+/g)){e.next=8;break}return e.abrupt("return",!1);case 8:if((g.a.markets||["60","00"]).includes("".concat(t).slice(0,2))){e.next=11;break}return e.abrupt("return",!1);case 11:if(!"".concat(t).startsWith("200")&&!"".concat(t).startsWith("900")){e.next=13;break}return e.abrupt("return",!1);case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})}]),e}(),S=(n(569),n(75),n(356),n(536)),E=n(532),I=n(535),Q=function(){function e(t){Object(i.a)(this,e),Object(u.a)(this,"name",void 0),this.name=t}var t,n,r;return Object(o.a)(e,[{key:"filter",value:(r=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"start",value:(n=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"broadcast",value:function(e,t,n){window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Interval_Event",{detail:{name:e,vtype:t,stock:n}}))}},{key:"monitor",value:(t=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,o,c,u,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n||(n=new M(g.a.validators[0])),r=n.config.name,s=!0,i=!1,o=void 0,e.prev=6,c=t[Symbol.iterator]();case 8:if(s=(u=c.next()).done){e.next=25;break}if(h=u.value,n.isFullRequiredFields(h)){e.next=14;break}return e.next=13,f.a.captureStock(h.code);case 13:h=e.sent;case 14:return e.next=16,n.filter(this.name,h);case 16:if(e.sent){e.next=18;break}return e.abrupt("continue",22);case 18:return e.next=20,this.filter(h);case 20:if(!e.sent){e.next=22;break}this.broadcast(this.name,r,h);case 22:s=!0,e.next=8;break;case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(6),i=!0,o=e.t0;case 31:e.prev=31,e.prev=32,s||null==c.return||c.return();case 34:if(e.prev=34,!i){e.next=37;break}throw o;case 37:return e.finish(34);case 38:return e.finish(31);case 39:e.next=43;break;case 41:e.prev=41,e.t1=e.catch(0);case 43:case"end":return e.stop()}}),e,this,[[0,41],[6,27,31,39],[32,,34,38]])}))),function(e,n){return t.apply(this,arguments)})}]),e}(),G=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V.K.key;return Object(i.a)(this,t),Object(S.a)(this,Object(E.a)(t).call(this,e))}var n,r;return Object(I.a)(t,e),Object(o.a)(t,[{key:"filter",value:(r=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",+t.change>=9.5);case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"start",value:(n=Object(s.a)(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v.a.interval(Object(s.a)(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.a.listOfStocks("netinflow");case 3:return n=(n=e.sent).slice(0,200),e.next=7,t.monitor(n);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.warn("#diggers# capture fail",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),null,60);case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})}]),t}(Q),T=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V.M.key,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return Object(i.a)(this,t),(e=Object(S.a)(this,Object(E.a)(t).call(this,n))).dayOfMa=r,e}var n;return Object(I.a)(t,e),Object(o.a)(t,[{key:"filter",value:(n=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.ma(t.code,this.dayOfMa);case 2:return n=e.sent,e.abrupt("return",+t.price<n);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),t}(Q),F=(n(149),n(547)),L=n(549),U=n(575),R=n(551),K=n(101),H=n.n(K),P=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(i.a)(this,e),Object(u.a)(this,"name",void 0),Object(u.a)(this,"origin",{}),Object(u.a)(this,"stocks",{}),this.name=t,this.origin=H()(r),this.stocks=H()(a),window.addEventListener("__Walle_Stock_Ignore_Event",(function(e){var t=e.detail;n.ignore(t)}))}var t,n,r,c,h,l,d;return Object(o.a)(e,[{key:"filter",value:(d=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)}))),function(){return d.apply(this,arguments)})},{key:"start",value:(l=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)})},{key:"broadcast",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"buy";window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Interval_Event",{detail:{name:e,vtype:t,stock:n,tradetype:r}}))}},{key:"hook",value:(h=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o,c,u,h,l,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=g.a.trader.interval.target,n=t.split("/"),(r=Object(p.a)(n,2))[0],s=r[1],this.name===s){e.next=5;break}return e.abrupt("return");case 5:for(U.a.notification("Walle Stock Interval Notification",t,this.origin,this.stocks),i={},o={},c=Object.values(this.stocks),u=0,h=c;u<h.length;u++)l=h[u],f=l.code,l.name,this.origin[f]&&!this.stocks[f]&&(o[f]=l),!this.origin[f]&&this.stocks[f]&&(i[f]=l);return e.next=11,R.a.buyStocks("interval",i);case 11:return e.next=13,R.a.sellStocks("interval",o);case 13:e.next=17;break;case 15:e.prev=15,e.t0=e.catch(0);case 17:case"end":return e.stop()}}),e,this,[[0,15]])}))),function(){return h.apply(this,arguments)})},{key:"ignore",value:(c=Object(s.a)(a.a.mark((function e(t){var n,r,s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.time,r=t.vtype,s=t.listkey,i=t.code,e.prev=1,"interval"!==n||"v0"!==r||s!==this.name){e.next=9;break}if(!this.origin[i]){e.next=8;break}return e.next=6,this.deliver(i);case 6:e.next=9;break;case 8:delete this.stocks[i];case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(1);case 13:case"end":return e.stop()}}),e,this,[[1,11]])}))),function(e){return c.apply(this,arguments)})},{key:"deliver",value:(r=Object(s.a)(a.a.mark((function e(t){var n,r,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=Ne.controller("interval","v0"),!this.origin[t]){e.next=15;break}return console.log("#Digger# filter ".concat(this.name," stock"),t),e.next=6,f.a.captureStock(t);case 6:return r=e.sent,s=this.origin[t],e.next=10,n.ignore(this.name,t);case 10:return e.next=12,n.t0Statement.remove(this.name,t);case 12:return e.next=14,n.t1Statement.update(this.name,s,r);case 14:delete this.stocks[t];case 15:e.next=19;break;case 17:e.prev=17,e.t0=e.catch(0);case 19:case"end":return e.stop()}}),e,this,[[0,17]])}))),function(e){return r.apply(this,arguments)})},{key:"update",value:(n=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,o,c,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(n=Object.keys(this.stocks)).length){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,f.a.captureStocks(n);case 6:this.stocks=e.sent,r=!0,s=!1,i=void 0,e.prev=10,o=t[Symbol.iterator]();case 12:if(r=(c=o.next()).done){e.next=19;break}return u=c.value,e.next=16,u.monitor(this.stocks,this.validator);case 16:r=!0,e.next=12;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(10),s=!0,i=e.t0;case 25:e.prev=25,e.prev=26,r||null==o.return||o.return();case 28:if(e.prev=28,!s){e.next=31;break}throw i;case 31:return e.finish(28);case 32:return e.finish(25);case 33:e.next=37;break;case 35:e.prev=35,e.t1=e.catch(0);case 37:return e.abrupt("return",Object.values(this.stocks));case 38:case"end":return e.stop()}}),e,this,[[0,35],[10,21,25,33],[26,,28,32]])}))),function(e){return n.apply(this,arguments)})},{key:"capture",value:(t=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,o,c,u,h,l,p,d,v,k,y,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n||(n=new M(g.a.validators[0])),r=n.config.name,s=!0,i=!1,o=void 0,e.prev=6,c=t[Symbol.iterator]();case 8:if(s=(u=c.next()).done){e.next=34;break}if(h=u.value,n.isFullRequiredFields(h)){e.next=14;break}return e.next=13,f.a.captureStock(h.code);case 13:h=e.sent;case 14:return e.next=16,n.filter(this.name,h);case 16:if(e.sent){e.next=18;break}return e.abrupt("continue",31);case 18:return e.next=20,this.filter(h);case 20:if(e.sent){e.next=22;break}return e.abrupt("continue",31);case 22:if(p=(l=h).code,d=l.name,l.price,v=l.change,k=l.netinflow,y=l.rate,l.eps,l.bvps,l.roe,l.turnover,l.qrr,console.log("#Digger# capture ".concat(this.name,"-").concat(r," stock"),p,d,v,y,k),!this.stocks[p]&&!this.origin[p]){e.next=26;break}return e.abrupt("continue",31);case 26:if(!(Object.keys(this.stocks).length>=10)){e.next=29;break}return e.abrupt("break",34);case 29:this.broadcast(this.name,"v0",h,"buy"),this.stocks[p]=h;case 31:s=!0,e.next=8;break;case 34:e.next=40;break;case 36:e.prev=36,e.t0=e.catch(6),i=!0,o=e.t0;case 40:e.prev=40,e.prev=41,s||null==c.return||c.return();case 43:if(e.prev=43,!i){e.next=46;break}throw o;case 46:return e.finish(43);case 47:return e.finish(40);case 48:return b=Ne.controller("interval","v0"),e.next=51,b.update(this.name,this.stocks);case 51:this.hook(),e.next=56;break;case 54:e.prev=54,e.t1=e.catch(0);case 56:return e.abrupt("return",Object.values(this.stocks));case 57:case"end":return e.stop()}}),e,this,[[0,54],[6,36,40,48],[41,,43,47]])}))),function(e,n){return t.apply(this,arguments)})}]),e}(),J=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=Object(S.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(a))),Object(u.a)(Object(F.a)(n),"ma5Monitor",new T(V.M.key,5)),Object(u.a)(Object(F.a)(n),"ma7Monitor",new T(V.N.key,7)),Object(u.a)(Object(F.a)(n),"ma10Monitor",new T(V.L.key,10)),n}var n,r,c,h,l;return Object(I.a)(t,e),Object(o.a)(t,[{key:"start",value:(l=Object(s.a)(a.a.mark((function e(){var t,n=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t=g.a.intervals[0],v.a.interval(Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.clear();case 2:return e.next=4,n.capture(n.name);case 4:case"end":return e.stop()}}),e)}))),t.trace)}catch(e){}case 1:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)})},{key:"update",value:(h=Object(s.a)(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.abrupt("return",Object(L.a)(Object(E.a)(t.prototype),"update",this).call(this,n));case 2:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"clear",value:(c=Object(s.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(this.stocks);case 2:if((e.t1=e.t0()).done){e.next=13;break}return t=e.t1.value,n=this.stocks[t],e.next=7,this.filter(n);case 7:if(e.sent){e.next=11;break}return this.broadcast(this.name,"v0",n,"sell"),e.next=11,this.deliver(n.code);case 11:e.next=2;break;case 13:e.next=17;break;case 15:e.prev=15,e.t2=e.catch(0);case 17:case"end":return e.stop()}}),e,this,[[0,15]])}))),function(){return c.apply(this,arguments)})},{key:"capture",value:(r=Object(s.a)(a.a.mark((function e(n,r){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.captureList(n);case 3:return s=e.sent,e.abrupt("return",Object(L.a)(Object(E.a)(t.prototype),"capture",this).call(this,s,r));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",[]);case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e,t){return r.apply(this,arguments)})},{key:"filter",value:(n=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.ma(t.code,5);case 2:return n=e.sent,e.next=5,j.ma(t.code,7);case 5:return r=e.sent,e.abrupt("return",+t.price>n&&+t.price>r);case 7:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]),t}(P),W=n(949),N=(n(950),n(951),n(954)),q=n.n(N),_=n(655),Z=n(657),z=n(656),X=n(658),$=n(796),ee=n(797),te=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,[{key:"generate",value:function(e,t){var n=null,r=[],a=!0,s=!1,i=void 0;try{for(var o,c=t[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var u=o.value;u=Object.assign({},u),n?A()(u.day)[e]()===A()(n.day)[e]()?(n.high=+(u.high>n.high?u.high:n.high),n.low=+(u.low<n.low?u.low:n.low),n.close=+u.close,n.day=u.day,n.volume+=+u.volume):(r.push(n),(n=u).volume=+n.volume):(n=u).volume=+n.volume}}catch(e){s=!0,i=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw i}}return r.push(n),r}},{key:"week",value:function(e){return this.generate("week",e)}},{key:"month",value:function(e){return this.generate("month",e)}},{key:"year",value:function(e){return this.generate("year",e)}}]),e}();Object(u.a)(te,"LEVEL",{week:"week",month:"month",year:"year"});var ne=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,[{key:"mergeKline",value:function(e,t){e&&t&&(e.high=""+Math.max(e.high,t.high),e.low=""+Math.min(e.low,t.low),e.volume=""+t.volume,e.close=""+t.close)}},{key:"merge",value:function(e,t){for(var n=A()(e[0].day,"YYYY-MM-DD",!0).isValid()?"YYYY-MM-DD":"YYYYMMDDHHmm00",r=(A()(e[0].day).format(n),A()(e[e.length-1].day).format(n)),a=[],s=t.length-1;s>=0;s--){var i=t[s],o=A()(i.day).format(n);o>r&&(A()(e[0].day,"YYYY-MM-DD",!0).isValid()&&(i.day=A()(i.day).format("YYYY-MM-DD")),a.unshift(i)),o<=r&&this.mergeKline(e[e.length-1],i)}return[].concat(Object(Y.a)(e),a)}},{key:"generate",value:function(e,t,n){for(var r=this,a=[],s=null,i=!0,o=n.slice(-2),c=Object(p.a)(o,2),u=c[0],h=(c[1],A()(u.day).format("YYYYMMDDHHmm00")),l=function(o){var c=Object.assign({},t[o]),u=A()(c.day).format("YYYYMMDDHHmm00"),l=function(){(s=c).volume=+s.volume,s.open=+s.open,1};return i?(u<=h||(l(),i=!1),"continue"):"day"===e&&A()(s.day).format("YYYY-MM-DD")!==A()(c.day).format("YYYY-MM-DD")?(a.push(s),l(),"continue"):"day"===e||s?(s.high=+(c.high>s.high?c.high:s.high),s.low=+(c.low<s.low?c.low:s.low),s.close=+c.close,s.day=c.day,s.volume+=+c.volume,e<=30&&A()(c.day).minute()%e==0||e>=60&&[30,0].includes(A()(c.day).minute())&&r.isNextSplitTime(n,c)?(a.push(s),s=null,"continue"):void 0):(l(),"continue")},f=0;f<t.length;f++)l(f);return s&&a.push(s),this.merge(n,a,s)}},{key:"isNextSplitTime",value:function(e,t){for(var n,r=[],a=e.length-2;a>=1;a--){var s=A()(e[a].day).format("YYYY-MM-DD");if(!n){if(A()(t.day).format("YYYY-MM-DD")===s)continue;n=A()(e[a].day).format("YYYY-MM-DD")}if(n!==s)break;r.push(A()(e[a].day).format("HHmmss"))}var i=A()(t.day).format("HHmmss");return r.includes(i)}},{key:"min1",value:function(e,t){return this.merge(t,e)}},{key:"min5",value:function(e,t){return this.generate(5,e,t)}},{key:"min15",value:function(e,t){return this.generate(15,e,t)}},{key:"min30",value:function(e,t){return this.generate(30,e,t)}},{key:"min60",value:function(e,t){return this.generate(60,e,t)}},{key:"min120",value:function(e,t){return this.generate(120,e,t)}},{key:"min240",value:function(e,t){return this.generate(240,e,t)}},{key:"day",value:function(e,t){return this.generate("day",e,t)}}]),e}();Object(u.a)(ne,"LEVEL",{min5:5,min15:15,min30:30,min60:60,min120:120,min240:240});var re=n(564),ae=(window.top.__Walle_Devtools,function(){function e(t,n){var r=this;Object(i.a)(this,e),Object(u.a)(this,"code",void 0),Object(u.a)(this,"originCode",void 0),Object(u.a)(this,"level",void 0),Object(u.a)(this,"callback",void 0),Object(u.a)(this,"crawler",void 0),Object(u.a)(this,"klines",{min1:[],min5:[],min15:[],min30:[],min60:[],min120:[],min240:[],day:[],week:[],month:[],year:[]}),Object(u.a)(this,"interval",10),Object(u.a)(this,"intervalId",-1),Object(u.a)(this,"limit",1e4),Object(u.a)(this,"isExtendKline",!0),this.code=t.replace("-","").toLowerCase(),this.originCode=t.replace("huobi-","").replace("okex-","").toLowerCase(),this.crawler=X.a,t.startsWith("huobi")?(this.code=t.replace("huobi-","").replace("-","").toLowerCase(),this.crawler=X.a):t.startsWith("okex")&&(this.code=t.replace("okex-","").toUpperCase(),this.crawler=z.a),this.crawler.listener.on("reconnect",(function(e,t){"public"===t&&(r.crawler.kline.resubscribe(r.code,"ohlcv"),r.crawler.kline.resubscribe(r.code,r.level))}))}var t,n,r,c,h;return Object(o.a)(e,[{key:"loop",value:(h=Object(s.a)(a.a.mark((function e(t,n){var r=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&(this.callback=n),re.a.stop(this.intervalId),this.intervalId=re.a.interval(1e3*(t||this.interval),(function(){r.callback&&r.callback()}));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"stop",value:(c=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.callback=null,re.a.stop(this.intervalId),this.crawler.stop();case 3:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"ohlcv",value:(r=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.crawler.kline.subscribe(this.code,"ohlcv",(function(e,n){return t(n)})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"kline",value:(n=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=t.includes("sec")?this.crawler.tick:this.crawler.kline).setLength&&n.setLength(this.limit),t===this.level){e.next=10;break}if(!this.level){e.next=6;break}return e.next=6,(this.level.includes("sec")?this.crawler.tick:this.crawler.kline).unsubscribe(this.code,this.level);case 6:return e.next=8,n.subscribe(this.code,t);case 8:this.loop(t.includes("sec")?1:10),this.level=t;case 10:return e.next=12,n.kline(this.code,t);case 12:return r=e.sent,e.abrupt("return",r);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"capture",value:(t=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.crawler.kline.capture(this.code,t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}()),se=function(){function e(t,n){Object(i.a)(this,e),Object(u.a)(this,"klines",{min1:[],min5:[],min15:[],min30:[],min60:[],min120:[],min240:[],day:[],week:[],month:[],year:[]}),Object(u.a)(this,"generator",{min:null,day:null}),Object(u.a)(this,"code",void 0),Object(u.a)(this,"level",void 0),Object(u.a)(this,"interval",10),Object(u.a)(this,"intervalId",-1),Object(u.a)(this,"crawler",_.a),Object(u.a)(this,"codeOfJoinQuant",void 0),Object(u.a)(this,"lengthOfJoinQuant",void 0),Object(u.a)(this,"isExtendKline",!0),Object(u.a)(this,"limit",1e4),this.code="1.000001"===t?"sh000001":t,this.isJoinQuant(t)&&(this.codeOfJoinQuant=t.toUpperCase(),this.code=Z.a.market.symbol2code(t)),this.generator.min=new ne,this.generator.day=new te}var t,n,r,c,h,l,p,f,g,d,v,k,y,b,m,A,w,x,O,j,B,C;return Object(o.a)(e,[{key:"isJoinQuant",value:function(e){var t=e.toUpperCase().slice(-5);return[".XSHG",".XSHE",".CCFX",".XDCE",".XSGE",".XZCE",".XINE"].includes(t)}},{key:"loadJoinQuantAccount",value:(C=Object(s.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("TWIST_QUANT_JOINQUANT_DATA")){e.next=4;break}return q.a.info("JoinQuant账户信息缺失"),e.abrupt("return");case 4:if((n=JSON.parse(t)).mobile&&n.password){e.next=8;break}return q.a.info("JoinQuant账户信息缺失"),e.abrupt("return");case 8:return Z.a.setAccount(n.mobile,n.password),e.abrupt("return",n);case 10:case"end":return e.stop()}}),e)}))),function(){return C.apply(this,arguments)})},{key:"captureKline",value:(B=Object(s.a)(a.a.mark((function e(t,n,r){var s,i,o,c,u,h,l,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.codeOfJoinQuant){e.next=8;break}return r=this.lengthOfJoinQuant||r||(["min1","min5","day"].includes(n)?3e3:2e3),e.next=4,this.loadJoinQuantAccount();case 4:if(e.sent){e.next=7;break}return e.abrupt("return",[]);case 7:return e.abrupt("return",Z.a.captureKline(this.codeOfJoinQuant,n,r));case 8:if(!{"$.dji":"US30.OTC","$.ixic":"NAS.OTC","$.inx":"US500.OTC"}[this.code.toLowerCase()]){e.next=11;break}return e.abrupt("return",ee.a.captureKline(this.code,n,this.limit));case 11:return e.next=13,this.crawler.captureKline(this.code,n,this.limit);case 13:if(s=e.sent,!this.isExtendKline||!["min1","min5","min15","min30","min60"].includes(n)){e.next=53;break}if(i=["sh","sz"].includes(t.toLowerCase().slice(0,2)),o="hk"===t.toLowerCase().slice(0,2),c=t.startsWith("$"),u=_.a.market.marketOfCnFuture(t),i||o||c||u){e.next=21;break}return e.abrupt("return",s);case 21:if(!(s.length>=this.limit)){e.next=23;break}return e.abrupt("return",s);case 23:if(e.prev=23,h=[],!(i||o||c)){e.next=33;break}return e.next=28,ee.a.captureKline(this.code,n,this.limit);case 28:if(!(h=e.sent).length){e.next=33;break}return e.next=32,_.a.adjust.process(t,h);case 32:h=e.sent;case 33:if(!u){e.next=37;break}return e.next=36,$.a.captureKline(this.code,n,this.limit);case 36:h=e.sent;case 37:l=-1,p=h.length-1;case 39:if(!(p>=1)){e.next=46;break}if(!(h[p].day>=s[0].day&&h[p-1].day<s[0].day)){e.next=43;break}return l=p,e.abrupt("break",46);case 43:p--,e.next=39;break;case 46:-1!==l&&(s=[].concat(Object(Y.a)(h.slice(0,l)),Object(Y.a)(s))),e.next=53;break;case 49:return e.prev=49,e.t0=e.catch(23),console.warn("#Crawler# ExtendKline ",e.t0),e.abrupt("return",s);case 53:return e.abrupt("return",s);case 54:case"end":return e.stop()}}),e,this,[[23,49]])}))),function(e,t,n){return B.apply(this,arguments)})},{key:"capture",value:(j=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.captureKline(this.code,t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return j.apply(this,arguments)})},{key:"loop",value:(O=Object(s.a)(a.a.mark((function e(t,n){var r=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isMock){e.next=2;break}return e.abrupt("return");case 2:n&&(this.callback=n,this.crawler.tick.subscribe(this.code,"min1"),this.crawler.start(this.code)),re.a.stop(this.intervalId),this.intervalId=re.a.interval(1e3*(t||this.interval),Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.callback&&r.callback();case 1:case"end":return e.stop()}}),e)}))));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return O.apply(this,arguments)})},{key:"stop",value:(x=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.callback=null,re.a.stop(this.intervalId),this.crawler.stop();case 3:case"end":return e.stop()}}),e,this)}))),function(){return x.apply(this,arguments)})},{key:"ohlcv",value:(w=Object(s.a)(a.a.mark((function e(t){var n=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.crawler.wss.on("message",Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,n.crawler.wss.ohlcv(n.code);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"kline",value:(A=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n&&(this.lengthOfJoinQuant=n),t!==this.level&&t.includes("sec")&&(this.level.includes("sec")&&this.crawler.tick.unsubscribe(this.code,this.level),this.crawler.tick.subscribe(this.code,t)),this.loop(t.includes("sec")?1:10),this.level=t,e.abrupt("return",this[t]());case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return A.apply(this,arguments)})},{key:"sec5",value:(m=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.crawler.tick.kline(this.code,"sec5"));case 1:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"sec15",value:(b=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.crawler.tick.kline(this.code,"sec15"));case 1:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"sec30",value:(y=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.crawler.tick.kline(this.code,"sec30"));case 1:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"min",value:(k=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="min"+t,this.klines[n].length){e.next=6;break}return e.next=4,this.captureKline(this.code,n);case 4:return this.klines[n]=e.sent,e.abrupt("return",this.klines[n]);case 6:return e.next=8,this.crawler.tick.kline(this.code,"min1");case 8:return r=e.sent,e.abrupt("return",this.generator.min[n](r,this.klines[n]));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"min1",value:(v=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.min(1));case 1:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"min5",value:(d=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.min(5));case 1:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"min15",value:(g=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.min(15));case 1:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"min30",value:(f=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.min(30));case 1:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"min60",value:(p=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.min(60));case 1:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"min120",value:(l=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.min(120));case 1:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"min240",value:(h=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.min(240));case 1:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"day",value:(c=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.klines.day.length){e.next=5;break}return e.next=3,this.captureKline(this.code,"day");case 3:return this.klines.day=e.sent,e.abrupt("return",this.klines.day);case 5:return e.next=7,this.crawler.tick.kline(this.code,"min1");case 7:return t=e.sent,e.abrupt("return",this.generator.min.day(t,this.klines.day));case 9:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"week",value:(r=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.day();case 2:return t=e.sent,e.abrupt("return",this.generator.day.week(t));case 4:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"month",value:(n=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.day();case 2:return t=e.sent,e.abrupt("return",this.generator.day.month(t));case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"year",value:(t=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.day();case 2:return t=e.sent,e.abrupt("return",this.generator.day.year(t));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),ie=new(function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,[{key:"hasGap",value:function(e,t){return+e.high<+t.low||+e.low>+t.high}},{key:"hasContain",value:function(e,t,n){return"forward"===n?+e.high>=+t.high&&+e.low<=+t.low:"backward"===n?+e.high<=+t.high&&+e.low>=+t.low:+e.high<=+t.high&&+e.low>=+t.low||+e.high>=+t.high&&+e.low<=+t.low}},{key:"segment2stroke",value:function(e){var t=[],n=!0,r=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var o=s.value;o.box||(o.box=[]);var c={type:o.type,styping:o.sstroke.styping,etyping:o.estroke.etyping,high:o.high,low:o.low,index:t.length,macd:o.macd,box:o.box};t.push(c)}}catch(e){r=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}return t}},{key:"stroke2segment",value:function(e){var t=[],n=!0,r=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var o=s.value,c={type:o.type,sstroke:o,estroke:o,high:o.high,low:o.low,index:t.length,macd:o.macd};t.push(c)}}catch(e){r=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}return t}},{key:"segment2trend",value:function(e){var t=[],n=!0,r=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var o=s.value;o.box||(o.box=[]);var c={type:o.type,sstroke:o.sstroke,estroke:o.estroke,ssegment:{type:o.sstroke.type,sstroke:o.sstroke,estroke:o.sstroke,high:o.sstroke.high,low:o.sstroke.low,index:o.sstroke.index,macd:o.sstroke.macd},esegment:{type:o.estroke.type,sstroke:o.estroke,estroke:o.estroke,high:o.estroke.high,low:o.estroke.low,index:o.estroke.index,macd:o.estroke.macd},high:o.high,low:o.low,index:t.length,macd:o.macd,box:o.box};t.push(c)}}catch(e){r=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}return t}},{key:"trend2stroke",value:function(e){var t=[],n=!0,r=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var o=s.value,c={type:o.type,styping:o.ssegment.sstroke.styping,etyping:o.esegment.estroke.etyping,high:o.high,low:o.low,index:t.length,macd:o.macd};t.push(c)}}catch(e){r=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}return t}}]),e}()),oe=function(){function e(t){Object(i.a)(this,e),Object(u.a)(this,"klines",[]),Object(u.a)(this,"typings",[]),Object(u.a)(this,"points",[]),Object(u.a)(this,"options",{gap:"1k",contain:"none"}),t&&(this.options=t)}return Object(o.a)(e,[{key:"parse",value:function(e){this.klines=e,this.typings=[],this.points=[],"1k"===this.options.gap&&this.parseGap(),this.parseContain(),this.parseTyping()}},{key:"parseGap",value:function(){for(var e=[],t=0;t<=this.klines.length-2;t++){var n=this.klines.slice(t,t+2),r=Object(p.a)(n,2),a=r[0],s=r[1];if(e.push(a),ie.hasGap(a,s)){var i=Object.assign({},s);+a.high<+s.low&&(i.low=a.high,i.high=s.low,i.open=a.high,i.close=s.low),+a.low>+s.high&&(i.low=s.high,i.high=a.low,i.open=a.low,i.close=s.high),i.isGap=!0,i&&e.push(i)}}e.push(this.klines[this.klines.length-1]),this.klines=e}},{key:"parseContain",value:function(){for(var e=this.klines.slice(0,2),t=2;t<=this.klines.length-1;t++){var n=e.slice(-2),r=Object(p.a)(n,2),a=r[0],s=r[1],i=this.klines[t];ie.hasContain(s,i)?+a.high<+s.high?(+s.high<+i.high?s.day=i.day:s.day=s.day,s.high=""+Math.max(+s.high,+i.high),s.low=""+Math.max(+s.low,+i.low)):(+s.low>+i.low?s.day=i.day:s.day=s.day,s.high=""+Math.min(+s.high,+i.high),s.low=""+Math.min(+s.low,+i.low)):e.push(i)}this.klines=e}},{key:"filterTyping",value:function(e){if("none"===this.options.contain)return e;var t,n,r=[],a=e,s=function(e){return"bottom"===e.type?[e.range[1],e.range[0]]:[e.range[0],e.range[1]]},i="top-bottom"===this.options.contain?function(e,t){return+e.kline.high>=+t.kline.high&&+e.kline.low<=+t.kline.low}:function(e,t){var n=s(e),r=s(t);return n[0]<=r[0]&&n[1]>=r[1]};return["top","bottom"].forEach((function(e){t=null,r=[];for(var s=0;s<=a.length-1;s++)if(t)if((n=a[s]).type!==t.type){if(i(t,n))continue;r.push(n)}else r.push(n),i(t,n)||(t=n);else a[s].type===e&&(t=a[s]),r.push(a[s]);a=r})),r}},{key:"parseTyping",value:function(){for(var e,t=[],n=0;n<=this.klines.length-3;n++){var r=this.klines.slice(n,n+3),a=Object(p.a)(r,3),s=a[0],i=a[1],o=a[2];e=null,+s.high<+i.high&&+o.high<+i.high&&(e={point:[i.day,+i.high],type:"top",kline:i,range:[+s.low,+i.high,+o.low],kindex:n+1,isConfirm:!0}),+s.low>+i.low&&+o.low>+i.low&&(e={point:[i.day,+i.low],type:"bottom",kline:i,range:[+s.high,+i.low,+o.high],kindex:n+1,isConfirm:!0}),e&&t.push(e)}this.typings=this.filterTyping(t);var c=this.klines.slice(-2),u=Object(p.a)(c,2),h=u[0],l=u[1];+h.high<+l.high&&this.typings.push({point:[l.day,+l.high],type:"top",kline:l,range:[+h.low,+l.high,+l.low],kindex:this.klines.length-1}),+h.low>+l.low&&this.typings.push({point:[l.day,+l.low],type:"bottom",kline:l,range:[+h.high,+l.low,+l.high],kindex:this.klines.length-1});for(var f=0;f<this.typings.length;f++)this.typings[f].index=f,this.typings[f].timestamp=new Date(this.typings[f].point[0]).getTime()}},{key:"toPoints",value:function(){this.points=[];var e=!0,t=!1,n=void 0;try{for(var r,a=this.typings[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;this.points.push([].concat(Object(Y.a)(s.point),[s.tip||""]))}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}return this.points}}]),e}(),ce=function(){function e(t){Object(i.a)(this,e),Object(u.a)(this,"klines",[]),Object(u.a)(this,"typings",[]),Object(u.a)(this,"strokes",[]),Object(u.a)(this,"points",[]),Object(u.a)(this,"options",{mode:"strict",weak:"yes"}),t&&(this.options=t)}return Object(o.a)(e,[{key:"isValid3Klines",value:function(e,t){if(t.kindex-e.kindex<4)return!1;for(var n=e.kindex+1;n<=t.kindex-3;n++){if("top"===e.type&&this.klines[n].low>this.klines[n+1].low&&this.klines[n+1].low>this.klines[n+2].low)return!0;if("bottom"===e.type&&this.klines[n].high<this.klines[n+1].high&&this.klines[n+1].high<this.klines[n+2].high)return!0}return!1}},{key:"isValidStroke",value:function(e,t){return!(!e||!t)&&(e.type!==t.type&&(!(t.kindex-e.kindex<4)&&(!("top"===e.type&&e.point[1]<=t.point[1]||"bottom"===e.type&&e.point[1]>=t.point[1])&&("strict"!==this.options.mode||this.isValid3Klines(e,t)))))}},{key:"testValidStroke",value:function(e,t){for(var n=1;n<=3;n++){var r=this.typings[t.index+n];if(!r)break;if(r.type===t.type&&(("top"===r.type&&r.point[1]>t.point[1]||"bottom"===r.type&&r.point[1]<t.point[1])&&this.isValidStroke(e,r)))return!0}return!1}},{key:"isWeakStroke",value:function(e,t){for(var n=e,r=e.index;r<=t.index;r++){var a=this.typings[r];"top"===a.type&&0,"bottom"===a.type&&0,("top"===e.type&&n.point[1]>a.point[1]||"bottom"===e.type&&n.point[1]<a.point[1])&&(n=a)}return n!==t}},{key:"parse",value:function(e,t){this.klines=e,this.typings=t,this.strokes=[],this.points=[];for(var n={styping:this.typings[0],etyping:this.typings[0],type:""},r=0;r<this.typings.length;r++){if(this.isValidStroke(this.typings[0],this.typings[r])){n.styping=this.typings[0];break}if(this.isValidStroke(this.typings[1],this.typings[r])){n.styping=this.typings[1];break}}for(var a=n.styping.index;a<this.typings.length;a++){var s=this.typings[a];if(s.kindex-n.styping.kindex<3){if(s.type===n.styping.type&&("top"===n.styping.type&&n.styping.point[1]<s.point[1]||"bottom"===n.styping.type&&n.styping.point[1]>s.point[1])){n.styping=s,n.etyping=s;continue}}else if(s.type!==n.styping.type&&("top"===n.styping.type&&n.etyping.point[1]>s.point[1]||"bottom"===n.styping.type&&n.etyping.point[1]<s.point[1]?n.etyping=s:this.isValidStroke(n.styping,n.etyping)||(n.etyping=s)),s.type===n.styping.type){var i=this.strokes[this.strokes.length-1];if(i){if(("top"===n.styping.type&&n.styping.point[1]<s.point[1]||"bottom"===n.styping.type&&n.styping.point[1]>s.point[1])&&("top"===n.styping.type&&n.etyping.point[1]>i.styping.point[1]||"bottom"===n.styping.type&&n.etyping.point[1]<i.styping.point[1])){if("no"===this.options.weak&&this.isWeakStroke(n.styping,n.etyping)){this.strokes.pop(),i.etyping=s,n=i;continue}if(!this.isValidStroke(n.etyping,s)&&!this.testValidStroke(n.etyping,s)){this.strokes.pop(),i.etyping=s,n=i;continue}}if(!this.isValidStroke(n.etyping,s))continue}if(("top"===n.styping.type&&n.etyping.point[1]<s.point[1]||"bottom"===n.styping.type&&n.etyping.point[1]>s.point[1])&&this.isValidStroke(n.styping,n.etyping)){+n.etyping.point[1]>+n.styping.point[1]?n.type="up":n.type="down",this.strokes.push(n),n={styping:n.etyping,etyping:s,type:"up"===n.type?"down":"up"};continue}}}if(this.isValidStroke(n.styping,n.etyping)&&this.strokes.push(n),this.strokes[this.strokes.length-1].tip="虚笔",this.strokes.length>1&&this.strokes[0].type===this.strokes[1].type){var o=this.strokes.shift();this.strokes[0].styping=o.styping}for(var c=0;c<this.strokes.length;c++){var u=this.strokes[c];u.index=c,u.timestamp=new Date(u.styping.point[0]).getTime();for(var h=u.styping.kindex;h<=u.etyping.kindex;h++){var l=this.klines[h];u.high||(u.high=u.styping.point[1]),u.low||(u.low=u.styping.point[1]),u.high=Math.max(u.high,l.high),u.low=Math.min(u.low,l.low)}}}},{key:"toPoints",value:function(){this.points=[];var e=!0,t=!1,n=void 0;try{for(var r,a=this.strokes[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;s.tip&&s.tip.includes("虚笔")||(0===this.points.length&&this.points.push(Object(Y.a)(s.styping.point)),this.points.push([].concat(Object(Y.a)(s.etyping.point),[s.macd,s.type,s.tip])))}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}return this.points}},{key:"toPoints2",value:function(){var e=this.strokes[this.strokes.length-1];return e.tip&&e.tip.includes("虚笔")?[Object(Y.a)(e.styping.point),[].concat(Object(Y.a)(e.etyping.point),[e.macd,e.type,e.tip])]:[]}}]),e}(),ue=function(){function e(t){Object(i.a)(this,e),Object(u.a)(this,"strokes",[]),Object(u.a)(this,"segments",[]),Object(u.a)(this,"points",[]),Object(u.a)(this,"options",{mode:"optimize"}),t&&(this.options=t)}return Object(o.a)(e,[{key:"isSegment",value:function(e,t){return e&&t&&("up"===e.type&&e.styping.point[1]<t.styping.point[1]&&e.etyping.point[1]<t.etyping.point[1]||"down"===e.type&&e.styping.point[1]>t.styping.point[1]&&e.etyping.point[1]>t.etyping.point[1])}},{key:"isContain",value:function(e,t){return e&&t&&("up"===e.type&&e.styping.point[1]<t.styping.point[1]&&e.etyping.point[1]>t.etyping.point[1]||"down"===e.type&&e.styping.point[1]>t.styping.point[1]&&e.etyping.point[1]<t.etyping.point[1])}},{key:"merge",value:function(e,t,n){var r={};return"up"===n?(r.high=""+Math.max(+e.high,+t.high),r.low=""+Math.max(+e.low,+t.low)):(r.high=""+Math.min(+e.high,+t.high),r.low=""+Math.min(+e.low,+t.low)),r}},{key:"hasGap",value:function(e,t,n,r,a){var s;if(!t||!n)return!1;if(!a){for(var i=e.index+1;i<n.eindex;i+=2){var o=this.strokes[i],c="up"===r?Math.max:Math.min,u="up"===r?o.styping.kline.high:o.styping.kline.low;s=s?c(u,s):u}return"up"===r?s<n.low:s>n.high}s=null;for(var h=t.eindex+2;h<=n.eindex;h+=2){var l=this.strokes[h],p="up"===r?Math.min:Math.max,f="up"===r?l.etyping.kline.low:l.etyping.kline.high;s=s?p(f,s):f}return"up"===r?s>t.high:s<t.low}},{key:"parse",value:function(e){if(this.strokes=e,this.segments=[],this.points=[],this.strokes.length){for(var t,n,r,a,s,i=function(e){return{high:"up"===e.type?e.etyping.point[1]:e.styping.point[1],low:"up"===e.type?e.styping.point[1]:e.etyping.point[1],sindex:e.index,eindex:e.index}},o=[],c=!1,u=0;u<this.strokes.length;u++){var h=this.strokes.slice(u,u+2),l=Object(p.a)(h,2),f=l[0],g=l[1];if(s||(s=f),f&&g){var d=i(f),v=i(g);if(d.high<=v.high&&d.low>=v.low){s=g;continue}}break}s||(s=this.strokes[0]),n=s.index,a={sstroke:s,estroke:s,type:r=s.type,sequence:[]};for(var k=n;k<=this.strokes.length-3;k++){var y=this.strokes.slice(k,k+7),b=Object(p.a)(y,7),m=b[0],A=b[1],w=b[2],x=b[3],O=b[4],j=b[5],B=b[6],C=i(m),Y=i(A),D=i(w),V=(x&&i(x),O?i(O):null);j&&i(j),B&&i(B);if(w.type!==r)if(t){var M=this.segments[this.segments.length-1];if(c&&M&&o.length<2){var S=M.estroke.etyping;if("up"===r&&S.point[1]>D.low||"down"===r&&S.point[1]<D.high){M.estroke=w,c=!1,this.segments.pop(),a=M,o=[],r=M.type,t=Y;continue}}if(c&&ie.hasContain(t,D,"backward")&&o.length<2)Object.assign(t,this.merge(t,D,r)),t.eindex=w.index,t.isMerged=!0;else if(ie.hasContain(t,D,"forward"))Object.assign(t,this.merge(t,D,r)),t.eindex=w.index,t.isMerged=!0;else if(ie.hasContain(t,D,"backward"))o[0]=t,o[1]=D,t=D,a.estroke=A;else if("up"===r&&t.high<D.high||"down"===r&&t.low>D.low)o[0]=t,o[1]=D,t=D,a.estroke=A;else if("up"===r&&t.high>D.high||"down"===r&&t.low<D.low){if(o.length<2){o[0]=t,o[1]=D,t=D,a.estroke=A;continue}if(c=this.hasGap(a.sstroke,o[0],o[1],r,t.isMerged),V&&o[0]&&o[1]){var E="up"===r?this.strokes[D.sindex].etyping.point[1]<this.strokes[o[1].sindex].etyping.point[1]:this.strokes[D.sindex].etyping.point[1]>this.strokes[o[1].sindex].etyping.point[1],I=ie.hasContain(D,V,"forward");"optimize"===this.options.mode&&!E&&I&&(k+=1),"strict"===this.options.mode&&!c&&I&&(k+=1)}o[2]=D,a.sequence=o,this.segments.push(a);var Q=a.estroke,G=this.strokes[Q.index+1];a={sstroke:G,estroke:G,type:"up"===r?"down":"up",sequence:[]},o=[],r="up"===r?"down":"up",t=Y}else;}else t=C}a.tip="虚段",a.sequence=o,this.segments.push(a);var T=this.strokes[this.strokes.length-1],F=Object(p.a)(a.sequence,2),L=(F[0],F[1]);2===a.sequence.length?L.eindex+1===T.index&&("up"===a.type&&L.high<T.etyping.kline.high||"down"===a.type&&L.low>T.etyping.kline.low)&&(a.estroke=T):a.estroke=T;var U=this.segments[0],R=this.segments.slice(-1)[0];("up"===U.type&&U.sstroke.styping.point[1]>U.estroke.etyping.point[1]||"down"===U.type&&U.sstroke.styping.point[1]<U.estroke.etyping.point[1])&&(1===this.segments.length?this.segments[0].type="up"===U.type?"down":"up":(this.segments.shift(),this.segments[0].sstroke=U.sstroke)),this.segments[0].type!==this.segments[0].sstroke.type&&(this.segments[0].sstroke=this.strokes[this.segments[0].sstroke.index+1]),R.type!==R.estroke.type&&(R.estroke=this.strokes[R.estroke.index-1]);for(var K=0;K<this.segments.length;K++){var H=this.segments[K];H.index=K,H.timestamp=new Date(H.sstroke.styping.point[0]).getTime();for(var P=H.sstroke.index;P<=H.estroke.index;P++){var J=this.strokes[P];H.high||(H.high=J.styping.point[1]),H.low||(H.low=J.styping.point[1]),H.high=Math.max(H.high,J.high),H.low=Math.min(H.low,J.low)}}}}},{key:"toPoints",value:function(){this.points=[];var e=!0,t=!1,n=void 0;try{for(var r,a=this.segments[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;s.tip&&s.tip.includes("虚段")||(0===this.points.length&&this.points.push(Object(Y.a)(s.sstroke.styping.point)),this.points.push([].concat(Object(Y.a)(s.estroke.etyping.point),[s.macd,s.type,s.tip])))}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}return this.points}},{key:"toPoints2",value:function(){var e=this.segments[this.segments.length-1];return e&&e.tip&&e.tip.includes("虚段")?[Object(Y.a)(e.sstroke.styping.point),[].concat(Object(Y.a)(e.estroke.etyping.point),[e.macd,e.type,e.tip])]:[]}},{key:"toPointsOfSequence",value:function(){var e=this,t=[],n=function(t){return{type:e.strokes[t.sindex].styping.point[1]<e.strokes[t.eindex].etyping.point[1]?"up":"down",styping:e.strokes[t.sindex].styping,etyping:e.strokes[t.eindex].etyping}},r=!0,a=!1,s=void 0;try{for(var i,o=this.segments[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var c=i.value,u=Object(p.a)(c.sequence,3),h=u[0],l=u[1],f=u[2],g=h?n(h):null,d=l?n(l):null,v=f?n(f):null,k="up"===c.type?"顶分型":"底分型";g&&t.push(Object(Y.a)(g.styping.point),[].concat(Object(Y.a)(g.etyping.point),["",g.type,"".concat(k,"第一元素")]),null),d&&t.push(Object(Y.a)(d.styping.point),[].concat(Object(Y.a)(d.etyping.point),["",d.type,"".concat(k,"第二元素")]),null),v&&t.push(Object(Y.a)(v.styping.point),[].concat(Object(Y.a)(v.etyping.point),["",v.type,"".concat(k,"第三元素")]),null)}}catch(e){a=!0,s=e}finally{try{r||null==o.return||o.return()}finally{if(a)throw s}}return t}}]),e}(),he=function(){function e(t){Object(i.a)(this,e),Object(u.a)(this,"segments",[]),Object(u.a)(this,"boxes",[]),Object(u.a)(this,"points",[]),Object(u.a)(this,"options",{range:"3k",segment:"start&end"}),t&&(this.options=t)}return Object(o.a)(e,[{key:"isCoincide",value:function(e){return this.range(e)}},{key:"isExpand",value:function(e,t){return!this.merge(e.range,t.range)&&(e.range.top<t.range.bottom&&e.range.high>=t.range.low||e.range.bottom>t.range.top&&e.range.low<=t.range.high)}},{key:"isSpread",value:function(e,t){return!!this.merge(e.range,t.range)||(e.range.top<t.range.bottom&&e.range.top>=t.range.low||e.range.bottom>t.range.top&&e.range.bottom<=t.range.high)}},{key:"isTrend",value:function(e,t){return!this.merge(e.range,t.range)}},{key:"merge",value:function(e,t){var n={};return!(e.bottom>t.top||e.top<t.bottom)&&(n.top=Math.min(e.top,t.top),n.bottom=Math.max(e.bottom,t.bottom),n.high=Math.max(e.high,t.high),n.low=Math.min(e.low,t.low),n)}},{key:"range",value:function(e){if(!(e.length<3)){for(var t,n=0;n<=e.length-3;n++){var r=e.slice(n,n+3),a=Object(p.a)(r,3),s=a[0],i=a[1],o=a[2],c=void 0;if(s.estroke.etyping.point[1]!==i.sstroke.styping.point[1]||i.estroke.etyping.point[1]!==o.sstroke.styping.point[1])return!1;if("high&low"===this.options.segment?c={top:Math.min(i.high,o.high),high:i.high,bottom:Math.max(i.low,o.low),low:i.low}:("up"===s.type&&s.sstroke.styping.point[1]<o.estroke.etyping.point[1]&&(c={top:Math.min(s.estroke.etyping.point[1],o.estroke.etyping.point[1]),high:i.sstroke.styping.point[1],bottom:Math.max(s.sstroke.styping.point[1],o.sstroke.styping.point[1]),low:i.estroke.etyping.point[1]}),"down"===s.type&&s.sstroke.styping.point[1]>o.estroke.etyping.point[1]&&(c={top:Math.min(s.sstroke.styping.point[1],o.sstroke.styping.point[1]),high:i.estroke.etyping.point[1],bottom:Math.max(s.estroke.etyping.point[1],o.estroke.etyping.point[1]),low:i.sstroke.styping.point[1]})),!c)return!1;if(t){var u=this.merge(t,c);if(!u)return!1;"3k"===this.options.range?(n<=1&&(t=u),t.high=u.high,t.low=u.low):t=u}else t=c}return t}}},{key:"parse",value:function(e,t){if(this.segments=e,this.trends=Object(Y.a)(t),this.boxes=[],t&&(!t||0!==t.length)){var n=t[t.length-1];this.segments.length>n.esegment.index+3&&this.trends.push({type:"up"===n.type?"down":"up",ssegment:this.segments[n.esegment.index+1],esegment:this.segments[this.segments.length-1],index:t.length});var r=!0,a=!1,s=void 0;try{for(var i,o=this.trends[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var c=i.value;c.box=[];for(var u=c.ssegment.index,h=c.esegment.index,l=null,f=u;f<=h-2;f++){var g=this.segments.slice(f,f+3),d=Object(p.a)(g,3),v=d[0],k=d[1],y=d[2];e=l?[].concat(Object(Y.a)(l.segments),[y]):[v,k,y];var b=this.range(e);if("high&low"===this.options.segment&&!b&&l&&("up"===k.type&&k.high>l.range.bottom&&y.high<l.range.bottom||"down"===k.type&&k.low<l.range.top&&y.low>l.range.top)&&(b=l.range),b){l?l.esegment=y:l={type:v.type,ssegment:v,esegment:y},l.range=b,l.segments=e,l.isLevelUp=e.length>=11,l.isBreak=l.esegment.type===l.ssegment.type&&e[e.length-1].index!==l.esegment.index,l.isOppositeBreak=l.esegment.type!==l.ssegment.type;var m=c.box.slice(-1)[0];if(m){var A=this.isExpand(m,l),w=this.isSpread(m,l);l.isExpand=A,l.isSpread=w}}else l&&l.segments.length>=5&&(this.boxes.push(l),c.box.push(l)),l=null}l&&l.segments.length>=5&&(this.boxes.push(l),c.box.push(l))}}catch(e){a=!0,s=e}finally{try{r||null==o.return||o.return()}finally{if(a)throw s}}for(var x=0;x<this.boxes.length;x++)this.boxes[x].index=x,this.boxes[x].timestamp=new Date(this.boxes[x].ssegment.sstroke.styping.point[0]).getTime()}}},{key:"toPoints",value:function(){this.points=[];var e=!0,t=!1,n=void 0;try{for(var r,a=this.boxes[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value,i=s.esegment.index-s.ssegment.index-1,o=[[s.ssegment.estroke.etyping.point[0],s.range.top],[s.esegment.sstroke.styping.point[0],s.range.top],[s.esegment.sstroke.styping.point[0],s.range.bottom],[s.ssegment.estroke.etyping.point[0],s.range.bottom],[s.isExpand?"扩张":"",s.isLevelUp?i+" 段":""]];this.points.push(o)}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}return this.points}}]),e}(),le=function(){function e(t){Object(i.a)(this,e),Object(u.a)(this,"segments",[]),Object(u.a)(this,"trends",[]),Object(u.a)(this,"options",{recursion:"segment",a0:"segment",extend:"yes",spread:"yes",levelup:"no"}),Object(u.a)(this,"parser",{segment:null,box:null}),t&&(this.options=t.trend),this.parser.box=new he(t.box),this.parser.segment=new ue(t.segment)}return Object(o.a)(e,[{key:"isSegment",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!(!e||!t)&&(!(t.index-e.index<2)&&(n?"up"===e.type&&e.sstroke.styping.point[1]<t.sstroke.styping.point[1]&&e.estroke.etyping.point[1]<t.estroke.etyping.point[1]||"down"===e.type&&e.sstroke.styping.point[1]>t.sstroke.styping.point[1]&&e.estroke.etyping.point[1]>t.estroke.etyping.point[1]:"up"===e.type&&e.sstroke.styping.point[1]<=t.sstroke.styping.point[1]||"down"===e.type&&e.sstroke.styping.point[1]>=t.sstroke.styping.point[1]))}},{key:"isNotSegment",value:function(e,t){return!(!e||!t)&&(!(t.index-e.index<2)&&("down"===e.type&&e.sstroke.styping.point[1]<t.estroke.etyping.point[1]||"up"===e.type&&e.sstroke.styping.point[1]>t.estroke.etyping.point[1]))}},{key:"setBox",value:function(e){if(e.box=[],!(e.esegment.index-e.ssegment.index<=2)){var t=this.segments,n=[e];this.parser.box.parse(t,n)}}},{key:"setHighOrLow",value:function(e){for(var t=e.ssegment.index+2;t<=e.esegment.index;t+=2){var n=this.segments[t].estroke.etyping.point[1];"up"===e.type&&(e.high||(e.high=n),e.high<n&&(e.high=n)),"down"===e.type&&(e.low||(e.low=n),e.low>n&&(e.low=n))}}},{key:"parseCore2",value:function(e){var t=e.box[e.box.length-1];if(t){var n=!0,r=!0,a=!0;if(t&&"no"===this.options.extend&&t.segments.length>5&&(n=!1),t&&"no"===this.options.levelup&&t.isLevelUp&&(r=!1),t&&"no"===this.options.spread&&t.isSpread&&(a=!1),!(n&&r&&a)){var s=this.segments.slice(e.ssegment.index,e.esegment.index+3);e=this.parseCore([].concat(Object(Y.a)(new Array(e.ssegment.index)),Object(Y.a)(s)),!0),this.setHighOrLow(e)}}return e}},{key:"parseCore",value:function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=0;r<e.length;r++){var a=e.slice(r,r+3),s=Object(p.a)(a,3),i=s[0],o=s[1],c=s[2];if(i){if(!t){if(!this.isSegment(i,c))continue;if(!n&&!("up"===i.type&&i.sstroke.styping.point[1]<c.sstroke.styping.point[1]&&i.estroke.etyping.point[1]<c.estroke.etyping.point[1]||"down"===i.type&&i.sstroke.styping.point[1]>c.sstroke.styping.point[1]&&i.estroke.etyping.point[1]>c.estroke.etyping.point[1]))continue;r=c.index,t={ssegment:i,esegment:c,type:i.type}}if(!(i.index-t.ssegment.index<2)){this.setBox(t),this.setHighOrLow(t);var u=this.trends[this.trends.length-1];if(u&&!u.box&&(u.box=[]),!n&&(t=this.parseCore2(t),i.index<=t.esegment.index))r=t.esegment.index;else if((i.index-t.ssegment.index)%2!=0){if((i.index-t.ssegment.index)%2==1){if(this.isNotSegment(e[t.esegment.index-1],i)){if(c&&this.isSegment(i,c)){this.trends.push(t),t={ssegment:i,esegment:c,type:i.type},r=c.index;continue}continue}if(o&&c&&(this.isNotSegment(t.esegment,o)&&(t.isOppositeBreak=!0),t.box&&t.box.length)){var h=t.box[t.box.length-1];if(h.esegment.index===t.esegment.index){var l="up"===o.type&&o.estroke.etyping.point[1]<h.range.bottom||"down"===o.type&&o.estroke.etyping.point[1]>h.range.top;l&&(t.isOppositeBreak=!0)}}if(!n&&u&&i.index-t.esegment.index==1&&!u.isOppositeBreak&&(t.type!==i.type&&"up"===i.type&&i.estroke.etyping.point[1]>u.esegment.estroke.etyping.point[1]||t.type!==i.type&&"down"===i.type&&i.estroke.etyping.point[1]<u.esegment.estroke.etyping.point[1])){var f=!1,g=!1;if(!("up"===i.type&&i.sstroke.styping.point[1]<u.ssegment.sstroke.styping.point[1]||"down"===i.type&&i.sstroke.styping.point[1]>u.ssegment.sstroke.styping.point[1])){var d=t.esegment.index-t.ssegment.index==2,v=1===t.box.length&&t.ssegment.index===t.box[0].ssegment.index&&t.esegment.index===t.box[0].esegment.index&&t.esegment.index-t.ssegment.index<=5,k=!u.box.length;if(v&&u.box.length){var y=u.box[u.box.length-1];("down"===u.type&&y.range.bottom>t.box[0].range.top||"up"===u.type&&y.range.top<t.box[0].range.bottom)&&c&&!this.isSegment(i,c,!0)&&(k=!0)}if(d||v&&k){var b=Object.assign({},u);b.esegment=i,this.setBox(b);var m=b.box[b.box.length-1],A=!0,w=!0,x=!0;m&&"no"===this.options.extend&&m.segments.length>5&&(A=!1),m&&"no"===this.options.levelup&&m.isLevelUp,m&&"no"===this.options.spread&&m.isSpread&&(x=!1),m&&A&&w&&x&&!m.isOppositeBreak&&(g=!0)}}if(f||g){this.trends.pop(),(t=u).esegment=i;continue}}if(o&&(t.type===o.type&&"up"===o.type&&o.estroke.etyping.point[1]>t.high||t.type===o.type&&"down"===o.type&&o.estroke.etyping.point[1]<t.low)){if(i.index-t.esegment.index==1){t.esegment=o,r=o.index;continue}if(i.index-t.esegment.index==3){t.esegment=o,r=o.index;continue}}i.index-t.esegment.index==1&&c&&this.isSegment(i,c)&&(this.trends.push(t),t={ssegment:i,esegment:c,type:i.type},r=c.index),i.index-t.esegment.index==3&&c&&this.isSegment(i,c)&&(this.trends.push(t),t={ssegment:e[t.esegment.index+1],esegment:c,type:e[t.esegment.index+1].type},r=c.index)}}else{if("up"===t.type&&t.high<i.estroke.etyping.point[1]||"down"===t.type&&t.low>i.estroke.etyping.point[1]){t.esegment=i;continue}if(o&&i.index-t.esegment.index==4&&(t.type!==o.type&&"up"===o.type&&o.estroke.etyping.point[1]>i.sstroke.styping.point[1]||t.type!==o.type&&"down"===o.type&&o.estroke.etyping.point[1]<i.sstroke.styping.point[1])){this.trends.push(t),t={ssegment:e[t.esegment.index+1],esegment:o,type:o.type},r=o.index;continue}}}}}return t}},{key:"parse",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.segments=e,this.trends=[],this.points=[],this.segments.length&&!(this.segments.length<3)){if("segment"===this.options.recursion){var t=!!e[0].ssegment;return this.parser.segment.parse(t?ie.trend2stroke(e):ie.segment2stroke(e)),void(this.trends=ie.segment2trend(this.parser.segment.segments))}var n=this.parseCore(e);n&&(this.setBox(n),(n=this.parseCore2(n)).tip="虚走势",this.trends.push(n));for(var r=0;r<this.trends.length;r++){var a=this.trends[r];a.index=r,a.timestamp=new Date(a.ssegment.sstroke.styping.point[0]).getTime(),a.sstroke=a.ssegment.sstroke,a.estroke=a.esegment.estroke;for(var s=a.ssegment.index;s<=a.esegment.index;s++){var i=this.segments[s];a.high||(a.high=i.high),a.low||(a.low=i.low),a.high=Math.max(a.high,i.high),a.low=Math.min(a.low,i.low)}}}}},{key:"toPoints",value:function(){this.points=[];var e=!0,t=!1,n=void 0;try{for(var r,a=this.trends[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;s.tip&&s.tip.includes("虚走势")||(0===this.points.length&&this.points.push(Object(Y.a)(s.sstroke.styping.point)),this.points.push([].concat(Object(Y.a)(s.estroke.etyping.point),[s.macd,s.type,s.tip])))}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}return this.points}},{key:"toPoints2",value:function(){var e=this.trends[this.trends.length-1];return e&&e.tip&&e.tip.includes("虚走势")?[Object(Y.a)(e.sstroke.styping.point),[].concat(Object(Y.a)(e.estroke.etyping.point),[e.macd,e.type,e.tip])]:[]}}]),e}(),pe=function(){function e(t,n,r){Object(i.a)(this,e),Object(u.a)(this,"segments",[]),Object(u.a)(this,"boxes",[]),Object(u.a)(this,"sequences",[]),this.segments=t,this.boxes=n,this.sequences=r}return Object(o.a)(e,[{key:"type",value:function(){return"typing"}},{key:"state",value:function(){return 1===this.sequences.length?"new":2===this.sequences.length?"build":3===this.sequences.length?"leave":void 0}},{key:"test",value:function(){return!0}},{key:"testDeviate",value:function(e,t){return"up"===e.type?e.macd<t.macd:e.macd>t.macd}},{key:"isTradePoint1",value:function(){var e=this.segments.slice(-5),t=Object(p.a)(e,3),n=t[0],r=t[1],a=t[2],s=Object(p.a)(this.sequences,3),i=s[0],o=s[1];s[2];return!!(n&&r&&a)&&(n.type===a.type&&(!!i&&(!o&&(r.index===i.sindex&&this.testDeviate(a,n)))))}},{key:"isTradePoint2",value:function(){var e=this.segments.slice(-5),t=Object(p.a)(e,5),n=t[0],r=t[1],a=t[2],s=t[3],i=t[4],o=Object(p.a)(this.sequences,3),c=(o[0],o[1]),u=o[2];if(!(n&&r&&a&&s&&i))return!1;if(n.type!==a.type||a.type!==i.type||r.type!==s.type)return!1;if(!c)return!1;if(u)return!1;if(!i||s.index!==c.sindex)return!1;var h="up"===i.type?i.sstroke.styping.point[1]:i.estroke.etyping.point[1],l="up"===i.type?i.estroke.etyping.point[1]:i.sstroke.styping.point[1];return"up"===i.type?l<c.high:h>c.low}},{key:"isTradePoint3",value:function(){return!1}}]),e}(),fe=function(){function e(t,n,r){Object(i.a)(this,e),Object(u.a)(this,"segments",[]),Object(u.a)(this,"boxes",[]),Object(u.a)(this,"sequences",[]),this.segments=t,this.boxes=n,this.sequences=r}return Object(o.a)(e,[{key:"test",value:function(){var e=this.boxes.slice(-1);return!!Object(p.a)(e,1)[0]}},{key:"type",value:function(){return"box"}},{key:"state",value:function(){return this.isComplete()?"complete":this.isBreak()?"break":this.isBreakthrough()?"leave":this.isBuild()?"build":void 0}},{key:"isBuild",value:function(){var e=this.boxes.slice(-1),t=Object(p.a)(e,1)[0];return t.esegment.estroke.etyping.point[1]<=t.range.high&&t.esegment.estroke.etyping.point[1]>=t.range.low}},{key:"isComplete",value:function(){var e=this.boxes.slice(-1),t=Object(p.a)(e,1)[0],n=this.segments.slice(-1);return Object(p.a)(n,1)[0].index>t.esegment.index+1}},{key:"isBreakthrough",value:function(){var e=this.boxes.slice(-1),t=Object(p.a)(e,1)[0];return t.esegment.estroke.etyping.point[1]>t.range.high||t.esegment.estroke.etyping.point[1]<t.range.low}},{key:"isBreak",value:function(){var e=this.boxes.slice(-1),t=Object(p.a)(e,1)[0],n=this.segments.slice(-1),r=Object(p.a)(n,1)[0];if(t&&this.isBreakthrough()&&r.index===t.esegment.index+1&&!(r.index>t.esegment.index+1))return r.estroke.etyping.point[1]>t.range.top||r.estroke.etyping.point[1]<t.range.bottom}},{key:"isDeviate",value:function(){var e=this.boxes.slice(-1),t=Object(p.a)(e,1)[0];if(t&&this.isBreakthrough())return this.testDeviate(t.esegment,t.ssegment)}},{key:"testDeviate",value:function(e,t){return"up"===e.type?e.macd<t.macd:e.macd>t.macd}},{key:"testNewHighOrLow",value:function(e,t){return"up"===e.type?e.estroke.etyping.point[1]>t.estroke.etyping.point[1]:e.estroke.etyping.point[1]<t.estroke.etyping.point[1]}},{key:"isTradePoint1",value:function(){var e=this.boxes.slice(-1),t=Object(p.a)(e,1)[0],n=this.segments.slice(-3),r=Object(p.a)(n,3),a=r[0],s=(r[1],r[2]);if(t.esegment.type!==t.type)return!1;if("leave"===this.state())return this.isDeviate();if("complete"===this.state()){if(!this.isDeviate())return!1;if(s.index===t.esegment.index+2&&this.testNewHighOrLow(s,a))return this.testDeviate(s,a)}}},{key:"isTradePoint2",value:function(){var e=this.boxes.slice(-1),t=Object(p.a)(e,1)[0],n=this.segments.slice(-3),r=Object(p.a)(n,3),a=r[0],s=(r[1],r[2]);if(t.esegment.type!==t.type)return!1;if("complete"===this.state()){if(!this.isDeviate())return!1;if(s.index===t.esegment.index+2&&!this.testNewHighOrLow(s,a))return this.testDeviate(s,a)}}},{key:"isTradePoint3",value:function(){return"break"===this.state()}}]),e}(),ge=function(e){function t(){return Object(i.a)(this,t),Object(S.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(I.a)(t,e),Object(o.a)(t,[{key:"type",value:function(){return"shake"}},{key:"test",value:function(){if(!Object(L.a)(Object(E.a)(t.prototype),"test",this).call(this))return!1;var e=this.boxes.slice(-1),n=Object(p.a)(e,1)[0];return!n.isLevelUp&&(!!this.isBreakthrough()&&n.ssegment.type===n.esegment.type)}},{key:"isDeviate",value:function(){return Object(L.a)(Object(E.a)(t.prototype),"isDeviate",this).call(this)}}]),t}(fe),de=function(e){function t(){return Object(i.a)(this,t),Object(S.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(I.a)(t,e),Object(o.a)(t,[{key:"type",value:function(){return"trend"}},{key:"test",value:function(){if(!Object(L.a)(Object(E.a)(t.prototype),"test",this).call(this))return!1;var e=this.boxes.slice(-2),n=Object(p.a)(e,2),r=n[0],a=n[1];return!(!r||!a)&&(!(!r.isLevelUp||!a.isLevelUp)&&(!a.isExpand&&(r.type===a.type&&(!!this.isBreakthrough()&&a.ssegment.type===a.esegment.type))))}},{key:"isDeviate",value:function(){var e=this.boxes.slice(-2),t=Object(p.a)(e,2),n=t[0],r=t[1];if(n&&r&&!0===this.isBreak()){var a=r.type;return"up"===a?r.esegment.macd<r.ssegment.macd&&n.esegment.macd<n.ssegment.macd:"down"===a?r.esegment.macd>r.ssegment.macd&&n.esegment.macd>n.ssegment.macd:void 0}}}]),t}(fe),ve=n(560);n(553);function ke(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=[],r=e.length;if(0===r||t<=0)return n;var a=e[0];n.push(a);for(var s=e[0],i=t*(t+1)/2,o=1;o<r;o++){if(o<t){s+=e[o];for(var c=0,u=0,h=0;h<=o;h++)c+=e[o-h]*(t-h),u+=t-h;a=c/u}else a+=(t*e[o]-s)/i,s+=e[o]-e[o-t];n.push(a)}return n}function ye(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=e.length,r=[];if(0===n||t<=0)return r;var a=2/(t+1),s=e[0];r.push(s);for(var i=1;i<n;i++)s=a*e[i]+(1-a)*s,r.push(s);return r}function be(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=[],r=e.length;if(0===r||t<=0)return n;var a=e[0];n.push(a);for(var s=1;s<r;s++){if(s<t){for(var i=e[0],o=1;o<=s;o++)i+=e[o];a=i/(s+1)}else a+=(e[s]-e[s-t])/t;n.push(a)}return n}var me=n(961),Ae=n(795),we=n(972),xe={macd:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:26,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:9,a=e.length,s=[],i=[],o=[];if(0===a)return{dif:s,dea:o,bar:i};for(var c=ye(e,t),u=ye(e,n),h=0;h<a;h++)s.push(c[h]-u[h]);o=ye(s,r);for(var l=0;l<a;l++)i.push(2*(s[l]-o[l]));return{dif:s,dea:o,bar:i}},boll:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.ma,s=r.sd;a=a||Object(Ae.a)(e,t),s=s||Object(me.a)(e,t);var i=Object(we.b)(s,n);return{upper:Object(we.a)(a,i),mid:a,lower:Object(we.c)(a,i)}},ema:ye,wma:ke,ma:be},Oe=new(function(){function e(){Object(i.a)(this,e),Object(u.a)(this,"map",{}),Object(u.a)(this,"boll",{upper:[],mid:[],lower:[]}),Object(u.a)(this,"klines",[])}return Object(o.a)(e,[{key:"calc",value:function(e,t,n){return this.map=n,this.klines=e,this.boll=xe.boll(t),this.boll}},{key:"state",value:function(e){var t=this.map[e];return{upper:this.boll.upper[t],mid:this.boll.mid[t],lower:this.boll.lower[t]}}},{key:"calcBreak",value:function(e,t,n){var r=!0,a=!1,s=void 0;try{for(var i,o=t[Symbol.iterator]();!(r=(i=o.next()).done);r=!0)for(var c=i.value,u=c.styping?c.styping.point[0]:c.sstroke.styping.point[0],h=c.styping?c.etyping.point[0]:c.estroke.etyping.point[0],l=this.map[u],p=this.map[h],f=l;f<=p;f++)if(n(f))return!0}catch(e){a=!0,s=e}finally{try{r||null==o.return||o.return()}finally{if(a)throw s}}return!1}},{key:"isBreakUpper",value:function(e,t){var n=this;return this.calcBreak(t,e,(function(e){var r=n.klines[e],a=n.boll.upper[e];return"up"===t&&r.high>a||"down"===t&&r.low<a}),t)}},{key:"isBreakLower",value:function(e,t){var n=this;return this.calcBreak(t,e,(function(e){var r=n.klines[e],a=n.boll.lower[e];return"up"===t&&r.high>a||"down"===t&&r.low<a}))}},{key:"isBreakMid",value:function(e,t){var n=this;return this.calcBreak(e,(function(e){var r=n.klines[e],a=n.boll.mid[e];return"up"===t&&r.high>a||"down"===t&&r.low<a}))}}]),e}()),je=(window.top.__Walle_Devtools,function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(i.a)(this,t),n=Object(S.a)(this,Object(E.a)(t).call(this)),Object(u.a)(Object(F.a)(n),"pattern",void 0),Object(u.a)(Object(F.a)(n),"state",void 0),Object(u.a)(Object(F.a)(n),"oldState",null),Object(u.a)(Object(F.a)(n),"vip",void 0),Object(u.a)(Object(F.a)(n),"option",{boll:!1}),n.vip=e,Object.assign(n.option,r),n}return Object(I.a)(t,e),Object(o.a)(t,[{key:"prepareTip",value:function(e,t,n){if("svip"===this.vip&&t){var r=e.box?e:e.estroke,a=t.type+("down"===t.direction?"卖":"买")+(t.tip?"(".concat(t.tip,")"):"");r.tip&&r.tip.includes("虚")&&(a+="预期"),r.tip=r.tip?r.tip+" "+a:a}}},{key:"prepareBollTip",value:function(e,t,n){if(this.option.boll&&t&&1==+t.type){var r=e.box?e:e.estroke,a=t.type+("down"===t.direction?"卖":"买")+(t.tip?"(".concat(t.tip,")"):"");if("up"===e.type&&Oe.isBreakUpper(n,"up")){var s=n.slice(-1)[0].estroke.etyping.kline,i=Oe.state(s.day);s.high<i.upper&&(a="布林"+a,!0)}if("down"===e.type&&Oe.isBreakLower(n,"down")){var o=n.slice(-1)[0].estroke.etyping.kline,c=Oe.state(o.day);o.low>c.lower&&(a="布林"+a,!0)}r.tip&&r.tip.includes("虚")&&(a+="预期"),r.tip=r.tip?r.tip+" "+a:a}}},{key:"isDeviate",value:function(e,t){return"up"===e.type?+t.macd<+e.macd:+t.macd>+e.macd}},{key:"isBoxDeviate",value:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a={direction:e.type,macd:0},s={direction:e.type,macd:0},i=e.sstroke.index,o=e.estroke.index,c=0;c<e.box.length;c++)e.box[c+1]===n&&(i=e.box[c].ssegment.index),e.box[c-1]===n&&(o=e.box[c].ssegment.index);var u=!0,h=!1,l=void 0;try{for(var p,f=t[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var g=p.value;if(g.type===e.type){if(r&&g.index>r.index)break;g.index>=i&&g.index<=n.ssegment.index&&(a.macd+=g.macd),g.index<=o&&g.index>=n.esegment.index&&(s.macd+=g.macd)}}}catch(e){h=!0,l=e}finally{try{u||null==f.return||f.return()}finally{if(h)throw l}}return this.isDeviate(a,s)}},{key:"isBoxBreak",value:function(e,t){return"down"===e.type&&e.estroke.etyping.point[1]>t.range.top||"up"===e.type&&e.estroke.etyping.point[1]<t.range.bottom}},{key:"isValid",value:function(e){if(!e.box)return!0;var t=!0,n=!1,r=void 0;try{for(var a,s=e.box[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){if(a.value.type!==e.type)return!1}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}return!0}},{key:"isValidTrend",value:function(e){if(!e.box)return!1;if(e.box.length<2)return!1;var t=!0,n=!1,r=void 0;try{for(var a,s=e.box[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var i=a.value;if(i.type!==e.type)return!1;if(i.isExpand)return!1}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}return!0}},{key:"parse",value:function(e,t){this.segments=e,this.trends=t,this.state=null;var n=!0,r=!1,a=void 0;try{for(var s,i=t[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var o=s.value,c=o.ssegment.index,u=o===t.slice(-1)[0]?e.length-1:o.esegment.index,h=o===t.slice(-1)[0];if(this.option.boll&&(u=o.esegment.index),this.isValid(o)){var l={direction:o.type,segments:e.slice(c,u+1),boxes:Object(Y.a)(o.box||[]),sequences:o.sequence||[]},p=l.boxes.shift(),f=[],g=!0,d=!1,v=void 0;try{for(var k,y=l.segments[Symbol.iterator]();!(g=(k=y.next()).done);g=!0){var b=k.value,m=null;f.push(b);var A="up"===b.type?"down":"up";if(b===l.segments[1]&&("up"===o.type&&b.estroke.etyping.point[1]>l.segments[0].sstroke.styping.point[1]||"down"===o.type&&b.estroke.etyping.point[1]<l.segments[0].sstroke.styping.point[1])&&(m={type:"2",direction:A}),p){if(b.index===p.esegment.index&&b.type===o.type&&this.isDeviate(p.ssegment,p.esegment)&&b.index===o.esegment.index&&(m=this.isValidTrend(o)?{type:"1",direction:A,tip:"趋势背驰"}:{type:"1",direction:A,tip:"盘整背驰"}),b.index===p.esegment.index+1&&this.isBoxBreak(b,p)&&(m={type:"3",direction:A}),b.index===p.esegment.index+2&&b.index===o.esegment.index){var w="down"===b.type&&b.sstroke.styping.point[1]<p.range.bottom||"up"===b.type&&b.sstroke.styping.point[1]>p.range.top,x="down"===b.type&&b.estroke.etyping.point[1]<p.esegment.estroke.etyping.point[1]||"up"===b.type&&b.estroke.etyping.point[1]>p.esegment.estroke.etyping.point[1];b.type===o.type&&w&&x&&this.isDeviate(p.esegment,b)&&(m={type:"1",direction:A,tip:"3买/3卖后背驰"})}l.boxes.length&&b.index===p.esegment.index+2&&(p=l.boxes.shift())}else b.index!==u||h||this.isDeviate(l.segments[l.segments.length-3],b)&&(m={type:"1",direction:A});2===l.sequences.length&&b.index===l.sequences[1].eindex+1?("up"===o.type&&b.estroke.etyping.point[1]<l.sequences[1].high||"down"===o.type&&b.estroke.etyping.point[1]>l.sequences[1].low)&&(m={type:"2",direction:A}):b.index===o.esegment.index+2&&("up"===o.type&&b.estroke.etyping.point[1]<o.esegment.estroke.etyping.point[1]||"down"===o.type&&b.estroke.etyping.point[1]>o.esegment.estroke.etyping.point[1])&&(m={type:"2",direction:A}),this.updateState(b,m),m&&(this.option.boll?this.prepareBollTip(b,m,f):this.prepareTip(b,m,f))}}catch(e){d=!0,v=e}finally{try{g||null==y.return||y.return()}finally{if(d)throw v}}}}}catch(e){r=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}null===this.oldState?this.oldState=this.state:this.checkStateChange(),this.state&&console.log("#TradePattern# state ",JSON.stringify(this.state))}},{key:"parseOfPattern",value:function(e,t){this.segments=e,this.trends=t;var n=Object(p.a)(t.slice(-1)[0],1)[0],r=Object(p.a)(e.slice(-1)[0],1)[0];if(n){this.state=null,this.pattern=null;var a=n.sstroke.index,s=e.length,i={segments:e.slice(a,s),boxes:n.box||[],sequences:n.sequence||[]},o=(this.testPattern(i.segments,i.boxes,i.sequences),this.testTradePoint(i.segments,i.boxes,i.sequences));this.updateState(r,o),o&&this.prepareTip(o,r),this.pattern&&console.log("#TradePattern# pattern - ".concat(this.pattern.type(),", state - ").concat(this.pattern.state()),JSON.stringify(this.state))}}},{key:"testPattern",value:function(e,t,n){this.pattern=null;for(var r=0,a=[de,ge];r<a.length;r++){var s=new(0,a[r])(e,t,n);try{if(s.test()){this.pattern=s;break}}catch(e){}}return this.pattern||(this.pattern=new pe(e,t,n)),this.pattern}},{key:"testTradePoint",value:function(e,t,n){this.pattern||this.testPattern(e,t,n);var r=e.slice(-1),a="up"===Object(p.a)(r,1)[0].type?"down":"up",s=null;return this.pattern.isTradePoint1()&&(s={type:"1",direction:a}),this.pattern.isTradePoint2()&&(s={type:"2",direction:a}),this.pattern.isTradePoint3()&&(s={type:"3",direction:a}),s}},{key:"updateState",value:function(e,t){if("svip"===this.vip){if(t){var n=t.type+("down"===t.direction?"卖":"买");this.state=Object(c.a)({},t,{isConfirm:!1,sindex:e.index,tip:n+"预期"})}if(this.state&&e.index===this.state.sindex&&(this.state.typing=e.estroke.etyping),this.state&&e.index===this.state.sindex+1){var r=this.state.type+("down"===this.state.direction?"卖":"买");this.state.isConfirm=!0,this.state.tip=r+"确认"}this.state&&this.oldState&&this.oldState.isConfirm&&this.oldState.sindex===e.index&&this.state.type===this.oldState.type&&this.state.direction===this.oldState.direction&&(this.state.isRollback=!0,this.state.tip+="(回退)"),this.state&&this.state.isConfirm&&e.index===this.state.sindex+2&&(this.state=null)}}},{key:"checkStateChange",value:function(){if(this.state){if(this.oldState&&this.state&&this.state.tip){if(!this.state.isConfirm&&this.state.typing.isConfirm&&!this.oldState.typing.isConfirm){if(this.state.tip===this.oldState.tip&&this.state.sindex===this.oldState.sindex){var e=Object.assign({},this.state);e.tip+="(分型成立)",this.fire("change",e)}this.oldState.typing=this.state.typing}this.oldState.typing.index!==this.state.typing.index&&(this.oldState.typing=this.state.typing)}if(!this.oldState&&this.state.tip||this.oldState.tip!==this.state.tip){if(this.oldState=Object.assign({},this.state),!this.state.isConfirm&&!this.state.isRollback)return;this.state.isRollback&&(this.oldState.tip=this.oldState.tip.replace("(回退)","")),this.fire("change",this.state)}}}},{key:"initState",value:function(){this.oldState=null,this.state=null}}]),t}(ve.a)),Be=new(function(){function e(){Object(i.a)(this,e),Object(u.a)(this,"map",{}),Object(u.a)(this,"macd",{dif:[],dea:[],bar:[]})}return Object(o.a)(e,[{key:"calc",value:function(e,t){return this.map=t,this.macd=xe.macd(e),this.macd}},{key:"segments",value:function(e){var t=!0,n=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var i=a.value,o=i.sstroke.styping.point[0],c=i.estroke.etyping.point[0],u=this.map[o],h=this.map[c],l=this.calcArea(this.macd,u,h);this.toTip(i,l)}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}}},{key:"strokes",value:function(e){var t=!0,n=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var i=a.value,o=i.styping.point[0],c=i.etyping.point[0],u=this.map[o],h=this.map[c],l=this.calcArea(this.macd,u,h);this.toTip(i,l)}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}}},{key:"calcArea",value:function(e,t,n){var r={red:0,green:0};if(e&&e.bar&&!(e.bar.length<n)){for(var a=t;a<=n;a++){var s=e.bar[a];s>0?r.red+=+s:r.green+=+s}return r}}},{key:"toTip",value:function(e,t){e.macd=this.toString(t,e)}},{key:"toString",value:function(e,t){return"up"===t.type?e.red.toFixed(2):"down"===t.type?e.green.toFixed(2):(e.red+e.green).toFixed(2)}},{key:"toString2",value:function(e){return"Red: ".concat(e.red.toFixed(2)," Green: ").concat(e.green.toFixed(2))}}]),e}()),Ce=(window.top.__Walle_Devtools,function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(i.a)(this,e),Object(u.a)(this,"parsers",{typing:null,stroke:null,segment:null,trend:null,trend2:null,strokebox:null,segmentbox:null,trendbox:null}),Object(u.a)(this,"patterns",{stroke:null,segment:null,trend:null,trend2:null}),Object(u.a)(this,"indicators",{macd:{},boll:{}}),Object(u.a)(this,"klines",[]),Object(u.a)(this,"points",{}),Object(u.a)(this,"twist",{}),Object(u.a)(this,"vip",void 0),Object(u.a)(this,"indicator",void 0),Object(u.a)(this,"options",void 0),this.vip=t,this.options=n,this.patterns={stroke:new je(this.vip),segment:new je(this.vip),trend:new je(this.vip),trend2:new je(this.vip)}}return Object(o.a)(e,[{key:"reset",value:function(){this.parsers={typing:null,stroke:null,segment:null,trend:null,trend2:null,strokebox:null,segmentbox:null,trendbox:null},this.indicators={macd:{},boll:{}},this.patterns.stroke.initState(),this.patterns.segment.initState(),this.patterns.trend.initState(),this.patterns.trend2.initState(),this.klines=[],this.points={},this.twist={}}},{key:"init",value:function(e){this.klines=H()(e),this.parsers.typing=new oe(this.options.typing),this.parsers.stroke=new ce(this.options.stroke),this.parsers.segment=new ue(this.options.segment),this.parsers.trend=new le(this.options),this.parsers.trend2=new le(this.options),this.parsers.strokebox=new he(this.options.box),this.parsers.segmentbox=new he(this.options.box),this.parsers.trendbox=new he(this.options.box)}},{key:"setIndicatorType",value:function(e){this.indicator=e,this.patterns={stroke:new je(this.vip,{boll:"boll"===this.indicator}),segment:new je(this.vip),trend:new je(this.vip),trend2:new je(this.vip)}}},{key:"updateIndicator",value:function(e){for(var t=[],n={},r=0;r<e.length;r++)t.push(+e[r].close),n[e[r].day]=r;this.indicators.macd=Be.calc(t,n),"boll"===this.indicator&&(this.indicators.boll=Oe.calc(e,t,n))}},{key:"update",value:function(e){var t=e[e.length-1],n=this.klines[this.klines.length-1];return t&&n&&t.day===n.day&&this.klines.length===e.length?(this.updateIndicator(e),this.twist):this.parse(e)}},{key:"parse",value:function(e){return this.init(e),this.updateIndicator(e),this.parsers.typing.parse(this.klines),this.parsers.stroke.parse(this.parsers.typing.klines,this.parsers.typing.typings),Be.strokes(this.parsers.stroke.strokes,this.indicators.macd),"segment"===this.options.trend.a0?(this.parsers.segment=new ue(this.options.segment),this.parsers.segment.parse(this.parsers.stroke.strokes)):(this.parsers.segment=new le(this.options),this.parsers.segment.parse(ie.stroke2segment(this.parsers.stroke.strokes)),this.parsers.segment.segments=this.parsers.segment.trends),this.parsers.trend.parse(this.parsers.segment.segments),this.parsers.trend2.parse(this.parsers.trend.trends),Be.segments(this.parsers.segment.segments,this.indicators.macd),Be.segments(this.parsers.trend.trends,this.indicators.macd),Be.segments(this.parsers.trend2.trends,this.indicators.macd),this.parsers.strokebox.parse(ie.stroke2segment(this.parsers.stroke.strokes),ie.segment2trend(this.parsers.segment.segments)),this.parsers.segmentbox.parse(this.parsers.segment.segments,this.parsers.trend.trends),this.parsers.trendbox.parse(this.parsers.trend.trends,this.parsers.trend2.trends),this.patterns.stroke.parse(ie.stroke2segment(this.parsers.stroke.strokes),ie.segment2trend(this.parsers.segment.segments)),this.patterns.segment.parse(this.parsers.segment.segments,this.parsers.trend.trends),this.patterns.trend.parse(this.parsers.trend.trends,this.parsers.trend2.trends),this.twist={typing:this.parsers.typing.typings,stroke:this.parsers.stroke.strokes,segment:this.parsers.segment.segments,trend:this.parsers.trend.trends,trend2:this.parsers.trend2.trends,strokebox:this.parsers.strokebox.boxes,segmentbox:this.parsers.segmentbox.boxes,trendbox:this.parsers.trendbox.boxes},this.twist}},{key:"state",value:function(){return{typing:this.parsers.typing.typings.slice(-1)[0],stroke:this.parsers.stroke.strokes.slice(-1)[0],segment:this.parsers.segment.segments.slice(-1)[0],trend:this.parsers.trend.trends.slice(-1)[0],trend2:this.parsers.trend2.trends.slice(-1)[0],strokebox:this.parsers.strokebox.boxes.slice(-1)[0],segmentbox:this.parsers.segmentbox.boxes.slice(-1)[0],trendbox:this.parsers.trendbox.boxes.slice(-1)[0]}}},{key:"pattern",value:function(){return this.patterns}},{key:"sequence",value:function(){return"segment"!==this.options.trend.a0?[]:this.parsers.segment.toPointsOfSequence()}},{key:"line",value:function(){var e=this.klines.slice(-1)[0],t=this.parsers.segment.segments.slice(-1)[0];t&&t.sequence&&t.sequence.length<2&&(t=this.parsers.segment.segments.slice(-2)[0]);var n=this.parsers.trend.trends.slice(-1)[0];n&&n.sequence&&n.sequence.length<2&&(n=this.parsers.trend.trends.slice(-2)[0]);var r=[{type:"price",point:e.close,color:"white",tip:"价 格 线"}];return t&&t.sequence&&t.sequence[1]&&r.push({type:"segment",point:(t.sequence[1]||{}).high,color:"red",tip:"看 多 预 警 线 (段)"},{type:"segment",point:(t.sequence[1]||{}).low,color:"green",tip:"看 空 预 警 线 (段)"}),n&&n.sequence&&n.sequence[1]&&r.push({type:"trend",point:(n.sequence[1]||{}).high,color:"red",tip:"看 多 预 警 线 (走势)"},{type:"trend",point:(n.sequence[1]||{}).low,color:"green",tip:"看 空 预 警 线 (走势)"}),r}},{key:"toPoints",value:function(){return this.points={typing:this.parsers.typing.toPoints(),stroke:this.parsers.stroke.toPoints(),segment:this.parsers.segment.toPoints(),trend:this.parsers.trend.toPoints(),trend2:this.parsers.trend2.toPoints(),vstroke:this.parsers.stroke.toPoints2(),vsegment:this.parsers.segment.toPoints2(),vtrend:this.parsers.trend.toPoints2(),vtrend2:this.parsers.trend2.toPoints2(),strokebox:this.parsers.strokebox.toPoints(),segmentbox:this.parsers.segmentbox.toPoints(),trendbox:this.parsers.trendbox.toPoints(),indicator:this.indicators},this.points}}]),e}()),Ye=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["min5","min30","day"],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;Object(i.a)(this,e),Object(u.a)(this,"symbol",void 0),Object(u.a)(this,"levels",["min5","min30","day"]),Object(u.a)(this,"length",void 0),Object(u.a)(this,"processors",{}),Object(u.a)(this,"patterns",{}),Object(u.a)(this,"twists",{}),Object(u.a)(this,"states",{min1:null,min5:null,min30:null,day:null}),this.symbol=t,this.levels=n,this.options=r,this.length=a,t&&(this.crawler=t.includes("-")?new ae(t):new se(t))}var t,n;return Object(o.a)(e,[{key:"capture",value:(n=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([this.levels[0]&&this.crawler.capture(this.levels[0],this.length),this.levels[1]&&this.crawler.capture(this.levels[1],this.length),this.levels[2]&&this.crawler.capture(this.levels[2],this.length)]));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"parse",value:(t=Object(s.a)(a.a.mark((function e(t){var n,r,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=4;break}return e.next=3,this.capture();case 3:t=e.sent;case 4:n=0;case 5:if(!(n<this.levels.length)){e.next=16;break}if(r=t[n],s=this.levels[n],r&&s){e.next=10;break}return e.abrupt("continue",13);case 10:this.processors[s]=new Ce("svip",this.options),this.twists[s]=this.processors[s].parse(r),this.patterns[s]=this.processors[s].pattern();case 13:n++,e.next=5;break;case 16:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"toTips",value:function(){var e={},t=!0,n=!1,r=void 0;try{for(var a,s=this.levels[Symbol.iterator]();!(t=(a=s.next()).done);t=!0)for(var i=a.value,o=0,c=["stroke","segment","trend"];o<c.length;o++){var u=c[o];e[i]||(e[i]={}),e[i][u]=this.patterns[i][u].state}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}return e}}]),e}(),De=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=Object(S.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(a))),Object(u.a)(Object(F.a)(n),"kline",null),Object(u.a)(Object(F.a)(n),"state",{typing:null,stroke:null,segment:null,trend:null,strokebox:null,segmentbox:null,trendbox:null}),Object(u.a)(Object(F.a)(n),"isInit",!1),n}return Object(I.a)(t,e),Object(o.a)(t,[{key:"reset",value:function(){this.state={typing:null,stroke:null,segment:null,trend:null,strokebox:null,segmentbox:null,trendbox:null},this.kline=null,this.isInit=!1}},{key:"init",value:function(e){var t=e.typing,n=e.stroke,r=e.segment,a=e.trend,s=e.strokebox,i=e.segmentbox,o=e.trendbox;this.state={typing:t||{timestamp:-1},stroke:n||{timestamp:-1},segment:r||{timestamp:-1},trend:a||{timestamp:-1},strokebox:s||{timestamp:-1},segmentbox:i||{timestamp:-1},trendbox:o||{timestamp:-1}},this.isInit=!0}},{key:"process",value:function(e,t){if(this.isInit||this.init(t),!(this.kline&&new Date(e.day).getTime()<=new Date(this.kline.day).getTime())){this.kline=e;for(var n=0,r=["typing","stroke","segment","trend","strokebox","segmentbox","trendbox"];n<r.length;n++){var a=r[n],s=t[a],i=this.state[a];s&&s.timestamp&&(s.timestamp>i.timestamp&&(this.fire("newbuilt",{type:a,data:s}),this.state[a]=s),s.timestamp<i.timestamp&&(this.fire("rollback",{type:a,data:s}),this.state[a]=s))}}}}]),t}(ve.a),Ve={default:function(e){function t(){var e;return Object(i.a)(this,t),e=Object(S.a)(this,Object(E.a)(t).call(this)),Object(u.a)(Object(F.a)(e),"klines",[]),e.signal.on("newbuilt",(function(t,n){var r=n.type,a=n.data;"segment"===r&&"up"===a.type&&(e.action={type:"buy",tip:"向上新段成立"}),"segment"===r&&"down"===a.type&&(e.action={type:"sell",tip:"向下新段成立"})})),e.signal.on("rollback",(function(t,n){var r=n.type,a=n.data;"segment"===r&&"down"===a.type&&(e.action={type:"sell",tip:"向下旧段延续"}),"segment"===r&&"up"===a.type&&(e.action={type:"buy",tip:"向上旧段延续"})})),e}return Object(I.a)(t,e),Object(o.a)(t,[{key:"process",value:function(e,t,n){var r,a=e.slice(-1)[0];return t||(t=this.processor.parse(e)),n||(n=this.processor.state()),this.signal.process(a,n),this.action&&("buy"===this.action.type&&(r=this.buy(a,this.action.tip)),"sell"===this.action.type&&(r=this.sell(a,this.action.tip)),this.action=null),r}}]),t}(function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=Object(S.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(a))),Object(u.a)(Object(F.a)(n),"signal",new De),Object(u.a)(Object(F.a)(n),"processor",new Ce),Object(u.a)(Object(F.a)(n),"actions",[]),n}return Object(I.a)(t,e),Object(o.a)(t,[{key:"reset",value:function(){this.actions=[],this.signal.reset(),this.processor.reset()}},{key:"process",value:function(e,t,n){}},{key:"buy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={type:"buy",kline:e,tip:t,trade:""};return this.actions.push(n),this.fire("buy",n),n}},{key:"sell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={type:"sell",kline:e,tip:t,trade:""};return this.actions.push(n),this.fire("sell",n),n}},{key:"toRecords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"up",t=[],n={buy:null,sell:null},r=!0,a=!1,s=void 0;try{for(var i,o=this.actions[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var c=i.value,u=c.type,h=c.kline;c.tip;n.buy||"buy"!==u||(n.buy=h),n.sell||"sell"!==u||(n.sell=h),"up"===e&&!n.buy&&n.sell&&(n={buy:null,sell:null}),"down"===e&&!n.sell&&n.buy&&(n={buy:null,sell:null}),n.buy&&n.sell&&(t.push(n),n={buy:null,sell:null})}}catch(e){a=!0,s=e}finally{try{r||null==o.return||o.return()}finally{if(a)throw s}}return t}},{key:"toPoints",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!this.actions.length)return[];var t=e.length?e[0].day:this.actions[0].kline.day,n=e.length?e[e.length-1].day:this.actions[this.actions.length-1].kline.day,r=A()(t).toDate().getTime(),a=A()(n).toDate().getTime(),s=[],i=!0,o=!1,c=void 0;try{for(var u,h=this.actions[Symbol.iterator]();!(i=(u=h.next()).done);i=!0){var l=u.value,p=A()(l.kline.day).toDate().getTime();if(r<=p&&p<=a){var f="buy"===l.type?"red":"green";s.push([l.kline.day,+l.kline.high,f,l.tip,l.trade])}}}catch(e){o=!0,c=e}finally{try{i||null==h.return||h.return()}finally{if(o)throw c}}return s}}]),t}(ve.a))},Me=function(){function e(){Object(i.a)(this,e),Object(u.a)(this,"strategy",void 0)}var t;return Object(o.a)(e,[{key:"run",value:(t=Object(s.a)(a.a.mark((function e(t){var n,r,s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.klines,r=t.name,s=void 0===r?"default":r,this.klines=n,this.strategy=new Ve[s],i=100;case 4:if(!(i<this.klines.length)){e.next=18;break}if(e.prev=5,this.strategy.process(this.klines.slice(0,i)),i%100!=0){e.next=10;break}return e.next=10,Object(b.a)(1e3);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),console.warn("#Backtest# ",e.t0);case 15:i++,e.next=4;break;case 18:case"end":return e.stop()}}),e,this,[[5,12]])}))),function(e){return t.apply(this,arguments)})},{key:"toReport",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"up",t={time:0,change:0,profit:0,winrate:0,earnrate:0,record:[]},n=0,r=this.strategy.toRecords(e),a=!0,s=!1,i=void 0;try{for(var o,c=r[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var u=o.value;t.time++,t.change+=(u.sell.close-u.buy.close)/u.buy.close*100,t.profit+=u.sell.close-u.buy.close,t.change>0?n++:0}}catch(e){s=!0,i=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw i}}return t.records=r,t.change=+t.change.toFixed(2),t.profit=+t.profit.toFixed(2),t.winrate=+(n/t.time*100).toFixed(2),t.earnrate=+(t.change/t.time).toFixed(2),t}},{key:"toPoints",value:function(){var e=this.strategy.processor.toPoints(),t=this.strategy.processor.sequence(),n=this.strategy.toPoints();return Object(c.a)({},e,{pin:n,sequence:t})}}]),e}(),Se=null;window.addEventListener("keydown",(function(){return Se&&Se.apply(void 0,arguments)}));var Ee=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=Object(S.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(a))),Object(u.a)(Object(F.a)(n),"klines",[]),Object(u.a)(Object(F.a)(n),"hooks",{}),Object(u.a)(Object(F.a)(n),"defaultOffset",void 0),Object(u.a)(Object(F.a)(n),"defaultSpeed",void 0),Object(u.a)(Object(F.a)(n),"offset",void 0),Object(u.a)(Object(F.a)(n),"tick",void 0),Object(u.a)(Object(F.a)(n),"interval",void 0),Object(u.a)(Object(F.a)(n),"isInit",!1),Object(u.a)(Object(F.a)(n),"isRunning",!1),n}var n;return Object(I.a)(t,e),Object(o.a)(t,[{key:"reset",value:function(e){var t=e.offset,n=e.speed;n&&(this.defaultSpeed=n),t&&(this.defaultOffset=t),Se=function(){}}},{key:"initOffset",value:function(){if("string"==typeof this.defaultOffset){for(var e=0,t=0;t<this.klines.length;t++)if(this.klines[t].day===this.defaultOffset){this.defaultOffset=t-this.klines.length,e=t;break}e||(this.defaultOffset=-240)}return this.defaultOffset<0?this.klines.length+ +this.defaultOffset:this.defaultOffset}},{key:"hook",value:function(e,t){this.hooks[e]=t}},{key:"toggle",value:function(){this.isRunning?this.stop():this.start()}},{key:"start",value:function(){this.isRunning=!0,this.loop()}},{key:"stop",value:function(){this.isRunning=!1,clearInterval(this.interval)}},{key:"quit",value:function(){this.stop(),this.isInit=!1}},{key:"update",value:function(){var e=this.offset+this.tick;if(e>=this.klines.length)return this.tick=0,this.isInit=!1,this.stop(),void this.fire("end");var t=this.klines.slice(0,e);this.fire(0===this.tick?"start":"update",t,this.tick),this.tick++}},{key:"loop",value:function(){var e=this;clearInterval(this.interval),this.interval=setInterval((function(){return e.update()}),this.defaultSpeed)}},{key:"listen",value:(n=Object(s.a)(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Se=function(){var e=Object(s.a)(a.a.mark((function e(n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!["INPUT","TEXTEARA"].includes(n.target.nodeName||n.target.tagName)){e.next=2;break}return e.abrupt("return");case 2:if("Space"!==n.code){e.next=11;break}if(t.isInit){e.next=10;break}return e.next=6,t.hooks.klines();case 6:t.klines=e.sent,t.offset=t.initOffset(),t.tick=0,t.isInit=!0;case 10:t.toggle();case 11:if("ArrowLeft"!==n.code){e.next=18;break}if(t.isInit){e.next=14;break}return e.abrupt("return");case 14:t.fire("<"),t.tick-=2,t.stop(),t.update();case 18:if("ArrowRight"!==n.code){e.next=24;break}if(t.isInit){e.next=21;break}return e.abrupt("return");case 21:t.fire(">"),t.stop(),t.update();case 24:"Escape"===n.code&&(t.isInit=!1,t.stop(),t.fire("quit"));case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})}]),t}(ve.a),Ie=function(){function e(){Object(i.a)(this,e),Object(u.a)(this,"symbol",void 0),Object(u.a)(this,"level",void 0),Object(u.a)(this,"state",void 0),Object(u.a)(this,"action",void 0),Object(u.a)(this,"pattern",void 0),Object(u.a)(this,"klines",void 0),Object(u.a)(this,"states",{sec5:null,min1:null,min5:null,min30:null,day:null}),this.listen()}return Object(o.a)(e,[{key:"upLevel",value:function(e){return{sec5:"min1",min1:"min5",min5:"min30",min30:"day"}[e]}},{key:"subLevel",value:function(e){return{min1:"sec5",min5:"min1",min30:"min5",day:"min30"}[e]}},{key:"mock",value:function(){this.level="min1",this.symbol="btc-usdt",this.fire("min5",{symbol:"btc-usdt",level:"min5",type:"2",direction:"down",sequence:[],kline:{day:"2021-05-17 13:55:00",open:42603.38,high:42609.88,low:42593.88,close:42607.49,volume:70195.74552005}}),this.fire("min30",{symbol:"btc-usdt",level:"min30",type:"2",direction:"down",sequence:[],kline:{day:"2021-05-17 13:55:00",open:42603.38,high:42609.88,low:42593.88,close:42607.49,volume:70195.74552005}})}},{key:"listen",value:function(){var e=this;window.top.addEventListener("__twist_nest_trade_point_event",(function(t){var n=JSON.parse(t.detail),r=e.upLevel(e.level),a=e.upLevel(r);e.symbol===n.data.symbol&&[r,a].includes(n.level)&&(e.states[n.level]=n.data)}))}},{key:"fire",value:function(e,t){var n=new CustomEvent("__twist_nest_trade_point_event",{detail:JSON.stringify({level:e,data:t})});window.top.dispatchEvent(n)}},{key:"process",value:function(e,t,n,r,a,s){this.symbol=e,this.level=t,this.klines=s,this.state=n,this.action=a,this.pattern=r;var i=null;this.pattern.state&&!this.pattern.state.isConfirm&&(i={symbol:e,level:t,type:this.pattern.state.type,direction:this.pattern.state.direction,sequence:n.segment.sequence,kline:s.slice(-1)[0]},this.fire(t,i)),this.pattern.state&&a&&a&&(a.trade=this.pattern.state.tip),this.processNestSequence()}},{key:"processNestSequence",value:function(){var e=this.upLevel(this.level),t=this.upLevel(e);if(e&&t&&this.states[e]&&this.states[t]&&this.states[e].direction===this.states[t].direction&&this.pattern.state&&this.pattern.state.direction===this.states[e].direction&&this.pattern.state&&this.pattern.state.isConfirm&&this.action){this.action.trade="区间套 "+this.pattern.state.tip;var n=function(e){return e.type+("down"===e.direction?"卖":"买")};this.action.tip="".concat(e," - ").concat(n(this.states[e])," & ").concat(t," - ").concat(n(this.states[t])).toUpperCase()}}}]),e}(),Qe=(n(707),n(711),n(714),n(715),n(716),n(717),n(718),n(719),n(720),n(721),n(722),n(723),n(724),n(725),n(726),n(727),n(728),n(729),n(730),n(731),n(732),n(733),n(734),n(735),n(736),n(576),new(function(){function e(t){var n=t.audio,r=void 0!==n&&n;Object(i.a)(this,e),Object(u.a)(this,"audio",null),Object(u.a)(this,"source","data:audio/mpeg;base64,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pYUAkIFVhlz/88LE/WSbeZwA7jWgWZVUDsZYUQO0YwIQSBRIirmhXEAgBLzRkmgB0w2Y0tgFhLAoMv1WfAUYMiC4jHJmcSMEgBhAIQBXg7AGAu0hgoM/6YL2umWfSvfmB2UPJ27ZSMToAwIs8XehpDIxIgvVG8JyJAUMYEkQBm5RyB6MQATDA4URBoMUUaWYAaY4WzaXAgWMoj2zDGozkJUzEO7OpYu6X2eqTEEIThXdN5Jo3WMDLQTMRiIAggxqNDCoIMDhwOCtZqpiIQmIBuYKBRicRCIJGczAZLKHHphm5MGC4ABzICEWUZPZsGEFYKBI3TyuNmGkhi4gtaHs95526e3GJQ/j6GQlhfIww1NcaTKgoWPTAgVbjvIITEBUMBQcoiAFDiogATPCkyIZCoWZoaHCvwxDmgKxmgokizRSQ6LAkXJhxQUuSWeBxM3QyDWrqrGCEhcgJTGa0m2ahZtZm0Ud6ywTSREiaQKs4oIY8AeWZQZfAhZAopoBikRx0DxxCCcT5bpT00KGnBGYhJ0Sj5BgkGisa4AFaNsZxl3V9rtYcbTpeY40//PCxP1ki22AIubyv4meMIUBim2wCNT41BaA8xK1YX8jBAgaIBlsB088yYDRJPlDEsKr5wVlBhYMMs1Q85rWo2yE04kzahOWAHpGGONQP4/gilOJ01JR5KqnYdswPWpOS2dC9Ae1gZojDyhUQ1HLYlnUjhjWm9KcUp2Cu/D8bjEYjAYyMhHPUDk7AIcKxocuGf//+AGHh4eHgAAAAAGHh4eH1UxBTUUzLjEwMFVVCiJzZnlWbhLIF9lkUkS8zUHDYoYqgs0BA0MDRUGis2tCgJjEmcqApUyiyQOCUOUDAwrPHvpQsOaCIcSjaW1SJVKu1dq7V2rtUyWGBISJSRIVUOOQ3WjbaDhWVRdW1MUAImwSIyjFAMiM6Ex1IemNJ8CJHrscqxt4HEuVVjjQa2IRh4ZMFYJWJsphGkRBihJPg4FiLXX9lUveUKgI5RZSlnCEpQWlBhIYqBSC74KRC4DE1tgYFdBksG2gY5BmhMZGRi3pbkwiTSbNYVNwwwFLmtQ7DL+xl2X5RBAxohAReLnmw6GOoJnubGYgYhQRoT6gppzZDP/zwsT0YoQVVADOR3xUjRIMMBIILgJZGEmayKJBhlFxzWdNJk3bgeEXhVuFATCBMps2jzCBQeJCzs7PBsaFdpBkykTWfM9Az0jZYBzwiDBwt5/DDIQ6I1mIibEZ0Tm8uDlRUQz0kDQqIDjhQMINC4wGOZcw5rq5WKGGoaICXykzIJEbACdWFYLDsZpaXHHLL///VWZmZmZlVVVVUKGFMzMGAgJMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU="),r&&this.setAudio(this.base64ToUrl(this.source))}var t,n;return Object(o.a)(e,[{key:"show",value:(n=Object(s.a)(a.a.mark((function e(t,n,r){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.Notification.requestPermission();case 2:"granted"===e.sent&&(s=new window.Notification(t||"",{body:n,icon:"./favicon.ico",tag:r}),this.audio&&this.audio.play(),setTimeout((function(){return s.close()}),3e4));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"sendWxwork",value:(t=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t?"[".concat(t,"] ").concat(n):n,!window.top.__Walle_Devtools_Ajax){e.next=5;break}return e.next=5,window.top.__Walle_Devtools_Ajax({type:"POST",url:"https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=ad213d7a-b812-439e-baf9-5e490944fe81",data:JSON.stringify({msgtype:"text",text:{content:n}})});case 5:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"base64ToUrl",value:function(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],r=atob(t[1]),a=r.length,s=new Uint8Array(a);a--;)s[a]=r.charCodeAt(a);return URL.createObjectURL(new Blob([s],{type:n}))}},{key:"setAudio",value:function(e){var t=document.createElement("audio");t.setAttribute("src",e),t.setAttribute("style","display: none"),document.body.appendChild(t),this.audio=t}}]),e}())({audio:!0})),Ge=function(){function e(t,n,r){Object(i.a)(this,e),this.crawler=t.includes("-")?new ae(t,n):new se(t,n),this.processor=new Ce(n,r),this.playback=new Ee,this.backtest=new Me,this.nest=new Ie,this.signal=new De,this.strategy=new Ve.default}return Object(o.a)(e,null,[{key:"create",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Object(W.a)(e,n)}}]),e}();Object(u.a)(Ge,"Crawler",{sina:_.a,joinquant:Z.a,okex:z.a,huobi:X.a}),Object(u.a)(Ge,"Indicator",xe),Object(u.a)(Ge,"Strategy",Ve),Object(u.a)(Ge,"Notification",Qe),Object(u.a)(Ge,"Analyzer",Ye);var Te=function(e){function t(){return Object(i.a)(this,t),Object(S.a)(this,Object(E.a)(t).apply(this,arguments))}var n,r,c,h,l,p;return Object(I.a)(t,e),Object(o.a)(t,[{key:"start",value:(p=Object(s.a)(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{v.a.interval(Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.clear();case 2:return e.next=4,t.capture(t.name);case 4:case"end":return e.stop()}}),e)}))),null,60)}catch(e){}case 1:case"end":return e.stop()}}),e)}))),function(){return p.apply(this,arguments)})},{key:"update",value:(l=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(L.a)(Object(E.a)(t.prototype),"update",this).call(this,[]));case 1:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"clear",value:(h=Object(s.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(this.stocks);case 2:if((e.t1=e.t0()).done){e.next=13;break}return t=e.t1.value,n=this.stocks[t],e.next=7,this.filterOfSell(n);case 7:if(!e.sent){e.next=11;break}return this.broadcast(this.name,"v0",n,"sell"),e.next=11,this.deliver(n.code);case 11:e.next=2;break;case 13:e.next=17;break;case 15:e.prev=15,e.t2=e.catch(0);case 17:case"end":return e.stop()}}),e,this,[[0,15]])}))),function(){return h.apply(this,arguments)})},{key:"capture",value:(c=Object(s.a)(a.a.mark((function e(n,r){var s,i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s={},Object(u.a)(s,V.lb.key,{type:"1",status:"1",direction:"1"}),Object(u.a)(s,V.mb.key,{type:"2",status:"1",direction:"1"}),Object(u.a)(s,V.nb.key,{type:"3",status:"1",direction:"1"}),i=s,e.next=4,Ge.gap.list(i[n]);case 4:return o=e.sent,e.abrupt("return",Object(L.a)(Object(E.a)(t.prototype),"capture",this).call(this,o,r));case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(e,t){return c.apply(this,arguments)})},{key:"filter",value:(r=Object(s.a)(a.a.mark((function e(t){var n,r,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},Object(u.a)(n,V.lb.key,"1"),Object(u.a)(n,V.mb.key,"2"),Object(u.a)(n,V.nb.key,"3"),r=n,e.next=3,Ge.gap.stock(t.code,!0);case 3:return s=e.sent,e.abrupt("return",Ge.gap.isBuy(s,r[this.name]));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"filterOfSell",value:(n=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,o,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},Object(u.a)(n,V.lb.key,"1"),Object(u.a)(n,V.mb.key,"2"),Object(u.a)(n,V.nb.key,"3"),r=n,s=t.code,!this.origin[s]){e.next=13;break}if(0!==this.stocks[s].price){e.next=5;break}return e.abrupt("return",!1);case 5:if(i=(this.stocks[s].price-this.origin[s].price)/this.origin[s].price*100,o=this.stocks[s].change,!(+i<=-3&&+o<-1)){e.next=9;break}return e.abrupt("return",!0);case 9:return e.next=11,Ge.gap.stock(t.code,!0);case 11:return c=e.sent,e.abrupt("return",Ge.gap.isSell(c,r[this.name]));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),t}(P),Fe=function(e){function t(e){return Object(i.a)(this,t),Object(S.a)(this,Object(E.a)(t).call(this,e))}var n,r;return Object(I.a)(t,e),Object(o.a)(t,[{key:"start",value:(r=Object(s.a)(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v.a.interval(Object(s.a)(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ge.gap.diff();case 3:return n=e.sent,e.next=6,t.monitor(n);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])}))),null,60);case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"monitor",value:(n=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,o,c,u,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=!0,r=!1,s=void 0,e.prev=4,i=t[Symbol.iterator]();case 6:if(n=(o=i.next()).done){e.next=17;break}return c=o.value,u=c.code.slice(0,-3),e.next=11,f.a.captureStock(u);case 11:(h=e.sent).name+=" ".concat(c.text,",").concat(c.barSize),this.broadcast("monitor-twist-digger","v0",h);case 14:n=!0,e.next=6;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(4),r=!0,s=e.t0;case 23:e.prev=23,e.prev=24,n||null==i.return||i.return();case 26:if(e.prev=26,!r){e.next=29;break}throw s;case 29:return e.finish(26);case 30:return e.finish(23);case 31:e.next=35;break;case 33:e.prev=33,e.t1=e.catch(0);case 35:case"end":return e.stop()}}),e,this,[[0,33],[4,19,23,31],[24,,26,30]])}))),function(e){return n.apply(this,arguments)})}]),t}(Q),Le=new(function(){function e(){Object(i.a)(this,e),Object(u.a)(this,"diggers",{})}var t,n,r;return Object(o.a)(e,[{key:"load",value:(r=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o,c,u,h,l,f,g;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Ne.controller("interval","v0"),e.next=4,Promise.all([t.getYesterdayLists(),t.getTodayLists()]);case 4:if(n=e.sent,r=Object(p.a)(n,2),s=r[0],r[1]){e.next=11;break}return e.next=11,t.override(s);case 11:for(i=t.lists,o=[V.db.key,V.eb.key,V.fb.key],c=[V.lb.key,V.mb.key,V.nb.key],u=0,h=[].concat(o,c);u<h.length;u++){l=h[u],f={},g={};try{f=s[l].stocks,g=i[l].stocks}catch(e){}o.includes(l)&&(this.diggers[l]=new J(l,f,g)),c.includes(l)&&(this.diggers[l]=new Te(l,f,g))}e.next=19;break;case 17:e.prev=17,e.t0=e.catch(0);case 19:case"end":return e.stop()}}),e,this,[[0,17]])}))),function(){return r.apply(this,arguments)})},{key:"start",value:(n=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:e.prev=2,t=V.rb.getIntervalKeys(),n=!0,r=!1,s=void 0,e.prev=7,i=t[Symbol.iterator]();case 9:if(n=(o=i.next()).done){e.next=16;break}return c=o.value,e.next=13,this.diggers[c].start();case 13:n=!0,e.next=9;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(7),r=!0,s=e.t0;case 22:e.prev=22,e.prev=23,n||null==i.return||i.return();case 25:if(e.prev=25,!r){e.next=28;break}throw s;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return e.next=32,(new G).start();case 32:return e.next=34,(new Fe).start();case 34:e.next=38;break;case 36:e.prev=36,e.t1=e.catch(2);case 38:case"end":return e.stop()}}),e,this,[[2,36],[7,18,22,30],[23,,25,29]])}))),function(){return n.apply(this,arguments)})},{key:"list",value:(t=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.diggers[t].update());case 1:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}()),Ue=new(function(){function e(){Object(i.a)(this,e)}var t,n,r;return Object(o.a)(e,[{key:"list",value:(r=Object(s.a)(a.a.mark((function e(t){var n,r,s=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},Object(u.a)(n,V.f.key,(function(){return s.listOfBond("change")})),Object(u.a)(n,V.e.key,(function(){return s.listOfStock("change")})),Object(u.a)(n,V.i.key,(function(){return s.listOfBond("rate")})),Object(u.a)(n,V.h.key,(function(){return s.listOfStock("rate")})),Object(u.a)(n,V.j.key,(function(){return s.listOfBond("netinflow")})),Object(u.a)(n,V.g.key,(function(){return s.listOfStock("netinflow")})),r=n,e.abrupt("return",r[t]());case 2:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"listOfBond",value:(n=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,o,c,u,h,l,p,f,g;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=d.a.stocksOfBonds(),r=k.a.stocks(n),s=k.a.listOfBonds(t),i=[],o=!0,c=!1,u=void 0,e.prev=7,h=s[Symbol.iterator]();case 9:if(o=(l=h.next()).done){e.next=25;break}if(p=l.value,f=d.a.stockOfBond(p.code),g=r[f]){e.next=15;break}return e.abrupt("continue",22);case 15:return e.next=17,M.isValidStock(g.code,g.name);case 17:if(e.sent){e.next=19;break}return e.abrupt("continue",22);case 19:if(!(p.price<=0)){e.next=21;break}return e.abrupt("continue",22);case 21:i.push(p);case 22:o=!0,e.next=9;break;case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(7),c=!0,u=e.t0;case 31:e.prev=31,e.prev=32,o||null==h.return||h.return();case 34:if(e.prev=34,!c){e.next=37;break}throw u;case 37:return e.finish(34);case 38:return e.finish(31);case 39:return e.abrupt("return",i);case 40:case"end":return e.stop()}}),e,null,[[7,27,31,39],[32,,34,38]])}))),function(e){return n.apply(this,arguments)})},{key:"listOfStock",value:(t=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,o,c,u,h,l,p,f,g,v;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=d.a.stocksOfBonds(),r=k.a.stocks(n),s=k.a.bonds(),i=k.a.list(r,t),o=[],c=!0,u=!1,h=void 0,e.prev=8,l=i[Symbol.iterator]();case 10:if(c=(p=l.next()).done){e.next=26;break}return f=p.value,e.next=14,M.isValidStock(f.code,f.name);case 14:if(e.sent){e.next=16;break}return e.abrupt("continue",23);case 16:if(g=d.a.bondOfStock(f.code),v=s[g]){e.next=20;break}return e.abrupt("continue",23);case 20:if(!(v.price<=0)){e.next=22;break}return e.abrupt("continue",23);case 22:o.push(v);case 23:c=!0,e.next=10;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(8),u=!0,h=e.t0;case 32:e.prev=32,e.prev=33,c||null==l.return||l.return();case 35:if(e.prev=35,!u){e.next=38;break}throw h;case 38:return e.finish(35);case 39:return e.finish(32);case 40:return e.abrupt("return",o);case 41:case"end":return e.stop()}}),e,null,[[8,28,32,40],[33,,35,39]])}))),function(e){return t.apply(this,arguments)})}]),e}()),Re=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(i.a)(this,e),Object(u.a)(this,"stocks",{}),this.stocks=t}return Object(o.a)(e,[{key:"getStocks",value:function(){return this.stocks}},{key:"setStocks",value:function(e){this.stocks=e}},{key:"getStockCodes",value:function(){return Object.keys(this.stocks)}},{key:"clone",value:function(){var t=Object.assign({},t);return new e(t)}},{key:"merge",value:function(e){for(var t in e.stocks){if(Object.keys(this.stocks).length>9)return;this.stocks[t]||(this.stocks[t]=e.stocks[t])}}},{key:"recover",value:function(e){return this.stocks=e.stocks,this}},{key:"get",value:function(e){return this.stocks[e]}},{key:"upsert",value:function(e){this.stocks[e.code]=e}},{key:"remove",value:function(e){delete this.stocks[e]}}]),e}(),Ke=n(790),He=x.a.createInstance({name:"trace",driver:x.a.INDEXEDDB}),Pe=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{isToday:!1};Object(i.a)(this,e),Object(u.a)(this,"isToday",void 0),Object(u.a)(this,"record",{change:{},capture:{},trace:{}}),Object(u.a)(this,"name",void 0),Object(u.a)(this,"rule",void 0),Object(u.a)(this,"listController",void 0),Object(u.a)(this,"oldlists",void 0),Object(u.a)(this,"newlists",void 0),Object(u.a)(this,"openChanges",{}),Object(u.a)(this,"closeChanges",{}),this.rule=n,this.listController=t,this.isToday=r.isToday,this.name=(this.isToday?"t0-".concat(this.rule.name):this.rule.name).toLowerCase(),this.reset()}var t,n,r,c,h,l,d,k,y;return Object(o.a)(e,[{key:"start",value:(y=Object(s.a)(a.a.mark((function e(){var t,n=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=300,e.prev=2,e.next=5,this.load();case 5:if(!this.rule.name.includes("interval")||this.isToday){e.next=7;break}return e.abrupt("return");case 7:v.a.interval(Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("#StatementController# ".concat(n.name," capture start ...")),e.next=3,n.capture();case 3:console.log("#StatementController# ".concat(n.name," capture end ..."));case 4:case"end":return e.stop()}}),e)}))),null,t),this.hook(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.warn("#StatementController# ",e.t0);case 14:case"end":return e.stop()}}),e,this,[[2,11]])}))),function(){return y.apply(this,arguments)})},{key:"hook",value:(k=Object(s.a)(a.a.mark((function e(){var t,n,r,i,o,c=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=g.a.trader.capture.target,n=t.split("/"),r=Object(p.a)(n,2),i=r[0],o=r[1],i===this.name){e.next=5;break}return e.abrupt("return");case 5:v.a.interval(Object(s.a)(a.a.mark((function e(){var n,r,s,i,u,h,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:U.a.notification("Walle Stock Clear Notification",t,c.oldlists[o].stocks,c.newlists[o].stocks),n={},e.t0=a.a.keys(c.newlists[o].stocks);case 3:if((e.t1=e.t0()).done){e.next=25;break}if(r=e.t1.value,e.prev=5,s=c.newlists[o].stocks[r],i=s.change,u=s.name,h=+c.oldlists[o].stocks[r].price,0!=(l=+c.newlists[o].stocks[r].price)){e.next=11;break}return e.abrupt("continue",3);case 11:if(!(+(l-h)/h*100>=5&&+i>-1)){e.next=15;break}return console.info("#StatementController# ".concat(t," reverse high-value stock"),r,u,i),e.abrupt("continue",3);case 15:if(!(i>=9.88)){e.next=18;break}return console.info("#StatementController# ".concat(t," reverse limitup stock"),r,u,i),e.abrupt("continue",3);case 18:n[r]=c.newlists[o].stocks[r],e.next=23;break;case 21:e.prev=21,e.t2=e.catch(5);case 23:e.next=3;break;case 25:R.a.sellStocks("capture",n);case 26:case"end":return e.stop()}}),e,null,[[5,21]])}))),this.rule.trace),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return k.apply(this,arguments)})},{key:"load",value:(d=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o,c,u,h,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=A()().format("YYYYMMDD"),e.next=4,He.getItem(t);case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return");case 7:for(n[this.name]&&(this.record=n[this.name]),r=this.rule.interval?V.rb.getIntervalKeys():V.rb.getNormalKeys(),s=!0,i=!1,o=void 0,e.prev=12,c=r[Symbol.iterator]();!(s=(u=c.next()).done);s=!0)h=u.value,l=V.rb.name(h),this.oldlists[h]=new Re(this.record.capture[l]),this.newlists[h]=new Re(this.record.trace[l]);e.next=20;break;case 16:e.prev=16,e.t0=e.catch(12),i=!0,o=e.t0;case 20:e.prev=20,e.prev=21,s||null==c.return||c.return();case 23:if(e.prev=23,!i){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(20);case 28:e.next=32;break;case 30:e.prev=30,e.t1=e.catch(0);case 32:case"end":return e.stop()}}),e,this,[[0,30],[12,16,20,28],[21,,23,27]])}))),function(){return d.apply(this,arguments)})},{key:"save",value:(l=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=A()().format("YYYYMMDD"),e.next=3,He.getItem(n);case 3:return(r=e.sent)||(r={}),this.record={change:t.change,trace:t.trace,capture:t.capture},r[this.name]=this.record,e.abrupt("return",He.setItem(n,r));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"reset",value:function(){var e=this.rule.interval?V.rb.getIntervalKeys():V.rb.getNormalKeys();this.oldlists={},this.newlists={};var t=!0,n=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var i=a.value;this.newlists[i]=new Re,this.oldlists[i]=new Re}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}}},{key:"remove",value:(h=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.load();case 3:this.newlists[t]&&this.newlists[t].remove(n),this.oldlists[t]&&this.oldlists[t].remove(n),this.calc(),this.broadcast(),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e,t){return h.apply(this,arguments)})},{key:"update",value:(c=Object(s.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.load();case 3:this.newlists[t]||(this.newlists[t]=new Re),this.oldlists[t]||(this.oldlists[t]=new Re),this.oldlists[t].upsert(n),this.newlists[t].upsert(r),this.calc(),this.broadcast(),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(0);case 13:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e,t,n){return c.apply(this,arguments)})},{key:"capture",value:(r=Object(s.a)(a.a.mark((function e(t){var n,r,s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.newlists=null,this.oldlists=null,!t){e.next=7;break}this.oldlists=t,e.next=16;break;case 7:if(!this.isToday){e.next=13;break}return e.next=10,this.listController.getTodayLists();case 10:this.oldlists=e.sent,e.next=16;break;case 13:return e.next=15,this.listController.getYesterdayLists();case 15:this.oldlists=e.sent;case 16:if(this.oldlists){e.next=18;break}return e.abrupt("return");case 18:this.newlists={},n=Object.keys(this.oldlists),r=0,s=n;case 21:if(!(r<s.length)){e.next=37;break}if(i=s[r],e.prev=23,V.rb.get(i)){e.next=26;break}return e.abrupt("continue",34);case 26:return e.next=28,this.captureList(this.oldlists[i]);case 28:this.newlists[i]=e.sent,e.next=34;break;case 31:e.prev=31,e.t0=e.catch(23),console.warn("#StatementController# ",e.t0);case 34:r++,e.next=21;break;case 37:this.calc(),this.broadcast(),e.next=44;break;case 41:e.prev=41,e.t1=e.catch(0),console.warn("#StatementController# capture",e.t1);case 44:return e.abrupt("return",this.newlists);case 45:case"end":return e.stop()}}),e,this,[[0,41],[23,31]])}))),function(e){return r.apply(this,arguments)})},{key:"calc",value:function(){if(this.newlists)for(var e=0,t=Object.keys(this.newlists);e<t.length;e++){var n=t[e];try{var r=new Ke.a(this.oldlists[n].stocks,this.newlists[n].stocks);this.closeChanges[n]=r.getCloseChange(),this.openChanges[n]=r.getOpenChange()}catch(e){}}}},{key:"broadcast",value:(n=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o,c,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={name:this.name,change:{},trace:{},capture:{}},n=Object.keys(this.newlists),r=0,s=n;r<s.length;r++)i=s[r],o=V.rb.name(i),c=A()().format("HH:mm"),u=this.closeChanges[i],this.record.change[o]||(this.record.change[o]=[]),this.record.change[o].unshift(u,c),t.change[o]=this.record.change[o],t.trace[o]=this.newlists[i].getStocks(),t.capture[o]=this.oldlists[i].getStocks();return e.next=5,this.save(t);case 5:console.log("#StatementController# list trace [".concat(this.name,"] at ").concat(A()().format("HH:mm:ss")," ...")),window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Trace_Event",{detail:t}));case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"captureList",value:(t=Object(s.a)(a.a.mark((function e(t){var n,r,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Re,r=Object.keys(t.getStocks()),e.next=4,f.a.captureStocks(r);case 4:return s=e.sent,n.setStocks(s),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),Je=x.a.createInstance({name:"capture",driver:x.a.INDEXEDDB}),We=function(){function e(t,n){Object(i.a)(this,e),Object(u.a)(this,"rule",void 0),Object(u.a)(this,"validator",void 0),Object(u.a)(this,"lists",void 0),Object(u.a)(this,"listKeys",void 0),Object(u.a)(this,"statement",void 0),Object(u.a)(this,"t0Statement",void 0),Object(u.a)(this,"blocks",{concept:[],industry:[]}),this.rule=t,this.validator=n,this.t1Statement=new Pe(this,t),this.t0Statement=new Pe(this,t,{isToday:!0}),this.listKeys=t.interval?V.rb.getIntervalKeys():V.rb.getNormalKeys(),this.reset()}var t,n,r,c,h,l,d,k,y,m,w,x,O,j,B,C;return Object(o.a)(e,[{key:"all",value:function(){return this.lists}},{key:"list",value:function(e){return this.lists[e]}},{key:"stocks",value:function(e){return this.lists[e].getStocks()}},{key:"ignore",value:(C=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(this.lists[t]){e.next=4;break}return e.abrupt("return");case 4:return this.lists[t].remove("".concat(n)),this.broadcast(),e.next=8,this.save();case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return C.apply(this,arguments)})},{key:"update",value:(B=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lists[t]||(this.lists[t]=new Re),this.lists[t].merge({stocks:n}),this.broadcast(),e.next=5,this.save();case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return B.apply(this,arguments)})},{key:"override",value:(j=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lists=t,this.broadcast(),e.next=4,this.save();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return j.apply(this,arguments)})},{key:"load",value:(O=Object(s.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=A()().format("YYYYMMDD"),e.next=3,this.loadListsOf(t);case 3:(n=e.sent)&&(this.lists=n);case 5:case"end":return e.stop()}}),e,this)}))),function(){return O.apply(this,arguments)})},{key:"loadListsOf",value:(x=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.rule.name,e.next=3,Je.getItem(t);case 3:if(r=e.sent){e.next=7;break}return console.log("#ListController# ".concat(n," ").concat(t," lists not exist!")),e.abrupt("return");case 7:if(r[n]){e.next=10;break}return console.log("#ListController# ".concat(n," ").concat(t," lists not exist!")),e.abrupt("return");case 10:return e.abrupt("return",this.recover(r[n]));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"getTodayLists",value:(w=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=A()().format("YYYYMMDD"),e.abrupt("return",this.loadListsOf(t));case 2:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"getYesterdayLists",value:(m=Object(s.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je.length();case 2:return t=e.sent,n=A()().format("YYYYMMDD"),e.next=6,Je.key(t-1);case 6:if((r=e.sent)!==n){e.next=13;break}return e.next=10,Je.key(t-2);case 10:r=e.sent,e.next=16;break;case 13:return e.next=15,Je.key(t-1);case 15:r=e.sent;case 16:return e.abrupt("return",this.loadListsOf(r));case 17:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"recover",value:function(e){for(var t in e)e[t]=(new Re).recover(e[t]);return e}},{key:"save",value:(y=Object(s.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=A()().format("YYYYMMDD"),n=this.rule.name,e.next=4,Je.getItem(t);case 4:return(r=e.sent)||(r={}),r[n]=this.lists,e.abrupt("return",Je.setItem(t,r));case 8:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"reset",value:function(){var e=this.listKeys;this.lists={};var t=!0,n=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var i=a.value;this.lists[i]=new Re}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}}},{key:"captureHotBlocks",value:(k=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.captureBlock();case 2:return this.blocks=e.sent,console.info("#EastMoneyBlockCrawler# Hot Concept Blocks ..."),console.table(this.blocks.concept),console.info("#EastMoneyBlockCrawler# Hot Industry Blocks ..."),console.table(this.blocks.industry),e.abrupt("return",this.blocks);case 8:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"createHotBlocksList",value:(d=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o,c,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={concept:[V.n.key,V.o.key,V.p.key],industry:[V.w.key,V.x.key,V.y.key]},e.next=4,this.captureHotBlocks();case 4:for(n in t)for(s in r=t[n])for(u in i=r[s],o=this.lists[i],c=o.getStocks())c[u].block=this.blocks[n][s].name;e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn("#ListController# ",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return d.apply(this,arguments)})},{key:"createHotStocksList",value:(l=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o,c,u,h,l,p,f,g,d,v,k,y,b,m,A,w,x,O;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.listKeys,n=V.rb.getBondKeys(),r={},s={},i={},o=0,c=!0,u=!1,h=void 0,e.prev=9,l=t[Symbol.iterator]();case 11:if(c=(p=l.next()).done){e.next=22;break}if(f=p.value,!n.includes(f)){e.next=15;break}return e.abrupt("continue",19);case 15:for(v in g=this.lists[f],d=g.getStocks(),Object.assign(r,d),d)k=d[v],i[v]||(i[v]={name:k.name,count:0}),i[v].count++;case 19:c=!0,e.next=11;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(9),u=!0,h=e.t0;case 28:e.prev=28,e.prev=29,c||null==l.return||l.return();case 31:if(e.prev=31,!u){e.next=34;break}throw h;case 34:return e.finish(31);case 35:return e.finish(28);case 36:for(y=Object.keys(i).sort((function(e,t){return i[t].count-i[e].count})),b=!0,m=!1,A=void 0,e.prev=40,w=y[Symbol.iterator]();!(b=(x=w.next()).done);b=!0)O=x.value,i[O].count>=3&&o<10&&(s[O]=Object.assign({},r[O],{hot:i[O].count}),o++);e.next=48;break;case 44:e.prev=44,e.t1=e.catch(40),m=!0,A=e.t1;case 48:e.prev=48,e.prev=49,b||null==w.return||w.return();case 51:if(e.prev=51,!m){e.next=54;break}throw A;case 54:return e.finish(51);case 55:return e.finish(48);case 56:console.log("#ListController# list ".concat(this.rule.name," capture hot stcoks ...")),console.table(i),this.lists[V.v.key].setStocks(s);case 59:case"end":return e.stop()}}),e,this,[[9,24,28,36],[29,,31,35],[40,44,48,56],[49,,51,55]])}))),function(){return l.apply(this,arguments)})},{key:"start",value:(h=Object(s.a)(a.a.mark((function e(){var t,n=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.rule.interval?void 0:[this.rule.capture],e.prev=1,e.next=4,this.load();case 4:v.a.interval(Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("#ListController# list ".concat(n.rule.name," capture start ...")),e.next=3,n.capture();case 3:n.rule.interval||(console.info("=================================================="),console.info("#ListController# today list capture [".concat(n.rule.name,"] at ").concat(A()().format("HH:mm:ss"),": "),n.lists),console.info("==================================================")),console.log("#ListController# list ".concat(n.rule.name," capture end ..."));case 5:case"end":return e.stop()}}),e)}))),t,this.rule.interval),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.warn("#ListController# ",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])}))),function(){return h.apply(this,arguments)})},{key:"captureList",value:(c=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,o,c,u,h,l,p,g,d,v;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=V.rb.getIntervalKeys(),r=V.rb.getBondKeys(),s=[],!n.includes(t)){e.next=9;break}return e.next=6,Le.list(t,this.validator);case 6:s=e.sent,e.next=18;break;case 9:if(!r.includes(t)){e.next=15;break}return e.next=12,Ue.list(t);case 12:s=e.sent,e.next=18;break;case 15:return e.next=17,f.a.captureList(t);case 17:s=e.sent;case 18:if(s&&s.length){e.next=20;break}return e.abrupt("return",new Re);case 20:i={},o=0,c=!0,u=!1,h=void 0,e.prev=24,l=s[Symbol.iterator]();case 26:if(c=(p=l.next()).done){e.next=53;break}if(g=p.value,v=(d=g).code,d.name,d.change,t===V.F.key){e.next=39;break}if(n.includes(t)){e.next=39;break}if(this.validator.isFullRequiredFields(g)){e.next=35;break}return e.next=34,f.a.captureStock(v);case 34:g=e.sent;case 35:return e.next=37,this.validator.filter(t,g);case 37:if(e.sent){e.next=39;break}return e.abrupt("continue",50);case 39:if(!i[v]){e.next=41;break}return e.abrupt("continue",50);case 41:if(!(g.price<=0)){e.next=43;break}return e.abrupt("continue",50);case 43:if(r.includes(t)){e.next=46;break}if(!(g.change>9.8)){e.next=46;break}return e.abrupt("continue",50);case 46:if(i[v]=g,10!=++o){e.next=50;break}return e.abrupt("break",53);case 50:c=!0,e.next=26;break;case 53:e.next=59;break;case 55:e.prev=55,e.t0=e.catch(24),u=!0,h=e.t0;case 59:e.prev=59,e.prev=60,c||null==l.return||l.return();case 62:if(e.prev=62,!u){e.next=65;break}throw h;case 65:return e.finish(62);case 66:return e.finish(59);case 67:return console.log("#ListController# list ".concat(this.rule.name," capture ").concat(t," "),i),e.abrupt("return",new Re(i));case 69:case"end":return e.stop()}}),e,this,[[24,55,59,67],[60,,62,66]])}))),function(e){return c.apply(this,arguments)})},{key:"capture",value:(r=Object(s.a)(a.a.mark((function e(){var t,n,r,i,o,c=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object.keys(this.lists),n=0,r=t;case 2:if(!(n<r.length)){e.next=23;break}if(i=r[n],e.prev=4,i!==V.v.key){e.next=7;break}return e.abrupt("continue",20);case 7:if(this.listKeys.includes(i)){e.next=9;break}return e.abrupt("continue",20);case 9:return e.next=11,this.captureList(i);case 11:return o=e.sent,this.lists[i].merge(o),e.next=15,Object(b.a)(500);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),console.warn("#ListController# ",e.t0);case 20:n++,e.next=2;break;case 23:if(e.prev=23,!this.rule.interval){e.next=30;break}return this.broadcast(),e.next=28,this.save();case 28:e.next=37;break;case 30:return this.createHotStocksList(),this.createHotBlocksList(),this.broadcast(),this.hook(),e.next=36,this.save();case 36:setTimeout(Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,Object(b.a)(15e4);case 3:return e.next=5,c.t0Statement.capture(c.lists);case 5:if(t=e.sent,console.log("#ListController# [".concat(c.rule.name,"] t0Statement pre-trace "),t),!c.validator.hasCaptureRule("pre-trace")){e.next=13;break}return e.next=10,c.validator.filterOfPreTrace(c.lists,t);case 10:return c.broadcast(),e.next=13,c.save();case 13:case"end":return e.stop()}}),e)}))));case 37:e.next=42;break;case 39:e.prev=39,e.t1=e.catch(23),console.warn("#ListController# ",e.t1);case 42:case"end":return e.stop()}}),e,this,[[4,17],[23,39]])}))),function(){return r.apply(this,arguments)})},{key:"broadcast",value:(n=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={name:this.rule.name,lists:this.lists},window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Capture_Event",{detail:t}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"hook",value:(t=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=g.a.trader.capture.target,n=t.split("/"),r=Object(p.a)(n,2),s=r[0],i=r[1],s===this.rule.name){e.next=5;break}return e.abrupt("return");case 5:U.a.notification("Walle Stock Capture Notification",t,this.lists[i].stocks),R.a.buyStocks("capture",this.lists[i].stocks),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return t.apply(this,arguments)})}]),e}(),Ne=new(function(){function e(){Object(i.a)(this,e),Object(u.a)(this,"listControllers",[]),this.clearTempCapture();var t=[].concat(g.a.captures||[],g.a.temps||[]),n=g.a.validators,r=!0,a=!1,s=void 0;try{for(var o,c=t[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var h=o.value,l=!0,p=!1,f=void 0;try{for(var d,v=n[Symbol.iterator]();!(l=(d=v.next()).done);l=!0){var k=d.value,y=this.create(h,k);this.listControllers.push(y)}}catch(e){p=!0,f=e}finally{try{l||null==v.return||v.return()}finally{if(p)throw f}}}}catch(e){a=!0,s=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw s}}var b=this.create(g.a.intervals[0],n[0]);this.listControllers.push(b)}var t,n,r,l,p,f,d;return Object(o.a)(e,[{key:"create",value:function(e,t){var n="".concat(e.capture,"-").concat(t.name).toLowerCase(),r=new h(Object(c.a)({},e,{name:n})),a=new M(t);return new We(r,a)}},{key:"controller",value:function(e,t){var n=!0,r=!1,a=void 0;try{for(var s,i=this.listControllers[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var o=s.value,c=o.rule,u=o.validator.config;if(c.capture===e&&u.name===t)return o}}catch(e){r=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}}},{key:"capture",value:(d=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=A()().format("YYYYMMDD"),n=!0,r=!1,s=void 0,e.prev=5,i=this.listControllers[Symbol.iterator]();case 7:if(n=(o=i.next()).done){e.next=16;break}if(!(c=o.value).rule.date||c.rule.date===t){e.next=12;break}return console.log("#controllers# ignore temp capture rule ",c.rule.capture,c.rule.date),e.abrupt("continue",13);case 12:c.start();case 13:n=!0,e.next=7;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(5),r=!0,s=e.t0;case 22:e.prev=22,e.prev=23,n||null==i.return||i.return();case 25:if(e.prev=25,!r){e.next=28;break}throw s;case 28:return e.finish(25);case 29:return e.finish(22);case 30:this.deprecated(Je),e.next=36;break;case 33:e.prev=33,e.t1=e.catch(0),console.warn("#controllers# capture",e.t1);case 36:case"end":return e.stop()}}),e,this,[[0,33],[5,18,22,30],[23,,25,29]])}))),function(){return d.apply(this,arguments)})},{key:"trace",value:(f=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=!0,n=!1,r=void 0,e.prev=4,s=this.listControllers[Symbol.iterator]();case 6:if(t=(i=s.next()).done){e.next=15;break}return o=i.value,e.next=10,o.t1Statement.start();case 10:return e.next=12,o.t0Statement.start();case 12:t=!0,e.next=6;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),n=!0,r=e.t0;case 21:e.prev=21,e.prev=22,t||null==s.return||s.return();case 24:if(e.prev=24,!n){e.next=27;break}throw r;case 27:return e.finish(24);case 28:return e.finish(21);case 29:this.deprecated(He),e.next=35;break;case 32:e.prev=32,e.t1=e.catch(0),console.warn("#controllers# trace ",e.t1);case 35:case"end":return e.stop()}}),e,this,[[0,32],[4,17,21,29],[22,,24,28]])}))),function(){return f.apply(this,arguments)})},{key:"deprecated",value:(p=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.when("150000");case 2:return e.next=5,t.length();case 5:if(!(e.sent<=200)){e.next=8;break}return e.abrupt("break",15);case 8:return e.next=10,t.key(0);case 10:return n=e.sent,e.next=13,t.removeItem(n);case 13:e.next=2;break;case 15:case"end":return e.stop()}}),e)}))),function(e){return p.apply(this,arguments)})},{key:"clearTempCapture",value:(l=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o,c,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g.a.temps){e.next=2;break}return e.abrupt("return");case 2:if(g.a.temps.length){e.next=4;break}return e.abrupt("return");case 4:for(t=[],n=A()().subtract(2,"days").format("YYYYMMDD"),1!=+A()().day()&&2!=+A()().day()||(n=A()().subtract(4,"days").format("YYYYMMDD")),r=!0,s=!1,i=void 0,e.prev=10,o=g.a.temps[Symbol.iterator]();!(r=(c=o.next()).done);r=!0)+(u=c.value).date>n&&t.push(u);e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),s=!0,i=e.t0;case 18:e.prev=18,e.prev=19,r||null==o.return||o.return();case 21:if(e.prev=21,!s){e.next=24;break}throw i;case 24:return e.finish(21);case 25:return e.finish(18);case 26:g.a.temps=t;case 27:case"end":return e.stop()}}),e,null,[[10,14,18,26],[19,,21,25]])}))),function(){return l.apply(this,arguments)})},{key:"setTempCapture",value:(r=Object(s.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=A()().format("YYYYMMDD"),n=A()().add(1,"minutes").format("HH:mm"),r=new h({capture:n,trace:["14:40"],date:t}),g.a.temps=[].concat(g.a.temps,r);case 4:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"removeTempCapture",value:(n=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,o,c,u,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],s=!0,i=!1,o=void 0,e.prev=4,c=g.a.temps[Symbol.iterator]();case 6:if(s=(u=c.next()).done){e.next=14;break}if((h=u.value).capture!==t||h.date!==n){e.next=10;break}return e.abrupt("continue",11);case 10:r.push(h);case 11:s=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),i=!0,o=e.t0;case 20:e.prev=20,e.prev=21,s||null==c.return||c.return();case 23:if(e.prev=23,!i){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(20);case 28:g.a.temps=r;case 29:case"end":return e.stop()}}),e,null,[[4,16,20,28],[21,,23,27]])}))),function(e,t){return n.apply(this,arguments)})},{key:"ignore",value:(t=Object(s.a)(a.a.mark((function e(t,n,r,s){var i,o,c,u,h,l,p,f,g;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=!0,o=!1,c=void 0,e.prev=3,u=this.listControllers[Symbol.iterator]();case 5:if(i=(h=u.next()).done){e.next=19;break}if(l=h.value,p=l.rule,f=l.validator.config,g=V.rb.keyOf(r),p.capture!==t||f.name!==n){e.next=16;break}return e.next=13,l.ignore(g,s);case 13:return e.next=15,l.t0Statement.remove(g,s);case 15:window.dispatchEvent(new CustomEvent("__Walle_Stock_Ignore_Event",{detail:{time:t,vtype:n,listkey:g,code:s}}));case 16:i=!0,e.next=5;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(3),o=!0,c=e.t0;case 25:e.prev=25,e.prev=26,i||null==u.return||u.return();case 28:if(e.prev=28,!o){e.next=31;break}throw c;case 31:return e.finish(28);case 32:return e.finish(25);case 33:case"end":return e.stop()}}),e,this,[[3,21,25,33],[26,,28,32]])}))),function(e,n,r,a){return t.apply(this,arguments)})}]),e}()),qe=n(529),_e=new(function(){function e(){Object(i.a)(this,e),Object(u.a)(this,"index",{sse:{price:0,change:0,volume:0,amount:0,netinflow:0,rate:0},szse:{price:0,change:0,volume:0,amount:0,netinflow:0,rate:0},north:{}}),Object(u.a)(this,"number",{full:0,rise:0,down:0,limitup:0,limitdown:0,prelimitup:0,prelimitdown:0}),Object(u.a)(this,"rates",{netinflow:[],"000016":[],"000300":[],"000905":[]})}var t,n,r,c,h,l,p,g;return Object(o.a)(e,[{key:"start",value:(g=Object(s.a)(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.until("093000");case 2:v.a.interval((function(){t.process(!0)}),null,180,"market-analyse");case 3:case"end":return e.stop()}}),e)}))),function(){return g.apply(this,arguments)})},{key:"process",value:(p=Object(s.a)(a.a.mark((function e(){var t,n,r=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]&&r[0],e.prev=1,e.next=4,this.calcIndex();case 4:return e.next=6,this.calcIndexOfNorth();case 6:return e.next=8,this.calcNumber();case 8:if(!t){e.next=14;break}return n=A()().format("HH:mm"),e.next=12,this.calcWeight(n);case 12:return e.next=14,this.calcNetinflow(n);case 14:return e.next=16,this.broadcast();case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),console.warn("#Market-Trend# ",e.t0);case 21:case"end":return e.stop()}}),e,this,[[1,18]])}))),function(){return p.apply(this,arguments)})},{key:"broadcast",value:function(){window.dispatchEvent(new CustomEvent("__Walle_Stock_Market_Analyse_Event",{detail:{index:this.index,number:this.number,rates:this.rates}}))}},{key:"calcNumber",value:(l=Object(s.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n in t=k.a.stocks(),this.number.full=0,this.number.rise=0,this.number.down=0,this.number.limitup=0,this.number.limitdown=0,this.number.prelimitup=0,this.number.prelimitdown=0,t)(r=t[n]).change>0&&this.number.rise++,r.change<0&&this.number.down++,r.change>=9.8&&this.number.limitup++,r.change<=-9.8&&this.number.limitdown++,r.change>5&&r.change<9.8&&this.number.prelimitup++,r.change<-5&&r.change>-9.8&&this.number.prelimitdown++,this.number.full++;case 9:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"calcWeight",value:(h=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.captureStocks(["1.000016","1.000300","1.000905"]);case 2:n=e.sent,this.rates["000016"].unshift(+n[1.000016].rate.toFixed(2),t),this.rates["000300"].unshift(+n["1.000300"].rate.toFixed(2),t),this.rates["000905"].unshift(+n[1.000905].rate.toFixed(2),t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"calcNetinflow",value:(c=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,o,c,u,h,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=100,r=k.a.listOfStocks("netinflow",1,n),s=0,i=!0,o=!1,c=void 0,e.prev=6,u=r[Symbol.iterator]();!(i=(h=u.next()).done);i=!0)l=h.value,s+=l.rate;e.next=14;break;case 10:e.prev=10,e.t0=e.catch(6),o=!0,c=e.t0;case 14:e.prev=14,e.prev=15,i||null==u.return||u.return();case 17:if(e.prev=17,!o){e.next=20;break}throw c;case 20:return e.finish(17);case 21:return e.finish(14);case 22:this.rates.netinflow.unshift(+(s/n).toFixed(2),t);case 23:case"end":return e.stop()}}),e,this,[[6,10,14,22],[15,,17,21]])}))),function(e){return c.apply(this,arguments)})},{key:"calcIndexOfNorth",value:(r=Object(s.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,qe.b.get("http://push2.eastmoney.com/api/qt/kamt/get?fields1=f1,f2,f3,f4&fields2=f51,f52,f53,f54",null);case 4:t=e.sent,n=JSON.parse(t),this.index.north=n.data,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return r.apply(this,arguments)})},{key:"calcIndex",value:(n=Object(s.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.captureStocks(["1.000001","0.399001"]);case 2:t=e.sent,n=t[1.000001],r=t[.399001],this.index={sse:n,szse:r};case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"isTradingDay",value:(t=Object(s.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:if(t=+A()().format("HHmmss"),n="092500",!(t<92500)){e.next=8;break}n="092510",e.next=14;break;case 8:if(!(t>113e3)){e.next=12;break}n="130010",e.next=14;break;case 12:if(!(t>15e4)){e.next=14;break}return e.abrupt("return",!1);case 14:return console.log("#Markets# will start at ".concat(n," ...")),e.next=17,v.a.until(n);case 17:return e.next=19,f.a.isTrading();case 19:if(r=e.sent,console.info("#Markets# stock market trading status ".concat(r?"open":"close"," ...")),r){e.next=28;break}if(!(t>=92500&&t<=113e3||t>=13e4&&t<=15e4)){e.next=28;break}return e.next=25,toastr.clearAll();case 25:return e.next=27,toastr.loading("Market Closed","Holidays");case 27:console.info("#Markets# stock market closed for holidays ...");case 28:return e.abrupt("return",r);case 29:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}()),Ze=(n(530),new(function(){function e(){Object(i.a)(this,e),Object(u.a)(this,"_points",{}),Object(u.a)(this,"_stocks",{}),Object(u.a)(this,"_diff",{}),Object(u.a)(this,"_expiry",{}),Object(u.a)(this,"_today",{}),Object(u.a)(this,"_timestamp",0),Object(u.a)(this,"_defaultExpiry",14400)}var t,n,r,c,h,l,p,g,d,k,y;return Object(o.a)(e,[{key:"start",value:(y=Object(s.a)(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.pull();case 3:v.a.interval((function(){t.update()}),null,180),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return y.apply(this,arguments)})},{key:"process",value:function(e){var t=(new Date).getTime(),n=A()().format("YYYYMMDD");this._diff={},this._expiry={};var r=+e[0].findTime,a=!0,s=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var u=o.value;r<u.findTime&&(r=u.findTime);var h=u.code.slice(0,2).toLowerCase(),l=u.code.slice(-3).toLowerCase();if([".sh",".sz"].includes(l)&&["00","30","60","68"].includes(h)){var p=u.code.slice(0,-3),f=+u.findTime,g=+(u.findTime+"000");this._points[f]=u,this._stocks[p]?+u.findTime>+this._stocks[p].findTime&&(this._stocks[p]=u):this._stocks[p]=u,this._timestamp&&f>this._timestamp&&(this._diff[p]?+u.findTime>+this._diff[p].findTime&&(this._diff[p]=u):this._diff[p]=u),t-g<=1e3*this._defaultExpiry&&(this._expiry[f]=u),A()(g).format("YYYYMMDD")===n&&(this._today[p]?+u.findTime>+this._today[p].findTime&&(this._today[p]=u):this._today[p]=u),u.barTime=A()(+(u.barTime+"000")).format("YYYY-MM-DD HH:mm:ss"),u.confirmTime=A()(+(u.confirmTime+"000")).format("YYYY-MM-DD HH:mm:ss"),delete u.strategyName,delete u.clickImage,delete u.id}}}catch(e){s=!0,i=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw i}}this._timestamp=r}},{key:"pull",value:(k=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.gap.captureList(1,500);case 2:t=e.sent,this.process(t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"update",value:(d=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.gap.captureList(1,30);case 2:t=e.sent,this.process(t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"isBuy",value:(g=Object(s.a)(a.a.mark((function e(t,n){var r,s=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]?s[2]:"1",e.abrupt("return",t.signalType===n&&t.signalStatus===r&&"1"===t.direction);case 2:case"end":return e.stop()}}),e)}))),function(e,t){return g.apply(this,arguments)})},{key:"isSell",value:(p=Object(s.a)(a.a.mark((function e(t,n){var r,s=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]?s[2]:"1",e.abrupt("return",t.signalType===n&&t.signalStatus===r&&"-1"===t.direction);case 2:case"end":return e.stop()}}),e)}))),function(e,t){return p.apply(this,arguments)})},{key:"diff",value:(l=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object.values(this._diff));case 1:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"expiry",value:(h=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object.values(this._expiry));case 1:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"today",value:(c=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object.values(this._today));case 1:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"points",value:(r=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object.values(this._points));case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"stock",value:(n=Object(s.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this._stocks[t]){e.next=3;break}return e.abrupt("return",this._stocks[t]);case 3:if(!n){e.next=9;break}return e.next=6,f.a.gap.captureStock(t);case 6:return r=e.sent,this._stocks[t]=r[0],e.abrupt("return",r[0]);case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(0);case 13:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e,t){return n.apply(this,arguments)})},{key:"list",value:(t=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,o,c,u,h,l,p,f,g,d,v,k,y,b,m;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.type,r=void 0===n?"3":n,s=t.status,i=void 0===s?"1":s,o=t.direction,c=void 0===o?"1":o,u=t.expiry,h=void 0===u?Object.values(this._expiry).reverse():Object.values(this._points).reverse(),l=(new Date).getTime(),p={},f=!0,g=!1,d=void 0,e.prev=7,v=h[Symbol.iterator]();!(f=(k=v.next()).done);f=!0)y=k.value,b=y.code.slice(0,-3),m=+(y.findTime+"000"),y.direction===c&&y.signalType===r&&y.signalStatus===i&&(u?l-m<=1e3*u&&(p[b]={code:b,name:y.name}):p[b]={code:b,name:y.name});e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),g=!0,d=e.t0;case 15:e.prev=15,e.prev=16,f||null==v.return||v.return();case 18:if(e.prev=18,!g){e.next=21;break}throw d;case 21:return e.finish(18);case 22:return e.finish(15);case 23:return e.abrupt("return",Object.values(p));case 24:case"end":return e.stop()}}),e,this,[[7,11,15,23],[16,,18,22]])}))),function(e){return t.apply(this,arguments)})}]),e}())),ze=n(962),Xe=n.n(ze),$e=n(352),et=n(740),tt=function(){function e(){var t=this;Object(i.a)(this,e),$e.a.listen("KeyB",(function(){var e={timeOut:5e3,extendedTimeOut:5e3,closeButton:!0,positionClass:"toast-bottom-left"};et.a.clear(),et.a.confirm("click to backup trace file","BACKUP",(function(){return t.trace()}),e),et.a.confirm("click to backup capture file","BACKUP",(function(){return t.capture()}),e),et.a.confirm("click to backup flow file","BACKUP",(function(){return t.flow()}),e),et.a.confirm("click to backup storage file","BACKUP",(function(){return t.storage()}),e)}))}var t,n,r,c,u,h,l;return Object(o.a)(e,[{key:"download",value:(l=Object(s.a)(a.a.mark((function e(t,n){var r,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=A()().format("YYYYMMDD"),s=new Blob([JSON.stringify(n,null,"\t")],{type:"application/json;charset=utf-8"}),e.next=4,Object(b.a)(1e3);case 4:return e.abrupt("return",Xe.a.saveAs(s,"".concat(r,"-").concat(t)));case 5:case"end":return e.stop()}}),e)}))),function(e,t){return l.apply(this,arguments)})},{key:"trace",value:(h=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,He.iterate((function(e,n){t[n]=e}));case 4:n={},r="",e.t0=a.a.keys(t);case 6:if((e.t1=e.t0()).done){e.next=23;break}if(s=e.t1.value,e.prev=8,i=s.slice(0,6),r||(r=i),r===i){e.next=16;break}return e.next=14,this.download(r+"-walle-stocks-trace.json",n);case 14:r=i,n={};case 16:n[s]=t[s],e.next=21;break;case 19:e.prev=19,e.t2=e.catch(8);case 21:e.next=6;break;case 23:if(!Object.keys(n).length){e.next=26;break}return e.next=26,this.download(r+"-walle-stocks-trace.json",n);case 26:e.next=30;break;case 28:e.prev=28,e.t3=e.catch(0);case 30:case"end":return e.stop()}}),e,this,[[0,28],[8,19]])}))),function(){return h.apply(this,arguments)})},{key:"capture",value:(u=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,Je.iterate((function(e,n){t[n]=e}));case 4:return e.next=6,this.download("walle-stocks-capture.json",t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return u.apply(this,arguments)})},{key:"flow",value:(c=Object(s.a)(a.a.mark((function e(){var t,n,r,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,O.iterate((function(e,n){t[n]=e}));case 4:n={},r=1,e.t0=a.a.keys(t);case 6:if((e.t1=e.t0()).done){e.next=21;break}if(s=e.t1.value,e.prev=8,r%1e3!=0){e.next=13;break}return e.next=12,this.download(r+"-walle-stocks-flow.json",n);case 12:n={};case 13:r++,n[s]=t[s],e.next=19;break;case 17:e.prev=17,e.t2=e.catch(8);case 19:e.next=6;break;case 21:if(!Object.keys(n).length){e.next=24;break}return e.next=24,this.download(r+"-walle-stocks-flow.json",n);case 24:e.next=28;break;case 26:e.prev=26,e.t3=e.catch(0);case 28:case"end":return e.stop()}}),e,this,[[0,26],[8,17]])}))),function(){return c.apply(this,arguments)})},{key:"storage",value:(r=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={},e.next=4,x.a.iterate((function(e,n){t[n]=e}));case 4:return e.next=6,this.download("walle-stocks-storage.json",t);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return r.apply(this,arguments)})},{key:"all",value:(n=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage();case 2:return e.next=4,this.capture();case 4:return e.next=6,this.flow();case 6:return e.next=8,this.trace();case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"autoBackup",value:(t=Object(s.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=A()().endOf("month").format("YYYYMMDD"),n=A()().format("YYYYMMDD"),t!==n){e.next=8;break}return e.next=5,v.a.when("233000");case 5:return e.next=7,this.all();case 7:console.info("#Backup# auto backup storage & records at ".concat(n," ..."));case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),nt=function(){function e(){var t=this;Object(i.a)(this,e),$e.a.listen("KeyR",(function(){return t.upload()}))}var t,n,r,c,h,l;return Object(o.a)(e,[{key:"upload",value:(l=Object(s.a)(a.a.mark((function e(){var t,n=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=document.createElement("input")).type="file",t.multiple="multiple",t.onchange=function(){n.recover(t.files)},t.click();case 5:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)})},{key:"recover",value:(h=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,o,c,h,l,p,f,g,d=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n={},Object(u.a)(n,"walle-stocks-trace.json",(function(e){return d.trace(e)})),Object(u.a)(n,"walle-stocks-capture.json",(function(e){return d.capture(e)})),Object(u.a)(n,"walle-stocks-flow.json",(function(e){return d.flow(e)})),Object(u.a)(n,"walle-stocks-storage.json",(function(e){return d.storage(e)})),r=n,s=!0,i=!1,o=void 0,e.prev=5,c=t[Symbol.iterator]();case 7:if(s=(h=c.next()).done){e.next=21;break}if(l=h.value,p="",l.name.includes("walle-stocks-trace.json")?p="walle-stocks-trace.json":l.name.includes("walle-stocks-capture.json")?p="walle-stocks-capture.json":l.name.includes("walle-stocks-flow.json")?p="walle-stocks-flow.json":l.name.includes("walle-stocks-storage.json")&&(p="walle-stocks-storage.json"),!r[p]){e.next=18;break}return e.next=14,l.text();case 14:return f=e.sent,g=JSON.parse(f),e.next=18,r[p](g);case 18:s=!0,e.next=7;break;case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(5),i=!0,o=e.t0;case 27:e.prev=27,e.prev=28,s||null==c.return||c.return();case 30:if(e.prev=30,!i){e.next=33;break}throw o;case 33:return e.finish(30);case 34:return e.finish(27);case 35:window.alert("Walle Recover Success ..."),e.next=42;break;case 38:e.prev=38,e.t1=e.catch(0),console.info("#Recover# fail ",e.t1),window.alert("Walle Recover Fail, Try Aagin ...");case 42:case"end":return e.stop()}}),e,null,[[0,38],[5,23,27,35],[28,,30,34]])}))),function(e){return h.apply(this,arguments)})},{key:"trace",value:(c=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return n=e.t1.value,e.next=6,He.setItem(n,t[n]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(e){return c.apply(this,arguments)})},{key:"capture",value:(r=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return n=e.t1.value,e.next=6,Je.setItem(n,t[n]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(e){return r.apply(this,arguments)})},{key:"flow",value:(n=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return n=e.t1.value,e.next=6,O.setItem(n,t[n]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(e){return n.apply(this,arguments)})},{key:"storage",value:(t=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=a.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=8;break}return n=e.t1.value,e.next=6,x.a.setItem(n,t[n]);case 6:e.next=2;break;case 8:e.next=12;break;case 10:e.prev=10,e.t2=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(e){return t.apply(this,arguments)})}]),e}(),rt=new tt,at=(new nt,new(function(){function e(){Object(i.a)(this,e)}var t;return Object(o.a)(e,[{key:"start",value:(t=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,rt.autoBackup(),e.next=4,_e.isTradingDay();case 4:if(!e.sent){e.next=11;break}console.log("#Loop# core-loop start ..."),k.a.start(),_e.start(),R.a.start(),Ne.capture(),Ne.trace();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.warn("#loop# ",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])}))),function(){return t.apply(this,arguments)})}]),e}())),st=n(963),it=n.n(st),ot=n(621),ct=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(i.a)(this,e),Object(u.a)(this,"multiple",void 0),Object(u.a)(this,"code",void 0),Object(u.a)(this,"prevclose",void 0),Object(u.a)(this,"details",[]),this.code=t,this.multiple=n}var t;return Object(o.a)(e,[{key:"url",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=f.a.eastmoney.marketCode(e),r="".concat(n,".").concat(e),a="http://push2.eastmoney.com/api/qt/stock/details/get?fields1=f1,f2,f3,f4&fields2=f51,f52,f53,f54,f55&pos=".concat(t,"&secid=").concat(r);return a}},{key:"prevclose",value:function(){}},{key:"trends",value:function(){var e={time:[],price:[],volume:[]},t=0,n=0,r=0,a=H()(this.details).reverse();for(var s in a){var i=a[s];t=i[0].replace(/:/g,""),n+=+i[2],0==+s&&(r=t),+t>=+r+3*this.multiple&&(r=t,e.time.unshift(t),e.price.unshift(+i[1]),e.volume.unshift(n),n=0)}return e}},{key:"isFire",value:function(){var e=0,t=0,n=!0,r=!1,a=void 0;try{for(var s,i=this.details[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){if(2==+s.value[4]?e++:e=0,t>5)break;t++}}catch(e){r=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}return e>=3}},{key:"capture",value:(t=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,o,c,u,h,l,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.url(this.code,t),e.next=3,qe.b.get(n,null,{dataType:"json"});case 3:for(r=e.sent,s=r.data.details,i=!0,o=!1,c=void 0,e.prev=8,u=s[Symbol.iterator]();!(i=(h=u.next()).done);i=!0)l=h.value,p=l.split(","),this.details.unshift(p);e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),o=!0,c=e.t0;case 16:e.prev=16,e.prev=17,i||null==u.return||u.return();case 19:if(e.prev=19,!o){e.next=22;break}throw c;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return this.prevclose=+r.data.prePrice,e.abrupt("return",this);case 26:case"end":return e.stop()}}),e,this,[[8,12,16,24],[17,,19,23]])}))),function(e){return t.apply(this,arguments)})}]),e}(),ut=function(){function e(t){Object(i.a)(this,e),Object(u.a)(this,"code",void 0),Object(u.a)(this,"prevclose",void 0),Object(u.a)(this,"details",[]),this.code=t}var t;return Object(o.a)(e,[{key:"url",value:function(e){var t=f.a.eastmoney.marketCode(e),n="".concat(t,".").concat(e),r="http://push2.eastmoney.com/api/qt/stock/trends2/get?fields1=f1,f2,f3,f4,f5,f6,f7,f8,f9,f10,f11,f12,f13&fields2=f51,f52,f53,f54,f55,f56,f57,f58&secid=".concat(n,"&ndays=1&iscr=1");return r}},{key:"trends",value:function(){var e={time:[],price:[],volume:[]},t=!0,n=!1,r=void 0;try{for(var a,s=this.details[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var i=a.value,o=A()(i[0]).format("HHmmss");e.time.push(o),e.price.push(+i[2]),e.volume.push(+i[5])}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}return e}},{key:"capture",value:(t=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o,c,u,h,l,p,f=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:-10,n=this.url(this.code,t),e.next=4,qe.b.get(n,null,{dataType:"json"});case 4:for(r=e.sent,s=r.data.trends,i=!0,o=!1,c=void 0,e.prev=9,u=s[Symbol.iterator]();!(i=(h=u.next()).done);i=!0)l=h.value,p=l.split(","),this.details.unshift(p);e.next=17;break;case 13:e.prev=13,e.t0=e.catch(9),o=!0,c=e.t0;case 17:e.prev=17,e.prev=18,i||null==u.return||u.return();case 20:if(e.prev=20,!o){e.next=23;break}throw c;case 23:return e.finish(20);case 24:return e.finish(17);case 25:return this.prevclose=+r.data.preClose,e.abrupt("return",this);case 27:case"end":return e.stop()}}),e,this,[[9,13,17,25],[18,,20,24]])}))),function(){return t.apply(this,arguments)})}]),e}(),ht=function e(t,n,r){return Object(i.a)(this,e),3===n?new ct(t,r):60===n?new ut(t):void 0};function lt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,r=0,a=0,s=0;return e.forEach((function(e,i){s>=n||(1===t?(r+=+e,s++):(a+=+e,i%t==0&&(r+=+a/n,s++)))})),s<n&&(n=s),+(r/n).toFixed(2)}var pt=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(i.a)(this,e),Object(u.a)(this,"profit",{time:{win:0,lose:0},change:{win:0,lose:0},rate:{win:0,lose:0},ratio:0}),Object(u.a)(this,"trends",{time:[],price:[],volume:[],ma5:[],ma10:[],ma20:[],change:[],rate:[]}),Object(u.a)(this,"code",void 0),Object(u.a)(this,"period",void 0),Object(u.a)(this,"multiple",void 0),Object(u.a)(this,"prevclose",void 0),Object(u.a)(this,"details",{time:[],price:[],volume:[]}),Object(u.a)(this,"index",0),Object(u.a)(this,"simulator",void 0),this.code=n,this.period=r,this.multiple=a,this.simulator=t}var t,n;return Object(o.a)(e,[{key:"capture",value:(n=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new ht(this.code,this.period,this.multiple).capture();case 2:t=e.sent,this.details=t.trends(),this.details.time.reverse(),this.details.price.reverse(),this.details.volume.reverse(),this.prevclose=t.prevclose;case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"start",value:(t=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o,c,u,h,l,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.simulator,n=t.analyseOfBuy,r=t.analyseOfSell,s=t.analyseOfBuy2,i=t.analyseOfSell2,o=0,c=0,e.next=5,this.capture();case 5:n[this.code]={times:0};case 6:if(!this.hasNext()){e.next=51;break}if(this.next(),!(+this.trends.time[0]<93e3||+this.trends.time[0]>145e3)){e.next=10;break}return e.abrupt("continue",6);case 10:if(!n(this.trends,this.code)){e.next=49;break}console.info("#analyseOfBuy# ",this.trends.time[0],this.trends.price[0],this.trends.change[0],this.trends.volume[0],this.trends.ma5[0],this.trends.ma10[0],this.trends.ma20[0]),o=this.trends.change[0];case 13:if(!this.hasNext()){e.next=26;break}if(this.next(),u=+this.trends.time[0]>145e3,!r(this.trends,{change:o},u)){e.next=22;break}return c=this.trends.change[0],h=c-o,console.info("#analyseOfSell# ",this.trends.time[0],this.trends.price[0],this.trends.change[0],this.trends.volume[0],this.trends.ma5[0],this.trends.ma10[0],this.trends.ma20[0],h),this.update(h),e.abrupt("break",26);case 22:if(!u){e.next=24;break}return e.abrupt("break",26);case 24:e.next=13;break;case 26:if(!s){e.next=49;break}l=0;case 28:if(!this.hasNext()){e.next=49;break}if(!(++l>3)){e.next=32;break}return e.abrupt("break",49);case 32:if(this.next(),!s(this.trends)){e.next=47;break}console.info("#analyseOfBuy2# ",this.trends.time[0],this.trends.price[0],this.trends.change[0],this.trends.volume[0],this.trends.ma5[0],this.trends.ma10[0],this.trends.ma20[0]),o=this.trends.change[0];case 36:if(!this.hasNext()){e.next=46;break}if(this.next(),!i(this.trends,{change:o})){e.next=44;break}return c=this.trends.change[0],p=c-o,console.info("#analyseOfSell2# ",this.trends.time[0],this.trends.price[0],this.trends.change[0],this.trends.volume[0],this.trends.ma5[0],this.trends.ma10[0],this.trends.ma20[0],p),this.update(p),e.abrupt("break",46);case 44:e.next=36;break;case 46:return e.abrupt("break",49);case 47:e.next=28;break;case 49:e.next=6;break;case 51:console.info("#Profit# ","总笔数 ",this.profit.time.win+this.profit.time.lose,"总收益 ",this.profit.change.win+this.profit.change.lose,"单笔收益 ",(this.profit.change.win+this.profit.change.lose)/(this.profit.time.win+this.profit.time.lose),this.profit),e.next=57;break;case 54:e.prev=54,e.t0=e.catch(0),console.warn("MockProcessor ",e.t0);case 57:return e.abrupt("return",this);case 58:case"end":return e.stop()}}),e,this,[[0,54]])}))),function(){return t.apply(this,arguments)})},{key:"hasNext",value:function(){var e=this.details.time.length;return this.index<e}},{key:"next",value:function(){this.index+=1;var e=this.details.time[this.index],t=this.details.price[this.index],n=this.details.volume[this.index],r=+((t-this.prevclose)/this.prevclose*100).toFixed(2);this.trends.time.unshift(e),this.trends.price.unshift(t),this.trends.volume.unshift(n),this.trends.change.unshift(r),this.trends.ma5.unshift(lt(this.trends.price,1,5)),this.trends.ma10.unshift(lt(this.trends.price,1,10)),this.trends.ma20.unshift(lt(this.trends.price,1,20)),this.trends.rate.unshift(NaN)}},{key:"update",value:function(e){e>0?(this.profit.time.win++,this.profit.change.win+=e):(this.profit.time.lose++,this.profit.change.lose+=e);var t=this.profit.time.win+this.profit.time.lose||1;this.profit.rate.win=this.profit.time.win/t,this.profit.rate.lose=this.profit.time.lose/t,this.profit.ratio=(this.profit.change.win+this.profit.change.lose)/t}}]),e}(),ft=function(){function e(t,n,r,a){Object(i.a)(this,e),Object(u.a)(this,"Processor",void 0),Object(u.a)(this,"processor",void 0),Object(u.a)(this,"target",void 0),Object(u.a)(this,"key",void 0),Object(u.a)(this,"codes",[]),this.Processor=t,this.target=n,this.key=r,this.codes=a}var t,n,r;return Object(o.a)(e,[{key:"start",value:(r=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_e.isTradingDay();case 3:if(!e.sent){e.next=26;break}if(e.prev=4,Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.a.liquidation("t0");case 2:case"end":return e.stop()}}),e)})))(),this.codes){e.next=11;break}return e.next=10,this.capture();case 10:this.codes=e.sent;case 11:this.processor=new this.Processor(this.target,this.key,this.codes),this.processor.start(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),console.warn("T0Controller start ",e.t0);case 18:return this._isRunning=!0,e.next=22,v.a.until("145000");case 22:return e.next=24,this.stop();case 24:return e.next=26,R.a.liquidation("t0");case 26:e.next=32;break;case 28:e.prev=28,e.t1=e.catch(0),this._isRunning=!1,console.warn("T0Controller start ",e.t1);case 32:case"end":return e.stop()}}),e,this,[[0,28],[4,15]])}))),function(){return r.apply(this,arguments)})},{key:"stop",value:(n=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.processor.stop()}catch(e){console.warn("T0Controller stop ",e)}case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"capture",value:(t=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}(),gt=(n(794),new(function(){function e(){Object(i.a)(this,e)}var t,n,r,c;return Object(o.a)(e,[{key:"_broadcast",value:(c=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Interval_Event",{detail:t})),(n=(window.parent||window).opener)&&["L3","L5"].includes(t.state)&&n.dispatchEvent(new CustomEvent("__Walle_Stock_Daily_Interval_Event",{detail:t}));case 3:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"broadcast",value:(r=Object(s.a)(a.a.mark((function e(t,n,r,s){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._broadcast({name:"".concat(t," - ").concat(n),vtype:"v0",stock:r,trend:s,state:n});case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n,a){return r.apply(this,arguments)})},{key:"buy",value:(n=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.a.buy("t0",n);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(e,t){return n.apply(this,arguments)})},{key:"sell",value:(t=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.a.sell("t0",n);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(e,n){return t.apply(this,arguments)})}]),e}())),dt="L1",vt="L2",kt="L3",yt="L4",bt="L5",mt=function(){function e(t){Object(i.a)(this,e),Object(u.a)(this,"sse",void 0),Object(u.a)(this,"period",void 0),Object(u.a)(this,"codes",[]),Object(u.a)(this,"_stocks",{}),Object(u.a)(this,"_trend",{}),this.codes=t}var t,n,r;return Object(o.a)(e,[{key:"init",value:(r=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=!0,n=!1,r=void 0,e.prev=3,s=this.codes[Symbol.iterator]();!(t=(i=s.next()).done);t=!0)o=i.value,this._trend[o]={time:[],price:[],volume:[],ma5:[],ma10:[],ma20:[],change:[],rate:[]};e.next=11;break;case 7:e.prev=7,e.t0=e.catch(3),n=!0,r=e.t0;case 11:e.prev=11,e.prev=12,t||null==s.return||s.return();case 14:if(e.prev=14,!n){e.next=17;break}throw r;case 17:return e.finish(14);case 18:return e.finish(11);case 19:case"end":return e.stop()}}),e,this,[[3,7,11,19],[12,,14,18]])}))),function(){return r.apply(this,arguments)})},{key:"restart",value:(n=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sse=f.a.sseStart(this.codes,{interval:1});case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"start",value:(t=Object(s.a)(a.a.mark((function e(){var t,n=this,r=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:3,e.prev=1,this.period=t,e.next=5,this.init();case 5:return e.next=7,this.restart();case 7:return v.a.interval(Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.update());case 1:case"end":return e.stop()}}),e)}))),null,this.period),e.next=10,Object(b.a)(20*this.period*1e3);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.warn("T0SSE start ",e.t0);case 15:case"end":return e.stop()}}),e,this,[[1,12]])}))),function(){return t.apply(this,arguments)})},{key:"stop",value:function(){this.sse&&this.sse.stop()}},{key:"stocks",value:function(){return this.sse.getStocks(this.codes)}},{key:"stock",value:function(e){return this.sse.getStock(e)}},{key:"trends",value:function(){return this._trend}},{key:"trend",value:function(e){return this._trend[e]}},{key:"update",value:function(){console.log("@"),2==+this.sse.state()&&(console.warn("#T0# sse restart ...",this.sse.state()),this.restart()),this._bak=this._stocks,this._stocks=this.sse.getStocks(this.codes);var e=A()().format("HHmmss");for(var t in this._stocks){var n=this._bak[t],r=this._stocks[t];this._trend[t].time.unshift(e),this._trend[t].price.unshift(+r.price),this._trend[t].change.unshift(+r.change),this._trend[t].rate.unshift(+r.rate),this._trend[t].volume.unshift(+r.volume-(n?+n.volume:+r.volume)),this._trend[t].ma5.unshift(this.maOfPrice(t,1,5)),this._trend[t].ma10.unshift(this.maOfPrice(t,1,10)),this._trend[t].ma20.unshift(this.maOfPrice(t,1,20))}}},{key:"maOfPrice",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return lt(this._trend[e].price,t,n)}},{key:"maOfVolume",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return lt(this._trend[e].volume,t,n)}}]),e}(),At=x.a.createInstance({name:"storage",driver:x.a.INDEXEDDB}),wt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object(i.a)(this,e),Object(u.a)(this,"record",{code:"",name:"",trend:{time:[],ma5:[],ma10:[],ma20:[],price:[],change:[],rate:[]},monitor:{time:"",price:"",change:"",rate:""},buy:{time:"",price:"",change:"",rate:""},sell:{time:"",price:"",change:"",rate:""}}),this.record.name=n,this.record.code=t}return Object(o.a)(e,[{key:"key",value:function(){return this.record.key}},{key:"code",value:function(e){return e&&(this.record.code=e),this.record.code}},{key:"name",value:function(e){return e&&(this.record.code=e),this.record.name}},{key:"trend",value:function(e){return e&&(this.record.trend.time=e.time.slice(0,100),this.record.trend.ma5=e.ma5.slice(0,100),this.record.trend.ma10=e.ma10.slice(0,100),this.record.trend.ma20=e.ma20.slice(0,100),this.record.trend.price=e.price.slice(0,100),this.record.trend.change=e.change.slice(0,100),this.record.trend.rate=e.rate.slice(0,100)),this.record.trend}},{key:"monitor",value:function(e){if(e){var t=A()().format("HHmmss");this.record.monitor={time:t,price:e.price,change:e.change,rate:e.rate},this.record.name=e.name,this.record.code=e.code}return this.record.monitor}},{key:"buy",value:function(e){if(e){var t=A()().format("HHmmss");this.record.buy={time:t,price:e.price,change:e.change,rate:e.rate},this.record.name=e.name,this.record.code=e.code}return this.record.buy}},{key:"sell",value:function(e){if(e){var t=A()().format("HHmmss");this.record.sell={time:t,price:e.price,change:e.change,rate:e.rate},this.record.name=e.name,this.record.code=e.code}return this.record.sell}}]),e}(),xt=function(){function e(t,n){Object(i.a)(this,e),Object(u.a)(this,"records",{}),Object(u.a)(this,"target",void 0),Object(u.a)(this,"key",void 0),this.target=t,this.key=n}var t,n;return Object(o.a)(e,[{key:"name",value:function(){var e=A()().day();return"t0-".concat(e,"-").concat(this.target,"-").concat(this.key)}},{key:"record",value:function(){return new wt}},{key:"append",value:function(e){var t=e.record,n=A()().format("HHmmss");return this.records[n]=t,this.save()}},{key:"all",value:function(){return this.records}},{key:"get",value:function(e){return this.records[e]||{}}},{key:"set",value:function(e,t){var n=t.record;return this.records[e]=n,this.save()}},{key:"load",value:(n=Object(s.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=A()().format("YYYY-MM-DD"),e.next=3,At.getItem(this.name());case 3:return(n=e.sent)&&n.date===t&&(this.records=n),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"save",value:(t=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=A()().format("YYYY-MM-DD"),this.records.date=t,e.abrupt("return",At.setItem(this.name(),this.records));case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Ot=function(){function e(t,n,r){Object(i.a)(this,e),Object(u.a)(this,"key",""),Object(u.a)(this,"records",void 0),Object(u.a)(this,"sse",void 0),Object(u.a)(this,"hooks",gt),Object(u.a)(this,"current",void 0),Object(u.a)(this,"profit",{change:0,high:0,low:0}),Object(u.a)(this,"isRunning",!1),Object(u.a)(this,"isForceStop",!1),this.key=n,this.sse=new mt(r),this.records=new xt(t,n)}var t,n,r,c,h,l;return Object(o.a)(e,[{key:"start",value:(l=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.records.load();case 3:return e.next=5,this.sse.start(t);case 5:this.isRunning=!0;case 6:return console.log("#"),e.next=10,Object(b.a)(1e3);case 10:if(!(+A()().format("HHmmss")<93e3)){e.next=13;break}return e.abrupt("continue",6);case 13:if(!this.isForceStop){e.next=16;break}return console.log("T0Processor loop force stop ..."),e.abrupt("break",55);case 16:return e.prev=16,this.current=null,n=new wt(this.key),this.hooks.broadcast(this.key,dt),e.next=22,this.monitor();case 22:if(this.current=e.sent,this.current){e.next=25;break}return e.abrupt("continue",6);case 25:return n.monitor(this.current),console.log("T0Processor loop state L1 ... ",this.current),this.hooks.broadcast(this.key,vt,this.current,this.sse.trend(this.current.code)),e.next=30,this.analyseOfBuy(this.current);case 30:if(this.current=e.sent,this.current){e.next=33;break}return e.abrupt("continue",6);case 33:return n.buy(this.current),console.log("T0Processor loop state L2 ... ",this.current),this.hooks.broadcast(this.key,kt,this.current,this.sse.trend(this.current.code)),this.hooks.buy(this.key,this.current),console.log("T0Processor loop state L3 ... ",this.current),this.hooks.broadcast(this.key,yt,this.current,this.sse.trend(this.current.code)),e.next=41,this.analyseOfSell(this.current);case 41:this.current=e.sent,n.sell(this.current),console.log("T0Processor loop state L4 ... ",this.current),this.hooks.broadcast(this.key,bt,this.current,this.sse.trend(this.current.code)),this.hooks.sell(this.key,this.current),console.log("T0Processor loop state L5 ... ",this.current),this.updateRecord(n),e.next=53;break;case 50:e.prev=50,e.t0=e.catch(16),console.warn("T0Processor loop ",e.t0);case 53:e.next=6;break;case 55:this.isRunning=!1,e.next=61;break;case 58:e.prev=58,e.t1=e.catch(0),console.warn("T0Processor loop ",e.t1);case 61:case"end":return e.stop()}}),e,this,[[0,58],[16,50]])}))),function(e){return l.apply(this,arguments)})},{key:"updateProfit",value:(h=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.profit.change+=t.sell().change-t.buy().change,this.profit.change>this.profit.high&&(this.profit.high=this.profit.change),this.profit.change<this.profit.low&&(this.profit.low=this.profit.change),(this.profit.change>5||this.profit.high-this.profit.change>2)&&(console.info("T0Processor stop-profit",this.profit.change,"high = ",this.profit.high,"low = ",this.profit.low),this.stop())}catch(e){console.warn("T0Processor update profit",e)}case 1:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"updateRecord",value:(c=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(b.a)(18e4);case 3:t.trend(this.sse.trend(t.code())),this.records.append(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn("T0Processor update record",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e){return c.apply(this,arguments)})},{key:"stop",value:(r=Object(s.a)(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isForceStop=!0,this.sse.stop(),e.abrupt("return",new Promise((function(e){setInterval((function(){t.isRunning||e()}),1e3)})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"analyseOfBuy",value:(n=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"analyseOfSell",value:(t=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),jt={"long-impulse":function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=Object(S.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(a))),Object(u.a)(Object(F.a)(n),"period",9),n}var n,r,c;return Object(I.a)(t,e),Object(o.a)(t,[{key:"start",value:function(){return Object(L.a)(Object(E.a)(t.prototype),"start",this).call(this,this.period)}},{key:"monitor",value:(c=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=this.sse.trends();case 2:n=(new Date).getTime(),e.t0=a.a.keys(t);case 5:if((e.t1=e.t0()).done){e.next=17;break}if(r=e.t1.value,s=this.sse.trend(r),!((i=this.sse.stock(r)).change-s.change[0]>3)){e.next=12;break}return console.log("T0LongImpulseProcessor analyseOfBuy",s.time[0],"impulse boom",r,i.change,s.change[0],i.change-s.change[0]),e.abrupt("return",i);case 12:if(!(i.change-s.change[2]>.2)){e.next=15;break}return console.log("T0LongImpulseProcessor analyseOfBuy",s.time[0],"impulse catched",r,i.change,s.change[2],i.change-s.change[2]),e.abrupt("return",i);case 15:e.next=5;break;case 17:return o=(new Date).getTime(),console.log("*",o-n+"ms"),e.next=21,Object(b.a)(1500);case 21:e.next=2;break;case 23:e.next=28;break;case 25:e.prev=25,e.t2=e.catch(0),console.warn("T0LongImpulseProcessor monitor ",e.t2);case 28:case"end":return e.stop()}}),e,this,[[0,25]])}))),function(){return c.apply(this,arguments)})},{key:"analyseOfBuy",value:(r=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,o,c,u,h,l,p,f,g,d,v,k,y,b,m,A,w;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.code,e.prev=1,r=this.sse.trend(n),s=this.sse.stock(n),i=.3,o=!1,r.change[0]-r.change[1]>3&&(console.log("T0LongImpulseProcessor analyseOfBuy",r.time[0],"impulse boom",r.change[0],r.change[1],"+".concat(r.change[0]-r.change[1])),o=!0),o){e.next=52;break}if(r.price[0]>=r.ma5[0]&&r.price[0]>r.price[1]&&r.ma5[0]>r.ma5[1]&&r.ma5[1]>r.ma5[2]&&r.ma5[2]>r.ma5[3]){e.next=10;break}return e.abrupt("return");case 10:console.log("T0LongImpulseProcessor analyseOfBuy",r.time[0],"mas valid",r.price[0],r.ma5[0],r.ma5[1],r.ma5[2],r.ma5[3]),c=0,u=0,h=0,e.t0=a.a.keys(r.ma5);case 13:if((e.t1=e.t0()).done){e.next=22;break}if(l=e.t1.value,c=+l,r.volume[c],r.price[c]>u&&(u=r.price[c]),!(r.ma5[c]<r.ma5[c+1])){e.next=20;break}return e.abrupt("break",22);case 20:e.next=13;break;case 22:if(h=r.change[0]-r.change[c],c>=3&&r.price[0]>=u&&h>i){e.next=25;break}return e.abrupt("return");case 25:if(console.log("T0LongImpulseProcessor analyseOfBuy",r.time[0],"impulse valid","tick = ".concat(c),"+".concat(h)),p=!1,f=!1,g=!1,h>i+.3&&r.change[0]-r.change[3]>.8&&(console.log("T0LongImpulseProcessor analyseOfBuy",r.time[0],"impulse L1 breakthrough",r.change[0],r.change[3],"+".concat(r.change[0]-r.change[3])),p=!0),h>i+.5&&r.change[0]-r.change[3]>.5&&(console.log("T0LongImpulseProcessor analyseOfBuy",r.time[0],"impulse L2 breakthrough",r.change[0],r.change[3],"+".concat(r.change[0]-r.change[3])),f=!0),h>i+.7&&r.change[0]-r.change[3]>.2&&(console.log("T0LongImpulseProcessor analyseOfBuy",r.time[0],"impulse L3 breakthrough",r.change[0],r.change[3],"+".concat(r.change[0]-r.change[3])),g=!0),p||f||g){e.next=32;break}return e.abrupt("return");case 32:d=0,v=0,k=0,y=0,b=!0,e.t2=a.a.keys(r.ma20);case 34:if((e.t3=e.t2()).done){e.next=48;break}if(m=e.t3.value,c=+m,0===v&&0===k&&(y=r.volume.slice(0,3).reduce((function(e,t){return e+t})),v=y,k=y),!(r.ma20.length<c+6+1)){e.next=40;break}return e.abrupt("break",48);case 40:A=r.volume.slice(c,c+3).reduce((function(e,t){return e+t})),w=r.volume.slice(c+3,c+6).reduce((function(e,t){return e+t})),v<A&&(v=A),k>A&&(k=A),b&&A>=8*w&&d++,r.ma20[c]<r.ma20[c+1]&&(b=!1),e.next=34;break;case 48:if(y===v&&v>=8*k&&d++,d>=1){e.next=51;break}return e.abrupt("return");case 51:console.log("T0LongImpulseProcessor analyseOfBuy",r.time[0],"volume valid","now = ".concat(y),"high = ".concat(v),"low = ".concat(k),"times = ".concat(d));case 52:return this.analyseOfBuy.change=r.change[0],this.analyseOfSell.high=r.change[0],e.abrupt("return",s);case 57:e.prev=57,e.t4=e.catch(1),console.warn("T0LongImpulseProcessor analyseOfBuy",e.t4);case 60:case"end":return e.stop()}}),e,this,[[1,57]])}))),function(e){return r.apply(this,arguments)})},{key:"analyseOfSell",value:(n=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,o,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.code,t.change,e.prev=1,r=0;case 3:if(s=this.sse.stock(n),i=this.sse.trend(n),o=.2,s.change>this.analyseOfSell.high&&(this.analyseOfSell.high=s.change),r%this.period!=0){e.next=26;break}if(!(this.analyseOfSell.high-s.change>=.6)){e.next=12;break}return console.log("T0LongImpulseProcessor analyseOfSell",i.time[0],"drawdown",this.analyseOfSell.high,s.change),e.abrupt("return",s);case 12:if(!(i.price[0]<i.ma5[0])){e.next=19;break}if(c=!1,this.analyseOfBuy.change-i.change[0]>o&&(c=!0),this.analyseOfSell.high>this.analyseOfBuy.change+o+.1&&i.change[0]-this.analyseOfBuy.change<.1&&(c=!0),!c){e.next=19;break}return console.log("T0LongImpulseProcessor analyseOfSell",i.time[0],"stoploss",this.analyseOfBuy.change,i.change[0]),e.abrupt("return",s);case 19:if(i.price[0]>i.ma5[0]&&i.price[0]>i.ma10[0]){e.next=26;break}if(!(i.ma10[0]<=i.ma10[1])){e.next=23;break}return console.log("T0LongImpulseProcessor analyseOfSell",i.time[0],"ma10 reverse",i.ma10[0],i.ma10[1]),e.abrupt("return",s);case 23:if(!(i.ma5[0]<=i.ma10[0])){e.next=26;break}return console.log("T0LongImpulseProcessor analyseOfSell",i.time[0],"ma down ma5 <= ma10",i.ma5[0],i.ma10[0]),e.abrupt("return",s);case 26:return r++,e.next=29,Object(b.a)(1e3);case 29:e.next=3;break;case 31:e.next=37;break;case 33:return e.prev=33,e.t0=e.catch(1),console.warn("T0LongImpulseProcessor analyseOfSell",e.t0),e.abrupt("return",this.sse.stock(n));case 37:case"end":return e.stop()}}),e,this,[[1,33]])}))),function(e){return n.apply(this,arguments)})}]),t}(Ot),"short-impulse":function(e){function t(){return Object(i.a)(this,t),Object(S.a)(this,Object(E.a)(t).apply(this,arguments))}var n,r,c;return Object(I.a)(t,e),Object(o.a)(t,[{key:"start",value:function(){return Object(L.a)(Object(E.a)(t.prototype),"start",this).call(this,6)}},{key:"monitor",value:(c=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)}))),function(){return c.apply(this,arguments)})},{key:"analyseOfBuy",value:(r=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.code;case 2:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"analyseOfSell",value:(n=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.code,t.change;case 2:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]),t}(Ot)};function Bt(e,t){try{var n=!1;if(e.change[0]-e.change[1]>3&&(console.info("T0LongImpulseProcessor analyseOfBuy",e.time[0],"impulse boom",e.change[0],e.change[1],"+".concat(e.change[0]-e.change[1])),n=!0),!n){if(!(e.price[0]>=e.ma5[0]&&e.price[0]>e.price[1]&&e.ma5[0]>e.ma5[1]&&e.ma5[1]>e.ma5[2]&&e.ma5[2]>e.ma5[3]))return;console.info("T0LongImpulseProcessor analyseOfBuy",e.time[0],"mas valid",e.price[0],e.ma5[0],e.ma5[1],e.ma5[2],e.ma5[3]);var r,a=0,s=0;for(var i in e.ma5)if(a=+i,+e.volume[a],e.price[a]>s&&(s=e.price[a]),e.ma5[a]<e.ma5[a+1])break;if(r=e.change[0]-e.change[a],!(a>=3&&e.price[0]>=s&&r>.3))return;console.info("T0LongImpulseProcessor analyseOfBuy",e.time[0],"impulse valid","tick = ".concat(a),"+".concat(r));var o=!1,c=!1,u=!1;if(r>.6&&e.change[0]-e.change[3]>.8&&(console.info("T0LongImpulseProcessor analyseOfBuy",e.time[0],"impulse L1 breakthrough",e.change[0],e.change[3],"+".concat(e.change[0]-e.change[3])),o=!0),r>.8&&e.change[0]-e.change[3]>.5&&(console.info("T0LongImpulseProcessor analyseOfBuy",e.time[0],"impulse L2 breakthrough",e.change[0],e.change[3],"+".concat(e.change[0]-e.change[3])),c=!0),r>1&&e.change[0]-e.change[3]>.2&&(console.info("T0LongImpulseProcessor analyseOfBuy",e.time[0],"impulse L3 breakthrough",e.change[0],e.change[3],"+".concat(e.change[0]-e.change[3])),u=!0),!(o||c||u))return;var h=0,l=0,p=0,f=0,g=!0;for(var d in e.ma20){if(a=+d,0===l&&0===p&&(l=f=e.volume.slice(0,3).reduce((function(e,t){return e+t})),p=f),e.ma20.length<a+6+1)break;var v=e.volume.slice(a,a+3).reduce((function(e,t){return e+t})),k=e.volume.slice(a+3,a+6).reduce((function(e,t){return e+t}));l<v&&(l=v),p>v&&(p=v),g&&v>=8*k&&h++,e.ma20[a]<e.ma20[a+1]&&(g=!1)}if(f===l&&l>=8*p&&h++,!(h>=1))return;console.info("T0LongImpulseProcessor analyseOfBuy",e.time[0],"volume valid","now = ".concat(f),"high = ".concat(l),"low = ".concat(p),"times = ".concat(h))}return Bt.change=e.change[0],Ct.high=e.change[0],!0}catch(e){console.warn("T0LongImpulseProcessor analyseOfBuy",e)}}function Ct(e,t){t.change;try{var n={change:e.change[0],price:e.price[0]};if(n.change>Ct.high&&(Ct.high=n.change),Ct.high-n.change>=.6)return console.info("T0LongImpulseProcessor analyseOfSell",e.time[0],"period drawdown",Ct.high,n.change),n;if(e.price[0]<e.ma5[0]){var r=!1;if(Bt.change-e.change[0]>.2&&(r=!0),Ct.high>Bt.change+.2+.1&&e.change[0]-Bt.change<.1&&(r=!0),r)return console.info("T0LongImpulseProcessor analyseOfSell",e.time[0],"stoploss",Bt.change,e.change[0]),n}if(!(e.price[0]>e.ma5[0]&&e.price[0]>e.ma10[0])){if(e.ma10[0]<=e.ma10[1])return console.info("T0LongImpulseProcessor analyseOfSell",e.time[0],"ma10 reverse",e.ma10[0],e.ma10[1]),n;if(e.ma5[0]<=e.ma10[0])return console.info("T0LongImpulseProcessor analyseOfSell",e.time[0],"ma down ma5 <= ma10",e.ma5[0],e.ma10[0]),n}}catch(e){console.warn("T0LongImpulseProcessor analyseOfSell",e)}}var Yt={"long-impulse":{analyseOfBuy:Bt,analyseOfSell:Ct},"short-impulse":{analyseOfBuy:function(e){},analyseOfSell:function(e){}}},Dt=function(e){function t(){return Object(i.a)(this,t),Object(S.a)(this,Object(E.a)(t).apply(this,arguments))}var n;return Object(I.a)(t,e),Object(o.a)(t,[{key:"capture",value:(n=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i,o,c,u,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,f.a.captureList(V.qb.key);case 3:n=e.sent,r=!0,s=!1,i=void 0,e.prev=7,o=n[Symbol.iterator]();case 9:if(r=(c=o.next()).done){e.next=20;break}return u=c.value.code,h=d.a.stockOfBond(u),e.next=14,M.isValidStock(h,"");case 14:if(e.sent){e.next=16;break}return e.abrupt("continue",17);case 16:t.push(u);case 17:r=!0,e.next=9;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(7),s=!0,i=e.t0;case 26:e.prev=26,e.prev=27,r||null==o.return||o.return();case 29:if(e.prev=29,!s){e.next=32;break}throw i;case 32:return e.finish(29);case 33:return e.finish(26);case 34:return e.abrupt("return",t);case 35:case"end":return e.stop()}}),e,null,[[7,22,26,34],[27,,29,33]])}))),function(){return n.apply(this,arguments)})}]),t}(ft);Object(u.a)(Dt,"Processors",jt),Object(u.a)(Dt,"Simulators",Yt);var Vt={"long-impulse":function(e){function t(){return Object(i.a)(this,t),Object(S.a)(this,Object(E.a)(t).apply(this,arguments))}var n,r,c;return Object(I.a)(t,e),Object(o.a)(t,[{key:"start",value:function(){return Object(L.a)(Object(E.a)(t.prototype),"start",this).call(this,6)}},{key:"monitor",value:(c=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)}))),function(){return c.apply(this,arguments)})},{key:"analyseOfBuy",value:(r=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.code;case 2:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"analyseOfSell",value:(n=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.code,t.change;case 2:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]),t}(Ot),"short-impulse":function(e){function t(){return Object(i.a)(this,t),Object(S.a)(this,Object(E.a)(t).apply(this,arguments))}var n,r,c;return Object(I.a)(t,e),Object(o.a)(t,[{key:"start",value:function(){return Object(L.a)(Object(E.a)(t.prototype),"start",this).call(this,6)}},{key:"monitor",value:(c=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)}))),function(){return c.apply(this,arguments)})},{key:"analyseOfBuy",value:(r=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.code;case 2:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"analyseOfSell",value:(n=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.code,t.change;case 2:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]),t}(Ot)};var Mt={"long-impulse":{analyseOfBuy:function(e){},analyseOfSell:function(e){}},"short-impulse":{analyseOfBuy:function(e){},analyseOfSell:function(e){}}},St=function(e){function t(){return Object(i.a)(this,t),Object(S.a)(this,Object(E.a)(t).apply(this,arguments))}var n;return Object(I.a)(t,e),Object(o.a)(t,[{key:"capture",value:(n=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})}]),t}(ft);Object(u.a)(St,"Processors",Vt),Object(u.a)(St,"Simulators",Mt);var Et=new(function(){function e(){Object(i.a)(this,e),Object(u.a)(this,"Controllers",{bond:Dt,future:St})}return Object(o.a)(e,[{key:"processor",value:function(e,t,n){return new(0,this.Controllers[e])(this.Controllers[e].Processors[t],e,t,n)}},{key:"simulator",value:function(e,t,n,r,a){var s=this.Controllers[e].Simulators[t];return new pt(s,n,r,a)}},{key:"processors",value:function(e){return this.Controllers[e].Processors}},{key:"simulators",value:function(e){return this.Controllers[e].Simulators}}]),e}());window.__Walle_Stock_Loop=at,window.__Walle_Stock_Controller=Ne,window.__Walle_Stock_Pool=k.a,window.__Walle_Stock_Bond=Ue,window.__Walle_Stock_Flow=j,window.__Walle_Stock_Gene=C,window.__Walle_Stock_Crawler=f.a,window.__Walle_Stock_Trader=R.a,window.__Walle_Stock_Twist=Ge,window.__Walle_Stock_Twist.gap=Ze,window.__Walle_Stock_Strategy=it.a,window.__Walle_Stock_Define=V.rb,window.__Walle_Stock_Market=_e,window.__Walle_Stock_Whitelist=d.a,window.__Walle_Stock_Cron=v.a,window.__Walle_Stock_Validator=M,window.__Walle_Stock_Mail=U.a,window.__Walle_Stock_Captcha=ot.a,window.__Walle_Stock_Config=g.a,window.__Walle_Stock_T0=Et}}]);